1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 47a2   February 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.80.1.el7.x86_64(x86_64)       
                 Created on 10/27/23 at 17:28:30 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 27. 2023. JOBID=9843992610
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 27. 2023. JOBID=9843992610
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10947): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "468"
 Parameter: NAT <- "468"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "468"
 Parameter: NAT -> "468"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""468"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "468" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "485"
 Parameter: NAT <- "485"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "485"
 Parameter: NAT -> "485"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""485"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "485" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "488"
 Parameter: NAT <- "488"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "488"
 Parameter: NAT -> "488"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""488"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "488" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/cam.str
 VOPEN> Attempting to open::toppar/cam.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/cam.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY GENERATED BY PARMED
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY PARMED
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for CAM interacting with
 CHARMM>    ! water.
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CAM AND WATER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "554"
 Parameter: NAT <- "554"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "554"
 Parameter: NAT -> "554"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""554"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "554" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides, Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "585"
 Parameter: NAT <- "585"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "585"
 Parameter: NAT -> "585"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""585"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "585" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14748): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14769): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 15108): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15109): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15110): OG31  CG30  CG3C  HGA1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15108): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15109): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15110): OG31  CG30  CG3C  HGA1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF, PAR_ALL36_LIPID.PRM
 RDTITL> * AND
 RDTITL> * TOPPAR_ALL36_LIPID_BACTERIAL.STR
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated ANGLE parameter (  5023): CEL1  CEL1  CTL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15355): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15356): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15355): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15356): CTL2  CG2O  CTL1  CTL3 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    define PROT sele none end
 SELRPN>      0 atoms have been selected out of      0
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 82.1644692
 Parameter: A <- "82.1644692"
  
 CHARMM>     SET B        = 82.1644692
 Parameter: B <- "82.1644692"
  
 CHARMM>     SET C        = 85
 Parameter: C <- "85"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = 0
 Parameter: ZCEN <- "0"
  
 CHARMM>     SET NLIPTOP  = 100
 Parameter: NLIPTOP <- "100"
  
 CHARMM>     SET NLIPBOT  = 100
 Parameter: NLIPBOT <- "100"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 22.5
 Parameter: WATBOXZ <- "22.5"
  
 CHARMM>     SET NCHARGE  = -20
 Parameter: NCHARGE <- "-20"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being appended from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 27. 2023. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:    10/27/23     16:56: 4      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      200
         Number of atoms         =    26660   Number of groups     =     6820
         Number of bonds         =    26460   Number of angles     =    50900
         Number of dihedrals     =    70780   Number of impropers  =      420
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =  -20.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 27. 2023. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:    10/27/23     16:56: 5      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    ! Write coordinates
 CHARMM>    open write unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for WRITE access to step4.3_ion_protmemb.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of  26660
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR     26660 SELECTED ATOMS:
    XMIN =  -46.208328 XMAX =   44.175993 XAVE =   -0.044421
    YMIN =  -44.517966 YMAX =   45.882363 YAVE =    0.925250
    ZMIN =  -23.352064 ZMAX =   23.459872 ZAVE =    0.096244
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "44.1759928"
 RDCMND substituted energy or value "?XMIN" to "-46.2083283"
Evaluating: INT((44.1759928--46.2083283+5.0)/0.5)+1
 Parameter: XDIM <- "191"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "45.8823629"
 RDCMND substituted energy or value "?YMIN" to "-44.5179659"
Evaluating: INT((45.8823629--44.5179659+5.0)/0.5)+1
 Parameter: YDIM <- "191"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "23.459872"
 RDCMND substituted energy or value "?ZMIN" to "-23.3520643"
Evaluating: INT((23.459872--23.3520643+5.0)/0.5)+1
 Parameter: ZDIM <- "104"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "191"
 Parameter: YDIM -> "191"
 Parameter: ZDIM -> "104"
Evaluating: 191*191*104
 Parameter: SPACE <- "3794024"
  
 CHARMM>     
  
 CHARMM>    ! prevent overflow on integer conversion
 CHARMM>    calc maxint = 2**32 / 2 - 1
Evaluating: 2**32/2-1
 Parameter: MAXINT <- "2.147483647E+09"
  
 CHARMM>    if space .gt. @maxint calc space = @maxint
 Parameter: MAXINT -> "2.147483647E+09"
 Parameter: MAXINT -> "2.147483647E+09"
 Comparing "3794024" and "2.147483647E+09".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "3794024"
 SELRPN>  26660 atoms have been selected out of  26660
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -48.9483 XMAX=     46.8355 NX= 190
   YMIN=    -47.2580 YMAX=     48.6224 NY= 191
   ZMIN=    -26.1000 ZMAX=     26.0730 NZ= 103


 A TOTAL OF    15763   VACUUM POINTS WERE FOUND
 A TOTAL OF  2499874 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  1222233 EXTERNAL POINTS WERE FOUND
 A TOTAL OF  3722107 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  320450.475036
 TOTAL SELECTED  VOLUME =  477124.429585
 TOTAL FREE      VOLUME =    2020.606174
 FRACTIONAL FREE VOLUME =       0.626601
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "320450.475"
 Parameter: SYSVOL <- "320450.475"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "82.1644692"
 Parameter: B -> "82.1644692"
 Parameter: C -> "85"
 Parameter: SYSVOL -> "320450.475"
Evaluating: (82.1644692*82.1644692*85)-320450.475
 Parameter: VOLUMN <- "253384.525"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of  26660
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of  26660
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of  26660
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = POT
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "POT"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-20"
Evaluating: INT(-20)
 Parameter: NCHARGE <- "-20"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-20"
Evaluating: -20
 Parameter: CGTOT <- "-20"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "-20"
 Parameter: POSCHARGE -> "1"
 Comparing "-20" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(-20)/1)
 Parameter: NPOS <- "20"
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "-20"
 Parameter: NEGCHARGE -> "1"
 Comparing "-20" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-20"
 Parameter: NPOS -> "20"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-20+20*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "20"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-20"
 Parameter: NPOS -> "20"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-20+20*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "20"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "253384.525"
 Parameter: NEGVAL -> "1"
Evaluating: 20+INT(0.15*6.021*0.0001*253384.525)*1
 Parameter: NPOS <- "42"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "253384.525"
 Parameter: POSVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*253384.525)*1
 Parameter: NNEG <- "22"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "42" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "22" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "42" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "POT"
 Parameter: NPOS -> "42"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   2 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      242
         Number of atoms         =    26702   Number of groups     =     6862
         Number of bonds         =    26460   Number of angles     =    50900
         Number of dihedrals     =    70780   Number of impropers  =      420
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   22.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     42 atoms have been selected out of  26702
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>     42 atoms have been selected out of  26702
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "22"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   3 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      264
         Number of atoms         =    26724   Number of groups     =     6884
         Number of bonds         =    26460   Number of angles     =    50900
         Number of dihedrals     =    70780   Number of impropers  =      420
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     22 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>     22 atoms have been selected out of  26724
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>     64 atoms have been selected out of  26724
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>     64 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "42"
 Parameter: NNEG -> "22"
Evaluating: 42+22
 Parameter: NION <- "64"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "42"
 Parameter: NPOSTOT <- "42"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "22"
 Parameter: NNEGTOT <- "22"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "64"
 Parameter: NIONTOT <- "64"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "64" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "82.1644692"
 Parameter: B -> "82.1644692"
 Parameter: C -> "85"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =   82.16447 B    =   82.16447 C     =   85.00000
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 27. 2023. JOBID=9843992610
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 27. 2023. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN 0.0 YCEN 0.0 ZCEN @zcen
 Parameter: ZCEN -> "0"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  0.000000
 RESIDUE   82 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  194 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  200 OPERATED ON BY TRANSFORMATION Z0N1Z0R1

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0       40.30
    2  N1Z0N1R1 has       0       0       0       38.61
    3  N1P1N1R1 has       0       0       0       38.79
    4  Z0N1N1R1 has       0       0       0       38.48
    5  Z0Z0N1R1 has       0       0       0       38.19
    6  Z0P1N1R1 has       0       0       0       38.60
    7  N1N1Z0R1 has    1025     265      12        0.00
    8  N1Z0Z0R1 has    5385    1356      51        0.00
    9  N1P1Z0R1 has     481     116       7        0.00
   10  Z0N1Z0R1 has    5260    1325      51        0.00
   12  N1N1P1R1 has       0       0       0       40.45
   13  N1Z0P1R1 has       0       0       0       38.60
   14  N1P1P1R1 has       0       0       0       40.20
 Total of38875 atoms and 9946 groups and  385 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. ( POS .OR. NEG ) END
 SELRPN>  26660 atoms have been selected out of  26724
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "1" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.325564829"
Evaluating: 82.1644692*(0.325564829-0.5)
 Parameter: XPOS <- "-14.3323732"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.947701429"
Evaluating: 82.1644692*(0.947701429-0.5)
 Parameter: YPOS <- "36.7851503"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.865724825"
Evaluating: 85*(0.865724825-0.5)+0
 Parameter: ZPOS <- "31.0866101"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.0866101" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.0866101" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.3323732"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.3323732-0
 Parameter: XTRAN <- "-14.3323732"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.7851503"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 36.7851503-0
 Parameter: YTRAN <- "36.7851503"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.0866101"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.0866101-0
 Parameter: ZTRAN <- "31.0866101"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.3323732"
 Parameter: YTRAN -> "36.7851503"
 Parameter: ZTRAN -> "31.0866101"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -14.332373   36.785150   31.086610
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.746743718"
Evaluating: 0.746743718*360.0
 Parameter: XPHI <- "268.827738"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652396997"
Evaluating: 0.652396997*360.0
 Parameter: YPHI <- "234.862919"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.41278786"
Evaluating: 0.41278786*360.0
 Parameter: ZPHI <- "148.60363"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.3323732"
 Parameter: YPOS -> "36.7851503"
 Parameter: ZPOS -> "31.0866101"
 Parameter: XPHI -> "268.827738"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.020458   -0.999791
    0.000000    0.999791   -0.020458

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   91.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.3323732"
 Parameter: YPOS -> "36.7851503"
 Parameter: ZPOS -> "31.0866101"
 Parameter: YPHI -> "234.862919"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.575535    0.000000    0.817777
    0.000000    1.000000    0.000000
   -0.817777    0.000000   -0.575535

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  125.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.3323732"
 Parameter: YPOS -> "36.7851503"
 Parameter: ZPOS -> "31.0866101"
 Parameter: ZPHI -> "148.60363"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.853584    0.520956    0.000000
   -0.520956   -0.853584    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  148.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.332373 XMAX =  -14.332373 XAVE =  -14.332373
    YMIN =   36.785150 YMAX =   36.785150 YAVE =   36.785150
    ZMIN =   31.086610 ZMAX =   31.086610 ZAVE =   31.086610
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.3323732"
Evaluating: -14.3323732+3.5
 Parameter: XMAX <- "-10.8323732"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.7851503"
Evaluating: 36.7851503+3.5
 Parameter: YMAX <- "40.2851503"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.0866101"
Evaluating: 31.0866101+3.5
 Parameter: ZMAX <- "34.5866101"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.3323732"
Evaluating: -14.3323732-3.5
 Parameter: XMIN <- "-17.8323732"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.7851503"
Evaluating: 36.7851503-3.5
 Parameter: YMIN <- "33.2851503"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.0866101"
Evaluating: 31.0866101-3.5
 Parameter: ZMIN <- "27.5866101"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.8323732"
 Parameter: XMIN -> "-17.8323732"
 Parameter: YMAX -> "40.2851503"
 Parameter: YMIN -> "33.2851503"
 Parameter: ZMAX -> "34.5866101"
 Parameter: ZMIN -> "27.5866101"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "2" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "2" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "2.005598268E-02"
Evaluating: 82.1644692*(2.005598268E-02-0.5)
 Parameter: XPOS <- "-39.4343454"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.423880501"
Evaluating: 82.1644692*(0.423880501-0.5)
 Parameter: YPOS <- "-6.25431823"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.607951984"
Evaluating: 85*(0.607951984-0.5)+0
 Parameter: ZPOS <- "9.17591864"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.17591864" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.17591864" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "2" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.491566514"
Evaluating: 82.1644692*(0.491566514-0.5)
 Parameter: XPOS <- "-0.692932901"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.73333078"
Evaluating: 82.1644692*(0.73333078-0.5)
 Parameter: YPOS <- "19.1714997"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.468764427"
Evaluating: 85*(0.468764427-0.5)+0
 Parameter: ZPOS <- "-2.65502371"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.65502371" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.65502371" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "2" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.8835207"
Evaluating: 82.1644692*(0.8835207-0.5)
 Parameter: XPOS <- "31.5117747"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.526219206"
Evaluating: 82.1644692*(0.526219206-0.5)
 Parameter: YPOS <- "2.15428714"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.96153366"
Evaluating: 85*(0.96153366-0.5)+0
 Parameter: ZPOS <- "39.2303611"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.2303611" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.2303611" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.5117747"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.5117747-0
 Parameter: XTRAN <- "31.5117747"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.15428714"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.15428714-0
 Parameter: YTRAN <- "2.15428714"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.2303611"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.2303611-0
 Parameter: ZTRAN <- "39.2303611"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.5117747"
 Parameter: YTRAN -> "2.15428714"
 Parameter: ZTRAN -> "39.2303611"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    31.511775    2.154287   39.230361
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950753425"
Evaluating: 0.950753425*360.0
 Parameter: XPHI <- "342.271233"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.455570766"
Evaluating: 0.455570766*360.0
 Parameter: YPHI <- "164.005476"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.44390217E-02"
Evaluating: 3.44390217E-02*360.0
 Parameter: ZPHI <- "12.3980478"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.5117747"
 Parameter: YPOS -> "2.15428714"
 Parameter: ZPOS -> "39.2303611"
 Parameter: XPHI -> "342.271233"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.952509   -0.304511
    0.000000    0.304511    0.952509

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   17.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.5117747"
 Parameter: YPOS -> "2.15428714"
 Parameter: ZPOS -> "39.2303611"
 Parameter: YPHI -> "164.005476"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.961288    0.000000   -0.275545
    0.000000    1.000000    0.000000
    0.275545    0.000000   -0.961288

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  164.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.5117747"
 Parameter: YPOS -> "2.15428714"
 Parameter: ZPOS -> "39.2303611"
 Parameter: ZPHI -> "12.3980478"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.976680    0.214702    0.000000
   -0.214702    0.976680    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.511775 XMAX =   31.511775 XAVE =   31.511775
    YMIN =    2.154287 YMAX =    2.154287 YAVE =    2.154287
    ZMIN =   39.230361 ZMAX =   39.230361 ZAVE =   39.230361
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.5117747"
Evaluating: 31.5117747+3.5
 Parameter: XMAX <- "35.0117747"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.15428714"
Evaluating: 2.15428714+3.5
 Parameter: YMAX <- "5.65428714"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.2303611"
Evaluating: 39.2303611+3.5
 Parameter: ZMAX <- "42.7303611"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.5117747"
Evaluating: 31.5117747-3.5
 Parameter: XMIN <- "28.0117747"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.15428714"
Evaluating: 2.15428714-3.5
 Parameter: YMIN <- "-1.34571286"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.2303611"
Evaluating: 39.2303611-3.5
 Parameter: ZMIN <- "35.7303611"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.0117747"
 Parameter: XMIN -> "28.0117747"
 Parameter: YMAX -> "5.65428714"
 Parameter: YMIN -> "-1.34571286"
 Parameter: ZMAX -> "42.7303611"
 Parameter: ZMIN -> "35.7303611"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "3" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "3" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.915825924"
Evaluating: 82.1644692*(0.915825924-0.5)
 Parameter: XPOS <- "34.1661163"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.946654895"
Evaluating: 82.1644692*(0.946654895-0.5)
 Parameter: YPOS <- "36.6991624"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.66661801"
Evaluating: 85*(0.66661801-0.5)+0
 Parameter: ZPOS <- "14.1625309"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.1625309" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.1625309" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "3" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.887526539"
Evaluating: 82.1644692*(0.887526539-0.5)
 Parameter: XPOS <- "31.8409124"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.771631506"
Evaluating: 82.1644692*(0.771631506-0.5)
 Parameter: YPOS <- "22.3184585"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.298097294"
Evaluating: 85*(0.298097294-0.5)+0
 Parameter: ZPOS <- "-17.16173"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.16173" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.8409124"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.8409124-0
 Parameter: XTRAN <- "31.8409124"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.3184585"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.3184585-0
 Parameter: YTRAN <- "22.3184585"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.16173"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.16173-0
 Parameter: ZTRAN <- "-17.16173"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.8409124"
 Parameter: YTRAN -> "22.3184585"
 Parameter: ZTRAN -> "-17.16173"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    31.840912   22.318458  -17.161730
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193225818"
Evaluating: 0.193225818*360.0
 Parameter: XPHI <- "69.5612945"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.385251335E-02"
Evaluating: 7.385251335E-02*360.0
 Parameter: YPHI <- "26.5869048"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918343595"
Evaluating: 0.918343595*360.0
 Parameter: ZPHI <- "330.603694"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.8409124"
 Parameter: YPOS -> "22.3184585"
 Parameter: ZPOS -> "-17.16173"
 Parameter: XPHI -> "69.5612945"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.349205    0.937046
    0.000000   -0.937046    0.349205

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   69.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.8409124"
 Parameter: YPOS -> "22.3184585"
 Parameter: ZPOS -> "-17.16173"
 Parameter: YPHI -> "26.5869048"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.894257    0.000000   -0.447555
    0.000000    1.000000    0.000000
    0.447555    0.000000    0.894257

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   26.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.8409124"
 Parameter: YPOS -> "22.3184585"
 Parameter: ZPOS -> "-17.16173"
 Parameter: ZPHI -> "330.603694"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.871245   -0.490848    0.000000
    0.490848    0.871245    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.840912 XMAX =   31.840912 XAVE =   31.840912
    YMIN =   22.318458 YMAX =   22.318458 YAVE =   22.318458
    ZMIN =  -17.161730 ZMAX =  -17.161730 ZAVE =  -17.161730
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.8409124"
Evaluating: 31.8409124+3.5
 Parameter: XMAX <- "35.3409124"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.3184585"
Evaluating: 22.3184585+3.5
 Parameter: YMAX <- "25.8184585"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.16173"
Evaluating: -17.16173+3.5
 Parameter: ZMAX <- "-13.66173"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.8409124"
Evaluating: 31.8409124-3.5
 Parameter: XMIN <- "28.3409124"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.3184585"
Evaluating: 22.3184585-3.5
 Parameter: YMIN <- "18.8184585"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.16173"
Evaluating: -17.16173-3.5
 Parameter: ZMIN <- "-20.66173"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.3409124"
 Parameter: XMIN -> "28.3409124"
 Parameter: YMAX -> "25.8184585"
 Parameter: YMIN -> "18.8184585"
 Parameter: ZMAX -> "-13.66173"
 Parameter: ZMIN -> "-20.66173"
 SELRPN>     27 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     13 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26663 POS      POT      3        POT     -**** MEMB     POPC     157      O13           3.2064
26663 POS      POT      3        POT     -**** MEMB     POPC     157      C1            3.2216
26663 POS      POT      3        POT     -**** MEMB     POPC     157      C2            3.6315
26663 POS      POT      3        POT     -**** MEMB     POPC     157      C3            3.5667
26663 POS      POT      3        POT     -**** MEMB     POPC     181      C11           2.7542
26663 POS      POT      3        POT     -**** MEMB     POPC     181      P             3.1435
26663 POS      POT      3        POT     -**** MEMB     POPC     181      O13           2.0577
26663 POS      POT      3        POT     -**** MEMB     POPC     181      O12           3.1037
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "3" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.510277018"
Evaluating: 82.1644692*(0.510277018-0.5)
 Parameter: XPOS <- "0.844405729"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.507766185"
Evaluating: 82.1644692*(0.507766185-0.5)
 Parameter: YPOS <- "0.638104468"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.61681968"
Evaluating: 85*(0.61681968-0.5)+0
 Parameter: ZPOS <- "9.9296728"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.9296728" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.9296728" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "3" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.388435308"
Evaluating: 82.1644692*(0.388435308-0.5)
 Parameter: XPOS <- "-9.1666537"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.85584096"
Evaluating: 82.1644692*(0.85584096-0.5)
 Parameter: YPOS <- "29.2374836"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "5.389394576E-02"
Evaluating: 85*(5.389394576E-02-0.5)+0
 Parameter: ZPOS <- "-37.9190146"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.9190146" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.840912 XMAX =   31.840912 XAVE =   31.840912
    YMIN =   22.318458 YMAX =   22.318458 YAVE =   22.318458
    ZMIN =  -17.161730 ZMAX =  -17.161730 ZAVE =  -17.161730
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.1666537"
 RDCMND substituted energy or value "?XAVE" to "31.8409124"
Evaluating: -9.1666537-31.8409124
 Parameter: XTRAN <- "-41.0075661"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.2374836"
 RDCMND substituted energy or value "?YAVE" to "22.3184585"
Evaluating: 29.2374836-22.3184585
 Parameter: YTRAN <- "6.9190251"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.9190146"
 RDCMND substituted energy or value "?ZAVE" to "-17.16173"
Evaluating: -37.9190146--17.16173
 Parameter: ZTRAN <- "-20.7572846"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.0075661"
 Parameter: YTRAN -> "6.9190251"
 Parameter: ZTRAN -> "-20.7572846"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -41.007566    6.919025  -20.757285
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.920319061"
Evaluating: 0.920319061*360.0
 Parameter: XPHI <- "331.314862"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174510345"
Evaluating: 0.174510345*360.0
 Parameter: YPHI <- "62.8237242"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.497371966"
Evaluating: 0.497371966*360.0
 Parameter: ZPHI <- "179.053908"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.1666537"
 Parameter: YPOS -> "29.2374836"
 Parameter: ZPOS -> "-37.9190146"
 Parameter: XPHI -> "331.314862"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.877271   -0.479996
    0.000000    0.479996    0.877271

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   28.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.1666537"
 Parameter: YPOS -> "29.2374836"
 Parameter: ZPOS -> "-37.9190146"
 Parameter: YPHI -> "62.8237242"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.456730    0.000000   -0.889606
    0.000000    1.000000    0.000000
    0.889606    0.000000    0.456730

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   62.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.1666537"
 Parameter: YPOS -> "29.2374836"
 Parameter: ZPOS -> "-37.9190146"
 Parameter: ZPHI -> "179.053908"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.999864    0.016512    0.000000
   -0.016512   -0.999864    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.166654 XMAX =   -9.166654 XAVE =   -9.166654
    YMIN =   29.237484 YMAX =   29.237484 YAVE =   29.237484
    ZMIN =  -37.919015 ZMAX =  -37.919015 ZAVE =  -37.919015
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.1666537"
Evaluating: -9.1666537+3.5
 Parameter: XMAX <- "-5.6666537"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.2374836"
Evaluating: 29.2374836+3.5
 Parameter: YMAX <- "32.7374836"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.9190146"
Evaluating: -37.9190146+3.5
 Parameter: ZMAX <- "-34.4190146"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.1666537"
Evaluating: -9.1666537-3.5
 Parameter: XMIN <- "-12.6666537"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.2374836"
Evaluating: 29.2374836-3.5
 Parameter: YMIN <- "25.7374836"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.9190146"
Evaluating: -37.9190146-3.5
 Parameter: ZMIN <- "-41.4190146"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.6666537"
 Parameter: XMIN -> "-12.6666537"
 Parameter: YMAX -> "32.7374836"
 Parameter: YMIN -> "25.7374836"
 Parameter: ZMAX -> "-34.4190146"
 Parameter: ZMIN -> "-41.4190146"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "4" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "4" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.41997073"
Evaluating: 82.1644692*(0.41997073-0.5)
 Parameter: XPOS <- "-6.57556249"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.956846282"
Evaluating: 82.1644692*(0.956846282-0.5)
 Parameter: YPOS <- "37.5365323"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.979853326"
Evaluating: 85*(0.979853326-0.5)+0
 Parameter: ZPOS <- "40.7875327"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.7875327" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.7875327" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.57556249"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.57556249-0
 Parameter: XTRAN <- "-6.57556249"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.5365323"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.5365323-0
 Parameter: YTRAN <- "37.5365323"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.7875327"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.7875327-0
 Parameter: ZTRAN <- "40.7875327"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.57556249"
 Parameter: YTRAN -> "37.5365323"
 Parameter: ZTRAN -> "40.7875327"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -6.575562   37.536532   40.787533
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.602777179"
Evaluating: 0.602777179*360.0
 Parameter: XPHI <- "216.999784"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.108160834"
Evaluating: 0.108160834*360.0
 Parameter: YPHI <- "38.9379002"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.749759432"
Evaluating: 0.749759432*360.0
 Parameter: ZPHI <- "269.913396"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.57556249"
 Parameter: YPOS -> "37.5365323"
 Parameter: ZPOS -> "40.7875327"
 Parameter: XPHI -> "216.999784"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.798638   -0.601812
    0.000000    0.601812   -0.798638

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  143.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.57556249"
 Parameter: YPOS -> "37.5365323"
 Parameter: ZPOS -> "40.7875327"
 Parameter: YPHI -> "38.9379002"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.777828    0.000000   -0.628478
    0.000000    1.000000    0.000000
    0.628478    0.000000    0.777828

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   38.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.57556249"
 Parameter: YPOS -> "37.5365323"
 Parameter: ZPOS -> "40.7875327"
 Parameter: ZPHI -> "269.913396"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.001512   -0.999999    0.000000
    0.999999   -0.001512    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   90.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.575562 XMAX =   -6.575562 XAVE =   -6.575562
    YMIN =   37.536532 YMAX =   37.536532 YAVE =   37.536532
    ZMIN =   40.787533 ZMAX =   40.787533 ZAVE =   40.787533
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.57556249"
Evaluating: -6.57556249+3.5
 Parameter: XMAX <- "-3.07556249"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.5365323"
Evaluating: 37.5365323+3.5
 Parameter: YMAX <- "41.0365323"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.7875327"
Evaluating: 40.7875327+3.5
 Parameter: ZMAX <- "44.2875327"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.57556249"
Evaluating: -6.57556249-3.5
 Parameter: XMIN <- "-10.0755625"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.5365323"
Evaluating: 37.5365323-3.5
 Parameter: YMIN <- "34.0365323"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.7875327"
Evaluating: 40.7875327-3.5
 Parameter: ZMIN <- "37.2875327"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.07556249"
 Parameter: XMIN -> "-10.0755625"
 Parameter: YMAX -> "41.0365323"
 Parameter: YMIN -> "34.0365323"
 Parameter: ZMAX -> "44.2875327"
 Parameter: ZMIN -> "37.2875327"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "5" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "5" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.632784781"
Evaluating: 82.1644692*(0.632784781-0.5)
 Parameter: XPOS <- "10.910191"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.23263249"
Evaluating: 82.1644692*(0.23263249-0.5)
 Parameter: YPOS <- "-21.9681095"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.918645671"
Evaluating: 85*(0.918645671-0.5)+0
 Parameter: ZPOS <- "35.584882"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.584882" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.584882" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.910191"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.910191-0
 Parameter: XTRAN <- "10.910191"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.9681095"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.9681095-0
 Parameter: YTRAN <- "-21.9681095"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.584882"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.584882-0
 Parameter: ZTRAN <- "35.584882"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.910191"
 Parameter: YTRAN -> "-21.9681095"
 Parameter: ZTRAN -> "35.584882"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    10.910191  -21.968110   35.584882
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.72032981"
Evaluating: 0.72032981*360.0
 Parameter: XPHI <- "259.318732"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.808741309"
Evaluating: 0.808741309*360.0
 Parameter: YPHI <- "291.146871"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.399084019"
Evaluating: 0.399084019*360.0
 Parameter: ZPHI <- "143.670247"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.910191"
 Parameter: YPOS -> "-21.9681095"
 Parameter: ZPOS -> "35.584882"
 Parameter: XPHI -> "259.318732"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.185345   -0.982673
    0.000000    0.982673   -0.185345

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.910191"
 Parameter: YPOS -> "-21.9681095"
 Parameter: ZPOS -> "35.584882"
 Parameter: YPHI -> "291.146871"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.360760    0.000000    0.932659
    0.000000    1.000000    0.000000
   -0.932659    0.000000    0.360760

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   68.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.910191"
 Parameter: YPOS -> "-21.9681095"
 Parameter: ZPOS -> "35.584882"
 Parameter: ZPHI -> "143.670247"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.805621    0.592432    0.000000
   -0.592432   -0.805621    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  143.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.910191 XMAX =   10.910191 XAVE =   10.910191
    YMIN =  -21.968110 YMAX =  -21.968110 YAVE =  -21.968110
    ZMIN =   35.584882 ZMAX =   35.584882 ZAVE =   35.584882
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.910191"
Evaluating: 10.910191+3.5
 Parameter: XMAX <- "14.410191"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.9681095"
Evaluating: -21.9681095+3.5
 Parameter: YMAX <- "-18.4681095"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.584882"
Evaluating: 35.584882+3.5
 Parameter: ZMAX <- "39.084882"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.910191"
Evaluating: 10.910191-3.5
 Parameter: XMIN <- "7.410191"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.9681095"
Evaluating: -21.9681095-3.5
 Parameter: YMIN <- "-25.4681095"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.584882"
Evaluating: 35.584882-3.5
 Parameter: ZMIN <- "32.084882"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.410191"
 Parameter: XMIN -> "7.410191"
 Parameter: YMAX -> "-18.4681095"
 Parameter: YMIN -> "-25.4681095"
 Parameter: ZMAX -> "39.084882"
 Parameter: ZMIN -> "32.084882"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "6" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "6" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.68963979"
Evaluating: 82.1644692*(0.68963979-0.5)
 Parameter: XPOS <- "15.5816527"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.913949218"
Evaluating: 82.1644692*(0.913949218-0.5)
 Parameter: YPOS <- "34.0119178"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.781426501"
Evaluating: 85*(0.781426501-0.5)+0
 Parameter: ZPOS <- "23.9212526"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.9212526" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.9212526" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.5816527"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.5816527-0
 Parameter: XTRAN <- "15.5816527"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.0119178"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.0119178-0
 Parameter: YTRAN <- "34.0119178"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.9212526"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.9212526-0
 Parameter: ZTRAN <- "23.9212526"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.5816527"
 Parameter: YTRAN -> "34.0119178"
 Parameter: ZTRAN -> "23.9212526"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    15.581653   34.011918   23.921253
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.412208242"
Evaluating: 0.412208242*360.0
 Parameter: XPHI <- "148.394967"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.785638646E-02"
Evaluating: 4.785638646E-02*360.0
 Parameter: YPHI <- "17.2282991"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396234971"
Evaluating: 0.396234971*360.0
 Parameter: ZPHI <- "142.64459"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.5816527"
 Parameter: YPOS -> "34.0119178"
 Parameter: ZPOS -> "23.9212526"
 Parameter: XPHI -> "148.394967"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.851681    0.524061
    0.000000   -0.524061   -0.851681

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  148.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.5816527"
 Parameter: YPOS -> "34.0119178"
 Parameter: ZPOS -> "23.9212526"
 Parameter: YPHI -> "17.2282991"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.955132    0.000000   -0.296180
    0.000000    1.000000    0.000000
    0.296180    0.000000    0.955132

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   17.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.5816527"
 Parameter: YPOS -> "34.0119178"
 Parameter: ZPOS -> "23.9212526"
 Parameter: ZPHI -> "142.64459"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.794887    0.606757    0.000000
   -0.606757   -0.794887    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.581653 XMAX =   15.581653 XAVE =   15.581653
    YMIN =   34.011918 YMAX =   34.011918 YAVE =   34.011918
    ZMIN =   23.921253 ZMAX =   23.921253 ZAVE =   23.921253
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.5816527"
Evaluating: 15.5816527+3.5
 Parameter: XMAX <- "19.0816527"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.0119178"
Evaluating: 34.0119178+3.5
 Parameter: YMAX <- "37.5119178"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.9212526"
Evaluating: 23.9212526+3.5
 Parameter: ZMAX <- "27.4212526"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.5816527"
Evaluating: 15.5816527-3.5
 Parameter: XMIN <- "12.0816527"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.0119178"
Evaluating: 34.0119178-3.5
 Parameter: YMIN <- "30.5119178"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.9212526"
Evaluating: 23.9212526-3.5
 Parameter: ZMIN <- "20.4212526"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.0816527"
 Parameter: XMIN -> "12.0816527"
 Parameter: YMAX -> "37.5119178"
 Parameter: YMIN -> "30.5119178"
 Parameter: ZMAX -> "27.4212526"
 Parameter: ZMIN -> "20.4212526"
 SELRPN>      5 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "7" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "7" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.916080966"
Evaluating: 82.1644692*(0.916080966-0.5)
 Parameter: XPOS <- "34.1870717"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.36524869"
Evaluating: 82.1644692*(0.36524869-0.5)
 Parameter: YPOS <- "-11.0717699"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.259684406"
Evaluating: 85*(0.259684406-0.5)+0
 Parameter: ZPOS <- "-20.4268255"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.4268255" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.1870717"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.1870717-0
 Parameter: XTRAN <- "34.1870717"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.0717699"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.0717699-0
 Parameter: YTRAN <- "-11.0717699"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.4268255"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.4268255-0
 Parameter: ZTRAN <- "-20.4268255"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.1870717"
 Parameter: YTRAN -> "-11.0717699"
 Parameter: ZTRAN -> "-20.4268255"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    34.187072  -11.071770  -20.426825
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.129677597E-02"
Evaluating: 3.129677597E-02*360.0
 Parameter: XPHI <- "11.2668393"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.350591935"
Evaluating: 0.350591935*360.0
 Parameter: YPHI <- "126.213097"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738660275"
Evaluating: 0.738660275*360.0
 Parameter: ZPHI <- "265.917699"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.1870717"
 Parameter: YPOS -> "-11.0717699"
 Parameter: ZPOS -> "-20.4268255"
 Parameter: XPHI -> "11.2668393"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.980728    0.195379
    0.000000   -0.195379    0.980728

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.1870717"
 Parameter: YPOS -> "-11.0717699"
 Parameter: ZPOS -> "-20.4268255"
 Parameter: YPHI -> "126.213097"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.590790    0.000000   -0.806825
    0.000000    1.000000    0.000000
    0.806825    0.000000   -0.590790

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  126.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.1870717"
 Parameter: YPOS -> "-11.0717699"
 Parameter: ZPOS -> "-20.4268255"
 Parameter: ZPHI -> "265.917699"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.071189   -0.997463    0.000000
    0.997463   -0.071189    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   94.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.187072 XMAX =   34.187072 XAVE =   34.187072
    YMIN =  -11.071770 YMAX =  -11.071770 YAVE =  -11.071770
    ZMIN =  -20.426825 ZMAX =  -20.426825 ZAVE =  -20.426825
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.1870717"
Evaluating: 34.1870717+3.5
 Parameter: XMAX <- "37.6870717"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.0717699"
Evaluating: -11.0717699+3.5
 Parameter: YMAX <- "-7.5717699"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.4268255"
Evaluating: -20.4268255+3.5
 Parameter: ZMAX <- "-16.9268255"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.1870717"
Evaluating: 34.1870717-3.5
 Parameter: XMIN <- "30.6870717"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.0717699"
Evaluating: -11.0717699-3.5
 Parameter: YMIN <- "-14.5717699"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.4268255"
Evaluating: -20.4268255-3.5
 Parameter: ZMIN <- "-23.9268255"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.6870717"
 Parameter: XMIN -> "30.6870717"
 Parameter: YMAX -> "-7.5717699"
 Parameter: YMIN -> "-14.5717699"
 Parameter: ZMAX -> "-16.9268255"
 Parameter: ZMIN -> "-23.9268255"
 SELRPN>     21 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      8 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26667 POS      POT      7        POT     -**** MEMB     POPC     154      N             2.3529
26667 POS      POT      7        POT     -**** MEMB     POPC     154      C12           1.3744
26667 POS      POT      7        POT     -**** MEMB     POPC     154      C13           3.4099
26667 POS      POT      7        POT     -**** MEMB     POPC     154      C14           3.2939
26667 POS      POT      7        POT     -**** MEMB     POPC     154      C15           2.4432
26667 POS      POT      7        POT     -**** MEMB     POPC     154      C11           1.3102
26667 POS      POT      7        POT     -**** MEMB     POPC     154      O12           2.6726
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "7" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.335113127"
Evaluating: 82.1644692*(0.335113127-0.5)
 Parameter: XPOS <- "-13.5478424"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.168038225"
Evaluating: 82.1644692*(0.168038225-0.5)
 Parameter: YPOS <- "-27.275463"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.596795497"
Evaluating: 85*(0.596795497-0.5)+0
 Parameter: ZPOS <- "8.22761724"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.22761724" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.22761724" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "7" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.504425961"
Evaluating: 82.1644692*(0.504425961-0.5)
 Parameter: XPOS <- "0.363656736"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.973703628"
Evaluating: 82.1644692*(0.973703628-0.5)
 Parameter: YPOS <- "38.9216072"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.36043969"
Evaluating: 85*(0.36043969-0.5)+0
 Parameter: ZPOS <- "-11.8626263"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.8626263" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.8626263" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "7" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.530903839"
Evaluating: 82.1644692*(0.530903839-0.5)
 Parameter: XPOS <- "2.53919753"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.169078598"
Evaluating: 82.1644692*(0.169078598-0.5)
 Parameter: YPOS <- "-27.1899813"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.82072336"
Evaluating: 85*(0.82072336-0.5)+0
 Parameter: ZPOS <- "27.2614856"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.2614856" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.2614856" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.187072 XMAX =   34.187072 XAVE =   34.187072
    YMIN =  -11.071770 YMAX =  -11.071770 YAVE =  -11.071770
    ZMIN =  -20.426825 ZMAX =  -20.426825 ZAVE =  -20.426825
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.53919753"
 RDCMND substituted energy or value "?XAVE" to "34.1870717"
Evaluating: 2.53919753-34.1870717
 Parameter: XTRAN <- "-31.6478742"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.1899813"
 RDCMND substituted energy or value "?YAVE" to "-11.0717699"
Evaluating: -27.1899813--11.0717699
 Parameter: YTRAN <- "-16.1182114"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.2614856"
 RDCMND substituted energy or value "?ZAVE" to "-20.4268255"
Evaluating: 27.2614856--20.4268255
 Parameter: ZTRAN <- "47.6883111"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.6478742"
 Parameter: YTRAN -> "-16.1182114"
 Parameter: ZTRAN -> "47.6883111"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -31.647874  -16.118211   47.688311
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.22259075"
Evaluating: 0.22259075*360.0
 Parameter: XPHI <- "80.13267"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.553682085"
Evaluating: 0.553682085*360.0
 Parameter: YPHI <- "199.325551"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.996304901"
Evaluating: 0.996304901*360.0
 Parameter: ZPHI <- "358.669764"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.53919753"
 Parameter: YPOS -> "-27.1899813"
 Parameter: ZPOS -> "27.2614856"
 Parameter: XPHI -> "80.13267"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.171367    0.985207
    0.000000   -0.985207    0.171367

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   80.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.53919753"
 Parameter: YPOS -> "-27.1899813"
 Parameter: ZPOS -> "27.2614856"
 Parameter: YPHI -> "199.325551"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.943653    0.000000    0.330935
    0.000000    1.000000    0.000000
   -0.330935    0.000000   -0.943653

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  160.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.53919753"
 Parameter: YPOS -> "-27.1899813"
 Parameter: ZPOS -> "27.2614856"
 Parameter: ZPHI -> "358.669764"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.999730   -0.023215    0.000000
    0.023215    0.999730    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    1.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.539198 XMAX =    2.539198 XAVE =    2.539198
    YMIN =  -27.189981 YMAX =  -27.189981 YAVE =  -27.189981
    ZMIN =   27.261486 ZMAX =   27.261486 ZAVE =   27.261486
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.53919756"
Evaluating: 2.53919756+3.5
 Parameter: XMAX <- "6.03919756"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.1899813"
Evaluating: -27.1899813+3.5
 Parameter: YMAX <- "-23.6899813"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.2614856"
Evaluating: 27.2614856+3.5
 Parameter: ZMAX <- "30.7614856"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.53919756"
Evaluating: 2.53919756-3.5
 Parameter: XMIN <- "-0.96080244"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.1899813"
Evaluating: -27.1899813-3.5
 Parameter: YMIN <- "-30.6899813"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.2614856"
Evaluating: 27.2614856-3.5
 Parameter: ZMIN <- "23.7614856"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.03919756"
 Parameter: XMIN -> "-0.96080244"
 Parameter: YMAX -> "-23.6899813"
 Parameter: YMIN -> "-30.6899813"
 Parameter: ZMAX -> "30.7614856"
 Parameter: ZMIN -> "23.7614856"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "8" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "8" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.890860899"
Evaluating: 82.1644692*(0.890860899-0.5)
 Parameter: XPOS <- "32.1148783"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "8.081449244E-02"
Evaluating: 82.1644692*(8.081449244E-02-0.5)
 Parameter: YPOS <- "-34.4421547"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.441992173"
Evaluating: 85*(0.441992173-0.5)+0
 Parameter: ZPOS <- "-4.93066529"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.93066529" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.93066529" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "8" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.184333267"
Evaluating: 82.1644692*(0.184333267-0.5)
 Parameter: XPOS <- "-25.9365896"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.346770437"
Evaluating: 82.1644692*(0.346770437-0.5)
 Parameter: YPOS <- "-12.5900257"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.631769931"
Evaluating: 85*(0.631769931-0.5)+0
 Parameter: ZPOS <- "11.2004441"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.2004441" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.2004441" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "8" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.563293601"
Evaluating: 82.1644692*(0.563293601-0.5)
 Parameter: XPOS <- "5.20048513"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.102191819"
Evaluating: 82.1644692*(0.102191819-0.5)
 Parameter: YPOS <- "-32.685698"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.175777065"
Evaluating: 85*(0.175777065-0.5)+0
 Parameter: ZPOS <- "-27.5589495"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.5589495" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.20048513"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.20048513-0
 Parameter: XTRAN <- "5.20048513"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.685698"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.685698-0
 Parameter: YTRAN <- "-32.685698"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.5589495"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.5589495-0
 Parameter: ZTRAN <- "-27.5589495"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.20048513"
 Parameter: YTRAN -> "-32.685698"
 Parameter: ZTRAN -> "-27.5589495"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     5.200485  -32.685698  -27.558950
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453719074"
Evaluating: 0.453719074*360.0
 Parameter: XPHI <- "163.338867"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.948073155"
Evaluating: 0.948073155*360.0
 Parameter: YPHI <- "341.306336"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.14129489"
Evaluating: 0.14129489*360.0
 Parameter: ZPHI <- "50.8661604"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.20048513"
 Parameter: YPOS -> "-32.685698"
 Parameter: ZPOS -> "-27.5589495"
 Parameter: XPHI -> "163.338867"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.958017    0.286711
    0.000000   -0.286711   -0.958017

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.20048513"
 Parameter: YPOS -> "-32.685698"
 Parameter: ZPOS -> "-27.5589495"
 Parameter: YPHI -> "341.306336"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.947246    0.000000    0.320508
    0.000000    1.000000    0.000000
   -0.320508    0.000000    0.947246

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   18.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.20048513"
 Parameter: YPOS -> "-32.685698"
 Parameter: ZPOS -> "-27.5589495"
 Parameter: ZPHI -> "50.8661604"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.631134    0.775674    0.000000
   -0.775674    0.631134    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   50.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.200485 XMAX =    5.200485 XAVE =    5.200485
    YMIN =  -32.685698 YMAX =  -32.685698 YAVE =  -32.685698
    ZMIN =  -27.558950 ZMAX =  -27.558950 ZAVE =  -27.558950
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.20048513"
Evaluating: 5.20048513+3.5
 Parameter: XMAX <- "8.70048513"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.685698"
Evaluating: -32.685698+3.5
 Parameter: YMAX <- "-29.185698"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.5589495"
Evaluating: -27.5589495+3.5
 Parameter: ZMAX <- "-24.0589495"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.20048513"
Evaluating: 5.20048513-3.5
 Parameter: XMIN <- "1.70048513"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.685698"
Evaluating: -32.685698-3.5
 Parameter: YMIN <- "-36.185698"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.5589495"
Evaluating: -27.5589495-3.5
 Parameter: ZMIN <- "-31.0589495"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.70048513"
 Parameter: XMIN -> "1.70048513"
 Parameter: YMAX -> "-29.185698"
 Parameter: YMIN -> "-36.185698"
 Parameter: ZMAX -> "-24.0589495"
 Parameter: ZMIN -> "-31.0589495"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "9" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "9" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.640990137"
Evaluating: 82.1644692*(0.640990137-0.5)
 Parameter: XPOS <- "11.5843798"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.861154878"
Evaluating: 82.1644692*(0.861154878-0.5)
 Parameter: YPOS <- "29.6740988"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.316468155"
Evaluating: 85*(0.316468155-0.5)+0
 Parameter: ZPOS <- "-15.6002068"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.6002068" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.5843798"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.5843798-0
 Parameter: XTRAN <- "11.5843798"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.6740988"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.6740988-0
 Parameter: YTRAN <- "29.6740988"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.6002068"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.6002068-0
 Parameter: ZTRAN <- "-15.6002068"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.5843798"
 Parameter: YTRAN -> "29.6740988"
 Parameter: ZTRAN -> "-15.6002068"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    11.584380   29.674099  -15.600207
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.431769065"
Evaluating: 0.431769065*360.0
 Parameter: XPHI <- "155.436863"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.440702234"
Evaluating: 0.440702234*360.0
 Parameter: YPHI <- "158.652804"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.774043505"
Evaluating: 0.774043505*360.0
 Parameter: ZPHI <- "278.655662"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.5843798"
 Parameter: YPOS -> "29.6740988"
 Parameter: ZPOS -> "-15.6002068"
 Parameter: XPHI -> "155.436863"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.909504    0.415696
    0.000000   -0.415696   -0.909504

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  155.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.5843798"
 Parameter: YPOS -> "29.6740988"
 Parameter: ZPOS -> "-15.6002068"
 Parameter: YPHI -> "158.652804"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.931392    0.000000   -0.364019
    0.000000    1.000000    0.000000
    0.364019    0.000000   -0.931392

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  158.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.5843798"
 Parameter: YPOS -> "29.6740988"
 Parameter: ZPOS -> "-15.6002068"
 Parameter: ZPHI -> "278.655662"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.150496   -0.988611    0.000000
    0.988611    0.150496    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   81.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.584380 XMAX =   11.584380 XAVE =   11.584380
    YMIN =   29.674099 YMAX =   29.674099 YAVE =   29.674099
    ZMIN =  -15.600207 ZMAX =  -15.600207 ZAVE =  -15.600207
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.5843798"
Evaluating: 11.5843798+3.5
 Parameter: XMAX <- "15.0843798"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.6740988"
Evaluating: 29.6740988+3.5
 Parameter: YMAX <- "33.1740988"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.6002068"
Evaluating: -15.6002068+3.5
 Parameter: ZMAX <- "-12.1002068"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.5843798"
Evaluating: 11.5843798-3.5
 Parameter: XMIN <- "8.0843798"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.6740988"
Evaluating: 29.6740988-3.5
 Parameter: YMIN <- "26.1740988"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.6002068"
Evaluating: -15.6002068-3.5
 Parameter: ZMIN <- "-19.1002068"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.0843798"
 Parameter: XMIN -> "8.0843798"
 Parameter: YMAX -> "33.1740988"
 Parameter: YMIN -> "26.1740988"
 Parameter: ZMAX -> "-12.1002068"
 Parameter: ZMIN -> "-19.1002068"
 SELRPN>     29 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     18 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26669 POS      POT      9        POT     -**** MEMB     POPC     129      O21           3.5404
26669 POS      POT      9        POT     -**** MEMB     POPC     129      C21           2.8593
26669 POS      POT      9        POT     -**** MEMB     POPC     129      O22           2.6915
26669 POS      POT      9        POT     -**** MEMB     POPC     129      C22           3.3270
26669 POS      POT      9        POT     -**** MEMB     POPC     151      P             2.4069
26669 POS      POT      9        POT     -**** MEMB     POPC     151      O13           3.5927
26669 POS      POT      9        POT     -**** MEMB     POPC     151      O14           1.7791
26669 POS      POT      9        POT     -**** MEMB     POPC     151      O12           3.4020
26669 POS      POT      9        POT     -**** MEMB     POPC     151      O11           2.1007
26669 POS      POT      9        POT     -**** MEMB     POPC     151      C1            2.1987
26669 POS      POT      9        POT     -**** MEMB     POPC     151      C2            1.6109
26669 POS      POT      9        POT     -**** MEMB     POPC     151      O21           1.6360
26669 POS      POT      9        POT     -**** MEMB     POPC     151      C21           2.1737
26669 POS      POT      9        POT     -**** MEMB     POPC     151      O22           2.5210
26669 POS      POT      9        POT     -**** MEMB     POPC     151      C22           3.3069
26669 POS      POT      9        POT     -**** MEMB     POPC     151      C3            3.1381
26669 POS      POT      9        POT     -**** MEMB     POPC     151      O31           3.9788
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        17
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "17"
 Comparing "17" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "9" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.793294566"
Evaluating: 82.1644692*(0.793294566-0.5)
 Parameter: XPOS <- "24.0983923"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.550448582"
Evaluating: 82.1644692*(0.550448582-0.5)
 Parameter: YPOS <- "4.14508096"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.703097247"
Evaluating: 85*(0.703097247-0.5)+0
 Parameter: ZPOS <- "17.263266"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.263266" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.263266" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.584380 XMAX =   11.584380 XAVE =   11.584380
    YMIN =   29.674099 YMAX =   29.674099 YAVE =   29.674099
    ZMIN =  -15.600207 ZMAX =  -15.600207 ZAVE =  -15.600207
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.0983923"
 RDCMND substituted energy or value "?XAVE" to "11.5843798"
Evaluating: 24.0983923-11.5843798
 Parameter: XTRAN <- "12.5140125"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.14508096"
 RDCMND substituted energy or value "?YAVE" to "29.6740988"
Evaluating: 4.14508096-29.6740988
 Parameter: YTRAN <- "-25.5290178"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.263266"
 RDCMND substituted energy or value "?ZAVE" to "-15.6002068"
Evaluating: 17.263266--15.6002068
 Parameter: ZTRAN <- "32.8634728"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.5140125"
 Parameter: YTRAN -> "-25.5290178"
 Parameter: ZTRAN -> "32.8634728"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    12.514012  -25.529018   32.863473
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.440582625"
Evaluating: 0.440582625*360.0
 Parameter: XPHI <- "158.609745"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.332697382"
Evaluating: 0.332697382*360.0
 Parameter: YPHI <- "119.771058"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541694449"
Evaluating: 0.541694449*360.0
 Parameter: ZPHI <- "195.010002"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.0983923"
 Parameter: YPOS -> "4.14508096"
 Parameter: ZPOS -> "17.263266"
 Parameter: XPHI -> "158.609745"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.931118    0.364718
    0.000000   -0.364718   -0.931118

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  158.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.0983923"
 Parameter: YPOS -> "4.14508096"
 Parameter: ZPOS -> "17.263266"
 Parameter: YPHI -> "119.771058"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.496536    0.000000   -0.868016
    0.000000    1.000000    0.000000
    0.868016    0.000000   -0.496536

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  119.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.0983923"
 Parameter: YPOS -> "4.14508096"
 Parameter: ZPOS -> "17.263266"
 Parameter: ZPHI -> "195.010002"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.965881   -0.258988    0.000000
    0.258988   -0.965881    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  164.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.098392 XMAX =   24.098392 XAVE =   24.098392
    YMIN =    4.145081 YMAX =    4.145081 YAVE =    4.145081
    ZMIN =   17.263266 ZMAX =   17.263266 ZAVE =   17.263266
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.0983923"
Evaluating: 24.0983923+3.5
 Parameter: XMAX <- "27.5983923"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.145081"
Evaluating: 4.145081+3.5
 Parameter: YMAX <- "7.645081"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.263266"
Evaluating: 17.263266+3.5
 Parameter: ZMAX <- "20.763266"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.0983923"
Evaluating: 24.0983923-3.5
 Parameter: XMIN <- "20.5983923"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.145081"
Evaluating: 4.145081-3.5
 Parameter: YMIN <- "0.645081"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.263266"
Evaluating: 17.263266-3.5
 Parameter: ZMIN <- "13.763266"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.5983923"
 Parameter: XMIN -> "20.5983923"
 Parameter: YMAX -> "7.645081"
 Parameter: YMIN -> "0.645081"
 Parameter: ZMAX -> "20.763266"
 Parameter: ZMIN -> "13.763266"
 SELRPN>     24 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     12 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26669 POS      POT      9        POT     -1901 MEMB     POPC     15       O22           3.6452
26669 POS      POT      9        POT     -3882 MEMB     POPC     30       C11           3.5521
26669 POS      POT      9        POT     -3885 MEMB     POPC     30       P             2.3255
26669 POS      POT      9        POT     -3886 MEMB     POPC     30       O13           1.1693
26669 POS      POT      9        POT     -3887 MEMB     POPC     30       O14           2.8489
26669 POS      POT      9        POT     -3888 MEMB     POPC     30       O12           3.4426
26669 POS      POT      9        POT     -3889 MEMB     POPC     30       O11           3.4656
26669 POS      POT      9        POT     -3957 MEMB     POPC     30       C33           3.9895
26669 POS      POT      9        POT     -4273 MEMB     POPC     33       C15           3.7067
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "9" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.907675906"
Evaluating: 82.1644692*(0.907675906-0.5)
 Parameter: XPOS <- "33.4964744"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.648770803"
Evaluating: 82.1644692*(0.648770803-0.5)
 Parameter: YPOS <- "12.2236741"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.83939449"
Evaluating: 85*(0.83939449-0.5)+0
 Parameter: ZPOS <- "28.8485316"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.8485316" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.8485316" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.098392 XMAX =   24.098392 XAVE =   24.098392
    YMIN =    4.145081 YMAX =    4.145081 YAVE =    4.145081
    ZMIN =   17.263266 ZMAX =   17.263266 ZAVE =   17.263266
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.4964744"
 RDCMND substituted energy or value "?XAVE" to "24.0983923"
Evaluating: 33.4964744-24.0983923
 Parameter: XTRAN <- "9.3980821"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.2236741"
 RDCMND substituted energy or value "?YAVE" to "4.145081"
Evaluating: 12.2236741-4.145081
 Parameter: YTRAN <- "8.0785931"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.8485316"
 RDCMND substituted energy or value "?ZAVE" to "17.263266"
Evaluating: 28.8485316-17.263266
 Parameter: ZTRAN <- "11.5852656"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.3980821"
 Parameter: YTRAN -> "8.0785931"
 Parameter: ZTRAN -> "11.5852656"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     9.398082    8.078593   11.585266
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.965758805"
Evaluating: 0.965758805*360.0
 Parameter: XPHI <- "347.67317"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174970768"
Evaluating: 0.174970768*360.0
 Parameter: YPHI <- "62.9894765"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.465901141E-02"
Evaluating: 3.465901141E-02*360.0
 Parameter: ZPHI <- "12.4772441"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.4964744"
 Parameter: YPOS -> "12.2236741"
 Parameter: ZPOS -> "28.8485316"
 Parameter: XPHI -> "347.67317"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.976946   -0.213488
    0.000000    0.213488    0.976946

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   12.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.4964744"
 Parameter: YPOS -> "12.2236741"
 Parameter: ZPOS -> "28.8485316"
 Parameter: YPHI -> "62.9894765"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.454154    0.000000   -0.890923
    0.000000    1.000000    0.000000
    0.890923    0.000000    0.454154

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   62.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.4964744"
 Parameter: YPOS -> "12.2236741"
 Parameter: ZPOS -> "28.8485316"
 Parameter: ZPHI -> "12.4772441"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.976382    0.216052    0.000000
   -0.216052    0.976382    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.496474 XMAX =   33.496474 XAVE =   33.496474
    YMIN =   12.223674 YMAX =   12.223674 YAVE =   12.223674
    ZMIN =   28.848532 ZMAX =   28.848532 ZAVE =   28.848532
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.4964744"
Evaluating: 33.4964744+3.5
 Parameter: XMAX <- "36.9964744"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.2236741"
Evaluating: 12.2236741+3.5
 Parameter: YMAX <- "15.7236741"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.8485316"
Evaluating: 28.8485316+3.5
 Parameter: ZMAX <- "32.3485316"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.4964744"
Evaluating: 33.4964744-3.5
 Parameter: XMIN <- "29.9964744"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.2236741"
Evaluating: 12.2236741-3.5
 Parameter: YMIN <- "8.7236741"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.8485316"
Evaluating: 28.8485316-3.5
 Parameter: ZMIN <- "25.3485316"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.9964744"
 Parameter: XMIN -> "29.9964744"
 Parameter: YMAX -> "15.7236741"
 Parameter: YMIN -> "8.7236741"
 Parameter: ZMAX -> "32.3485316"
 Parameter: ZMIN -> "25.3485316"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "10" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "10" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "8.766726281E-02"
Evaluating: 82.1644692*(8.766726281E-02-0.5)
 Parameter: XPOS <- "-33.8791005"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.315199779"
Evaluating: 82.1644692*(0.315199779-0.5)
 Parameter: YPOS <- "-15.1840121"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.611081382"
Evaluating: 85*(0.611081382-0.5)+0
 Parameter: ZPOS <- "9.44191747"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.44191747" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.44191747" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "10" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.488834877"
Evaluating: 82.1644692*(0.488834877-0.5)
 Parameter: XPOS <- "-0.917376405"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.48480909"
Evaluating: 82.1644692*(0.48480909-0.5)
 Parameter: YPOS <- "-1.24815306"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.448603857"
Evaluating: 85*(0.448603857-0.5)+0
 Parameter: ZPOS <- "-4.36867215"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.36867215" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.36867215" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "10" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.468159841"
Evaluating: 82.1644692*(0.468159841-0.5)
 Parameter: XPOS <- "-2.61612976"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.965997951"
Evaluating: 82.1644692*(0.965997951-0.5)
 Parameter: YPOS <- "38.2884743"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.495879454"
Evaluating: 85*(0.495879454-0.5)+0
 Parameter: ZPOS <- "-0.35024641"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.35024641" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.35024641" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "10" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.896918123"
Evaluating: 82.1644692*(0.896918123-0.5)
 Parameter: XPOS <- "32.6125669"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.260496362"
Evaluating: 82.1644692*(0.260496362-0.5)
 Parameter: YPOS <- "-19.6786893"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.819684847"
Evaluating: 85*(0.819684847-0.5)+0
 Parameter: ZPOS <- "27.173212"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.173212" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.173212" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.6125669"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.6125669-0
 Parameter: XTRAN <- "32.6125669"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.6786893"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.6786893-0
 Parameter: YTRAN <- "-19.6786893"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.173212"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.173212-0
 Parameter: ZTRAN <- "27.173212"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.6125669"
 Parameter: YTRAN -> "-19.6786893"
 Parameter: ZTRAN -> "27.173212"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    32.612567  -19.678689   27.173212
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.213108661"
Evaluating: 0.213108661*360.0
 Parameter: XPHI <- "76.719118"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.200015385"
Evaluating: 0.200015385*360.0
 Parameter: YPHI <- "72.0055386"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83850867"
Evaluating: 0.83850867*360.0
 Parameter: ZPHI <- "301.863121"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.6125669"
 Parameter: YPOS -> "-19.6786893"
 Parameter: ZPOS -> "27.173212"
 Parameter: XPHI -> "76.719118"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.229725    0.973256
    0.000000   -0.973256    0.229725

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   76.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.6125669"
 Parameter: YPOS -> "-19.6786893"
 Parameter: ZPOS -> "27.173212"
 Parameter: YPHI -> "72.0055386"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.308925    0.000000   -0.951086
    0.000000    1.000000    0.000000
    0.951086    0.000000    0.308925

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   72.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.6125669"
 Parameter: YPOS -> "-19.6786893"
 Parameter: ZPOS -> "27.173212"
 Parameter: ZPHI -> "301.863121"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.527892   -0.849312    0.000000
    0.849312    0.527892    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   58.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.612567 XMAX =   32.612567 XAVE =   32.612567
    YMIN =  -19.678689 YMAX =  -19.678689 YAVE =  -19.678689
    ZMIN =   27.173212 ZMAX =   27.173212 ZAVE =   27.173212
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.6125669"
Evaluating: 32.6125669+3.5
 Parameter: XMAX <- "36.1125669"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.6786893"
Evaluating: -19.6786893+3.5
 Parameter: YMAX <- "-16.1786893"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.173212"
Evaluating: 27.173212+3.5
 Parameter: ZMAX <- "30.673212"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.6125669"
Evaluating: 32.6125669-3.5
 Parameter: XMIN <- "29.1125669"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.6786893"
Evaluating: -19.6786893-3.5
 Parameter: YMIN <- "-23.1786893"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.173212"
Evaluating: 27.173212-3.5
 Parameter: ZMIN <- "23.673212"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.1125669"
 Parameter: XMIN -> "29.1125669"
 Parameter: YMAX -> "-16.1786893"
 Parameter: YMIN -> "-23.1786893"
 Parameter: ZMAX -> "30.673212"
 Parameter: ZMIN -> "23.673212"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "11" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "11" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.570551859"
Evaluating: 82.1644692*(0.570551859-0.5)
 Parameter: XPOS <- "5.79685605"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "4.341292997E-02"
Evaluating: 82.1644692*(4.341292997E-02-0.5)
 Parameter: YPOS <- "-37.5152343"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.397590462"
Evaluating: 85*(0.397590462-0.5)+0
 Parameter: ZPOS <- "-8.70481073"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.70481073" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.70481073" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "11" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.106117838"
Evaluating: 82.1644692*(0.106117838-0.5)
 Parameter: XPOS <- "-32.3631188"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.401903111"
Evaluating: 82.1644692*(0.401903111-0.5)
 Parameter: YPOS <- "-8.06007881"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.63316894"
Evaluating: 85*(0.63316894-0.5)+0
 Parameter: ZPOS <- "11.3193599"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.3193599" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.3193599" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "11" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.895606755"
Evaluating: 82.1644692*(0.895606755-0.5)
 Parameter: XPOS <- "32.504819"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.927778668"
Evaluating: 82.1644692*(0.927778668-0.5)
 Parameter: YPOS <- "35.1482072"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.718565292"
Evaluating: 85*(0.718565292-0.5)+0
 Parameter: ZPOS <- "18.5780498"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.5780498" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.5780498" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.504819"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.504819-0
 Parameter: XTRAN <- "32.504819"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.1482072"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.1482072-0
 Parameter: YTRAN <- "35.1482072"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.5780498"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.5780498-0
 Parameter: ZTRAN <- "18.5780498"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.504819"
 Parameter: YTRAN -> "35.1482072"
 Parameter: ZTRAN -> "18.5780498"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    32.504819   35.148207   18.578050
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.202698584"
Evaluating: 0.202698584*360.0
 Parameter: XPHI <- "72.9714902"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.698414953"
Evaluating: 0.698414953*360.0
 Parameter: YPHI <- "251.429383"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660498259"
Evaluating: 0.660498259*360.0
 Parameter: ZPHI <- "237.779373"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.504819"
 Parameter: YPOS -> "35.1482072"
 Parameter: ZPOS -> "18.5780498"
 Parameter: XPHI -> "72.9714902"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.292848    0.956159
    0.000000   -0.956159    0.292848

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.504819"
 Parameter: YPOS -> "35.1482072"
 Parameter: ZPOS -> "18.5780498"
 Parameter: YPHI -> "251.429383"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.318473    0.000000    0.947932
    0.000000    1.000000    0.000000
   -0.947932    0.000000   -0.318473

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.504819"
 Parameter: YPOS -> "35.1482072"
 Parameter: ZPOS -> "18.5780498"
 Parameter: ZPHI -> "237.779373"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.533181   -0.846001    0.000000
    0.846001   -0.533181    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  122.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.504819 XMAX =   32.504819 XAVE =   32.504819
    YMIN =   35.148207 YMAX =   35.148207 YAVE =   35.148207
    ZMIN =   18.578050 ZMAX =   18.578050 ZAVE =   18.578050
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.504819"
Evaluating: 32.504819+3.5
 Parameter: XMAX <- "36.004819"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.1482072"
Evaluating: 35.1482072+3.5
 Parameter: YMAX <- "38.6482072"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.5780498"
Evaluating: 18.5780498+3.5
 Parameter: ZMAX <- "22.0780498"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.504819"
Evaluating: 32.504819-3.5
 Parameter: XMIN <- "29.004819"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.1482072"
Evaluating: 35.1482072-3.5
 Parameter: YMIN <- "31.6482072"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.5780498"
Evaluating: 18.5780498-3.5
 Parameter: ZMIN <- "15.0780498"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.004819"
 Parameter: XMIN -> "29.004819"
 Parameter: YMAX -> "38.6482072"
 Parameter: YMIN -> "31.6482072"
 Parameter: ZMAX -> "22.0780498"
 Parameter: ZMIN -> "15.0780498"
 SELRPN>     29 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      9 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26671 POS      POT      11       POT     -**** MEMB     POPC     88       C13           2.8672
26671 POS      POT      11       POT     -**** MEMB     POPC     88       C14           3.6072
26671 POS      POT      11       POT     -**** MEMB     POPC     97       N             2.1263
26671 POS      POT      11       POT     -**** MEMB     POPC     97       C12           1.4250
26671 POS      POT      11       POT     -**** MEMB     POPC     97       C13           3.2236
26671 POS      POT      11       POT     -**** MEMB     POPC     97       C14           2.2066
26671 POS      POT      11       POT     -**** MEMB     POPC     97       C15           3.3013
26671 POS      POT      11       POT     -**** MEMB     POPC     97       C11           2.8771
26671 POS      POT      11       POT     -**** MEMB     POPC     97       O12           3.7819
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "11" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.941778891"
Evaluating: 82.1644692*(0.941778891-0.5)
 Parameter: XPOS <- "36.2985281"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.158941684"
Evaluating: 82.1644692*(0.158941684-0.5)
 Parameter: YPOS <- "-28.0228755"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.208043021"
Evaluating: 85*(0.208043021-0.5)+0
 Parameter: ZPOS <- "-24.8163432"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.8163432" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.504819 XMAX =   32.504819 XAVE =   32.504819
    YMIN =   35.148207 YMAX =   35.148207 YAVE =   35.148207
    ZMIN =   18.578050 ZMAX =   18.578050 ZAVE =   18.578050
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.2985281"
 RDCMND substituted energy or value "?XAVE" to "32.504819"
Evaluating: 36.2985281-32.504819
 Parameter: XTRAN <- "3.7937091"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.0228755"
 RDCMND substituted energy or value "?YAVE" to "35.1482072"
Evaluating: -28.0228755-35.1482072
 Parameter: YTRAN <- "-63.1710827"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.8163432"
 RDCMND substituted energy or value "?ZAVE" to "18.5780498"
Evaluating: -24.8163432-18.5780498
 Parameter: ZTRAN <- "-43.394393"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.7937091"
 Parameter: YTRAN -> "-63.1710827"
 Parameter: ZTRAN -> "-43.394393"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     3.793709  -63.171083  -43.394393
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.522168369"
Evaluating: 0.522168369*360.0
 Parameter: XPHI <- "187.980613"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.483918694"
Evaluating: 0.483918694*360.0
 Parameter: YPHI <- "174.21073"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.243054064"
Evaluating: 0.243054064*360.0
 Parameter: ZPHI <- "87.499463"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.2985281"
 Parameter: YPOS -> "-28.0228755"
 Parameter: ZPOS -> "-24.8163432"
 Parameter: XPHI -> "187.980613"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.990315   -0.138838
    0.000000    0.138838   -0.990315

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  172.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.2985281"
 Parameter: YPOS -> "-28.0228755"
 Parameter: ZPOS -> "-24.8163432"
 Parameter: YPHI -> "174.21073"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.994900    0.000000   -0.100870
    0.000000    1.000000    0.000000
    0.100870    0.000000   -0.994900

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  174.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.2985281"
 Parameter: YPOS -> "-28.0228755"
 Parameter: ZPOS -> "-24.8163432"
 Parameter: ZPHI -> "87.499463"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.043629    0.999048    0.000000
   -0.999048    0.043629    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   87.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.298528 XMAX =   36.298528 XAVE =   36.298528
    YMIN =  -28.022876 YMAX =  -28.022876 YAVE =  -28.022876
    ZMIN =  -24.816343 ZMAX =  -24.816343 ZAVE =  -24.816343
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.2985281"
Evaluating: 36.2985281+3.5
 Parameter: XMAX <- "39.7985281"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.0228755"
Evaluating: -28.0228755+3.5
 Parameter: YMAX <- "-24.5228755"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.8163432"
Evaluating: -24.8163432+3.5
 Parameter: ZMAX <- "-21.3163432"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.2985281"
Evaluating: 36.2985281-3.5
 Parameter: XMIN <- "32.7985281"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.0228755"
Evaluating: -28.0228755-3.5
 Parameter: YMIN <- "-31.5228755"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.8163432"
Evaluating: -24.8163432-3.5
 Parameter: ZMIN <- "-28.3163432"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.7985281"
 Parameter: XMIN -> "32.7985281"
 Parameter: YMAX -> "-24.5228755"
 Parameter: YMIN -> "-31.5228755"
 Parameter: ZMAX -> "-21.3163432"
 Parameter: ZMIN -> "-28.3163432"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "12" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "12" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.675821306"
Evaluating: 82.1644692*(0.675821306-0.5)
 Parameter: XPOS <- "14.4462643"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.650479328"
Evaluating: 82.1644692*(0.650479328-0.5)
 Parameter: YPOS <- "12.3640541"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.840712178"
Evaluating: 85*(0.840712178-0.5)+0
 Parameter: ZPOS <- "28.9605351"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.9605351" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.9605351" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.4462643"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.4462643-0
 Parameter: XTRAN <- "14.4462643"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.3640541"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.3640541-0
 Parameter: YTRAN <- "12.3640541"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.9605351"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.9605351-0
 Parameter: ZTRAN <- "28.9605351"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.4462643"
 Parameter: YTRAN -> "12.3640541"
 Parameter: ZTRAN -> "28.9605351"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    14.446264   12.364054   28.960535
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.797888067"
Evaluating: 0.797888067*360.0
 Parameter: XPHI <- "287.239704"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487912953"
Evaluating: 0.487912953*360.0
 Parameter: YPHI <- "175.648663"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678378751"
Evaluating: 0.678378751*360.0
 Parameter: ZPHI <- "244.21635"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.4462643"
 Parameter: YPOS -> "12.3640541"
 Parameter: ZPOS -> "28.9605351"
 Parameter: XPHI -> "287.239704"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.296370   -0.955073
    0.000000    0.955073    0.296370

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   72.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.4462643"
 Parameter: YPOS -> "12.3640541"
 Parameter: ZPOS -> "28.9605351"
 Parameter: YPHI -> "175.648663"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.997118    0.000000   -0.075872
    0.000000    1.000000    0.000000
    0.075872    0.000000   -0.997118

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  175.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.4462643"
 Parameter: YPOS -> "12.3640541"
 Parameter: ZPOS -> "28.9605351"
 Parameter: ZPHI -> "244.21635"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.434974   -0.900443    0.000000
    0.900443   -0.434974    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  115.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.446264 XMAX =   14.446264 XAVE =   14.446264
    YMIN =   12.364054 YMAX =   12.364054 YAVE =   12.364054
    ZMIN =   28.960535 ZMAX =   28.960535 ZAVE =   28.960535
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.4462643"
Evaluating: 14.4462643+3.5
 Parameter: XMAX <- "17.9462643"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.3640541"
Evaluating: 12.3640541+3.5
 Parameter: YMAX <- "15.8640541"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.9605351"
Evaluating: 28.9605351+3.5
 Parameter: ZMAX <- "32.4605351"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.4462643"
Evaluating: 14.4462643-3.5
 Parameter: XMIN <- "10.9462643"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.3640541"
Evaluating: 12.3640541-3.5
 Parameter: YMIN <- "8.8640541"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.9605351"
Evaluating: 28.9605351-3.5
 Parameter: ZMIN <- "25.4605351"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.9462643"
 Parameter: XMIN -> "10.9462643"
 Parameter: YMAX -> "15.8640541"
 Parameter: YMIN -> "8.8640541"
 Parameter: ZMAX -> "32.4605351"
 Parameter: ZMIN -> "25.4605351"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "13" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "13" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.132356542"
Evaluating: 82.1644692*(0.132356542-0.5)
 Parameter: XPOS <- "-30.2072296"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.477724508"
Evaluating: 82.1644692*(0.477724508-0.5)
 Parameter: YPOS <- "-1.83025398"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.665378208"
Evaluating: 85*(0.665378208-0.5)+0
 Parameter: ZPOS <- "14.0571477"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.0571477" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.0571477" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "13" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.10980252"
Evaluating: 82.1644692*(0.10980252-0.5)
 Parameter: XPOS <- "-32.0603688"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.450145237"
Evaluating: 82.1644692*(0.450145237-0.5)
 Parameter: YPOS <- "-4.09629014"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.261188265"
Evaluating: 85*(0.261188265-0.5)+0
 Parameter: ZPOS <- "-20.2989975"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.2989975" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.0603688"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.0603688-0
 Parameter: XTRAN <- "-32.0603688"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.09629014"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.09629014-0
 Parameter: YTRAN <- "-4.09629014"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.2989975"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.2989975-0
 Parameter: ZTRAN <- "-20.2989975"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.0603688"
 Parameter: YTRAN -> "-4.09629014"
 Parameter: ZTRAN -> "-20.2989975"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -32.060369   -4.096290  -20.298997
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.831706448"
Evaluating: 0.831706448*360.0
 Parameter: XPHI <- "299.414321"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.595334714"
Evaluating: 0.595334714*360.0
 Parameter: YPHI <- "214.320497"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.561768301"
Evaluating: 0.561768301*360.0
 Parameter: ZPHI <- "202.236588"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.0603688"
 Parameter: YPOS -> "-4.09629014"
 Parameter: ZPOS -> "-20.2989975"
 Parameter: XPHI -> "299.414321"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.491121   -0.871091
    0.000000    0.871091    0.491121

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   60.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.0603688"
 Parameter: YPOS -> "-4.09629014"
 Parameter: ZPOS -> "-20.2989975"
 Parameter: YPHI -> "214.320497"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.825897    0.000000    0.563822
    0.000000    1.000000    0.000000
   -0.563822    0.000000   -0.825897

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  145.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.0603688"
 Parameter: YPOS -> "-4.09629014"
 Parameter: ZPOS -> "-20.2989975"
 Parameter: ZPHI -> "202.236588"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.925629   -0.378432    0.000000
    0.378432   -0.925629    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  157.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.060369 XMAX =  -32.060369 XAVE =  -32.060369
    YMIN =   -4.096290 YMAX =   -4.096290 YAVE =   -4.096290
    ZMIN =  -20.298997 ZMAX =  -20.298997 ZAVE =  -20.298997
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.0603688"
Evaluating: -32.0603688+3.5
 Parameter: XMAX <- "-28.5603688"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.09629014"
Evaluating: -4.09629014+3.5
 Parameter: YMAX <- "-0.59629014"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.2989975"
Evaluating: -20.2989975+3.5
 Parameter: ZMAX <- "-16.7989975"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.0603688"
Evaluating: -32.0603688-3.5
 Parameter: XMIN <- "-35.5603688"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.09629014"
Evaluating: -4.09629014-3.5
 Parameter: YMIN <- "-7.59629014"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.2989975"
Evaluating: -20.2989975-3.5
 Parameter: ZMIN <- "-23.7989975"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.5603688"
 Parameter: XMIN -> "-35.5603688"
 Parameter: YMAX -> "-0.59629014"
 Parameter: YMIN -> "-7.59629014"
 Parameter: ZMAX -> "-16.7989975"
 Parameter: ZMIN -> "-23.7989975"
 SELRPN>     14 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      3 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26673 POS      POT      13       POT     -**** MEMB     POPC     137      C13           3.5490
26673 POS      POT      13       POT     -**** MEMB     POPC     163      C13           3.5840
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "13" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.781082882"
Evaluating: 82.1644692*(0.781082882-0.5)
 Parameter: XPOS <- "23.0950258"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.749866987"
Evaluating: 82.1644692*(0.749866987-0.5)
 Parameter: YPOS <- "20.5301884"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.979939656"
Evaluating: 85*(0.979939656-0.5)+0
 Parameter: ZPOS <- "40.7948708"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.7948708" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.7948708" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.060369 XMAX =  -32.060369 XAVE =  -32.060369
    YMIN =   -4.096290 YMAX =   -4.096290 YAVE =   -4.096290
    ZMIN =  -20.298997 ZMAX =  -20.298997 ZAVE =  -20.298997
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.0950258"
 RDCMND substituted energy or value "?XAVE" to "-32.0603688"
Evaluating: 23.0950258--32.0603688
 Parameter: XTRAN <- "55.1553946"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.5301884"
 RDCMND substituted energy or value "?YAVE" to "-4.09629014"
Evaluating: 20.5301884--4.09629014
 Parameter: YTRAN <- "24.6264785"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.7948708"
 RDCMND substituted energy or value "?ZAVE" to "-20.2989975"
Evaluating: 40.7948708--20.2989975
 Parameter: ZTRAN <- "61.0938683"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.1553946"
 Parameter: YTRAN -> "24.6264785"
 Parameter: ZTRAN -> "61.0938683"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    55.155395   24.626479   61.093868
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518725924"
Evaluating: 0.518725924*360.0
 Parameter: XPHI <- "186.741333"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.293502828"
Evaluating: 0.293502828*360.0
 Parameter: YPHI <- "105.661018"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.605337825"
Evaluating: 0.605337825*360.0
 Parameter: ZPHI <- "217.921617"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.0950258"
 Parameter: YPOS -> "20.5301884"
 Parameter: ZPOS -> "40.7948708"
 Parameter: XPHI -> "186.741333"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.993086   -0.117387
    0.000000    0.117387   -0.993086

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  173.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.0950258"
 Parameter: YPOS -> "20.5301884"
 Parameter: ZPOS -> "40.7948708"
 Parameter: YPHI -> "105.661018"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.269945    0.000000   -0.962876
    0.000000    1.000000    0.000000
    0.962876    0.000000   -0.269945

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.0950258"
 Parameter: YPOS -> "20.5301884"
 Parameter: ZPOS -> "40.7948708"
 Parameter: ZPHI -> "217.921617"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.788852   -0.614583    0.000000
    0.614583   -0.788852    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  142.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.095026 XMAX =   23.095026 XAVE =   23.095026
    YMIN =   20.530188 YMAX =   20.530188 YAVE =   20.530188
    ZMIN =   40.794871 ZMAX =   40.794871 ZAVE =   40.794871
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.0950258"
Evaluating: 23.0950258+3.5
 Parameter: XMAX <- "26.5950258"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.5301884"
Evaluating: 20.5301884+3.5
 Parameter: YMAX <- "24.0301884"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.7948708"
Evaluating: 40.7948708+3.5
 Parameter: ZMAX <- "44.2948708"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.0950258"
Evaluating: 23.0950258-3.5
 Parameter: XMIN <- "19.5950258"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.5301884"
Evaluating: 20.5301884-3.5
 Parameter: YMIN <- "17.0301884"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.7948708"
Evaluating: 40.7948708-3.5
 Parameter: ZMIN <- "37.2948708"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.5950258"
 Parameter: XMIN -> "19.5950258"
 Parameter: YMAX -> "24.0301884"
 Parameter: YMIN -> "17.0301884"
 Parameter: ZMAX -> "44.2948708"
 Parameter: ZMIN -> "37.2948708"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "14" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "14" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.421040697"
Evaluating: 82.1644692*(0.421040697-0.5)
 Parameter: XPOS <- "-6.48764922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.792783012"
Evaluating: 82.1644692*(0.792783012-0.5)
 Parameter: YPOS <- "24.0563608"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.975395432"
Evaluating: 85*(0.975395432-0.5)+0
 Parameter: ZPOS <- "40.4086117"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.4086117" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.4086117" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.48764922"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.48764922-0
 Parameter: XTRAN <- "-6.48764922"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.0563608"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.0563608-0
 Parameter: YTRAN <- "24.0563608"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.4086117"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.4086117-0
 Parameter: ZTRAN <- "40.4086117"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.48764922"
 Parameter: YTRAN -> "24.0563608"
 Parameter: ZTRAN -> "40.4086117"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -6.487649   24.056361   40.408612
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484362103"
Evaluating: 0.484362103*360.0
 Parameter: XPHI <- "174.370357"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393206826"
Evaluating: 0.393206826*360.0
 Parameter: YPHI <- "141.554457"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.240695348"
Evaluating: 0.240695348*360.0
 Parameter: ZPHI <- "86.6503253"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.48764922"
 Parameter: YPOS -> "24.0563608"
 Parameter: ZPOS -> "40.4086117"
 Parameter: XPHI -> "174.370357"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.995177    0.098098
    0.000000   -0.098098   -0.995177

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  174.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.48764922"
 Parameter: YPOS -> "24.0563608"
 Parameter: ZPOS -> "40.4086117"
 Parameter: YPHI -> "141.554457"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.783199    0.000000   -0.621771
    0.000000    1.000000    0.000000
    0.621771    0.000000   -0.783199

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  141.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.48764922"
 Parameter: YPOS -> "24.0563608"
 Parameter: ZPOS -> "40.4086117"
 Parameter: ZPHI -> "86.6503253"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.058430    0.998292    0.000000
   -0.998292    0.058430    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   86.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.487649 XMAX =   -6.487649 XAVE =   -6.487649
    YMIN =   24.056361 YMAX =   24.056361 YAVE =   24.056361
    ZMIN =   40.408612 ZMAX =   40.408612 ZAVE =   40.408612
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.48764922"
Evaluating: -6.48764922+3.5
 Parameter: XMAX <- "-2.98764922"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.0563608"
Evaluating: 24.0563608+3.5
 Parameter: YMAX <- "27.5563608"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.4086117"
Evaluating: 40.4086117+3.5
 Parameter: ZMAX <- "43.9086117"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.48764922"
Evaluating: -6.48764922-3.5
 Parameter: XMIN <- "-9.98764922"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.0563608"
Evaluating: 24.0563608-3.5
 Parameter: YMIN <- "20.5563608"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.4086117"
Evaluating: 40.4086117-3.5
 Parameter: ZMIN <- "36.9086117"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.98764922"
 Parameter: XMIN -> "-9.98764922"
 Parameter: YMAX -> "27.5563608"
 Parameter: YMIN -> "20.5563608"
 Parameter: ZMAX -> "43.9086117"
 Parameter: ZMIN -> "36.9086117"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "15" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "15" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.742841023"
Evaluating: 82.1644692*(0.742841023-0.5)
 Parameter: XPOS <- "19.9529038"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.999104541"
Evaluating: 82.1644692*(0.999104541-0.5)
 Parameter: YPOS <- "41.0086597"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.666291387"
Evaluating: 85*(0.666291387-0.5)+0
 Parameter: ZPOS <- "14.1347679"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.1347679" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.1347679" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "15" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.891816478"
Evaluating: 82.1644692*(0.891816478-0.5)
 Parameter: XPOS <- "32.1933929"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.350535612"
Evaluating: 82.1644692*(0.350535612-0.5)
 Parameter: YPOS <- "-12.2806621"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.528175895"
Evaluating: 85*(0.528175895-0.5)+0
 Parameter: ZPOS <- "2.39495107"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.39495107" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.39495107" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "15" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.513311229"
Evaluating: 82.1644692*(0.513311229-0.5)
 Parameter: XPOS <- "1.09371007"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.2398103"
Evaluating: 82.1644692*(0.2398103-0.5)
 Parameter: YPOS <- "-21.3783486"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.425754824"
Evaluating: 85*(0.425754824-0.5)+0
 Parameter: ZPOS <- "-6.31083996"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.31083996" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.31083996" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "15" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.325197788"
Evaluating: 82.1644692*(0.325197788-0.5)
 Parameter: XPOS <- "-14.362531"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.211697949"
Evaluating: 82.1644692*(0.211697949-0.5)
 Parameter: YPOS <- "-23.688185"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.372256676"
Evaluating: 85*(0.372256676-0.5)+0
 Parameter: ZPOS <- "-10.8581825"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.8581825" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.8581825" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "15" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.705902468"
Evaluating: 82.1644692*(0.705902468-0.5)
 Parameter: XPOS <- "16.917867"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.607553611"
Evaluating: 82.1644692*(0.607553611-0.5)
 Parameter: YPOS <- "8.83708536"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.75861002"
Evaluating: 85*(0.75861002-0.5)+0
 Parameter: ZPOS <- "21.9818517"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.9818517" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.9818517" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.917867"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.917867-0
 Parameter: XTRAN <- "16.917867"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.83708536"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.83708536-0
 Parameter: YTRAN <- "8.83708536"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.9818517"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.9818517-0
 Parameter: ZTRAN <- "21.9818517"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.917867"
 Parameter: YTRAN -> "8.83708536"
 Parameter: ZTRAN -> "21.9818517"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    16.917867    8.837085   21.981852
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.909133124"
Evaluating: 0.909133124*360.0
 Parameter: XPHI <- "327.287925"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.961682661"
Evaluating: 0.961682661*360.0
 Parameter: YPHI <- "346.205758"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56963122"
Evaluating: 0.56963122*360.0
 Parameter: ZPHI <- "205.067239"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.917867"
 Parameter: YPOS -> "8.83708536"
 Parameter: ZPOS -> "21.9818517"
 Parameter: XPHI -> "327.287925"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.841397   -0.540418
    0.000000    0.540418    0.841397

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.917867"
 Parameter: YPOS -> "8.83708536"
 Parameter: ZPOS -> "21.9818517"
 Parameter: YPHI -> "346.205758"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.971158    0.000000    0.238436
    0.000000    1.000000    0.000000
   -0.238436    0.000000    0.971158

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   13.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.917867"
 Parameter: YPOS -> "8.83708536"
 Parameter: ZPOS -> "21.9818517"
 Parameter: ZPHI -> "205.067239"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.905811   -0.423682    0.000000
    0.423682   -0.905811    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.917867 XMAX =   16.917867 XAVE =   16.917867
    YMIN =    8.837085 YMAX =    8.837085 YAVE =    8.837085
    ZMIN =   21.981852 ZMAX =   21.981852 ZAVE =   21.981852
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.917867"
Evaluating: 16.917867+3.5
 Parameter: XMAX <- "20.417867"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.83708536"
Evaluating: 8.83708536+3.5
 Parameter: YMAX <- "12.3370854"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.9818517"
Evaluating: 21.9818517+3.5
 Parameter: ZMAX <- "25.4818517"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.917867"
Evaluating: 16.917867-3.5
 Parameter: XMIN <- "13.417867"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.83708536"
Evaluating: 8.83708536-3.5
 Parameter: YMIN <- "5.33708536"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.9818517"
Evaluating: 21.9818517-3.5
 Parameter: ZMIN <- "18.4818517"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.417867"
 Parameter: XMIN -> "13.417867"
 Parameter: YMAX -> "12.3370854"
 Parameter: YMIN -> "5.33708536"
 Parameter: ZMAX -> "25.4818517"
 Parameter: ZMIN -> "18.4818517"
 SELRPN>     12 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      2 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26675 POS      POT      15       POT     -2411 MEMB     POPC     19       C15           3.8896
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "15" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.908464657"
Evaluating: 82.1644692*(0.908464657-0.5)
 Parameter: XPOS <- "33.5612817"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "8.27092645E-02"
Evaluating: 82.1644692*(8.27092645E-02-0.5)
 Parameter: YPOS <- "-34.2864718"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.706419474E-02"
Evaluating: 85*(9.706419474E-02-0.5)+0
 Parameter: ZPOS <- "-34.2495434"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.2495434" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.917867 XMAX =   16.917867 XAVE =   16.917867
    YMIN =    8.837085 YMAX =    8.837085 YAVE =    8.837085
    ZMIN =   21.981852 ZMAX =   21.981852 ZAVE =   21.981852
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.5612817"
 RDCMND substituted energy or value "?XAVE" to "16.917867"
Evaluating: 33.5612817-16.917867
 Parameter: XTRAN <- "16.6434147"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.2864718"
 RDCMND substituted energy or value "?YAVE" to "8.83708536"
Evaluating: -34.2864718-8.83708536
 Parameter: YTRAN <- "-43.1235572"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.2495434"
 RDCMND substituted energy or value "?ZAVE" to "21.9818517"
Evaluating: -34.2495434-21.9818517
 Parameter: ZTRAN <- "-56.2313951"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.6434147"
 Parameter: YTRAN -> "-43.1235572"
 Parameter: ZTRAN -> "-56.2313951"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    16.643415  -43.123557  -56.231395
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272275405"
Evaluating: 0.272275405*360.0
 Parameter: XPHI <- "98.0191458"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102012501"
Evaluating: 0.102012501*360.0
 Parameter: YPHI <- "36.7245004"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.502326271"
Evaluating: 0.502326271*360.0
 Parameter: ZPHI <- "180.837458"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.5612817"
 Parameter: YPOS -> "-34.2864718"
 Parameter: ZPOS -> "-34.2495434"
 Parameter: XPHI -> "98.0191458"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.139504    0.990222
    0.000000   -0.990222   -0.139504

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.5612817"
 Parameter: YPOS -> "-34.2864718"
 Parameter: ZPOS -> "-34.2495434"
 Parameter: YPHI -> "36.7245004"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.801520    0.000000   -0.597968
    0.000000    1.000000    0.000000
    0.597968    0.000000    0.801520

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.5612817"
 Parameter: YPOS -> "-34.2864718"
 Parameter: ZPOS -> "-34.2495434"
 Parameter: ZPHI -> "180.837458"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.999893   -0.014616    0.000000
    0.014616   -0.999893    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  179.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.561282 XMAX =   33.561282 XAVE =   33.561282
    YMIN =  -34.286472 YMAX =  -34.286472 YAVE =  -34.286472
    ZMIN =  -34.249543 ZMAX =  -34.249543 ZAVE =  -34.249543
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.5612817"
Evaluating: 33.5612817+3.5
 Parameter: XMAX <- "37.0612817"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.2864718"
Evaluating: -34.2864718+3.5
 Parameter: YMAX <- "-30.7864718"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.2495434"
Evaluating: -34.2495434+3.5
 Parameter: ZMAX <- "-30.7495434"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.5612817"
Evaluating: 33.5612817-3.5
 Parameter: XMIN <- "30.0612817"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.2864718"
Evaluating: -34.2864718-3.5
 Parameter: YMIN <- "-37.7864718"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.2495434"
Evaluating: -34.2495434-3.5
 Parameter: ZMIN <- "-37.7495434"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.0612817"
 Parameter: XMIN -> "30.0612817"
 Parameter: YMAX -> "-30.7864718"
 Parameter: YMIN -> "-37.7864718"
 Parameter: ZMAX -> "-30.7495434"
 Parameter: ZMIN -> "-37.7495434"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "16" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "16" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.892015743"
Evaluating: 82.1644692*(0.892015743-0.5)
 Parameter: XPOS <- "32.2097654"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.522952628"
Evaluating: 82.1644692*(0.522952628-0.5)
 Parameter: YPOS <- "1.8858905"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.862936579"
Evaluating: 85*(0.862936579-0.5)+0
 Parameter: ZPOS <- "30.8496092"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.8496092" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.8496092" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.2097654"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.2097654-0
 Parameter: XTRAN <- "32.2097654"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.8858905"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.8858905-0
 Parameter: YTRAN <- "1.8858905"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.8496092"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.8496092-0
 Parameter: ZTRAN <- "30.8496092"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.2097654"
 Parameter: YTRAN -> "1.8858905"
 Parameter: ZTRAN -> "30.8496092"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    32.209765    1.885890   30.849609
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863592919"
Evaluating: 0.863592919*360.0
 Parameter: XPHI <- "310.893451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121015559"
Evaluating: 0.121015559*360.0
 Parameter: YPHI <- "43.5656012"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360720206"
Evaluating: 0.360720206*360.0
 Parameter: ZPHI <- "129.859274"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.2097654"
 Parameter: YPOS -> "1.8858905"
 Parameter: ZPOS -> "30.8496092"
 Parameter: XPHI -> "310.893451"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.654654   -0.755928
    0.000000    0.755928    0.654654

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   49.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.2097654"
 Parameter: YPOS -> "1.8858905"
 Parameter: ZPOS -> "30.8496092"
 Parameter: YPHI -> "43.5656012"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.724586    0.000000   -0.689185
    0.000000    1.000000    0.000000
    0.689185    0.000000    0.724586

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   43.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.2097654"
 Parameter: YPOS -> "1.8858905"
 Parameter: ZPOS -> "30.8496092"
 Parameter: ZPHI -> "129.859274"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.640904    0.767621    0.000000
   -0.767621   -0.640904    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  129.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.209765 XMAX =   32.209765 XAVE =   32.209765
    YMIN =    1.885890 YMAX =    1.885890 YAVE =    1.885890
    ZMIN =   30.849609 ZMAX =   30.849609 ZAVE =   30.849609
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.2097654"
Evaluating: 32.2097654+3.5
 Parameter: XMAX <- "35.7097654"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.8858905"
Evaluating: 1.8858905+3.5
 Parameter: YMAX <- "5.3858905"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.8496092"
Evaluating: 30.8496092+3.5
 Parameter: ZMAX <- "34.3496092"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.2097654"
Evaluating: 32.2097654-3.5
 Parameter: XMIN <- "28.7097654"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.8858905"
Evaluating: 1.8858905-3.5
 Parameter: YMIN <- "-1.6141095"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.8496092"
Evaluating: 30.8496092-3.5
 Parameter: ZMIN <- "27.3496092"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.7097654"
 Parameter: XMIN -> "28.7097654"
 Parameter: YMAX -> "5.3858905"
 Parameter: YMIN -> "-1.6141095"
 Parameter: ZMAX -> "34.3496092"
 Parameter: ZMIN -> "27.3496092"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "17" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "17" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.590050657"
Evaluating: 82.1644692*(0.590050657-0.5)
 Parameter: XPOS <- "7.39896443"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.357176987"
Evaluating: 82.1644692*(0.357176987-0.5)
 Parameter: YPOS <- "-11.7349771"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.684069215"
Evaluating: 85*(0.684069215-0.5)+0
 Parameter: ZPOS <- "15.6458833"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.6458833" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.6458833" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.39896443"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.39896443-0
 Parameter: XTRAN <- "7.39896443"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.7349771"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.7349771-0
 Parameter: YTRAN <- "-11.7349771"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.6458833"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.6458833-0
 Parameter: ZTRAN <- "15.6458833"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.39896443"
 Parameter: YTRAN -> "-11.7349771"
 Parameter: ZTRAN -> "15.6458833"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     7.398964  -11.734977   15.645883
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175466831"
Evaluating: 0.175466831*360.0
 Parameter: XPHI <- "63.1680592"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.168333642"
Evaluating: 0.168333642*360.0
 Parameter: YPHI <- "60.6001111"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221390505"
Evaluating: 0.221390505*360.0
 Parameter: ZPHI <- "79.7005818"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.39896443"
 Parameter: YPOS -> "-11.7349771"
 Parameter: ZPOS -> "15.6458833"
 Parameter: XPHI -> "63.1680592"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.451375    0.892334
    0.000000   -0.892334    0.451375

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   63.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.39896443"
 Parameter: YPOS -> "-11.7349771"
 Parameter: ZPOS -> "15.6458833"
 Parameter: YPHI -> "60.6001111"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.490902    0.000000   -0.871215
    0.000000    1.000000    0.000000
    0.871215    0.000000    0.490902

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   60.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.39896443"
 Parameter: YPOS -> "-11.7349771"
 Parameter: ZPOS -> "15.6458833"
 Parameter: ZPHI -> "79.7005818"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.178792    0.983887    0.000000
   -0.983887    0.178792    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   79.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.398964 XMAX =    7.398964 XAVE =    7.398964
    YMIN =  -11.734977 YMAX =  -11.734977 YAVE =  -11.734977
    ZMIN =   15.645883 ZMAX =   15.645883 ZAVE =   15.645883
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.39896443"
Evaluating: 7.39896443+3.5
 Parameter: XMAX <- "10.8989644"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.7349771"
Evaluating: -11.7349771+3.5
 Parameter: YMAX <- "-8.2349771"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.6458833"
Evaluating: 15.6458833+3.5
 Parameter: ZMAX <- "19.1458833"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.39896443"
Evaluating: 7.39896443-3.5
 Parameter: XMIN <- "3.89896443"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.7349771"
Evaluating: -11.7349771-3.5
 Parameter: YMIN <- "-15.2349771"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.6458833"
Evaluating: 15.6458833-3.5
 Parameter: ZMIN <- "12.1458833"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.8989644"
 Parameter: XMIN -> "3.89896443"
 Parameter: YMAX -> "-8.2349771"
 Parameter: YMIN -> "-15.2349771"
 Parameter: ZMAX -> "19.1458833"
 Parameter: ZMIN -> "12.1458833"
 SELRPN>     17 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      5 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26677 POS      POT      17       POT     - 444 MEMB     POPC     4        C32           3.8883
26677 POS      POT      17       POT     -1500 MEMB     POPS     12       C22           3.8691
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "17" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.253136338"
Evaluating: 82.1644692*(0.253136338-0.5)
 Parameter: XPOS <- "-20.2834218"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.989246211"
Evaluating: 82.1644692*(0.989246211-0.5)
 Parameter: YPOS <- "40.1986552"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.905782459"
Evaluating: 85*(0.905782459-0.5)+0
 Parameter: ZPOS <- "34.491509"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.491509" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.491509" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.398964 XMAX =    7.398964 XAVE =    7.398964
    YMIN =  -11.734977 YMAX =  -11.734977 YAVE =  -11.734977
    ZMIN =   15.645883 ZMAX =   15.645883 ZAVE =   15.645883
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.2834218"
 RDCMND substituted energy or value "?XAVE" to "7.39896443"
Evaluating: -20.2834218-7.39896443
 Parameter: XTRAN <- "-27.6823862"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.1986552"
 RDCMND substituted energy or value "?YAVE" to "-11.7349771"
Evaluating: 40.1986552--11.7349771
 Parameter: YTRAN <- "51.9336323"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.491509"
 RDCMND substituted energy or value "?ZAVE" to "15.6458833"
Evaluating: 34.491509-15.6458833
 Parameter: ZTRAN <- "18.8456257"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.6823862"
 Parameter: YTRAN -> "51.9336323"
 Parameter: ZTRAN -> "18.8456257"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -27.682386   51.933632   18.845626
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.309952536"
Evaluating: 0.309952536*360.0
 Parameter: XPHI <- "111.582913"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.534167241"
Evaluating: 0.534167241*360.0
 Parameter: YPHI <- "192.300207"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.198022622"
Evaluating: 0.198022622*360.0
 Parameter: ZPHI <- "71.2881439"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.2834218"
 Parameter: YPOS -> "40.1986552"
 Parameter: ZPOS -> "34.491509"
 Parameter: XPHI -> "111.582913"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.367847    0.929886
    0.000000   -0.929886   -0.367847

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  111.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.2834218"
 Parameter: YPOS -> "40.1986552"
 Parameter: ZPOS -> "34.491509"
 Parameter: YPHI -> "192.300207"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.977045    0.000000    0.213034
    0.000000    1.000000    0.000000
   -0.213034    0.000000   -0.977045

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.2834218"
 Parameter: YPOS -> "40.1986552"
 Parameter: ZPOS -> "34.491509"
 Parameter: ZPHI -> "71.2881439"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.320809    0.947144    0.000000
   -0.947144    0.320809    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   71.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.283422 XMAX =  -20.283422 XAVE =  -20.283422
    YMIN =   40.198655 YMAX =   40.198655 YAVE =   40.198655
    ZMIN =   34.491509 ZMAX =   34.491509 ZAVE =   34.491509
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.2834218"
Evaluating: -20.2834218+3.5
 Parameter: XMAX <- "-16.7834218"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.1986552"
Evaluating: 40.1986552+3.5
 Parameter: YMAX <- "43.6986552"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.491509"
Evaluating: 34.491509+3.5
 Parameter: ZMAX <- "37.991509"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.2834218"
Evaluating: -20.2834218-3.5
 Parameter: XMIN <- "-23.7834218"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.1986552"
Evaluating: 40.1986552-3.5
 Parameter: YMIN <- "36.6986552"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.491509"
Evaluating: 34.491509-3.5
 Parameter: ZMIN <- "30.991509"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.7834218"
 Parameter: XMIN -> "-23.7834218"
 Parameter: YMAX -> "43.6986552"
 Parameter: YMIN -> "36.6986552"
 Parameter: ZMAX -> "37.991509"
 Parameter: ZMIN -> "30.991509"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "18" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "18" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.970768394"
Evaluating: 82.1644692*(0.970768394-0.5)
 Parameter: XPOS <- "38.6804352"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.989151575"
Evaluating: 82.1644692*(0.989151575-0.5)
 Parameter: YPOS <- "40.1908795"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.464706443"
Evaluating: 85*(0.464706443-0.5)+0
 Parameter: ZPOS <- "-2.99995235"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.99995235" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.99995235" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "18" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.771040494"
Evaluating: 82.1644692*(0.771040494-0.5)
 Parameter: XPOS <- "22.2698983"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.728771837"
Evaluating: 82.1644692*(0.728771837-0.5)
 Parameter: YPOS <- "18.7969166"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.425462053"
Evaluating: 85*(0.425462053-0.5)+0
 Parameter: ZPOS <- "-6.33572549"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.33572549" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.33572549" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "18" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.942552517"
Evaluating: 82.1644692*(0.942552517-0.5)
 Parameter: XPOS <- "36.3620927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.144097216"
Evaluating: 82.1644692*(0.144097216-0.5)
 Parameter: YPOS <- "-29.2425633"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.990777459"
Evaluating: 85*(0.990777459-0.5)+0
 Parameter: ZPOS <- "41.716084"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.716084" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.716084" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.3620927"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.3620927-0
 Parameter: XTRAN <- "36.3620927"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.2425633"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.2425633-0
 Parameter: YTRAN <- "-29.2425633"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.716084"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.716084-0
 Parameter: ZTRAN <- "41.716084"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.3620927"
 Parameter: YTRAN -> "-29.2425633"
 Parameter: ZTRAN -> "41.716084"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    36.362093  -29.242563   41.716084
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.400618001"
Evaluating: 0.400618001*360.0
 Parameter: XPHI <- "144.22248"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.816635398"
Evaluating: 0.816635398*360.0
 Parameter: YPHI <- "293.988743"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661486758"
Evaluating: 0.661486758*360.0
 Parameter: ZPHI <- "238.135233"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.3620927"
 Parameter: YPOS -> "-29.2425633"
 Parameter: ZPOS -> "41.716084"
 Parameter: XPHI -> "144.22248"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.811293    0.584639
    0.000000   -0.584639   -0.811293

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  144.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.3620927"
 Parameter: YPOS -> "-29.2425633"
 Parameter: ZPOS -> "41.716084"
 Parameter: YPHI -> "293.988743"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.406557    0.000000    0.913625
    0.000000    1.000000    0.000000
   -0.913625    0.000000    0.406557

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   66.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.3620927"
 Parameter: YPOS -> "-29.2425633"
 Parameter: ZPOS -> "41.716084"
 Parameter: ZPHI -> "238.135233"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.527916   -0.849296    0.000000
    0.849296   -0.527916    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.362093 XMAX =   36.362093 XAVE =   36.362093
    YMIN =  -29.242563 YMAX =  -29.242563 YAVE =  -29.242563
    ZMIN =   41.716084 ZMAX =   41.716084 ZAVE =   41.716084
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.3620927"
Evaluating: 36.3620927+3.5
 Parameter: XMAX <- "39.8620927"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.2425633"
Evaluating: -29.2425633+3.5
 Parameter: YMAX <- "-25.7425633"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.716084"
Evaluating: 41.716084+3.5
 Parameter: ZMAX <- "45.216084"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.3620927"
Evaluating: 36.3620927-3.5
 Parameter: XMIN <- "32.8620927"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.2425633"
Evaluating: -29.2425633-3.5
 Parameter: YMIN <- "-32.7425633"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.716084"
Evaluating: 41.716084-3.5
 Parameter: ZMIN <- "38.216084"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.8620927"
 Parameter: XMIN -> "32.8620927"
 Parameter: YMAX -> "-25.7425633"
 Parameter: YMIN -> "-32.7425633"
 Parameter: ZMAX -> "45.216084"
 Parameter: ZMIN -> "38.216084"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "19" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "19" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.952885399"
Evaluating: 82.1644692*(0.952885399-0.5)
 Parameter: XPOS <- "37.2110884"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.114469122"
Evaluating: 82.1644692*(0.114469122-0.5)
 Parameter: YPOS <- "-31.67694"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.726704477"
Evaluating: 85*(0.726704477-0.5)+0
 Parameter: ZPOS <- "19.2698805"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.2698805" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.2698805" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.2110884"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.2110884-0
 Parameter: XTRAN <- "37.2110884"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.67694"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.67694-0
 Parameter: YTRAN <- "-31.67694"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.2698805"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.2698805-0
 Parameter: ZTRAN <- "19.2698805"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.2110884"
 Parameter: YTRAN -> "-31.67694"
 Parameter: ZTRAN -> "19.2698805"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    37.211088  -31.676940   19.269880
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.93473912"
Evaluating: 0.93473912*360.0
 Parameter: XPHI <- "336.506083"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7481743"
Evaluating: 0.7481743*360.0
 Parameter: YPHI <- "269.342748"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.398496668"
Evaluating: 0.398496668*360.0
 Parameter: ZPHI <- "143.4588"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.2110884"
 Parameter: YPOS -> "-31.67694"
 Parameter: ZPOS -> "19.2698805"
 Parameter: XPHI -> "336.506083"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.917102   -0.398652
    0.000000    0.398652    0.917102

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.2110884"
 Parameter: YPOS -> "-31.67694"
 Parameter: ZPOS -> "19.2698805"
 Parameter: YPHI -> "269.342748"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.011471    0.000000    0.999934
    0.000000    1.000000    0.000000
   -0.999934    0.000000   -0.011471

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   90.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.2110884"
 Parameter: YPOS -> "-31.67694"
 Parameter: ZPOS -> "19.2698805"
 Parameter: ZPHI -> "143.4588"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.803429    0.595401    0.000000
   -0.595401   -0.803429    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  143.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.211088 XMAX =   37.211088 XAVE =   37.211088
    YMIN =  -31.676940 YMAX =  -31.676940 YAVE =  -31.676940
    ZMIN =   19.269880 ZMAX =   19.269880 ZAVE =   19.269880
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.2110884"
Evaluating: 37.2110884+3.5
 Parameter: XMAX <- "40.7110884"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.67694"
Evaluating: -31.67694+3.5
 Parameter: YMAX <- "-28.17694"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.2698805"
Evaluating: 19.2698805+3.5
 Parameter: ZMAX <- "22.7698805"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.2110884"
Evaluating: 37.2110884-3.5
 Parameter: XMIN <- "33.7110884"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.67694"
Evaluating: -31.67694-3.5
 Parameter: YMIN <- "-35.17694"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.2698805"
Evaluating: 19.2698805-3.5
 Parameter: ZMIN <- "15.7698805"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.7110884"
 Parameter: XMIN -> "33.7110884"
 Parameter: YMAX -> "-28.17694"
 Parameter: YMIN -> "-35.17694"
 Parameter: ZMAX -> "22.7698805"
 Parameter: ZMIN -> "15.7698805"
 SELRPN>     27 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     13 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26679 POS      POT      19       POT     -**** MEMB     POPC     95       N             1.8897
26679 POS      POT      19       POT     -**** MEMB     POPC     95       C12           2.6943
26679 POS      POT      19       POT     -**** MEMB     POPC     95       C13           3.0832
26679 POS      POT      19       POT     -**** MEMB     POPC     95       C14           2.4757
26679 POS      POT      19       POT     -**** MEMB     POPC     95       C15           0.6548
26679 POS      POT      19       POT     -**** MEMB     POPC     95       C11           3.3704
26679 POS      POT      19       POT     -**** MEMB     POPC     95       P             3.5936
26679 POS      POT      19       POT     -**** MEMB     POPC     95       O14           3.0286
26679 POS      POT      19       POT     -**** MEMB     POPC     95       O12           3.1440
26679 POS      POT      19       POT     -**** MEMB     POPC     95       C1            3.6376
26679 POS      POT      19       POT     -**** MEMB     POPC     95       C2            3.7905
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "19" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.502063322"
Evaluating: 82.1644692*(0.502063322-0.5)
 Parameter: XPOS <- "0.169531757"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.130544394"
Evaluating: 82.1644692*(0.130544394-0.5)
 Parameter: YPOS <- "-30.3561238"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.818055217"
Evaluating: 85*(0.818055217-0.5)+0
 Parameter: ZPOS <- "27.0346934"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.0346934" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.0346934" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.211088 XMAX =   37.211088 XAVE =   37.211088
    YMIN =  -31.676940 YMAX =  -31.676940 YAVE =  -31.676940
    ZMIN =   19.269880 ZMAX =   19.269880 ZAVE =   19.269880
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.169531757"
 RDCMND substituted energy or value "?XAVE" to "37.2110884"
Evaluating: 0.169531757-37.2110884
 Parameter: XTRAN <- "-37.0415566"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.3561238"
 RDCMND substituted energy or value "?YAVE" to "-31.67694"
Evaluating: -30.3561238--31.67694
 Parameter: YTRAN <- "1.3208162"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.0346934"
 RDCMND substituted energy or value "?ZAVE" to "19.2698805"
Evaluating: 27.0346934-19.2698805
 Parameter: ZTRAN <- "7.7648129"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.0415566"
 Parameter: YTRAN -> "1.3208162"
 Parameter: ZTRAN -> "7.7648129"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -37.041557    1.320816    7.764813
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.143612714"
Evaluating: 0.143612714*360.0
 Parameter: XPHI <- "51.700577"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.264513689"
Evaluating: 0.264513689*360.0
 Parameter: YPHI <- "95.224928"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.64238765E-02"
Evaluating: 3.64238765E-02*360.0
 Parameter: ZPHI <- "13.1125955"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.169531757"
 Parameter: YPOS -> "-30.3561238"
 Parameter: ZPOS -> "27.0346934"
 Parameter: XPHI -> "51.700577"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.619771    0.784783
    0.000000   -0.784783    0.619771

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   51.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.169531757"
 Parameter: YPOS -> "-30.3561238"
 Parameter: ZPOS -> "27.0346934"
 Parameter: YPHI -> "95.224928"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.091066    0.000000   -0.995845
    0.000000    1.000000    0.000000
    0.995845    0.000000   -0.091066

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   95.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.169531757"
 Parameter: YPOS -> "-30.3561238"
 Parameter: ZPOS -> "27.0346934"
 Parameter: ZPHI -> "13.1125955"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.973926    0.226865    0.000000
   -0.226865    0.973926    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.169532 XMAX =    0.169532 XAVE =    0.169532
    YMIN =  -30.356124 YMAX =  -30.356124 YAVE =  -30.356124
    ZMIN =   27.034693 ZMAX =   27.034693 ZAVE =   27.034693
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.169531753"
Evaluating: 0.169531753+3.5
 Parameter: XMAX <- "3.66953175"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.3561238"
Evaluating: -30.3561238+3.5
 Parameter: YMAX <- "-26.8561238"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.0346934"
Evaluating: 27.0346934+3.5
 Parameter: ZMAX <- "30.5346934"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.169531753"
Evaluating: 0.169531753-3.5
 Parameter: XMIN <- "-3.33046825"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.3561238"
Evaluating: -30.3561238-3.5
 Parameter: YMIN <- "-33.8561238"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.0346934"
Evaluating: 27.0346934-3.5
 Parameter: ZMIN <- "23.5346934"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.66953175"
 Parameter: XMIN -> "-3.33046825"
 Parameter: YMAX -> "-26.8561238"
 Parameter: YMIN -> "-33.8561238"
 Parameter: ZMAX -> "30.5346934"
 Parameter: ZMIN -> "23.5346934"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      1 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26679 POS      POT      19       POT     -**** POS      POT      7        POT           3.9612
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "19" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.419372597"
Evaluating: 82.1644692*(0.419372597-0.5)
 Parameter: XPOS <- "-6.62470777"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "5.788347386E-02"
Evaluating: 82.1644692*(5.788347386E-02-0.5)
 Parameter: YPOS <- "-36.3262697"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.159639227"
Evaluating: 85*(0.159639227-0.5)+0
 Parameter: ZPOS <- "-28.9306657"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.9306657" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.169532 XMAX =    0.169532 XAVE =    0.169532
    YMIN =  -30.356124 YMAX =  -30.356124 YAVE =  -30.356124
    ZMIN =   27.034693 ZMAX =   27.034693 ZAVE =   27.034693
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.62470777"
 RDCMND substituted energy or value "?XAVE" to "0.169531753"
Evaluating: -6.62470777-0.169531753
 Parameter: XTRAN <- "-6.79423952"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.3262697"
 RDCMND substituted energy or value "?YAVE" to "-30.3561238"
Evaluating: -36.3262697--30.3561238
 Parameter: YTRAN <- "-5.9701459"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.9306657"
 RDCMND substituted energy or value "?ZAVE" to "27.0346934"
Evaluating: -28.9306657-27.0346934
 Parameter: ZTRAN <- "-55.9653591"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.79423952"
 Parameter: YTRAN -> "-5.9701459"
 Parameter: ZTRAN -> "-55.9653591"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -6.794240   -5.970146  -55.965359
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764189338"
Evaluating: 0.764189338*360.0
 Parameter: XPHI <- "275.108162"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.364440822"
Evaluating: 0.364440822*360.0
 Parameter: YPHI <- "131.198696"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.596905374"
Evaluating: 0.596905374*360.0
 Parameter: ZPHI <- "214.885935"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.62470777"
 Parameter: YPOS -> "-36.3262697"
 Parameter: ZPOS -> "-28.9306657"
 Parameter: XPHI -> "275.108162"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.089036   -0.996028
    0.000000    0.996028    0.089036

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   84.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.62470777"
 Parameter: YPOS -> "-36.3262697"
 Parameter: ZPOS -> "-28.9306657"
 Parameter: YPHI -> "131.198696"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.658672    0.000000   -0.752430
    0.000000    1.000000    0.000000
    0.752430    0.000000   -0.658672

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  131.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.62470777"
 Parameter: YPOS -> "-36.3262697"
 Parameter: ZPOS -> "-28.9306657"
 Parameter: ZPHI -> "214.885935"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.820292   -0.571945    0.000000
    0.571945   -0.820292    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  145.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.624708 XMAX =   -6.624708 XAVE =   -6.624708
    YMIN =  -36.326270 YMAX =  -36.326270 YAVE =  -36.326270
    ZMIN =  -28.930666 ZMAX =  -28.930666 ZAVE =  -28.930666
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.62470774"
Evaluating: -6.62470774+3.5
 Parameter: XMAX <- "-3.12470774"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.3262697"
Evaluating: -36.3262697+3.5
 Parameter: YMAX <- "-32.8262697"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.9306657"
Evaluating: -28.9306657+3.5
 Parameter: ZMAX <- "-25.4306657"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.62470774"
Evaluating: -6.62470774-3.5
 Parameter: XMIN <- "-10.1247077"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.3262697"
Evaluating: -36.3262697-3.5
 Parameter: YMIN <- "-39.8262697"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.9306657"
Evaluating: -28.9306657-3.5
 Parameter: ZMIN <- "-32.4306657"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.12470774"
 Parameter: XMIN -> "-10.1247077"
 Parameter: YMAX -> "-32.8262697"
 Parameter: YMIN -> "-39.8262697"
 Parameter: ZMAX -> "-25.4306657"
 Parameter: ZMIN -> "-32.4306657"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "20" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "20" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.119803016"
Evaluating: 82.1644692*(0.119803016-0.5)
 Parameter: XPOS <- "-31.2386834"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.284576461"
Evaluating: 82.1644692*(0.284576461-0.5)
 Parameter: YPOS <- "-17.7001607"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.232160183"
Evaluating: 85*(0.232160183-0.5)+0
 Parameter: ZPOS <- "-22.7663844"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.7663844" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.2386834"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.2386834-0
 Parameter: XTRAN <- "-31.2386834"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.7001607"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.7001607-0
 Parameter: YTRAN <- "-17.7001607"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.7663844"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.7663844-0
 Parameter: ZTRAN <- "-22.7663844"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.2386834"
 Parameter: YTRAN -> "-17.7001607"
 Parameter: ZTRAN -> "-22.7663844"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -31.238683  -17.700161  -22.766384
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.650778057"
Evaluating: 0.650778057*360.0
 Parameter: XPHI <- "234.280101"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.696398019"
Evaluating: 0.696398019*360.0
 Parameter: YPHI <- "250.703287"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.667922041"
Evaluating: 0.667922041*360.0
 Parameter: ZPHI <- "240.451935"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.2386834"
 Parameter: YPOS -> "-17.7001607"
 Parameter: ZPOS -> "-22.7663844"
 Parameter: XPHI -> "234.280101"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.583823   -0.811881
    0.000000    0.811881   -0.583823

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.2386834"
 Parameter: YPOS -> "-17.7001607"
 Parameter: ZPOS -> "-22.7663844"
 Parameter: YPHI -> "250.703287"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.330460    0.000000    0.943820
    0.000000    1.000000    0.000000
   -0.943820    0.000000   -0.330460

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  109.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.2386834"
 Parameter: YPOS -> "-17.7001607"
 Parameter: ZPOS -> "-22.7663844"
 Parameter: ZPHI -> "240.451935"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.493154   -0.869942    0.000000
    0.869942   -0.493154    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  119.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.238683 XMAX =  -31.238683 XAVE =  -31.238683
    YMIN =  -17.700161 YMAX =  -17.700161 YAVE =  -17.700161
    ZMIN =  -22.766384 ZMAX =  -22.766384 ZAVE =  -22.766384
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.2386834"
Evaluating: -31.2386834+3.5
 Parameter: XMAX <- "-27.7386834"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.7001607"
Evaluating: -17.7001607+3.5
 Parameter: YMAX <- "-14.2001607"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.7663844"
Evaluating: -22.7663844+3.5
 Parameter: ZMAX <- "-19.2663844"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.2386834"
Evaluating: -31.2386834-3.5
 Parameter: XMIN <- "-34.7386834"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.7001607"
Evaluating: -17.7001607-3.5
 Parameter: YMIN <- "-21.2001607"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.7663844"
Evaluating: -22.7663844-3.5
 Parameter: ZMIN <- "-26.2663844"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.7386834"
 Parameter: XMIN -> "-34.7386834"
 Parameter: YMAX -> "-14.2001607"
 Parameter: YMIN -> "-21.2001607"
 Parameter: ZMAX -> "-19.2663844"
 Parameter: ZMIN -> "-26.2663844"
 SELRPN>      8 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      3 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26680 POS      POT      20       POT     -**** MEMB     POPC     152      C15           3.3383
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "20" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.275358679"
Evaluating: 82.1644692*(0.275358679-0.5)
 Parameter: XPOS <- "-18.4575349"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.580133362"
Evaluating: 82.1644692*(0.580133362-0.5)
 Parameter: YPOS <- "6.58411515"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.379929291"
Evaluating: 85*(0.379929291-0.5)+0
 Parameter: ZPOS <- "-10.2060103"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.2060103" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.2060103" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "20" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.433234338"
Evaluating: 82.1644692*(0.433234338-0.5)
 Parameter: XPOS <- "-5.48576518"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.234567452"
Evaluating: 82.1644692*(0.234567452-0.5)
 Parameter: YPOS <- "-21.8091244"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.47894694"
Evaluating: 85*(0.47894694-0.5)+0
 Parameter: ZPOS <- "-1.7895101"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.7895101" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.7895101" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "20" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.995802405"
Evaluating: 82.1644692*(0.995802405-0.5)
 Parameter: XPOS <- "40.7373414"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.683305191"
Evaluating: 82.1644692*(0.683305191-0.5)
 Parameter: YPOS <- "15.0611737"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.574662824"
Evaluating: 85*(0.574662824-0.5)+0
 Parameter: ZPOS <- "6.34634004"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.34634004" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.34634004" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "20" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.218958567"
Evaluating: 82.1644692*(0.218958567-0.5)
 Parameter: XPOS <- "-23.0916202"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.838039274"
Evaluating: 82.1644692*(0.838039274-0.5)
 Parameter: YPOS <- "27.7748175"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.964759729"
Evaluating: 85*(0.964759729-0.5)+0
 Parameter: ZPOS <- "39.504577"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.504577" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.504577" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.238683 XMAX =  -31.238683 XAVE =  -31.238683
    YMIN =  -17.700161 YMAX =  -17.700161 YAVE =  -17.700161
    ZMIN =  -22.766384 ZMAX =  -22.766384 ZAVE =  -22.766384
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.0916202"
 RDCMND substituted energy or value "?XAVE" to "-31.2386834"
Evaluating: -23.0916202--31.2386834
 Parameter: XTRAN <- "8.1470632"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.7748175"
 RDCMND substituted energy or value "?YAVE" to "-17.7001607"
Evaluating: 27.7748175--17.7001607
 Parameter: YTRAN <- "45.4749782"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.504577"
 RDCMND substituted energy or value "?ZAVE" to "-22.7663844"
Evaluating: 39.504577--22.7663844
 Parameter: ZTRAN <- "62.2709614"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.1470632"
 Parameter: YTRAN -> "45.4749782"
 Parameter: ZTRAN -> "62.2709614"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     8.147063   45.474978   62.270961
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154090957"
Evaluating: 0.154090957*360.0
 Parameter: XPHI <- "55.4727445"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777741398"
Evaluating: 0.777741398*360.0
 Parameter: YPHI <- "279.986903"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.280598325E-02"
Evaluating: 2.280598325E-02*360.0
 Parameter: ZPHI <- "8.21015397"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.0916202"
 Parameter: YPOS -> "27.7748175"
 Parameter: ZPOS -> "39.504577"
 Parameter: XPHI -> "55.4727445"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.566798    0.823857
    0.000000   -0.823857    0.566798

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   55.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.0916202"
 Parameter: YPOS -> "27.7748175"
 Parameter: ZPOS -> "39.504577"
 Parameter: YPHI -> "279.986903"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.173423    0.000000    0.984847
    0.000000    1.000000    0.000000
   -0.984847    0.000000    0.173423

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   80.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.0916202"
 Parameter: YPOS -> "27.7748175"
 Parameter: ZPOS -> "39.504577"
 Parameter: ZPHI -> "8.21015397"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.989751    0.142804    0.000000
   -0.142804    0.989751    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    8.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.091620 XMAX =  -23.091620 XAVE =  -23.091620
    YMIN =   27.774818 YMAX =   27.774818 YAVE =   27.774818
    ZMIN =   39.504577 ZMAX =   39.504577 ZAVE =   39.504577
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.0916202"
Evaluating: -23.0916202+3.5
 Parameter: XMAX <- "-19.5916202"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.7748175"
Evaluating: 27.7748175+3.5
 Parameter: YMAX <- "31.2748175"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.504577"
Evaluating: 39.504577+3.5
 Parameter: ZMAX <- "43.004577"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.0916202"
Evaluating: -23.0916202-3.5
 Parameter: XMIN <- "-26.5916202"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.7748175"
Evaluating: 27.7748175-3.5
 Parameter: YMIN <- "24.2748175"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.504577"
Evaluating: 39.504577-3.5
 Parameter: ZMIN <- "36.004577"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.5916202"
 Parameter: XMIN -> "-26.5916202"
 Parameter: YMAX -> "31.2748175"
 Parameter: YMIN -> "24.2748175"
 Parameter: ZMAX -> "43.004577"
 Parameter: ZMIN -> "36.004577"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "21" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "21" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.534516624"
Evaluating: 82.1644692*(0.534516624-0.5)
 Parameter: XPOS <- "2.83604009"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.322274011"
Evaluating: 82.1644692*(0.322274011-0.5)
 Parameter: YPOS <- "-14.6027615"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.910866302"
Evaluating: 85*(0.910866302-0.5)+0
 Parameter: ZPOS <- "34.9236357"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.9236357" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.9236357" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.83604009"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 2.83604009-0
 Parameter: XTRAN <- "2.83604009"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.6027615"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.6027615-0
 Parameter: YTRAN <- "-14.6027615"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.9236357"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.9236357-0
 Parameter: ZTRAN <- "34.9236357"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.83604009"
 Parameter: YTRAN -> "-14.6027615"
 Parameter: ZTRAN -> "34.9236357"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     2.836040  -14.602761   34.923636
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.203282646"
Evaluating: 0.203282646*360.0
 Parameter: XPHI <- "73.1817526"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71559927"
Evaluating: 0.71559927*360.0
 Parameter: YPHI <- "257.615737"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658118646"
Evaluating: 0.658118646*360.0
 Parameter: ZPHI <- "236.922713"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.83604009"
 Parameter: YPOS -> "-14.6027615"
 Parameter: ZPOS -> "34.9236357"
 Parameter: XPHI -> "73.1817526"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.289337    0.957227
    0.000000   -0.957227    0.289337

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   73.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.83604009"
 Parameter: YPOS -> "-14.6027615"
 Parameter: ZPOS -> "34.9236357"
 Parameter: YPHI -> "257.615737"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.214467    0.000000    0.976731
    0.000000    1.000000    0.000000
   -0.976731    0.000000   -0.214467

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  102.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.83604009"
 Parameter: YPOS -> "-14.6027615"
 Parameter: ZPOS -> "34.9236357"
 Parameter: ZPHI -> "236.922713"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.545770   -0.837935    0.000000
    0.837935   -0.545770    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  123.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.836040 XMAX =    2.836040 XAVE =    2.836040
    YMIN =  -14.602761 YMAX =  -14.602761 YAVE =  -14.602761
    ZMIN =   34.923636 ZMAX =   34.923636 ZAVE =   34.923636
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.83604009"
Evaluating: 2.83604009+3.5
 Parameter: XMAX <- "6.33604009"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.6027615"
Evaluating: -14.6027615+3.5
 Parameter: YMAX <- "-11.1027615"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.9236357"
Evaluating: 34.9236357+3.5
 Parameter: ZMAX <- "38.4236357"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.83604009"
Evaluating: 2.83604009-3.5
 Parameter: XMIN <- "-0.66395991"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.6027615"
Evaluating: -14.6027615-3.5
 Parameter: YMIN <- "-18.1027615"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.9236357"
Evaluating: 34.9236357-3.5
 Parameter: ZMIN <- "31.4236357"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.33604009"
 Parameter: XMIN -> "-0.66395991"
 Parameter: YMAX -> "-11.1027615"
 Parameter: YMIN -> "-18.1027615"
 Parameter: ZMAX -> "38.4236357"
 Parameter: ZMIN -> "31.4236357"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "22" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "22" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "3.312582503E-02"
Evaluating: 82.1644692*(3.312582503E-02-0.5)
 Parameter: XPOS <- "-38.3604688"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.349176642"
Evaluating: 82.1644692*(0.349176642-0.5)
 Parameter: YPOS <- "-12.3923212"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.364315031"
Evaluating: 85*(0.364315031-0.5)+0
 Parameter: ZPOS <- "-11.5332224"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.5332224" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.5332224" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "22" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.534386701"
Evaluating: 82.1644692*(0.534386701-0.5)
 Parameter: XPOS <- "2.82536504"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.436403913"
Evaluating: 82.1644692*(0.436403913-0.5)
 Parameter: YPOS <- "-5.22533873"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.312867648"
Evaluating: 85*(0.312867648-0.5)+0
 Parameter: ZPOS <- "-15.9062499"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.9062499" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.82536504"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 2.82536504-0
 Parameter: XTRAN <- "2.82536504"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.22533873"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.22533873-0
 Parameter: YTRAN <- "-5.22533873"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.9062499"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.9062499-0
 Parameter: ZTRAN <- "-15.9062499"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.82536504"
 Parameter: YTRAN -> "-5.22533873"
 Parameter: ZTRAN -> "-15.9062499"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     2.825365   -5.225339  -15.906250
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71447806"
Evaluating: 0.71447806*360.0
 Parameter: XPHI <- "257.212102"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345848082"
Evaluating: 0.345848082*360.0
 Parameter: YPHI <- "124.50531"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.028429645E-02"
Evaluating: 5.028429645E-02*360.0
 Parameter: ZPHI <- "18.1023467"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.82536504"
 Parameter: YPOS -> "-5.22533873"
 Parameter: ZPOS -> "-15.9062499"
 Parameter: XPHI -> "257.212102"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.221343   -0.975196
    0.000000    0.975196   -0.221343

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  102.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.82536504"
 Parameter: YPOS -> "-5.22533873"
 Parameter: ZPOS -> "-15.9062499"
 Parameter: YPHI -> "124.50531"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.566483    0.000000   -0.824074
    0.000000    1.000000    0.000000
    0.824074    0.000000   -0.566483

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.82536504"
 Parameter: YPOS -> "-5.22533873"
 Parameter: ZPOS -> "-15.9062499"
 Parameter: ZPHI -> "18.1023467"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.950503    0.310715    0.000000
   -0.310715    0.950503    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   18.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.825365 XMAX =    2.825365 XAVE =    2.825365
    YMIN =   -5.225339 YMAX =   -5.225339 YAVE =   -5.225339
    ZMIN =  -15.906250 ZMAX =  -15.906250 ZAVE =  -15.906250
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.82536504"
Evaluating: 2.82536504+3.5
 Parameter: XMAX <- "6.32536504"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.22533873"
Evaluating: -5.22533873+3.5
 Parameter: YMAX <- "-1.72533873"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.9062499"
Evaluating: -15.9062499+3.5
 Parameter: ZMAX <- "-12.4062499"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.82536504"
Evaluating: 2.82536504-3.5
 Parameter: XMIN <- "-0.67463496"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.22533873"
Evaluating: -5.22533873-3.5
 Parameter: YMIN <- "-8.72533873"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.9062499"
Evaluating: -15.9062499-3.5
 Parameter: ZMIN <- "-19.4062499"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.32536504"
 Parameter: XMIN -> "-0.67463496"
 Parameter: YMAX -> "-1.72533873"
 Parameter: YMIN -> "-8.72533873"
 Parameter: ZMAX -> "-12.4062499"
 Parameter: ZMIN -> "-19.4062499"
 SELRPN>     32 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     15 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26682 POS      POT      22       POT     -**** MEMB     POPC     101      O22           3.9597
26682 POS      POT      22       POT     -**** MEMB     POPC     102      C21           3.3055
26682 POS      POT      22       POT     -**** MEMB     POPC     102      C22           2.1878
26682 POS      POT      22       POT     -**** MEMB     POPC     102      C23           0.8966
26682 POS      POT      22       POT     -**** MEMB     POPC     102      C24           0.7785
26682 POS      POT      22       POT     -**** MEMB     POPC     102      C25           1.9326
26682 POS      POT      22       POT     -**** MEMB     POPC     102      C26           3.2205
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "22" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.779927754"
Evaluating: 82.1644692*(0.779927754-0.5)
 Parameter: XPOS <- "23.0001153"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.609957443"
Evaluating: 82.1644692*(0.609957443-0.5)
 Parameter: YPOS <- "9.03459494"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.427462497"
Evaluating: 85*(0.427462497-0.5)+0
 Parameter: ZPOS <- "-6.16568776"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.16568776" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.16568776" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "22" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "8.082194301E-02"
Evaluating: 82.1644692*(8.082194301E-02-0.5)
 Parameter: XPOS <- "-34.4415426"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.717481743"
Evaluating: 82.1644692*(0.717481743-0.5)
 Parameter: YPOS <- "17.869272"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.80039512"
Evaluating: 85*(0.80039512-0.5)+0
 Parameter: ZPOS <- "25.5335852"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.5335852" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.5335852" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.825365 XMAX =    2.825365 XAVE =    2.825365
    YMIN =   -5.225339 YMAX =   -5.225339 YAVE =   -5.225339
    ZMIN =  -15.906250 ZMAX =  -15.906250 ZAVE =  -15.906250
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.4415426"
 RDCMND substituted energy or value "?XAVE" to "2.82536504"
Evaluating: -34.4415426-2.82536504
 Parameter: XTRAN <- "-37.2669076"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.869272"
 RDCMND substituted energy or value "?YAVE" to "-5.22533873"
Evaluating: 17.869272--5.22533873
 Parameter: YTRAN <- "23.0946107"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.5335852"
 RDCMND substituted energy or value "?ZAVE" to "-15.9062499"
Evaluating: 25.5335852--15.9062499
 Parameter: ZTRAN <- "41.4398351"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.2669076"
 Parameter: YTRAN -> "23.0946107"
 Parameter: ZTRAN -> "41.4398351"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -37.266908   23.094611   41.439835
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905828918"
Evaluating: 0.905828918*360.0
 Parameter: XPHI <- "326.09841"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.352558626"
Evaluating: 0.352558626*360.0
 Parameter: YPHI <- "126.921105"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.621479998"
Evaluating: 0.621479998*360.0
 Parameter: ZPHI <- "223.732799"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.4415426"
 Parameter: YPOS -> "17.869272"
 Parameter: ZPOS -> "25.5335852"
 Parameter: XPHI -> "326.09841"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.829997   -0.557768
    0.000000    0.557768    0.829997

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.4415426"
 Parameter: YPOS -> "17.869272"
 Parameter: ZPOS -> "25.5335852"
 Parameter: YPHI -> "126.921105"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.600715    0.000000   -0.799463
    0.000000    1.000000    0.000000
    0.799463    0.000000   -0.600715

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  126.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.4415426"
 Parameter: YPOS -> "17.869272"
 Parameter: ZPOS -> "25.5335852"
 Parameter: ZPHI -> "223.732799"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.722572   -0.691296    0.000000
    0.691296   -0.722572    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  136.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.441543 XMAX =  -34.441543 XAVE =  -34.441543
    YMIN =   17.869272 YMAX =   17.869272 YAVE =   17.869272
    ZMIN =   25.533585 ZMAX =   25.533585 ZAVE =   25.533585
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.4415426"
Evaluating: -34.4415426+3.5
 Parameter: XMAX <- "-30.9415426"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.869272"
Evaluating: 17.869272+3.5
 Parameter: YMAX <- "21.369272"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.5335852"
Evaluating: 25.5335852+3.5
 Parameter: ZMAX <- "29.0335852"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.4415426"
Evaluating: -34.4415426-3.5
 Parameter: XMIN <- "-37.9415426"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.869272"
Evaluating: 17.869272-3.5
 Parameter: YMIN <- "14.369272"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.5335852"
Evaluating: 25.5335852-3.5
 Parameter: ZMIN <- "22.0335852"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.9415426"
 Parameter: XMIN -> "-37.9415426"
 Parameter: YMAX -> "21.369272"
 Parameter: YMIN -> "14.369272"
 Parameter: ZMAX -> "29.0335852"
 Parameter: ZMIN -> "22.0335852"
 SELRPN>      2 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "23" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "23" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.879183532"
Evaluating: 82.1644692*(0.879183532-0.5)
 Parameter: XPOS <- "31.1554136"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.225099093"
Evaluating: 82.1644692*(0.225099093-0.5)
 Parameter: YPOS <- "-22.5870871"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.218222573"
Evaluating: 85*(0.218222573-0.5)+0
 Parameter: ZPOS <- "-23.9510813"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.9510813" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.1554136"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.1554136-0
 Parameter: XTRAN <- "31.1554136"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.5870871"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.5870871-0
 Parameter: YTRAN <- "-22.5870871"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.9510813"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.9510813-0
 Parameter: ZTRAN <- "-23.9510813"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.1554136"
 Parameter: YTRAN -> "-22.5870871"
 Parameter: ZTRAN -> "-23.9510813"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    31.155414  -22.587087  -23.951081
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.446586252"
Evaluating: 0.446586252*360.0
 Parameter: XPHI <- "160.771051"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.191436712"
Evaluating: 0.191436712*360.0
 Parameter: YPHI <- "68.9172163"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.814484524"
Evaluating: 0.814484524*360.0
 Parameter: ZPHI <- "293.214429"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.1554136"
 Parameter: YPOS -> "-22.5870871"
 Parameter: ZPOS -> "-23.9510813"
 Parameter: XPHI -> "160.771051"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.944210    0.329344
    0.000000   -0.329344   -0.944210

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  160.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.1554136"
 Parameter: YPOS -> "-22.5870871"
 Parameter: ZPOS -> "-23.9510813"
 Parameter: YPHI -> "68.9172163"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.359716    0.000000   -0.933062
    0.000000    1.000000    0.000000
    0.933062    0.000000    0.359716

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.1554136"
 Parameter: YPOS -> "-22.5870871"
 Parameter: ZPOS -> "-23.9510813"
 Parameter: ZPHI -> "293.214429"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.394173   -0.919036    0.000000
    0.919036    0.394173    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.155414 XMAX =   31.155414 XAVE =   31.155414
    YMIN =  -22.587087 YMAX =  -22.587087 YAVE =  -22.587087
    ZMIN =  -23.951081 ZMAX =  -23.951081 ZAVE =  -23.951081
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.1554136"
Evaluating: 31.1554136+3.5
 Parameter: XMAX <- "34.6554136"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.5870871"
Evaluating: -22.5870871+3.5
 Parameter: YMAX <- "-19.0870871"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.9510813"
Evaluating: -23.9510813+3.5
 Parameter: ZMAX <- "-20.4510813"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.1554136"
Evaluating: 31.1554136-3.5
 Parameter: XMIN <- "27.6554136"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.5870871"
Evaluating: -22.5870871-3.5
 Parameter: YMIN <- "-26.0870871"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.9510813"
Evaluating: -23.9510813-3.5
 Parameter: ZMIN <- "-27.4510813"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.6554136"
 Parameter: XMIN -> "27.6554136"
 Parameter: YMAX -> "-19.0870871"
 Parameter: YMIN -> "-26.0870871"
 Parameter: ZMAX -> "-20.4510813"
 Parameter: ZMIN -> "-27.4510813"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "24" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "24" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.369467992"
Evaluating: 82.1644692*(0.369467992-0.5)
 Parameter: XPOS <- "-10.7250932"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.224818936"
Evaluating: 82.1644692*(0.224818936-0.5)
 Parameter: YPOS <- "-22.6101061"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.725172171E-02"
Evaluating: 85*(6.725172171E-02-0.5)+0
 Parameter: ZPOS <- "-36.7836037"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.7836037" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.7250932"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.7250932-0
 Parameter: XTRAN <- "-10.7250932"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.6101061"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.6101061-0
 Parameter: YTRAN <- "-22.6101061"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.7836037"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.7836037-0
 Parameter: ZTRAN <- "-36.7836037"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.7250932"
 Parameter: YTRAN -> "-22.6101061"
 Parameter: ZTRAN -> "-36.7836037"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -10.725093  -22.610106  -36.783604
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.681745502"
Evaluating: 0.681745502*360.0
 Parameter: XPHI <- "245.428381"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.834966823"
Evaluating: 0.834966823*360.0
 Parameter: YPHI <- "300.588056"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.712748766"
Evaluating: 0.712748766*360.0
 Parameter: ZPHI <- "256.589556"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.7250932"
 Parameter: YPOS -> "-22.6101061"
 Parameter: ZPOS -> "-36.7836037"
 Parameter: XPHI -> "245.428381"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.415830   -0.909442
    0.000000    0.909442   -0.415830

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  114.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.7250932"
 Parameter: YPOS -> "-22.6101061"
 Parameter: ZPOS -> "-36.7836037"
 Parameter: YPHI -> "300.588056"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.508862    0.000000    0.860848
    0.000000    1.000000    0.000000
   -0.860848    0.000000    0.508862

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.7250932"
 Parameter: YPOS -> "-22.6101061"
 Parameter: ZPOS -> "-36.7836037"
 Parameter: ZPHI -> "256.589556"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.231925   -0.972734    0.000000
    0.972734   -0.231925    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  103.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.725093 XMAX =  -10.725093 XAVE =  -10.725093
    YMIN =  -22.610106 YMAX =  -22.610106 YAVE =  -22.610106
    ZMIN =  -36.783604 ZMAX =  -36.783604 ZAVE =  -36.783604
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.7250932"
Evaluating: -10.7250932+3.5
 Parameter: XMAX <- "-7.2250932"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.6101061"
Evaluating: -22.6101061+3.5
 Parameter: YMAX <- "-19.1101061"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.7836037"
Evaluating: -36.7836037+3.5
 Parameter: ZMAX <- "-33.2836037"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.7250932"
Evaluating: -10.7250932-3.5
 Parameter: XMIN <- "-14.2250932"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.6101061"
Evaluating: -22.6101061-3.5
 Parameter: YMIN <- "-26.1101061"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.7836037"
Evaluating: -36.7836037-3.5
 Parameter: ZMIN <- "-40.2836037"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.2250932"
 Parameter: XMIN -> "-14.2250932"
 Parameter: YMAX -> "-19.1101061"
 Parameter: YMIN -> "-26.1101061"
 Parameter: ZMAX -> "-33.2836037"
 Parameter: ZMIN -> "-40.2836037"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "25" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "25" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.815137716"
Evaluating: 82.1644692*(0.815137716-0.5)
 Parameter: XPOS <- "25.8931232"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.499339254"
Evaluating: 82.1644692*(0.499339254-0.5)
 Parameter: YPOS <- "-5.428984437E-02"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.335453751"
Evaluating: 85*(0.335453751-0.5)+0
 Parameter: ZPOS <- "-13.9864312"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.9864312" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.9864312" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "25" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.17298558"
Evaluating: 82.1644692*(0.17298558-0.5)
 Parameter: XPOS <- "-26.8689662"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.540926959"
Evaluating: 82.1644692*(0.540926959-0.5)
 Parameter: YPOS <- "3.36274186"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.345402708"
Evaluating: 85*(0.345402708-0.5)+0
 Parameter: ZPOS <- "-13.1407698"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.1407698" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.1407698" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "25" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "3.239719319E-02"
Evaluating: 82.1644692*(3.239719319E-02-0.5)
 Parameter: XPOS <- "-38.4203364"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.760639871"
Evaluating: 82.1644692*(0.760639871-0.5)
 Parameter: YPOS <- "21.4153367"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.97782569"
Evaluating: 85*(0.97782569-0.5)+0
 Parameter: ZPOS <- "40.6151836"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.6151836" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.6151836" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.4203364"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.4203364-0
 Parameter: XTRAN <- "-38.4203364"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.4153367"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.4153367-0
 Parameter: YTRAN <- "21.4153367"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.6151836"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.6151836-0
 Parameter: ZTRAN <- "40.6151836"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.4203364"
 Parameter: YTRAN -> "21.4153367"
 Parameter: ZTRAN -> "40.6151836"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -38.420336   21.415337   40.615184
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.505990024"
Evaluating: 0.505990024*360.0
 Parameter: XPHI <- "182.156409"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111510888"
Evaluating: 0.111510888*360.0
 Parameter: YPHI <- "40.1439197"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.236038561E-02"
Evaluating: 3.236038561E-02*360.0
 Parameter: ZPHI <- "11.6497388"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.4203364"
 Parameter: YPOS -> "21.4153367"
 Parameter: ZPOS -> "40.6151836"
 Parameter: XPHI -> "182.156409"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999292   -0.037628
    0.000000    0.037628   -0.999292

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  177.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.4203364"
 Parameter: YPOS -> "21.4153367"
 Parameter: ZPOS -> "40.6151836"
 Parameter: YPHI -> "40.1439197"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.764427    0.000000   -0.644710
    0.000000    1.000000    0.000000
    0.644710    0.000000    0.764427

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.4203364"
 Parameter: YPOS -> "21.4153367"
 Parameter: ZPOS -> "40.6151836"
 Parameter: ZPHI -> "11.6497388"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.979400    0.201928    0.000000
   -0.201928    0.979400    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   11.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.420336 XMAX =  -38.420336 XAVE =  -38.420336
    YMIN =   21.415337 YMAX =   21.415337 YAVE =   21.415337
    ZMIN =   40.615184 ZMAX =   40.615184 ZAVE =   40.615184
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.4203364"
Evaluating: -38.4203364+3.5
 Parameter: XMAX <- "-34.9203364"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.4153367"
Evaluating: 21.4153367+3.5
 Parameter: YMAX <- "24.9153367"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.6151836"
Evaluating: 40.6151836+3.5
 Parameter: ZMAX <- "44.1151836"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.4203364"
Evaluating: -38.4203364-3.5
 Parameter: XMIN <- "-41.9203364"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.4153367"
Evaluating: 21.4153367-3.5
 Parameter: YMIN <- "17.9153367"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.6151836"
Evaluating: 40.6151836-3.5
 Parameter: ZMIN <- "37.1151836"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.9203364"
 Parameter: XMIN -> "-41.9203364"
 Parameter: YMAX -> "24.9153367"
 Parameter: YMIN -> "17.9153367"
 Parameter: ZMAX -> "44.1151836"
 Parameter: ZMIN -> "37.1151836"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "26" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "26" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.345502742"
Evaluating: 82.1644692*(0.345502742-0.5)
 Parameter: XPOS <- "-12.6941852"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.590625896"
Evaluating: 82.1644692*(0.590625896-0.5)
 Parameter: YPOS <- "7.44622864"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.890447188"
Evaluating: 85*(0.890447188-0.5)+0
 Parameter: ZPOS <- "33.188011"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.188011" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.188011" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.6941852"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.6941852-0
 Parameter: XTRAN <- "-12.6941852"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.44622864"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.44622864-0
 Parameter: YTRAN <- "7.44622864"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.188011"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.188011-0
 Parameter: ZTRAN <- "33.188011"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.6941852"
 Parameter: YTRAN -> "7.44622864"
 Parameter: ZTRAN -> "33.188011"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -12.694185    7.446229   33.188011
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.265453233"
Evaluating: 0.265453233*360.0
 Parameter: XPHI <- "95.5631639"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.701588083"
Evaluating: 0.701588083*360.0
 Parameter: YPHI <- "252.57171"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.869890329E-02"
Evaluating: 7.869890329E-02*360.0
 Parameter: ZPHI <- "28.3316052"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.6941852"
 Parameter: YPOS -> "7.44622864"
 Parameter: ZPOS -> "33.188011"
 Parameter: XPHI -> "95.5631639"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.096943    0.995290
    0.000000   -0.995290   -0.096943

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   95.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.6941852"
 Parameter: YPOS -> "7.44622864"
 Parameter: ZPOS -> "33.188011"
 Parameter: YPHI -> "252.57171"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.299512    0.000000    0.954093
    0.000000    1.000000    0.000000
   -0.954093    0.000000   -0.299512

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  107.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.6941852"
 Parameter: YPOS -> "7.44622864"
 Parameter: ZPOS -> "33.188011"
 Parameter: ZPHI -> "28.3316052"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.880216    0.474574    0.000000
   -0.474574    0.880216    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   28.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.694185 XMAX =  -12.694185 XAVE =  -12.694185
    YMIN =    7.446229 YMAX =    7.446229 YAVE =    7.446229
    ZMIN =   33.188011 ZMAX =   33.188011 ZAVE =   33.188011
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.6941852"
Evaluating: -12.6941852+3.5
 Parameter: XMAX <- "-9.1941852"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.44622864"
Evaluating: 7.44622864+3.5
 Parameter: YMAX <- "10.9462286"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.188011"
Evaluating: 33.188011+3.5
 Parameter: ZMAX <- "36.688011"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.6941852"
Evaluating: -12.6941852-3.5
 Parameter: XMIN <- "-16.1941852"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.44622864"
Evaluating: 7.44622864-3.5
 Parameter: YMIN <- "3.94622864"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.188011"
Evaluating: 33.188011-3.5
 Parameter: ZMIN <- "29.688011"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.1941852"
 Parameter: XMIN -> "-16.1941852"
 Parameter: YMAX -> "10.9462286"
 Parameter: YMIN -> "3.94622864"
 Parameter: ZMAX -> "36.688011"
 Parameter: ZMIN -> "29.688011"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "27" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "27" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.563500208"
Evaluating: 82.1644692*(0.563500208-0.5)
 Parameter: XPOS <- "5.21746088"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.785402416"
Evaluating: 82.1644692*(0.785402416-0.5)
 Parameter: YPOS <- "23.449938"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.407324548"
Evaluating: 85*(0.407324548-0.5)+0
 Parameter: ZPOS <- "-7.87741342"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.87741342" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.87741342" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "27" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.423433447"
Evaluating: 82.1644692*(0.423433447-0.5)
 Parameter: XPOS <- "-6.29105019"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.695239202"
Evaluating: 82.1644692*(0.695239202-0.5)
 Parameter: YPOS <- "16.0417254"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.411295017"
Evaluating: 85*(0.411295017-0.5)+0
 Parameter: ZPOS <- "-7.53992355"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.53992355" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.53992355" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "27" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.977116944"
Evaluating: 82.1644692*(0.977116944-0.5)
 Parameter: XPOS <- "39.2020605"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.315100029"
Evaluating: 82.1644692*(0.315100029-0.5)
 Parameter: YPOS <- "-15.192208"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.237474681"
Evaluating: 85*(0.237474681-0.5)+0
 Parameter: ZPOS <- "-22.3146521"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.3146521" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.2020605"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.2020605-0
 Parameter: XTRAN <- "39.2020605"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.192208"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.192208-0
 Parameter: YTRAN <- "-15.192208"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.3146521"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.3146521-0
 Parameter: ZTRAN <- "-22.3146521"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.2020605"
 Parameter: YTRAN -> "-15.192208"
 Parameter: ZTRAN -> "-22.3146521"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    39.202061  -15.192208  -22.314652
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.890242848"
Evaluating: 0.890242848*360.0
 Parameter: XPHI <- "320.487425"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652954276"
Evaluating: 0.652954276*360.0
 Parameter: YPHI <- "235.063539"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.454667915E-02"
Evaluating: 7.454667915E-02*360.0
 Parameter: ZPHI <- "26.8368045"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.2020605"
 Parameter: YPOS -> "-15.192208"
 Parameter: ZPOS -> "-22.3146521"
 Parameter: XPHI -> "320.487425"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.771485   -0.636248
    0.000000    0.636248    0.771485

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   39.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.2020605"
 Parameter: YPOS -> "-15.192208"
 Parameter: ZPOS -> "-22.3146521"
 Parameter: YPHI -> "235.063539"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.572668    0.000000    0.819788
    0.000000    1.000000    0.000000
   -0.819788    0.000000   -0.572668

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  124.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.2020605"
 Parameter: YPOS -> "-15.192208"
 Parameter: ZPOS -> "-22.3146521"
 Parameter: ZPHI -> "26.8368045"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.892296    0.451451    0.000000
   -0.451451    0.892296    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   26.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.202061 XMAX =   39.202061 XAVE =   39.202061
    YMIN =  -15.192208 YMAX =  -15.192208 YAVE =  -15.192208
    ZMIN =  -22.314652 ZMAX =  -22.314652 ZAVE =  -22.314652
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.2020605"
Evaluating: 39.2020605+3.5
 Parameter: XMAX <- "42.7020605"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.192208"
Evaluating: -15.192208+3.5
 Parameter: YMAX <- "-11.692208"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.3146521"
Evaluating: -22.3146521+3.5
 Parameter: ZMAX <- "-18.8146521"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.2020605"
Evaluating: 39.2020605-3.5
 Parameter: XMIN <- "35.7020605"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.192208"
Evaluating: -15.192208-3.5
 Parameter: YMIN <- "-18.692208"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.3146521"
Evaluating: -22.3146521-3.5
 Parameter: ZMIN <- "-25.8146521"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.7020605"
 Parameter: XMIN -> "35.7020605"
 Parameter: YMAX -> "-11.692208"
 Parameter: YMIN -> "-18.692208"
 Parameter: ZMAX -> "-18.8146521"
 Parameter: ZMIN -> "-25.8146521"
 SELRPN>     17 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      7 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26687 POS      POT      27       POT     -**** MEMB     POPC     177      C1            3.6259
26687 POS      POT      27       POT     -**** MEMB     POPC     185      N             2.6894
26687 POS      POT      27       POT     -**** MEMB     POPC     185      C12           3.5634
26687 POS      POT      27       POT     -**** MEMB     POPC     185      C13           1.3800
26687 POS      POT      27       POT     -**** MEMB     POPC     185      C14           3.0879
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "27" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.483706244"
Evaluating: 82.1644692*(0.483706244-0.5)
 Parameter: XPOS <- "-1.33876781"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.679063541"
Evaluating: 82.1644692*(0.679063541-0.5)
 Parameter: YPOS <- "14.7126608"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.375644785"
Evaluating: 85*(0.375644785-0.5)+0
 Parameter: ZPOS <- "-10.5701933"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.5701933" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.5701933" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "27" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.649807029"
Evaluating: 82.1644692*(0.649807029-0.5)
 Parameter: XPOS <- "12.308815"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.916769448"
Evaluating: 82.1644692*(0.916769448-0.5)
 Parameter: YPOS <- "34.2436405"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.394145645"
Evaluating: 85*(0.394145645-0.5)+0
 Parameter: ZPOS <- "-8.99762017"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.99762017" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.99762017" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "27" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.125153785"
Evaluating: 82.1644692*(0.125153785-0.5)
 Parameter: XPOS <- "-30.7990403"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.478522008"
Evaluating: 82.1644692*(0.478522008-0.5)
 Parameter: YPOS <- "-1.76472781"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.518163298"
Evaluating: 85*(0.518163298-0.5)+0
 Parameter: ZPOS <- "1.54388033"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.54388033" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.54388033" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "27" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.125107033"
Evaluating: 82.1644692*(0.125107033-0.5)
 Parameter: XPOS <- "-30.8028816"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.154563217"
Evaluating: 82.1644692*(0.154563217-0.5)
 Parameter: YPOS <- "-28.3826299"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.503068443"
Evaluating: 85*(0.503068443-0.5)+0
 Parameter: ZPOS <- "0.260817655"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.260817655" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.260817655" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "7"
Evaluating: 7+1
 Parameter: CNTRAND <- "8"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "8" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "27" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.731667792"
Evaluating: 82.1644692*(0.731667792-0.5)
 Parameter: XPOS <- "19.0348612"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.264204264"
Evaluating: 82.1644692*(0.264204264-0.5)
 Parameter: YPOS <- "-19.3740315"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.101628642"
Evaluating: 85*(0.101628642-0.5)+0
 Parameter: ZPOS <- "-33.8615654"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.8615654" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.202061 XMAX =   39.202061 XAVE =   39.202061
    YMIN =  -15.192208 YMAX =  -15.192208 YAVE =  -15.192208
    ZMIN =  -22.314652 ZMAX =  -22.314652 ZAVE =  -22.314652
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.0348612"
 RDCMND substituted energy or value "?XAVE" to "39.2020605"
Evaluating: 19.0348612-39.2020605
 Parameter: XTRAN <- "-20.1671993"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.3740315"
 RDCMND substituted energy or value "?YAVE" to "-15.192208"
Evaluating: -19.3740315--15.192208
 Parameter: YTRAN <- "-4.1818235"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.8615654"
 RDCMND substituted energy or value "?ZAVE" to "-22.3146521"
Evaluating: -33.8615654--22.3146521
 Parameter: ZTRAN <- "-11.5469133"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.1671993"
 Parameter: YTRAN -> "-4.1818235"
 Parameter: ZTRAN -> "-11.5469133"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -20.167199   -4.181824  -11.546913
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.548718118"
Evaluating: 0.548718118*360.0
 Parameter: XPHI <- "197.538522"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.672853317"
Evaluating: 0.672853317*360.0
 Parameter: YPHI <- "242.227194"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.956706566E-02"
Evaluating: 3.956706566E-02*360.0
 Parameter: ZPHI <- "14.2441436"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.0348612"
 Parameter: YPOS -> "-19.3740315"
 Parameter: ZPOS -> "-33.8615654"
 Parameter: XPHI -> "197.538522"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.953515   -0.301347
    0.000000    0.301347   -0.953515

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.0348612"
 Parameter: YPOS -> "-19.3740315"
 Parameter: ZPOS -> "-33.8615654"
 Parameter: YPHI -> "242.227194"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.465967    0.000000    0.884802
    0.000000    1.000000    0.000000
   -0.884802    0.000000   -0.465967

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  117.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.0348612"
 Parameter: YPOS -> "-19.3740315"
 Parameter: ZPOS -> "-33.8615654"
 Parameter: ZPHI -> "14.2441436"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.969256    0.246054    0.000000
   -0.246054    0.969256    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.034861 XMAX =   19.034861 XAVE =   19.034861
    YMIN =  -19.374032 YMAX =  -19.374032 YAVE =  -19.374032
    ZMIN =  -33.861565 ZMAX =  -33.861565 ZAVE =  -33.861565
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.0348612"
Evaluating: 19.0348612+3.5
 Parameter: XMAX <- "22.5348612"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.3740315"
Evaluating: -19.3740315+3.5
 Parameter: YMAX <- "-15.8740315"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.8615654"
Evaluating: -33.8615654+3.5
 Parameter: ZMAX <- "-30.3615654"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.0348612"
Evaluating: 19.0348612-3.5
 Parameter: XMIN <- "15.5348612"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.3740315"
Evaluating: -19.3740315-3.5
 Parameter: YMIN <- "-22.8740315"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.8615654"
Evaluating: -33.8615654-3.5
 Parameter: ZMIN <- "-37.3615654"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.5348612"
 Parameter: XMIN -> "15.5348612"
 Parameter: YMAX -> "-15.8740315"
 Parameter: YMIN -> "-22.8740315"
 Parameter: ZMAX -> "-30.3615654"
 Parameter: ZMIN -> "-37.3615654"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "28" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "28" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.997586598"
Evaluating: 82.1644692*(0.997586598-0.5)
 Parameter: XPOS <- "40.8839387"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.215936416"
Evaluating: 82.1644692*(0.215936416-0.5)
 Parameter: YPOS <- "-23.3399336"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.404747532"
Evaluating: 85*(0.404747532-0.5)+0
 Parameter: ZPOS <- "-8.09645978"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.09645978" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.09645978" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "28" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.142091515"
Evaluating: 82.1644692*(0.142091515-0.5)
 Parameter: XPOS <- "-29.4073607"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.896239782"
Evaluating: 82.1644692*(0.896239782-0.5)
 Parameter: YPOS <- "32.5568314"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.415481938"
Evaluating: 85*(0.415481938-0.5)+0
 Parameter: ZPOS <- "-7.18403527"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.18403527" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.18403527" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "28" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.604496448"
Evaluating: 82.1644692*(0.604496448-0.5)
 Parameter: XPOS <- "8.58589518"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "9.214722863E-02"
Evaluating: 82.1644692*(9.214722863E-02-0.5)
 Parameter: YPOS <- "-33.5110065"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.694965803"
Evaluating: 85*(0.694965803-0.5)+0
 Parameter: ZPOS <- "16.5720933"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.5720933" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.5720933" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.58589518"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.58589518-0
 Parameter: XTRAN <- "8.58589518"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.5110065"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.5110065-0
 Parameter: YTRAN <- "-33.5110065"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.5720933"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.5720933-0
 Parameter: ZTRAN <- "16.5720933"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.58589518"
 Parameter: YTRAN -> "-33.5110065"
 Parameter: ZTRAN -> "16.5720933"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     8.585895  -33.511007   16.572093
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65590755"
Evaluating: 0.65590755*360.0
 Parameter: XPHI <- "236.126718"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.233812463"
Evaluating: 0.233812463*360.0
 Parameter: YPHI <- "84.1724867"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.438742548"
Evaluating: 0.438742548*360.0
 Parameter: ZPHI <- "157.947317"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.58589518"
 Parameter: YPOS -> "-33.5110065"
 Parameter: ZPOS -> "16.5720933"
 Parameter: XPHI -> "236.126718"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.557358   -0.830272
    0.000000    0.830272   -0.557358

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.58589518"
 Parameter: YPOS -> "-33.5110065"
 Parameter: ZPOS -> "16.5720933"
 Parameter: YPHI -> "84.1724867"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.101534    0.000000   -0.994832
    0.000000    1.000000    0.000000
    0.994832    0.000000    0.101534

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   84.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.58589518"
 Parameter: YPOS -> "-33.5110065"
 Parameter: ZPOS -> "16.5720933"
 Parameter: ZPHI -> "157.947317"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.926839    0.375459    0.000000
   -0.375459   -0.926839    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  157.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.585895 XMAX =    8.585895 XAVE =    8.585895
    YMIN =  -33.511007 YMAX =  -33.511007 YAVE =  -33.511007
    ZMIN =   16.572093 ZMAX =   16.572093 ZAVE =   16.572093
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.58589518"
Evaluating: 8.58589518+3.5
 Parameter: XMAX <- "12.0858952"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.5110065"
Evaluating: -33.5110065+3.5
 Parameter: YMAX <- "-30.0110065"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.5720933"
Evaluating: 16.5720933+3.5
 Parameter: ZMAX <- "20.0720933"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.58589518"
Evaluating: 8.58589518-3.5
 Parameter: XMIN <- "5.08589518"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.5110065"
Evaluating: -33.5110065-3.5
 Parameter: YMIN <- "-37.0110065"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.5720933"
Evaluating: 16.5720933-3.5
 Parameter: ZMIN <- "13.0720933"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.0858952"
 Parameter: XMIN -> "5.08589518"
 Parameter: YMAX -> "-30.0110065"
 Parameter: YMIN -> "-37.0110065"
 Parameter: ZMAX -> "20.0720933"
 Parameter: ZMIN -> "13.0720933"
 SELRPN>     18 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     10 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26688 POS      POT      28       POT     -7450 MEMB     POPC     57       C12           3.6354
26688 POS      POT      28       POT     -7465 MEMB     POPC     57       C11           3.1054
26688 POS      POT      28       POT     -7468 MEMB     POPC     57       P             0.5063
26688 POS      POT      28       POT     -7469 MEMB     POPC     57       O13           1.2277
26688 POS      POT      28       POT     -7470 MEMB     POPC     57       O14           1.5405
26688 POS      POT      28       POT     -7471 MEMB     POPC     57       O12           2.0676
26688 POS      POT      28       POT     -7472 MEMB     POPC     57       O11           1.4857
26688 POS      POT      28       POT     -7473 MEMB     POPC     57       C1            2.5322
26688 POS      POT      28       POT     -7487 MEMB     POPC     57       O31           3.9847
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "28" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.876208136"
Evaluating: 82.1644692*(0.876208136-0.5)
 Parameter: XPOS <- "30.9109418"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.785886958"
Evaluating: 82.1644692*(0.785886958-0.5)
 Parameter: YPOS <- "23.4897502"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "7.947220379E-02"
Evaluating: 85*(7.947220379E-02-0.5)+0
 Parameter: ZPOS <- "-35.7448627"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.7448627" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.585895 XMAX =    8.585895 XAVE =    8.585895
    YMIN =  -33.511007 YMAX =  -33.511007 YAVE =  -33.511007
    ZMIN =   16.572093 ZMAX =   16.572093 ZAVE =   16.572093
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.9109418"
 RDCMND substituted energy or value "?XAVE" to "8.58589518"
Evaluating: 30.9109418-8.58589518
 Parameter: XTRAN <- "22.3250466"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.4897502"
 RDCMND substituted energy or value "?YAVE" to "-33.5110065"
Evaluating: 23.4897502--33.5110065
 Parameter: YTRAN <- "57.0007567"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.7448627"
 RDCMND substituted energy or value "?ZAVE" to "16.5720933"
Evaluating: -35.7448627-16.5720933
 Parameter: ZTRAN <- "-52.316956"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.3250466"
 Parameter: YTRAN -> "57.0007567"
 Parameter: ZTRAN -> "-52.316956"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    22.325047   57.000757  -52.316956
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.565148014"
Evaluating: 0.565148014*360.0
 Parameter: XPHI <- "203.453285"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.763087884"
Evaluating: 0.763087884*360.0
 Parameter: YPHI <- "274.711638"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.977600213"
Evaluating: 0.977600213*360.0
 Parameter: ZPHI <- "351.936077"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.9109418"
 Parameter: YPOS -> "23.4897502"
 Parameter: ZPOS -> "-35.7448627"
 Parameter: XPHI -> "203.453285"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.917385   -0.398001
    0.000000    0.398001   -0.917385

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  156.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.9109418"
 Parameter: YPOS -> "23.4897502"
 Parameter: ZPOS -> "-35.7448627"
 Parameter: YPHI -> "274.711638"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.082141    0.000000    0.996621
    0.000000    1.000000    0.000000
   -0.996621    0.000000    0.082141

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   85.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.9109418"
 Parameter: YPOS -> "23.4897502"
 Parameter: ZPOS -> "-35.7448627"
 Parameter: ZPHI -> "351.936077"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.990112   -0.140278    0.000000
    0.140278    0.990112    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.910942 XMAX =   30.910942 XAVE =   30.910942
    YMIN =   23.489750 YMAX =   23.489750 YAVE =   23.489750
    ZMIN =  -35.744863 ZMAX =  -35.744863 ZAVE =  -35.744863
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.9109418"
Evaluating: 30.9109418+3.5
 Parameter: XMAX <- "34.4109418"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.4897502"
Evaluating: 23.4897502+3.5
 Parameter: YMAX <- "26.9897502"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.7448627"
Evaluating: -35.7448627+3.5
 Parameter: ZMAX <- "-32.2448627"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.9109418"
Evaluating: 30.9109418-3.5
 Parameter: XMIN <- "27.4109418"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.4897502"
Evaluating: 23.4897502-3.5
 Parameter: YMIN <- "19.9897502"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.7448627"
Evaluating: -35.7448627-3.5
 Parameter: ZMIN <- "-39.2448627"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.4109418"
 Parameter: XMIN -> "27.4109418"
 Parameter: YMAX -> "26.9897502"
 Parameter: YMIN -> "19.9897502"
 Parameter: ZMAX -> "-32.2448627"
 Parameter: ZMIN -> "-39.2448627"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "29" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "29" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.871178264"
Evaluating: 82.1644692*(0.871178264-0.5)
 Parameter: XPOS <- "30.497665"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.737288908"
Evaluating: 82.1644692*(0.737288908-0.5)
 Parameter: YPOS <- "19.4967172"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.885784079"
Evaluating: 85*(0.885784079-0.5)+0
 Parameter: ZPOS <- "32.7916467"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.7916467" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.7916467" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.497665"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.497665-0
 Parameter: XTRAN <- "30.497665"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.4967172"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.4967172-0
 Parameter: YTRAN <- "19.4967172"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.7916467"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.7916467-0
 Parameter: ZTRAN <- "32.7916467"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.497665"
 Parameter: YTRAN -> "19.4967172"
 Parameter: ZTRAN -> "32.7916467"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    30.497665   19.496717   32.791647
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.997469163"
Evaluating: 0.997469163*360.0
 Parameter: XPHI <- "359.088899"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805512124"
Evaluating: 0.805512124*360.0
 Parameter: YPHI <- "289.984365"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.394532184"
Evaluating: 0.394532184*360.0
 Parameter: ZPHI <- "142.031586"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.497665"
 Parameter: YPOS -> "19.4967172"
 Parameter: ZPOS -> "32.7916467"
 Parameter: XPHI -> "359.088899"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999874   -0.015901
    0.000000    0.015901    0.999874

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    0.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.497665"
 Parameter: YPOS -> "19.4967172"
 Parameter: ZPOS -> "32.7916467"
 Parameter: YPHI -> "289.984365"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.341764    0.000000    0.939786
    0.000000    1.000000    0.000000
   -0.939786    0.000000    0.341764

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.497665"
 Parameter: YPOS -> "19.4967172"
 Parameter: ZPOS -> "32.7916467"
 Parameter: ZPHI -> "142.031586"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.788350    0.615227    0.000000
   -0.615227   -0.788350    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.497665 XMAX =   30.497665 XAVE =   30.497665
    YMIN =   19.496717 YMAX =   19.496717 YAVE =   19.496717
    ZMIN =   32.791647 ZMAX =   32.791647 ZAVE =   32.791647
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.497665"
Evaluating: 30.497665+3.5
 Parameter: XMAX <- "33.997665"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.4967172"
Evaluating: 19.4967172+3.5
 Parameter: YMAX <- "22.9967172"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.7916467"
Evaluating: 32.7916467+3.5
 Parameter: ZMAX <- "36.2916467"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.497665"
Evaluating: 30.497665-3.5
 Parameter: XMIN <- "26.997665"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.4967172"
Evaluating: 19.4967172-3.5
 Parameter: YMIN <- "15.9967172"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.7916467"
Evaluating: 32.7916467-3.5
 Parameter: ZMIN <- "29.2916467"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.997665"
 Parameter: XMIN -> "26.997665"
 Parameter: YMAX -> "22.9967172"
 Parameter: YMIN -> "15.9967172"
 Parameter: ZMAX -> "36.2916467"
 Parameter: ZMIN -> "29.2916467"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "30" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "30" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.646967021"
Evaluating: 82.1644692*(0.646967021-0.5)
 Parameter: XPOS <- "12.0754673"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.843379278"
Evaluating: 82.1644692*(0.843379278-0.5)
 Parameter: YPOS <- "28.2135761"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.17492014"
Evaluating: 85*(0.17492014-0.5)+0
 Parameter: ZPOS <- "-27.6317881"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.6317881" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.0754673"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.0754673-0
 Parameter: XTRAN <- "12.0754673"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.2135761"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.2135761-0
 Parameter: YTRAN <- "28.2135761"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.6317881"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.6317881-0
 Parameter: ZTRAN <- "-27.6317881"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.0754673"
 Parameter: YTRAN -> "28.2135761"
 Parameter: ZTRAN -> "-27.6317881"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    12.075467   28.213576  -27.631788
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.115756264"
Evaluating: 0.115756264*360.0
 Parameter: XPHI <- "41.672255"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.958376723E-02"
Evaluating: 5.958376723E-02*360.0
 Parameter: YPHI <- "21.4501562"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393280264"
Evaluating: 0.393280264*360.0
 Parameter: ZPHI <- "141.580895"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.0754673"
 Parameter: YPOS -> "28.2135761"
 Parameter: ZPOS -> "-27.6317881"
 Parameter: XPHI -> "41.672255"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.746960    0.664869
    0.000000   -0.664869    0.746960

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   41.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.0754673"
 Parameter: YPOS -> "28.2135761"
 Parameter: ZPOS -> "-27.6317881"
 Parameter: YPHI -> "21.4501562"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.930736    0.000000   -0.365692
    0.000000    1.000000    0.000000
    0.365692    0.000000    0.930736

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.0754673"
 Parameter: YPOS -> "28.2135761"
 Parameter: ZPOS -> "-27.6317881"
 Parameter: ZPHI -> "141.580895"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.783486    0.621409    0.000000
   -0.621409   -0.783486    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  141.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.075467 XMAX =   12.075467 XAVE =   12.075467
    YMIN =   28.213576 YMAX =   28.213576 YAVE =   28.213576
    ZMIN =  -27.631788 ZMAX =  -27.631788 ZAVE =  -27.631788
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.0754673"
Evaluating: 12.0754673+3.5
 Parameter: XMAX <- "15.5754673"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.2135761"
Evaluating: 28.2135761+3.5
 Parameter: YMAX <- "31.7135761"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.6317881"
Evaluating: -27.6317881+3.5
 Parameter: ZMAX <- "-24.1317881"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.0754673"
Evaluating: 12.0754673-3.5
 Parameter: XMIN <- "8.5754673"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.2135761"
Evaluating: 28.2135761-3.5
 Parameter: YMIN <- "24.7135761"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.6317881"
Evaluating: -27.6317881-3.5
 Parameter: ZMIN <- "-31.1317881"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.5754673"
 Parameter: XMIN -> "8.5754673"
 Parameter: YMAX -> "31.7135761"
 Parameter: YMIN -> "24.7135761"
 Parameter: ZMAX -> "-24.1317881"
 Parameter: ZMIN -> "-31.1317881"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "31" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "31" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.905312634"
Evaluating: 82.1644692*(0.905312634-0.5)
 Parameter: XPOS <- "33.3022974"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.129678594"
Evaluating: 82.1644692*(0.129678594-0.5)
 Parameter: YPOS <- "-30.4272618"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.466848483"
Evaluating: 85*(0.466848483-0.5)+0
 Parameter: ZPOS <- "-2.81787894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.81787894" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.81787894" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "31" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.493751606"
Evaluating: 82.1644692*(0.493751606-0.5)
 Parameter: XPOS <- "-0.513395976"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.911774966"
Evaluating: 82.1644692*(0.911774966-0.5)
 Parameter: YPOS <- "33.8332715"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.482911411"
Evaluating: 85*(0.482911411-0.5)+0
 Parameter: ZPOS <- "-1.45253007"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.45253007" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.45253007" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "31" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.685758813"
Evaluating: 82.1644692*(0.685758813-0.5)
 Parameter: XPOS <- "15.2627743"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.980330226"
Evaluating: 82.1644692*(0.980330226-0.5)
 Parameter: YPOS <- "39.4660781"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.22566714"
Evaluating: 85*(0.22566714-0.5)+0
 Parameter: ZPOS <- "-23.3182931"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.3182931" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.2627743"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.2627743-0
 Parameter: XTRAN <- "15.2627743"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.4660781"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.4660781-0
 Parameter: YTRAN <- "39.4660781"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.3182931"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.3182931-0
 Parameter: ZTRAN <- "-23.3182931"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.2627743"
 Parameter: YTRAN -> "39.4660781"
 Parameter: ZTRAN -> "-23.3182931"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    15.262774   39.466078  -23.318293
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.369186499E-02"
Evaluating: 8.369186499E-02*360.0
 Parameter: XPHI <- "30.1290714"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.138840641"
Evaluating: 0.138840641*360.0
 Parameter: YPHI <- "49.9826308"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.405005849"
Evaluating: 0.405005849*360.0
 Parameter: ZPHI <- "145.802106"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.2627743"
 Parameter: YPOS -> "39.4660781"
 Parameter: ZPOS -> "-23.3182931"
 Parameter: XPHI -> "30.1290714"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.864897    0.501950
    0.000000   -0.501950    0.864897

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   30.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.2627743"
 Parameter: YPOS -> "39.4660781"
 Parameter: ZPOS -> "-23.3182931"
 Parameter: YPHI -> "49.9826308"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.643020    0.000000   -0.765850
    0.000000    1.000000    0.000000
    0.765850    0.000000    0.643020

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   49.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.2627743"
 Parameter: YPOS -> "39.4660781"
 Parameter: ZPOS -> "-23.3182931"
 Parameter: ZPHI -> "145.802106"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.827101    0.562053    0.000000
   -0.562053   -0.827101    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  145.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.262774 XMAX =   15.262774 XAVE =   15.262774
    YMIN =   39.466078 YMAX =   39.466078 YAVE =   39.466078
    ZMIN =  -23.318293 ZMAX =  -23.318293 ZAVE =  -23.318293
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.2627743"
Evaluating: 15.2627743+3.5
 Parameter: XMAX <- "18.7627743"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.4660781"
Evaluating: 39.4660781+3.5
 Parameter: YMAX <- "42.9660781"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.3182931"
Evaluating: -23.3182931+3.5
 Parameter: ZMAX <- "-19.8182931"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.2627743"
Evaluating: 15.2627743-3.5
 Parameter: XMIN <- "11.7627743"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.4660781"
Evaluating: 39.4660781-3.5
 Parameter: YMIN <- "35.9660781"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.3182931"
Evaluating: -23.3182931-3.5
 Parameter: ZMIN <- "-26.8182931"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.7627743"
 Parameter: XMIN -> "11.7627743"
 Parameter: YMAX -> "42.9660781"
 Parameter: YMIN -> "35.9660781"
 Parameter: ZMAX -> "-19.8182931"
 Parameter: ZMIN -> "-26.8182931"
 SELRPN>      4 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      2 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26691 POS      POT      31       POT     -**** MEMB     POPC     178      C11           3.3108
26691 POS      POT      31       POT     -**** MEMB     POPC     178      O13           2.9347
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "31" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.782775801"
Evaluating: 82.1644692*(0.782775801-0.5)
 Parameter: XPOS <- "23.2341236"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.856752266"
Evaluating: 82.1644692*(0.856752266-0.5)
 Parameter: YPOS <- "29.3123606"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.925566728"
Evaluating: 85*(0.925566728-0.5)+0
 Parameter: ZPOS <- "36.1731719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.1731719" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.1731719" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.262774 XMAX =   15.262774 XAVE =   15.262774
    YMIN =   39.466078 YMAX =   39.466078 YAVE =   39.466078
    ZMIN =  -23.318293 ZMAX =  -23.318293 ZAVE =  -23.318293
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.2341236"
 RDCMND substituted energy or value "?XAVE" to "15.2627743"
Evaluating: 23.2341236-15.2627743
 Parameter: XTRAN <- "7.9713493"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.3123606"
 RDCMND substituted energy or value "?YAVE" to "39.4660781"
Evaluating: 29.3123606-39.4660781
 Parameter: YTRAN <- "-10.1537175"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.1731719"
 RDCMND substituted energy or value "?ZAVE" to "-23.3182931"
Evaluating: 36.1731719--23.3182931
 Parameter: ZTRAN <- "59.491465"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.9713493"
 Parameter: YTRAN -> "-10.1537175"
 Parameter: ZTRAN -> "59.491465"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     7.971349  -10.153718   59.491465
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918896632"
Evaluating: 0.918896632*360.0
 Parameter: XPHI <- "330.802788"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.177988843"
Evaluating: 0.177988843*360.0
 Parameter: YPHI <- "64.0759835"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.933540607"
Evaluating: 0.933540607*360.0
 Parameter: ZPHI <- "336.074619"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.2341236"
 Parameter: YPOS -> "29.3123606"
 Parameter: ZPOS -> "36.1731719"
 Parameter: XPHI -> "330.802788"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.872946   -0.487817
    0.000000    0.487817    0.872946

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.2341236"
 Parameter: YPOS -> "29.3123606"
 Parameter: ZPOS -> "36.1731719"
 Parameter: YPHI -> "64.0759835"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.437179    0.000000   -0.899375
    0.000000    1.000000    0.000000
    0.899375    0.000000    0.437179

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   64.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.2341236"
 Parameter: YPOS -> "29.3123606"
 Parameter: ZPOS -> "36.1731719"
 Parameter: ZPHI -> "336.074619"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.914074   -0.405547    0.000000
    0.405547    0.914074    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.234124 XMAX =   23.234124 XAVE =   23.234124
    YMIN =   29.312361 YMAX =   29.312361 YAVE =   29.312361
    ZMIN =   36.173172 ZMAX =   36.173172 ZAVE =   36.173172
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.2341236"
Evaluating: 23.2341236+3.5
 Parameter: XMAX <- "26.7341236"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.3123606"
Evaluating: 29.3123606+3.5
 Parameter: YMAX <- "32.8123606"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.1731719"
Evaluating: 36.1731719+3.5
 Parameter: ZMAX <- "39.6731719"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.2341236"
Evaluating: 23.2341236-3.5
 Parameter: XMIN <- "19.7341236"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.3123606"
Evaluating: 29.3123606-3.5
 Parameter: YMIN <- "25.8123606"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.1731719"
Evaluating: 36.1731719-3.5
 Parameter: ZMIN <- "32.6731719"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.7341236"
 Parameter: XMIN -> "19.7341236"
 Parameter: YMAX -> "32.8123606"
 Parameter: YMIN -> "25.8123606"
 Parameter: ZMAX -> "39.6731719"
 Parameter: ZMIN -> "32.6731719"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "32" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "32" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.313784992"
Evaluating: 82.1644692*(0.313784992-0.5)
 Parameter: XPOS <- "-15.3002573"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.203966442"
Evaluating: 82.1644692*(0.203966442-0.5)
 Parameter: YPOS <- "-24.3234402"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.500302324"
Evaluating: 85*(0.500302324-0.5)+0
 Parameter: ZPOS <- "2.569754E-02"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.569754E-02" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.569754E-02" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "32" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.204500576"
Evaluating: 82.1644692*(0.204500576-0.5)
 Parameter: XPOS <- "-24.2795533"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.815811626"
Evaluating: 82.1644692*(0.815811626-0.5)
 Parameter: YPOS <- "25.9484946"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.363364011"
Evaluating: 85*(0.363364011-0.5)+0
 Parameter: ZPOS <- "-11.6140591"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.6140591" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.6140591" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "32" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.464247419"
Evaluating: 82.1644692*(0.464247419-0.5)
 Parameter: XPOS <- "-2.93759184"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.863578442"
Evaluating: 82.1644692*(0.863578442-0.5)
 Parameter: YPOS <- "29.8732297"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.546399633"
Evaluating: 85*(0.546399633-0.5)+0
 Parameter: ZPOS <- "3.94396881"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.94396881" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.94396881" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "32" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.343879444"
Evaluating: 82.1644692*(0.343879444-0.5)
 Parameter: XPOS <- "-12.8275626"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.632253997"
Evaluating: 82.1644692*(0.632253997-0.5)
 Parameter: YPOS <- "10.8665795"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.28760203"
Evaluating: 85*(0.28760203-0.5)+0
 Parameter: ZPOS <- "-18.0538274"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.0538274" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.8275626"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.8275626-0
 Parameter: XTRAN <- "-12.8275626"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.8665795"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.8665795-0
 Parameter: YTRAN <- "10.8665795"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.0538274"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.0538274-0
 Parameter: ZTRAN <- "-18.0538274"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.8275626"
 Parameter: YTRAN -> "10.8665795"
 Parameter: ZTRAN -> "-18.0538274"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -12.827563   10.866580  -18.053827
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.693566354"
Evaluating: 0.693566354*360.0
 Parameter: XPHI <- "249.683887"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.257836049"
Evaluating: 0.257836049*360.0
 Parameter: YPHI <- "92.8209776"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.428930243"
Evaluating: 0.428930243*360.0
 Parameter: ZPHI <- "154.414887"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.8275626"
 Parameter: YPOS -> "10.8665795"
 Parameter: ZPOS -> "-18.0538274"
 Parameter: XPHI -> "249.683887"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.347199   -0.937791
    0.000000    0.937791   -0.347199

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  110.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.8275626"
 Parameter: YPOS -> "10.8665795"
 Parameter: ZPOS -> "-18.0538274"
 Parameter: YPHI -> "92.8209776"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.049215    0.000000   -0.998788
    0.000000    1.000000    0.000000
    0.998788    0.000000   -0.049215

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   92.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.8275626"
 Parameter: YPOS -> "10.8665795"
 Parameter: ZPOS -> "-18.0538274"
 Parameter: ZPHI -> "154.414887"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.901945    0.431851    0.000000
   -0.431851   -0.901945    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.827563 XMAX =  -12.827563 XAVE =  -12.827563
    YMIN =   10.866580 YMAX =   10.866580 YAVE =   10.866580
    ZMIN =  -18.053827 ZMAX =  -18.053827 ZAVE =  -18.053827
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.8275626"
Evaluating: -12.8275626+3.5
 Parameter: XMAX <- "-9.3275626"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.8665795"
Evaluating: 10.8665795+3.5
 Parameter: YMAX <- "14.3665795"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.0538274"
Evaluating: -18.0538274+3.5
 Parameter: ZMAX <- "-14.5538274"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.8275626"
Evaluating: -12.8275626-3.5
 Parameter: XMIN <- "-16.3275626"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.8665795"
Evaluating: 10.8665795-3.5
 Parameter: YMIN <- "7.3665795"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.0538274"
Evaluating: -18.0538274-3.5
 Parameter: ZMIN <- "-21.5538274"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.3275626"
 Parameter: XMIN -> "-16.3275626"
 Parameter: YMAX -> "14.3665795"
 Parameter: YMIN -> "7.3665795"
 Parameter: ZMAX -> "-14.5538274"
 Parameter: ZMIN -> "-21.5538274"
 SELRPN>     20 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     12 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26692 POS      POT      32       POT     -**** MEMB     POPC     111      C13           3.0546
26692 POS      POT      32       POT     -**** MEMB     POPC     111      C11           3.5391
26692 POS      POT      32       POT     -**** MEMB     POPC     111      P             2.3298
26692 POS      POT      32       POT     -**** MEMB     POPC     111      O13           3.6233
26692 POS      POT      32       POT     -**** MEMB     POPC     111      O14           1.7892
26692 POS      POT      32       POT     -**** MEMB     POPC     111      O12           2.2127
26692 POS      POT      32       POT     -**** MEMB     POPC     111      O11           3.2854
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "32" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.478385996"
Evaluating: 82.1644692*(0.478385996-0.5)
 Parameter: XPOS <- "-1.77590317"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.346553451"
Evaluating: 82.1644692*(0.346553451-0.5)
 Parameter: YPOS <- "-12.6078542"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.130372065"
Evaluating: 85*(0.130372065-0.5)+0
 Parameter: ZPOS <- "-31.4183745"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.4183745" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.827563 XMAX =  -12.827563 XAVE =  -12.827563
    YMIN =   10.866580 YMAX =   10.866580 YAVE =   10.866580
    ZMIN =  -18.053827 ZMAX =  -18.053827 ZAVE =  -18.053827
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.77590317"
 RDCMND substituted energy or value "?XAVE" to "-12.8275626"
Evaluating: -1.77590317--12.8275626
 Parameter: XTRAN <- "11.0516594"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.6078542"
 RDCMND substituted energy or value "?YAVE" to "10.8665795"
Evaluating: -12.6078542-10.8665795
 Parameter: YTRAN <- "-23.4744337"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.4183745"
 RDCMND substituted energy or value "?ZAVE" to "-18.0538274"
Evaluating: -31.4183745--18.0538274
 Parameter: ZTRAN <- "-13.3645471"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.0516594"
 Parameter: YTRAN -> "-23.4744337"
 Parameter: ZTRAN -> "-13.3645471"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    11.051659  -23.474434  -13.364547
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.200741591"
Evaluating: 0.200741591*360.0
 Parameter: XPHI <- "72.2669728"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.113543365E-02"
Evaluating: 3.113543365E-02*360.0
 Parameter: YPHI <- "11.2087561"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832645589"
Evaluating: 0.832645589*360.0
 Parameter: ZPHI <- "299.752412"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.77590317"
 Parameter: YPOS -> "-12.6078542"
 Parameter: ZPOS -> "-31.4183745"
 Parameter: XPHI -> "72.2669728"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.304582    0.952486
    0.000000   -0.952486    0.304582

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.77590317"
 Parameter: YPOS -> "-12.6078542"
 Parameter: ZPOS -> "-31.4183745"
 Parameter: YPHI -> "11.2087561"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.980925    0.000000   -0.194384
    0.000000    1.000000    0.000000
    0.194384    0.000000    0.980925

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.77590317"
 Parameter: YPOS -> "-12.6078542"
 Parameter: ZPOS -> "-31.4183745"
 Parameter: ZPHI -> "299.752412"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.496253   -0.868178    0.000000
    0.868178    0.496253    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.775903 XMAX =   -1.775903 XAVE =   -1.775903
    YMIN =  -12.607854 YMAX =  -12.607854 YAVE =  -12.607854
    ZMIN =  -31.418375 ZMAX =  -31.418375 ZAVE =  -31.418375
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.77590318"
Evaluating: -1.77590318+3.5
 Parameter: XMAX <- "1.72409682"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.6078542"
Evaluating: -12.6078542+3.5
 Parameter: YMAX <- "-9.1078542"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.4183745"
Evaluating: -31.4183745+3.5
 Parameter: ZMAX <- "-27.9183745"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.77590318"
Evaluating: -1.77590318-3.5
 Parameter: XMIN <- "-5.27590318"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.6078542"
Evaluating: -12.6078542-3.5
 Parameter: YMIN <- "-16.1078542"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.4183745"
Evaluating: -31.4183745-3.5
 Parameter: ZMIN <- "-34.9183745"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.72409682"
 Parameter: XMIN -> "-5.27590318"
 Parameter: YMAX -> "-9.1078542"
 Parameter: YMIN -> "-16.1078542"
 Parameter: ZMAX -> "-27.9183745"
 Parameter: ZMIN -> "-34.9183745"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "33" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "33" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.357852064"
Evaluating: 82.1644692*(0.357852064-0.5)
 Parameter: XPOS <- "-11.6795097"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.170919411"
Evaluating: 82.1644692*(0.170919411-0.5)
 Parameter: YPOS <- "-27.0387319"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.73962361"
Evaluating: 85*(0.73962361-0.5)+0
 Parameter: ZPOS <- "20.3680069"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.3680069" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.3680069" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.6795097"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.6795097-0
 Parameter: XTRAN <- "-11.6795097"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.0387319"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.0387319-0
 Parameter: YTRAN <- "-27.0387319"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.3680069"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.3680069-0
 Parameter: ZTRAN <- "20.3680069"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.6795097"
 Parameter: YTRAN -> "-27.0387319"
 Parameter: ZTRAN -> "20.3680069"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -11.679510  -27.038732   20.368007
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.220259458"
Evaluating: 0.220259458*360.0
 Parameter: XPHI <- "79.2934049"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.401368063"
Evaluating: 0.401368063*360.0
 Parameter: YPHI <- "144.492503"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486264166"
Evaluating: 0.486264166*360.0
 Parameter: ZPHI <- "175.0551"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.6795097"
 Parameter: YPOS -> "-27.0387319"
 Parameter: ZPOS -> "20.3680069"
 Parameter: XPHI -> "79.2934049"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.185780    0.982591
    0.000000   -0.982591    0.185780

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   79.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.6795097"
 Parameter: YPOS -> "-27.0387319"
 Parameter: ZPOS -> "20.3680069"
 Parameter: YPHI -> "144.492503"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.814040    0.000000   -0.580809
    0.000000    1.000000    0.000000
    0.580809    0.000000   -0.814040

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.6795097"
 Parameter: YPOS -> "-27.0387319"
 Parameter: ZPOS -> "20.3680069"
 Parameter: ZPHI -> "175.0551"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.996278    0.086198    0.000000
   -0.086198   -0.996278    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.679510 XMAX =  -11.679510 XAVE =  -11.679510
    YMIN =  -27.038732 YMAX =  -27.038732 YAVE =  -27.038732
    ZMIN =   20.368007 ZMAX =   20.368007 ZAVE =   20.368007
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.6795097"
Evaluating: -11.6795097+3.5
 Parameter: XMAX <- "-8.1795097"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.0387319"
Evaluating: -27.0387319+3.5
 Parameter: YMAX <- "-23.5387319"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.3680069"
Evaluating: 20.3680069+3.5
 Parameter: ZMAX <- "23.8680069"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.6795097"
Evaluating: -11.6795097-3.5
 Parameter: XMIN <- "-15.1795097"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.0387319"
Evaluating: -27.0387319-3.5
 Parameter: YMIN <- "-30.5387319"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.3680069"
Evaluating: 20.3680069-3.5
 Parameter: ZMIN <- "16.8680069"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.1795097"
 Parameter: XMIN -> "-15.1795097"
 Parameter: YMAX -> "-23.5387319"
 Parameter: YMIN -> "-30.5387319"
 Parameter: ZMAX -> "23.8680069"
 Parameter: ZMIN -> "16.8680069"
 SELRPN>      8 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      2 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26693 POS      POT      33       POT     -5059 MEMB     POPC     39       C14           2.9221
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "33" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.924944541"
Evaluating: 82.1644692*(0.924944541-0.5)
 Parameter: XPOS <- "34.9153427"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.906801456"
Evaluating: 82.1644692*(0.906801456-0.5)
 Parameter: YPOS <- "33.4246257"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.779971343"
Evaluating: 85*(0.779971343-0.5)+0
 Parameter: ZPOS <- "23.7975642"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.7975642" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.7975642" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.679510 XMAX =  -11.679510 XAVE =  -11.679510
    YMIN =  -27.038732 YMAX =  -27.038732 YAVE =  -27.038732
    ZMIN =   20.368007 ZMAX =   20.368007 ZAVE =   20.368007
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.9153427"
 RDCMND substituted energy or value "?XAVE" to "-11.6795097"
Evaluating: 34.9153427--11.6795097
 Parameter: XTRAN <- "46.5948524"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.4246257"
 RDCMND substituted energy or value "?YAVE" to "-27.0387319"
Evaluating: 33.4246257--27.0387319
 Parameter: YTRAN <- "60.4633576"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.7975642"
 RDCMND substituted energy or value "?ZAVE" to "20.3680069"
Evaluating: 23.7975642-20.3680069
 Parameter: ZTRAN <- "3.4295573"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.5948524"
 Parameter: YTRAN -> "60.4633576"
 Parameter: ZTRAN -> "3.4295573"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    46.594852   60.463358    3.429557
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835862492"
Evaluating: 0.835862492*360.0
 Parameter: XPHI <- "300.910497"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549286386"
Evaluating: 0.549286386*360.0
 Parameter: YPHI <- "197.743099"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.363286958"
Evaluating: 0.363286958*360.0
 Parameter: ZPHI <- "130.783305"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.9153427"
 Parameter: YPOS -> "33.4246257"
 Parameter: ZPOS -> "23.7975642"
 Parameter: XPHI -> "300.910497"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.513698   -0.857971
    0.000000    0.857971    0.513698

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   59.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.9153427"
 Parameter: YPOS -> "33.4246257"
 Parameter: ZPOS -> "23.7975642"
 Parameter: YPHI -> "197.743099"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.952433    0.000000    0.304750
    0.000000    1.000000    0.000000
   -0.304750    0.000000   -0.952433

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  162.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.9153427"
 Parameter: YPOS -> "33.4246257"
 Parameter: ZPOS -> "23.7975642"
 Parameter: ZPHI -> "130.783305"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.653200    0.757185    0.000000
   -0.757185   -0.653200    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  130.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.915343 XMAX =   34.915343 XAVE =   34.915343
    YMIN =   33.424626 YMAX =   33.424626 YAVE =   33.424626
    ZMIN =   23.797564 ZMAX =   23.797564 ZAVE =   23.797564
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.9153427"
Evaluating: 34.9153427+3.5
 Parameter: XMAX <- "38.4153427"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.4246257"
Evaluating: 33.4246257+3.5
 Parameter: YMAX <- "36.9246257"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.7975642"
Evaluating: 23.7975642+3.5
 Parameter: ZMAX <- "27.2975642"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.9153427"
Evaluating: 34.9153427-3.5
 Parameter: XMIN <- "31.4153427"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.4246257"
Evaluating: 33.4246257-3.5
 Parameter: YMIN <- "29.9246257"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.7975642"
Evaluating: 23.7975642-3.5
 Parameter: ZMIN <- "20.2975642"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.4153427"
 Parameter: XMIN -> "31.4153427"
 Parameter: YMAX -> "36.9246257"
 Parameter: YMIN -> "29.9246257"
 Parameter: ZMAX -> "27.2975642"
 Parameter: ZMIN -> "20.2975642"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "34" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "34" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.227449363"
Evaluating: 82.1644692*(0.227449363-0.5)
 Parameter: XPOS <- "-22.3939784"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "7.440513923E-02"
Evaluating: 82.1644692*(7.440513923E-02-0.5)
 Parameter: YPOS <- "-34.9687758"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.260851772"
Evaluating: 85*(0.260851772-0.5)+0
 Parameter: ZPOS <- "-20.3275994"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.3275994" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.3939784"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.3939784-0
 Parameter: XTRAN <- "-22.3939784"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.9687758"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.9687758-0
 Parameter: YTRAN <- "-34.9687758"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.3275994"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.3275994-0
 Parameter: ZTRAN <- "-20.3275994"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.3939784"
 Parameter: YTRAN -> "-34.9687758"
 Parameter: ZTRAN -> "-20.3275994"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -22.393978  -34.968776  -20.327599
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.17710434E-02"
Evaluating: 5.17710434E-02*360.0
 Parameter: XPHI <- "18.6375756"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65528549"
Evaluating: 0.65528549*360.0
 Parameter: YPHI <- "235.902776"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107565366"
Evaluating: 0.107565366*360.0
 Parameter: ZPHI <- "38.7235318"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.3939784"
 Parameter: YPOS -> "-34.9687758"
 Parameter: ZPOS -> "-20.3275994"
 Parameter: XPHI -> "18.6375756"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.947559    0.319581
    0.000000   -0.319581    0.947559

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   18.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.3939784"
 Parameter: YPOS -> "-34.9687758"
 Parameter: ZPOS -> "-20.3275994"
 Parameter: YPHI -> "235.902776"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.560599    0.000000    0.828087
    0.000000    1.000000    0.000000
   -0.828087    0.000000   -0.560599

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  124.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.3939784"
 Parameter: YPOS -> "-34.9687758"
 Parameter: ZPOS -> "-20.3275994"
 Parameter: ZPHI -> "38.7235318"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.780174    0.625563    0.000000
   -0.625563    0.780174    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   38.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.393978 XMAX =  -22.393978 XAVE =  -22.393978
    YMIN =  -34.968776 YMAX =  -34.968776 YAVE =  -34.968776
    ZMIN =  -20.327599 ZMAX =  -20.327599 ZAVE =  -20.327599
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.3939784"
Evaluating: -22.3939784+3.5
 Parameter: XMAX <- "-18.8939784"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.9687758"
Evaluating: -34.9687758+3.5
 Parameter: YMAX <- "-31.4687758"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.3275994"
Evaluating: -20.3275994+3.5
 Parameter: ZMAX <- "-16.8275994"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.3939784"
Evaluating: -22.3939784-3.5
 Parameter: XMIN <- "-25.8939784"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.9687758"
Evaluating: -34.9687758-3.5
 Parameter: YMIN <- "-38.4687758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.3275994"
Evaluating: -20.3275994-3.5
 Parameter: ZMIN <- "-23.8275994"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.8939784"
 Parameter: XMIN -> "-25.8939784"
 Parameter: YMAX -> "-31.4687758"
 Parameter: YMIN -> "-38.4687758"
 Parameter: ZMAX -> "-16.8275994"
 Parameter: ZMIN -> "-23.8275994"
 SELRPN>     23 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      9 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26694 POS      POT      34       POT     -**** MEMB     POPC     171      C11           3.6484
26694 POS      POT      34       POT     -**** MEMB     POPC     171      O11           3.2673
26694 POS      POT      34       POT     -**** MEMB     POPC     171      C1            3.5178
26694 POS      POT      34       POT     -**** MEMB     POPC     188      C13           3.2420
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "34" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.33290967"
Evaluating: 82.1644692*(0.33290967-0.5)
 Parameter: XPOS <- "-13.7288883"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.456153666"
Evaluating: 82.1644692*(0.456153666-0.5)
 Parameter: YPOS <- "-3.60261076"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.534300394"
Evaluating: 85*(0.534300394-0.5)+0
 Parameter: ZPOS <- "2.91553349"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.91553349" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.91553349" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "34" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "6.581261943E-02"
Evaluating: 82.1644692*(6.581261943E-02-0.5)
 Parameter: XPOS <- "-35.6747757"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.792798107"
Evaluating: 82.1644692*(0.792798107-0.5)
 Parameter: YPOS <- "24.057601"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.131668953"
Evaluating: 85*(0.131668953-0.5)+0
 Parameter: ZPOS <- "-31.308139"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.308139" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.393978 XMAX =  -22.393978 XAVE =  -22.393978
    YMIN =  -34.968776 YMAX =  -34.968776 YAVE =  -34.968776
    ZMIN =  -20.327599 ZMAX =  -20.327599 ZAVE =  -20.327599
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.6747757"
 RDCMND substituted energy or value "?XAVE" to "-22.3939784"
Evaluating: -35.6747757--22.3939784
 Parameter: XTRAN <- "-13.2807973"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.057601"
 RDCMND substituted energy or value "?YAVE" to "-34.9687758"
Evaluating: 24.057601--34.9687758
 Parameter: YTRAN <- "59.0263768"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.308139"
 RDCMND substituted energy or value "?ZAVE" to "-20.3275994"
Evaluating: -31.308139--20.3275994
 Parameter: ZTRAN <- "-10.9805396"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.2807973"
 Parameter: YTRAN -> "59.0263768"
 Parameter: ZTRAN -> "-10.9805396"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -13.280797   59.026377  -10.980540
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.745535572"
Evaluating: 0.745535572*360.0
 Parameter: XPHI <- "268.392806"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.290558336E-02"
Evaluating: 5.290558336E-02*360.0
 Parameter: YPHI <- "19.04601"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.498006281E-02"
Evaluating: 4.498006281E-02*360.0
 Parameter: ZPHI <- "16.1928226"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.6747757"
 Parameter: YPOS -> "24.057601"
 Parameter: ZPOS -> "-31.308139"
 Parameter: XPHI -> "268.392806"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.028047   -0.999607
    0.000000    0.999607   -0.028047

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   91.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.6747757"
 Parameter: YPOS -> "24.057601"
 Parameter: ZPOS -> "-31.308139"
 Parameter: YPHI -> "19.04601"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.945257    0.000000   -0.326327
    0.000000    1.000000    0.000000
    0.326327    0.000000    0.945257

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   19.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.6747757"
 Parameter: YPOS -> "24.057601"
 Parameter: ZPOS -> "-31.308139"
 Parameter: ZPHI -> "16.1928226"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.960329    0.278871    0.000000
   -0.278871    0.960329    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   16.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.674776 XMAX =  -35.674776 XAVE =  -35.674776
    YMIN =   24.057601 YMAX =   24.057601 YAVE =   24.057601
    ZMIN =  -31.308139 ZMAX =  -31.308139 ZAVE =  -31.308139
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.6747757"
Evaluating: -35.6747757+3.5
 Parameter: XMAX <- "-32.1747757"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.057601"
Evaluating: 24.057601+3.5
 Parameter: YMAX <- "27.557601"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.308139"
Evaluating: -31.308139+3.5
 Parameter: ZMAX <- "-27.808139"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.6747757"
Evaluating: -35.6747757-3.5
 Parameter: XMIN <- "-39.1747757"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.057601"
Evaluating: 24.057601-3.5
 Parameter: YMIN <- "20.557601"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.308139"
Evaluating: -31.308139-3.5
 Parameter: ZMIN <- "-34.808139"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.1747757"
 Parameter: XMIN -> "-39.1747757"
 Parameter: YMAX -> "27.557601"
 Parameter: YMIN -> "20.557601"
 Parameter: ZMAX -> "-27.808139"
 Parameter: ZMIN -> "-34.808139"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "35" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "35" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.152780413"
Evaluating: 82.1644692*(0.152780413-0.5)
 Parameter: XPOS <- "-28.5291131"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "1.297637925E-02"
Evaluating: 82.1644692*(1.297637925E-02-0.5)
 Parameter: YPOS <- "-40.0160373"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.865192886"
Evaluating: 85*(0.865192886-0.5)+0
 Parameter: ZPOS <- "31.0413953"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.0413953" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.0413953" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.5291131"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.5291131-0
 Parameter: XTRAN <- "-28.5291131"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.0160373"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.0160373-0
 Parameter: YTRAN <- "-40.0160373"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.0413953"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.0413953-0
 Parameter: ZTRAN <- "31.0413953"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.5291131"
 Parameter: YTRAN -> "-40.0160373"
 Parameter: ZTRAN -> "31.0413953"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -28.529113  -40.016037   31.041395
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835463705"
Evaluating: 0.835463705*360.0
 Parameter: XPHI <- "300.766934"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.127118317"
Evaluating: 0.127118317*360.0
 Parameter: YPHI <- "45.7625941"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454006449"
Evaluating: 0.454006449*360.0
 Parameter: ZPHI <- "163.442322"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.5291131"
 Parameter: YPOS -> "-40.0160373"
 Parameter: ZPOS -> "31.0413953"
 Parameter: XPHI -> "300.766934"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.511547   -0.859255
    0.000000    0.859255    0.511547

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   59.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.5291131"
 Parameter: YPOS -> "-40.0160373"
 Parameter: ZPOS -> "31.0413953"
 Parameter: YPHI -> "45.7625941"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.697633    0.000000   -0.716455
    0.000000    1.000000    0.000000
    0.716455    0.000000    0.697633

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.5291131"
 Parameter: YPOS -> "-40.0160373"
 Parameter: ZPOS -> "31.0413953"
 Parameter: ZPHI -> "163.442322"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.958533    0.284980    0.000000
   -0.284980   -0.958533    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.529113 XMAX =  -28.529113 XAVE =  -28.529113
    YMIN =  -40.016037 YMAX =  -40.016037 YAVE =  -40.016037
    ZMIN =   31.041395 ZMAX =   31.041395 ZAVE =   31.041395
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.5291131"
Evaluating: -28.5291131+3.5
 Parameter: XMAX <- "-25.0291131"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.0160373"
Evaluating: -40.0160373+3.5
 Parameter: YMAX <- "-36.5160373"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.0413953"
Evaluating: 31.0413953+3.5
 Parameter: ZMAX <- "34.5413953"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.5291131"
Evaluating: -28.5291131-3.5
 Parameter: XMIN <- "-32.0291131"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.0160373"
Evaluating: -40.0160373-3.5
 Parameter: YMIN <- "-43.5160373"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.0413953"
Evaluating: 31.0413953-3.5
 Parameter: ZMIN <- "27.5413953"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.0291131"
 Parameter: XMIN -> "-32.0291131"
 Parameter: YMAX -> "-36.5160373"
 Parameter: YMIN -> "-43.5160373"
 Parameter: ZMAX -> "34.5413953"
 Parameter: ZMIN -> "27.5413953"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "36" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "36" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "5.06566839E-02"
Evaluating: 82.1644692*(5.06566839E-02-0.5)
 Parameter: XPOS <- "-36.9200551"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.340881572"
Evaluating: 82.1644692*(0.340881572-0.5)
 Parameter: YPOS <- "-13.0738812"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "5.617981884E-02"
Evaluating: 85*(5.617981884E-02-0.5)+0
 Parameter: ZPOS <- "-37.7247154"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.7247154" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.9200551"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.9200551-0
 Parameter: XTRAN <- "-36.9200551"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.0738812"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.0738812-0
 Parameter: YTRAN <- "-13.0738812"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.7247154"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.7247154-0
 Parameter: ZTRAN <- "-37.7247154"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.9200551"
 Parameter: YTRAN -> "-13.0738812"
 Parameter: ZTRAN -> "-37.7247154"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -36.920055  -13.073881  -37.724715
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.197161258"
Evaluating: 0.197161258*360.0
 Parameter: XPHI <- "70.9780529"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.891060424"
Evaluating: 0.891060424*360.0
 Parameter: YPHI <- "320.781753"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.269806996"
Evaluating: 0.269806996*360.0
 Parameter: ZPHI <- "97.1305186"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.9200551"
 Parameter: YPOS -> "-13.0738812"
 Parameter: ZPOS -> "-37.7247154"
 Parameter: XPHI -> "70.9780529"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.325930    0.945394
    0.000000   -0.945394    0.325930

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   70.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.9200551"
 Parameter: YPOS -> "-13.0738812"
 Parameter: ZPOS -> "-37.7247154"
 Parameter: YPHI -> "320.781753"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.774743    0.000000    0.632276
    0.000000    1.000000    0.000000
   -0.632276    0.000000    0.774743

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.9200551"
 Parameter: YPOS -> "-13.0738812"
 Parameter: ZPOS -> "-37.7247154"
 Parameter: ZPHI -> "97.1305186"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.124130    0.992266    0.000000
   -0.992266   -0.124130    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   97.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.920055 XMAX =  -36.920055 XAVE =  -36.920055
    YMIN =  -13.073881 YMAX =  -13.073881 YAVE =  -13.073881
    ZMIN =  -37.724715 ZMAX =  -37.724715 ZAVE =  -37.724715
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.9200551"
Evaluating: -36.9200551+3.5
 Parameter: XMAX <- "-33.4200551"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.0738812"
Evaluating: -13.0738812+3.5
 Parameter: YMAX <- "-9.5738812"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.7247154"
Evaluating: -37.7247154+3.5
 Parameter: ZMAX <- "-34.2247154"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.9200551"
Evaluating: -36.9200551-3.5
 Parameter: XMIN <- "-40.4200551"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.0738812"
Evaluating: -13.0738812-3.5
 Parameter: YMIN <- "-16.5738812"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.7247154"
Evaluating: -37.7247154-3.5
 Parameter: ZMIN <- "-41.2247154"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.4200551"
 Parameter: XMIN -> "-40.4200551"
 Parameter: YMAX -> "-9.5738812"
 Parameter: YMIN -> "-16.5738812"
 Parameter: ZMAX -> "-34.2247154"
 Parameter: ZMIN -> "-41.2247154"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "37" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "37" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "9.386050912E-02"
Evaluating: 82.1644692*(9.386050912E-02-0.5)
 Parameter: XPOS <- "-33.3702357"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.70812712"
Evaluating: 82.1644692*(0.70812712-0.5)
 Parameter: YPOS <- "17.1006543"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.486368559"
Evaluating: 85*(0.486368559-0.5)+0
 Parameter: ZPOS <- "-1.15867248"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.15867248" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.15867248" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "37" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "5.698024875E-02"
Evaluating: 82.1644692*(5.698024875E-02-0.5)
 Parameter: XPOS <- "-36.4004827"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "3.645464217E-02"
Evaluating: 82.1644692*(3.645464217E-02-0.5)
 Parameter: YPOS <- "-38.0869583"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.905001545"
Evaluating: 85*(0.905001545-0.5)+0
 Parameter: ZPOS <- "34.4251313"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.4251313" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.4251313" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.4004827"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.4004827-0
 Parameter: XTRAN <- "-36.4004827"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.0869583"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.0869583-0
 Parameter: YTRAN <- "-38.0869583"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.4251313"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.4251313-0
 Parameter: ZTRAN <- "34.4251313"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.4004827"
 Parameter: YTRAN -> "-38.0869583"
 Parameter: ZTRAN -> "34.4251313"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -36.400483  -38.086958   34.425131
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.48335927"
Evaluating: 0.48335927*360.0
 Parameter: XPHI <- "174.009337"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.601837622E-02"
Evaluating: 9.601837622E-02*360.0
 Parameter: YPHI <- "34.5666154"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.16458029"
Evaluating: 0.16458029*360.0
 Parameter: ZPHI <- "59.2489044"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.4004827"
 Parameter: YPOS -> "-38.0869583"
 Parameter: ZPOS -> "34.4251313"
 Parameter: XPHI -> "174.009337"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.994539    0.104366
    0.000000   -0.104366   -0.994539

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  174.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.4004827"
 Parameter: YPOS -> "-38.0869583"
 Parameter: ZPOS -> "34.4251313"
 Parameter: YPHI -> "34.5666154"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.823467    0.000000   -0.567364
    0.000000    1.000000    0.000000
    0.567364    0.000000    0.823467

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   34.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.4004827"
 Parameter: YPOS -> "-38.0869583"
 Parameter: ZPOS -> "34.4251313"
 Parameter: ZPHI -> "59.2489044"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.511310    0.859397    0.000000
   -0.859397    0.511310    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   59.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.400483 XMAX =  -36.400483 XAVE =  -36.400483
    YMIN =  -38.086958 YMAX =  -38.086958 YAVE =  -38.086958
    ZMIN =   34.425131 ZMAX =   34.425131 ZAVE =   34.425131
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.4004827"
Evaluating: -36.4004827+3.5
 Parameter: XMAX <- "-32.9004827"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.0869583"
Evaluating: -38.0869583+3.5
 Parameter: YMAX <- "-34.5869583"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.4251313"
Evaluating: 34.4251313+3.5
 Parameter: ZMAX <- "37.9251313"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.4004827"
Evaluating: -36.4004827-3.5
 Parameter: XMIN <- "-39.9004827"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.0869583"
Evaluating: -38.0869583-3.5
 Parameter: YMIN <- "-41.5869583"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.4251313"
Evaluating: 34.4251313-3.5
 Parameter: ZMIN <- "30.9251313"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.9004827"
 Parameter: XMIN -> "-39.9004827"
 Parameter: YMAX -> "-34.5869583"
 Parameter: YMIN -> "-41.5869583"
 Parameter: ZMAX -> "37.9251313"
 Parameter: ZMIN -> "30.9251313"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "38" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "38" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.371058893"
Evaluating: 82.1644692*(0.371058893-0.5)
 Parameter: XPOS <- "-10.5943776"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.182417137"
Evaluating: 82.1644692*(0.182417137-0.5)
 Parameter: YPOS <- "-26.0940274"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.505185975"
Evaluating: 85*(0.505185975-0.5)+0
 Parameter: ZPOS <- "0.440807875"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.440807875" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.440807875" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "38" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.17766969"
Evaluating: 82.1644692*(0.17766969-0.5)
 Parameter: XPOS <- "-26.4840988"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.87948165"
Evaluating: 82.1644692*(0.87948165-0.5)
 Parameter: YPOS <- "31.1799083"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.432598414"
Evaluating: 85*(0.432598414-0.5)+0
 Parameter: ZPOS <- "-5.72913481"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.72913481" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.72913481" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "38" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.181366551"
Evaluating: 82.1644692*(0.181366551-0.5)
 Parameter: XPOS <- "-26.1803482"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.669017065"
Evaluating: 82.1644692*(0.669017065-0.5)
 Parameter: YPOS <- "13.8871974"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.548493402E-02"
Evaluating: 85*(1.548493402E-02-0.5)+0
 Parameter: ZPOS <- "-41.1837806"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.1837806" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.1803482"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.1803482-0
 Parameter: XTRAN <- "-26.1803482"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.8871974"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.8871974-0
 Parameter: YTRAN <- "13.8871974"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.1837806"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.1837806-0
 Parameter: ZTRAN <- "-41.1837806"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.1803482"
 Parameter: YTRAN -> "13.8871974"
 Parameter: ZTRAN -> "-41.1837806"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -26.180348   13.887197  -41.183781
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.948681465"
Evaluating: 0.948681465*360.0
 Parameter: XPHI <- "341.525327"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.985786086"
Evaluating: 0.985786086*360.0
 Parameter: YPHI <- "354.882991"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867283163"
Evaluating: 0.867283163*360.0
 Parameter: ZPHI <- "312.221939"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.1803482"
 Parameter: YPOS -> "13.8871974"
 Parameter: ZPOS -> "-41.1837806"
 Parameter: XPHI -> "341.525327"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.948464   -0.316885
    0.000000    0.316885    0.948464

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.1803482"
 Parameter: YPOS -> "13.8871974"
 Parameter: ZPOS -> "-41.1837806"
 Parameter: YPHI -> "354.882991"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.996015    0.000000    0.089190
    0.000000    1.000000    0.000000
   -0.089190    0.000000    0.996015

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    5.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.1803482"
 Parameter: YPOS -> "13.8871974"
 Parameter: ZPOS -> "-41.1837806"
 Parameter: ZPHI -> "312.221939"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.672004   -0.740547    0.000000
    0.740547    0.672004    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.180348 XMAX =  -26.180348 XAVE =  -26.180348
    YMIN =   13.887197 YMAX =   13.887197 YAVE =   13.887197
    ZMIN =  -41.183781 ZMAX =  -41.183781 ZAVE =  -41.183781
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.1803482"
Evaluating: -26.1803482+3.5
 Parameter: XMAX <- "-22.6803482"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.8871974"
Evaluating: 13.8871974+3.5
 Parameter: YMAX <- "17.3871974"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.1837806"
Evaluating: -41.1837806+3.5
 Parameter: ZMAX <- "-37.6837806"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.1803482"
Evaluating: -26.1803482-3.5
 Parameter: XMIN <- "-29.6803482"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.8871974"
Evaluating: 13.8871974-3.5
 Parameter: YMIN <- "10.3871974"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.1837806"
Evaluating: -41.1837806-3.5
 Parameter: ZMIN <- "-44.6837806"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.6803482"
 Parameter: XMIN -> "-29.6803482"
 Parameter: YMAX -> "17.3871974"
 Parameter: YMIN -> "10.3871974"
 Parameter: ZMAX -> "-37.6837806"
 Parameter: ZMIN -> "-44.6837806"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "39" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "39" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.686416211"
Evaluating: 82.1644692*(0.686416211-0.5)
 Parameter: XPOS <- "15.316789"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.228861209"
Evaluating: 82.1644692*(0.228861209-0.5)
 Parameter: YPOS <- "-22.2779748"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.306460704"
Evaluating: 85*(0.306460704-0.5)+0
 Parameter: ZPOS <- "-16.4508402"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.4508402" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.316789"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.316789-0
 Parameter: XTRAN <- "15.316789"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.2779748"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.2779748-0
 Parameter: YTRAN <- "-22.2779748"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.4508402"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.4508402-0
 Parameter: ZTRAN <- "-16.4508402"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.316789"
 Parameter: YTRAN -> "-22.2779748"
 Parameter: ZTRAN -> "-16.4508402"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    15.316789  -22.277975  -16.450840
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.260912104E-03"
Evaluating: 4.260912104E-03*360.0
 Parameter: XPHI <- "1.53392836"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.636465002"
Evaluating: 0.636465002*360.0
 Parameter: YPHI <- "229.127401"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.94203896"
Evaluating: 0.94203896*360.0
 Parameter: ZPHI <- "339.134026"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.316789"
 Parameter: YPOS -> "-22.2779748"
 Parameter: ZPOS -> "-16.4508402"
 Parameter: XPHI -> "1.53392836"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999642    0.026769
    0.000000   -0.026769    0.999642

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    1.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.316789"
 Parameter: YPOS -> "-22.2779748"
 Parameter: ZPOS -> "-16.4508402"
 Parameter: YPHI -> "229.127401"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.654379    0.000000    0.756167
    0.000000    1.000000    0.000000
   -0.756167    0.000000   -0.654379

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  130.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.316789"
 Parameter: YPOS -> "-22.2779748"
 Parameter: ZPOS -> "-16.4508402"
 Parameter: ZPHI -> "339.134026"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.934416   -0.356183    0.000000
    0.356183    0.934416    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.316789 XMAX =   15.316789 XAVE =   15.316789
    YMIN =  -22.277975 YMAX =  -22.277975 YAVE =  -22.277975
    ZMIN =  -16.450840 ZMAX =  -16.450840 ZAVE =  -16.450840
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.316789"
Evaluating: 15.316789+3.5
 Parameter: XMAX <- "18.816789"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.2779748"
Evaluating: -22.2779748+3.5
 Parameter: YMAX <- "-18.7779748"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.4508402"
Evaluating: -16.4508402+3.5
 Parameter: ZMAX <- "-12.9508402"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.316789"
Evaluating: 15.316789-3.5
 Parameter: XMIN <- "11.816789"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.2779748"
Evaluating: -22.2779748-3.5
 Parameter: YMIN <- "-25.7779748"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.4508402"
Evaluating: -16.4508402-3.5
 Parameter: ZMIN <- "-19.9508402"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.816789"
 Parameter: XMIN -> "11.816789"
 Parameter: YMAX -> "-18.7779748"
 Parameter: YMIN -> "-25.7779748"
 Parameter: ZMAX -> "-12.9508402"
 Parameter: ZMIN -> "-19.9508402"
 SELRPN>     35 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     17 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26699 POS      POT      39       POT     -**** MEMB     POPC     124      O14           3.4687
26699 POS      POT      39       POT     -**** MEMB     POPC     135      N             2.7673
26699 POS      POT      39       POT     -**** MEMB     POPC     135      C12           3.1175
26699 POS      POT      39       POT     -**** MEMB     POPC     135      C14           2.1011
26699 POS      POT      39       POT     -**** MEMB     POPC     135      C15           2.8895
26699 POS      POT      39       POT     -**** MEMB     POPC     135      C22           3.4563
26699 POS      POT      39       POT     -**** MEMB     POPC     135      C24           3.4210
26699 POS      POT      39       POT     -**** MEMB     POPC     148      C2            3.6545
26699 POS      POT      39       POT     -**** MEMB     POPC     148      O21           3.1260
26699 POS      POT      39       POT     -**** MEMB     POPC     148      C21           3.2655
26699 POS      POT      39       POT     -**** MEMB     POPC     148      O22           3.7500
26699 POS      POT      39       POT     -**** MEMB     POPC     148      C22           3.6392
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "39" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.665166586"
Evaluating: 82.1644692*(0.665166586-0.5)
 Parameter: XPOS <- "13.5708249"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "3.475464849E-02"
Evaluating: 82.1644692*(3.475464849E-02-0.5)
 Parameter: YPOS <- "-38.2266374"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.65387818"
Evaluating: 85*(0.65387818-0.5)+0
 Parameter: ZPOS <- "13.0796453"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.0796453" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.0796453" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "39" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.527662538"
Evaluating: 82.1644692*(0.527662538-0.5)
 Parameter: XPOS <- "2.27287775"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.813300286"
Evaluating: 82.1644692*(0.813300286-0.5)
 Parameter: YPOS <- "25.7421517"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.550625042"
Evaluating: 85*(0.550625042-0.5)+0
 Parameter: ZPOS <- "4.30312857"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.30312857" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.30312857" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "39" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.938925346"
Evaluating: 82.1644692*(0.938925346-0.5)
 Parameter: XPOS <- "36.0640681"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.562014605"
Evaluating: 82.1644692*(0.562014605-0.5)
 Parameter: YPOS <- "5.0953971"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.724976276"
Evaluating: 85*(0.724976276-0.5)+0
 Parameter: ZPOS <- "19.1229835"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.1229835" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.1229835" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.316789 XMAX =   15.316789 XAVE =   15.316789
    YMIN =  -22.277975 YMAX =  -22.277975 YAVE =  -22.277975
    ZMIN =  -16.450840 ZMAX =  -16.450840 ZAVE =  -16.450840
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.0640681"
 RDCMND substituted energy or value "?XAVE" to "15.316789"
Evaluating: 36.0640681-15.316789
 Parameter: XTRAN <- "20.7472791"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.0953971"
 RDCMND substituted energy or value "?YAVE" to "-22.2779748"
Evaluating: 5.0953971--22.2779748
 Parameter: YTRAN <- "27.3733719"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.1229835"
 RDCMND substituted energy or value "?ZAVE" to "-16.4508402"
Evaluating: 19.1229835--16.4508402
 Parameter: ZTRAN <- "35.5738237"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.7472791"
 Parameter: YTRAN -> "27.3733719"
 Parameter: ZTRAN -> "35.5738237"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    20.747279   27.373372   35.573824
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.455448223"
Evaluating: 0.455448223*360.0
 Parameter: XPHI <- "163.96136"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.91215506"
Evaluating: 0.91215506*360.0
 Parameter: YPHI <- "328.375822"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192528055"
Evaluating: 0.192528055*360.0
 Parameter: ZPHI <- "69.3100998"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.0640681"
 Parameter: YPOS -> "5.0953971"
 Parameter: ZPOS -> "19.1229835"
 Parameter: XPHI -> "163.96136"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.961076    0.276286
    0.000000   -0.276286   -0.961076

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.0640681"
 Parameter: YPOS -> "5.0953971"
 Parameter: ZPOS -> "19.1229835"
 Parameter: YPHI -> "328.375822"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.851506    0.000000    0.524345
    0.000000    1.000000    0.000000
   -0.524345    0.000000    0.851506

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   31.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.0640681"
 Parameter: YPOS -> "5.0953971"
 Parameter: ZPOS -> "19.1229835"
 Parameter: ZPHI -> "69.3100998"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.353310    0.935506    0.000000
   -0.935506    0.353310    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.064068 XMAX =   36.064068 XAVE =   36.064068
    YMIN =    5.095397 YMAX =    5.095397 YAVE =    5.095397
    ZMIN =   19.122984 ZMAX =   19.122984 ZAVE =   19.122984
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.0640681"
Evaluating: 36.0640681+3.5
 Parameter: XMAX <- "39.5640681"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.0953971"
Evaluating: 5.0953971+3.5
 Parameter: YMAX <- "8.5953971"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.1229835"
Evaluating: 19.1229835+3.5
 Parameter: ZMAX <- "22.6229835"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.0640681"
Evaluating: 36.0640681-3.5
 Parameter: XMIN <- "32.5640681"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.0953971"
Evaluating: 5.0953971-3.5
 Parameter: YMIN <- "1.5953971"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.1229835"
Evaluating: 19.1229835-3.5
 Parameter: ZMIN <- "15.6229835"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.5640681"
 Parameter: XMIN -> "32.5640681"
 Parameter: YMAX -> "8.5953971"
 Parameter: YMIN -> "1.5953971"
 Parameter: ZMAX -> "22.6229835"
 Parameter: ZMIN -> "15.6229835"
 SELRPN>      9 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      7 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26699 POS      POT      39       POT     -9200 MEMB     POPC     70       C11           3.9770
26699 POS      POT      39       POT     -9203 MEMB     POPC     70       P             1.4187
26699 POS      POT      39       POT     -9204 MEMB     POPC     70       O13           0.9155
26699 POS      POT      39       POT     -9205 MEMB     POPC     70       O14           2.2922
26699 POS      POT      39       POT     -9206 MEMB     POPC     70       O12           2.7964
26699 POS      POT      39       POT     -9207 MEMB     POPC     70       O11           2.1013
26699 POS      POT      39       POT     -9208 MEMB     POPC     70       C1            2.6494
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "39" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.174243301"
Evaluating: 82.1644692*(0.174243301-0.5)
 Parameter: XPOS <- "-26.7656263"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.195461263"
Evaluating: 82.1644692*(0.195461263-0.5)
 Parameter: YPOS <- "-25.0222637"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.909758867"
Evaluating: 85*(0.909758867-0.5)+0
 Parameter: ZPOS <- "34.8295037"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.8295037" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.8295037" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.064068 XMAX =   36.064068 XAVE =   36.064068
    YMIN =    5.095397 YMAX =    5.095397 YAVE =    5.095397
    ZMIN =   19.122984 ZMAX =   19.122984 ZAVE =   19.122984
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.7656263"
 RDCMND substituted energy or value "?XAVE" to "36.0640681"
Evaluating: -26.7656263-36.0640681
 Parameter: XTRAN <- "-62.8296944"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.0222637"
 RDCMND substituted energy or value "?YAVE" to "5.0953971"
Evaluating: -25.0222637-5.0953971
 Parameter: YTRAN <- "-30.1176608"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.8295037"
 RDCMND substituted energy or value "?ZAVE" to "19.1229835"
Evaluating: 34.8295037-19.1229835
 Parameter: ZTRAN <- "15.7065202"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.8296944"
 Parameter: YTRAN -> "-30.1176608"
 Parameter: ZTRAN -> "15.7065202"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -62.829694  -30.117661   15.706520
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.32638851"
Evaluating: 0.32638851*360.0
 Parameter: XPHI <- "117.499864"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.403202812"
Evaluating: 0.403202812*360.0
 Parameter: YPHI <- "145.153012"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.637169336"
Evaluating: 0.637169336*360.0
 Parameter: ZPHI <- "229.380961"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.7656263"
 Parameter: YPOS -> "-25.0222637"
 Parameter: ZPOS -> "34.8295037"
 Parameter: XPHI -> "117.499864"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.461747    0.887012
    0.000000   -0.887012   -0.461747

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  117.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.7656263"
 Parameter: YPOS -> "-25.0222637"
 Parameter: ZPOS -> "34.8295037"
 Parameter: YPHI -> "145.153012"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.820681    0.000000   -0.571387
    0.000000    1.000000    0.000000
    0.571387    0.000000   -0.820681

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  145.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.7656263"
 Parameter: YPOS -> "-25.0222637"
 Parameter: ZPOS -> "34.8295037"
 Parameter: ZPHI -> "229.380961"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.651026   -0.759055    0.000000
    0.759055   -0.651026    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  130.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.765626 XMAX =  -26.765626 XAVE =  -26.765626
    YMIN =  -25.022264 YMAX =  -25.022264 YAVE =  -25.022264
    ZMIN =   34.829504 ZMAX =   34.829504 ZAVE =   34.829504
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.7656263"
Evaluating: -26.7656263+3.5
 Parameter: XMAX <- "-23.2656263"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.0222637"
Evaluating: -25.0222637+3.5
 Parameter: YMAX <- "-21.5222637"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.8295037"
Evaluating: 34.8295037+3.5
 Parameter: ZMAX <- "38.3295037"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.7656263"
Evaluating: -26.7656263-3.5
 Parameter: XMIN <- "-30.2656263"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.0222637"
Evaluating: -25.0222637-3.5
 Parameter: YMIN <- "-28.5222637"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.8295037"
Evaluating: 34.8295037-3.5
 Parameter: ZMIN <- "31.3295037"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.2656263"
 Parameter: XMIN -> "-30.2656263"
 Parameter: YMAX -> "-21.5222637"
 Parameter: YMIN -> "-28.5222637"
 Parameter: ZMAX -> "38.3295037"
 Parameter: ZMIN -> "31.3295037"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "40" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "40" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.272873303"
Evaluating: 82.1644692*(0.272873303-0.5)
 Parameter: XPOS <- "-18.6617445"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.170203285"
Evaluating: 82.1644692*(0.170203285-0.5)
 Parameter: YPOS <- "-27.097572"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.94212109"
Evaluating: 85*(0.94212109-0.5)+0
 Parameter: ZPOS <- "37.5802926"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.5802926" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.5802926" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.6617445"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.6617445-0
 Parameter: XTRAN <- "-18.6617445"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.097572"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.097572-0
 Parameter: YTRAN <- "-27.097572"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.5802926"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.5802926-0
 Parameter: ZTRAN <- "37.5802926"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.6617445"
 Parameter: YTRAN -> "-27.097572"
 Parameter: ZTRAN -> "37.5802926"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -18.661745  -27.097572   37.580293
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.498256908"
Evaluating: 0.498256908*360.0
 Parameter: XPHI <- "179.372487"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832987171"
Evaluating: 0.832987171*360.0
 Parameter: YPHI <- "299.875382"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.445199782"
Evaluating: 0.445199782*360.0
 Parameter: ZPHI <- "160.271922"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.6617445"
 Parameter: YPOS -> "-27.097572"
 Parameter: ZPOS -> "37.5802926"
 Parameter: XPHI -> "179.372487"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999940    0.010952
    0.000000   -0.010952   -0.999940

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  179.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.6617445"
 Parameter: YPOS -> "-27.097572"
 Parameter: ZPOS -> "37.5802926"
 Parameter: YPHI -> "299.875382"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.498115    0.000000    0.867111
    0.000000    1.000000    0.000000
   -0.867111    0.000000    0.498115

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   60.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.6617445"
 Parameter: YPOS -> "-27.097572"
 Parameter: ZPOS -> "37.5802926"
 Parameter: ZPHI -> "160.271922"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.941305    0.337557    0.000000
   -0.337557   -0.941305    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  160.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.661745 XMAX =  -18.661745 XAVE =  -18.661745
    YMIN =  -27.097572 YMAX =  -27.097572 YAVE =  -27.097572
    ZMIN =   37.580293 ZMAX =   37.580293 ZAVE =   37.580293
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.6617445"
Evaluating: -18.6617445+3.5
 Parameter: XMAX <- "-15.1617445"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.097572"
Evaluating: -27.097572+3.5
 Parameter: YMAX <- "-23.597572"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.5802926"
Evaluating: 37.5802926+3.5
 Parameter: ZMAX <- "41.0802926"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.6617445"
Evaluating: -18.6617445-3.5
 Parameter: XMIN <- "-22.1617445"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.097572"
Evaluating: -27.097572-3.5
 Parameter: YMIN <- "-30.597572"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.5802926"
Evaluating: 37.5802926-3.5
 Parameter: ZMIN <- "34.0802926"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.1617445"
 Parameter: XMIN -> "-22.1617445"
 Parameter: YMAX -> "-23.597572"
 Parameter: YMIN -> "-30.597572"
 Parameter: ZMAX -> "41.0802926"
 Parameter: ZMIN -> "34.0802926"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "41" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "41" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.481814851"
Evaluating: 82.1644692*(0.481814851-0.5)
 Parameter: XPOS <- "-1.49417311"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "6.461607195E-02"
Evaluating: 82.1644692*(6.461607195E-02-0.5)
 Parameter: YPOS <- "-35.7730893"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.592705496"
Evaluating: 85*(0.592705496-0.5)+0
 Parameter: ZPOS <- "7.87996716"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.87996716" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.87996716" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "41" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.715789148"
Evaluating: 82.1644692*(0.715789148-0.5)
 Parameter: XPOS <- "17.7302008"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.732568739"
Evaluating: 82.1644692*(0.732568739-0.5)
 Parameter: YPOS <- "19.108887"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.462972993"
Evaluating: 85*(0.462972993-0.5)+0
 Parameter: ZPOS <- "-3.1472956"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.1472956" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.1472956" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "41" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.312738857"
Evaluating: 82.1644692*(0.312738857-0.5)
 Parameter: XPOS <- "-15.3862124"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.647427766"
Evaluating: 82.1644692*(0.647427766-0.5)
 Parameter: YPOS <- "12.1133241"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.438757642"
Evaluating: 85*(0.438757642-0.5)+0
 Parameter: ZPOS <- "-5.20560043"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.20560043" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.20560043" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "41" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.464022206"
Evaluating: 82.1644692*(0.464022206-0.5)
 Parameter: XPOS <- "-2.95609635"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.265039704"
Evaluating: 82.1644692*(0.265039704-0.5)
 Parameter: YPOS <- "-19.305388"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.35341868"
Evaluating: 85*(0.35341868-0.5)+0
 Parameter: ZPOS <- "-12.4594122"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.4594122" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.4594122" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "41" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.202193036"
Evaluating: 82.1644692*(0.202193036-0.5)
 Parameter: XPOS <- "-24.4691511"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.544888926"
Evaluating: 82.1644692*(0.544888926-0.5)
 Parameter: YPOS <- "3.68827478"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.195807639"
Evaluating: 85*(0.195807639-0.5)+0
 Parameter: ZPOS <- "-25.8563507"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.8563507" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.4691511"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.4691511-0
 Parameter: XTRAN <- "-24.4691511"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.68827478"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.68827478-0
 Parameter: YTRAN <- "3.68827478"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.8563507"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.8563507-0
 Parameter: ZTRAN <- "-25.8563507"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.4691511"
 Parameter: YTRAN -> "3.68827478"
 Parameter: ZTRAN -> "-25.8563507"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -24.469151    3.688275  -25.856351
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.296435495"
Evaluating: 0.296435495*360.0
 Parameter: XPHI <- "106.716778"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.106419854"
Evaluating: 0.106419854*360.0
 Parameter: YPHI <- "38.3111474"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78479419"
Evaluating: 0.78479419*360.0
 Parameter: ZPHI <- "282.525908"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.4691511"
 Parameter: YPOS -> "3.68827478"
 Parameter: ZPOS -> "-25.8563507"
 Parameter: XPHI -> "106.716778"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.287641    0.957738
    0.000000   -0.957738   -0.287641

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  106.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.4691511"
 Parameter: YPOS -> "3.68827478"
 Parameter: ZPOS -> "-25.8563507"
 Parameter: YPHI -> "38.3111474"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.784656    0.000000   -0.619932
    0.000000    1.000000    0.000000
    0.619932    0.000000    0.784656

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   38.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.4691511"
 Parameter: YPOS -> "3.68827478"
 Parameter: ZPOS -> "-25.8563507"
 Parameter: ZPHI -> "282.525908"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.216881   -0.976198    0.000000
    0.976198    0.216881    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   77.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.469151 XMAX =  -24.469151 XAVE =  -24.469151
    YMIN =    3.688275 YMAX =    3.688275 YAVE =    3.688275
    ZMIN =  -25.856351 ZMAX =  -25.856351 ZAVE =  -25.856351
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.4691511"
Evaluating: -24.4691511+3.5
 Parameter: XMAX <- "-20.9691511"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.68827478"
Evaluating: 3.68827478+3.5
 Parameter: YMAX <- "7.18827478"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.8563507"
Evaluating: -25.8563507+3.5
 Parameter: ZMAX <- "-22.3563507"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.4691511"
Evaluating: -24.4691511-3.5
 Parameter: XMIN <- "-27.9691511"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.68827478"
Evaluating: 3.68827478-3.5
 Parameter: YMIN <- "0.18827478"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.8563507"
Evaluating: -25.8563507-3.5
 Parameter: ZMIN <- "-29.3563507"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.9691511"
 Parameter: XMIN -> "-27.9691511"
 Parameter: YMAX -> "7.18827478"
 Parameter: YMIN -> "0.18827478"
 Parameter: ZMAX -> "-22.3563507"
 Parameter: ZMIN -> "-29.3563507"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "42" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "42" and "42".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.51403531"
Evaluating: 82.1644692*(0.51403531-0.5)
 Parameter: XPOS <- "1.1532038"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.248405639"
Evaluating: 82.1644692*(0.248405639-0.5)
 Parameter: YPOS <- "-20.6721171"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.940036368"
Evaluating: 85*(0.940036368-0.5)+0
 Parameter: ZPOS <- "37.4030913"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.4030913" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.4030913" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.1532038"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.1532038-0
 Parameter: XTRAN <- "1.1532038"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.6721171"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.6721171-0
 Parameter: YTRAN <- "-20.6721171"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.4030913"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.4030913-0
 Parameter: ZTRAN <- "37.4030913"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.1532038"
 Parameter: YTRAN -> "-20.6721171"
 Parameter: ZTRAN -> "37.4030913"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     1.153204  -20.672117   37.403091
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.673166707"
Evaluating: 0.673166707*360.0
 Parameter: XPHI <- "242.340015"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.765226444E-03"
Evaluating: 9.765226444E-03*360.0
 Parameter: YPHI <- "3.51548152"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.870531484"
Evaluating: 0.870531484*360.0
 Parameter: ZPHI <- "313.391334"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.1532038"
 Parameter: YPOS -> "-20.6721171"
 Parameter: ZPOS -> "37.4030913"
 Parameter: XPHI -> "242.340015"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.464224   -0.885718
    0.000000    0.885718   -0.464224

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.1532038"
 Parameter: YPOS -> "-20.6721171"
 Parameter: ZPOS -> "37.4030913"
 Parameter: YPHI -> "3.51548152"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.998118    0.000000   -0.061318
    0.000000    1.000000    0.000000
    0.061318    0.000000    0.998118

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    3.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.1532038"
 Parameter: YPOS -> "-20.6721171"
 Parameter: ZPOS -> "37.4030913"
 Parameter: ZPHI -> "313.391334"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.686978   -0.726679    0.000000
    0.726679    0.686978    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   46.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.153204 XMAX =    1.153204 XAVE =    1.153204
    YMIN =  -20.672117 YMAX =  -20.672117 YAVE =  -20.672117
    ZMIN =   37.403091 ZMAX =   37.403091 ZAVE =   37.403091
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.1532038"
Evaluating: 1.1532038+3.5
 Parameter: XMAX <- "4.6532038"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.6721171"
Evaluating: -20.6721171+3.5
 Parameter: YMAX <- "-17.1721171"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.4030913"
Evaluating: 37.4030913+3.5
 Parameter: ZMAX <- "40.9030913"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.1532038"
Evaluating: 1.1532038-3.5
 Parameter: XMIN <- "-2.3467962"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.6721171"
Evaluating: -20.6721171-3.5
 Parameter: YMIN <- "-24.1721171"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.4030913"
Evaluating: 37.4030913-3.5
 Parameter: ZMIN <- "33.9030913"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.6532038"
 Parameter: XMIN -> "-2.3467962"
 Parameter: YMAX -> "-17.1721171"
 Parameter: YMIN -> "-24.1721171"
 Parameter: ZMAX -> "40.9030913"
 Parameter: ZMIN -> "33.9030913"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "43" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "43" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "42"
Evaluating: 43-42
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.51348558"
Evaluating: 82.1644692*(0.51348558-0.5)
 Parameter: XPOS <- "1.10803552"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.357380971"
Evaluating: 82.1644692*(0.357380971-0.5)
 Parameter: YPOS <- "-11.7182168"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.904789365"
Evaluating: 85*(0.904789365-0.5)+0
 Parameter: ZPOS <- "34.407096"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.407096" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.407096" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.10803552"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.10803552-0
 Parameter: XTRAN <- "1.10803552"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.7182168"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -11.7182168-0
 Parameter: YTRAN <- "-11.7182168"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.407096"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.407096-0
 Parameter: ZTRAN <- "34.407096"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.10803552"
 Parameter: YTRAN -> "-11.7182168"
 Parameter: ZTRAN -> "34.407096"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     1.108036  -11.718217   34.407096
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.310363493"
Evaluating: 0.310363493*360.0
 Parameter: XPHI <- "111.730857"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355560278"
Evaluating: 0.355560278*360.0
 Parameter: YPHI <- "128.0017"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.364348143"
Evaluating: 0.364348143*360.0
 Parameter: ZPHI <- "131.165331"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.10803552"
 Parameter: YPOS -> "-11.7182168"
 Parameter: ZPOS -> "34.407096"
 Parameter: XPHI -> "111.730857"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.370247    0.928933
    0.000000   -0.928933   -0.370247

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  111.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.10803552"
 Parameter: YPOS -> "-11.7182168"
 Parameter: ZPOS -> "34.407096"
 Parameter: YPHI -> "128.0017"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.615685    0.000000   -0.787992
    0.000000    1.000000    0.000000
    0.787992    0.000000   -0.615685

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  128.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.10803552"
 Parameter: YPOS -> "-11.7182168"
 Parameter: ZPOS -> "34.407096"
 Parameter: ZPHI -> "131.165331"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.658234    0.752813    0.000000
   -0.752813   -0.658234    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  131.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.108036 XMAX =    1.108036 XAVE =    1.108036
    YMIN =  -11.718217 YMAX =  -11.718217 YAVE =  -11.718217
    ZMIN =   34.407096 ZMAX =   34.407096 ZAVE =   34.407096
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.10803552"
Evaluating: 1.10803552+3.5
 Parameter: XMAX <- "4.60803552"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.7182168"
Evaluating: -11.7182168+3.5
 Parameter: YMAX <- "-8.2182168"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.407096"
Evaluating: 34.407096+3.5
 Parameter: ZMAX <- "37.907096"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.10803552"
Evaluating: 1.10803552-3.5
 Parameter: XMIN <- "-2.39196448"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.7182168"
Evaluating: -11.7182168-3.5
 Parameter: YMIN <- "-15.2182168"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.407096"
Evaluating: 34.407096-3.5
 Parameter: ZMIN <- "30.907096"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.60803552"
 Parameter: XMIN -> "-2.39196448"
 Parameter: YMAX -> "-8.2182168"
 Parameter: YMIN -> "-15.2182168"
 Parameter: ZMAX -> "37.907096"
 Parameter: ZMIN -> "30.907096"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      1 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26703 NEG      CLA      1        CLA     -**** POS      POT      21       POT           3.4020
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "43" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "42"
Evaluating: 43-42
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.888676561"
Evaluating: 82.1644692*(0.888676561-0.5)
 Parameter: XPOS <- "31.9354033"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.712049473"
Evaluating: 82.1644692*(0.712049473-0.5)
 Parameter: YPOS <- "17.4229324"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.497023198"
Evaluating: 85*(0.497023198-0.5)+0
 Parameter: ZPOS <- "-0.25302817"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.25302817" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.25302817" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "43" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "42"
Evaluating: 43-42
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.954546169"
Evaluating: 82.1644692*(0.954546169-0.5)
 Parameter: XPOS <- "37.3475447"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.297564705"
Evaluating: 82.1644692*(0.297564705-0.5)
 Parameter: YPOS <- "-16.6329886"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.569770887"
Evaluating: 85*(0.569770887-0.5)+0
 Parameter: ZPOS <- "5.9305254"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.9305254" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.9305254" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "43" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "42"
Evaluating: 43-42
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.945471836"
Evaluating: 82.1644692*(0.945471836-0.5)
 Parameter: XPOS <- "36.6019569"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.300571375"
Evaluating: 82.1644692*(0.300571375-0.5)
 Parameter: YPOS <- "-16.3859471"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.746562911"
Evaluating: 85*(0.746562911-0.5)+0
 Parameter: ZPOS <- "20.9578474"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.9578474" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.9578474" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.108036 XMAX =    1.108036 XAVE =    1.108036
    YMIN =  -11.718217 YMAX =  -11.718217 YAVE =  -11.718217
    ZMIN =   34.407096 ZMAX =   34.407096 ZAVE =   34.407096
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.6019569"
 RDCMND substituted energy or value "?XAVE" to "1.10803552"
Evaluating: 36.6019569-1.10803552
 Parameter: XTRAN <- "35.4939214"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.3859471"
 RDCMND substituted energy or value "?YAVE" to "-11.7182168"
Evaluating: -16.3859471--11.7182168
 Parameter: YTRAN <- "-4.6677303"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.9578474"
 RDCMND substituted energy or value "?ZAVE" to "34.407096"
Evaluating: 20.9578474-34.407096
 Parameter: ZTRAN <- "-13.4492486"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.4939214"
 Parameter: YTRAN -> "-4.6677303"
 Parameter: ZTRAN -> "-13.4492486"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    35.493921   -4.667730  -13.449249
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.20157365"
Evaluating: 0.20157365*360.0
 Parameter: XPHI <- "72.566514"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.590001014"
Evaluating: 0.590001014*360.0
 Parameter: YPHI <- "212.400365"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.682377885"
Evaluating: 0.682377885*360.0
 Parameter: ZPHI <- "245.656039"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.6019569"
 Parameter: YPOS -> "-16.3859471"
 Parameter: ZPOS -> "20.9578474"
 Parameter: XPHI -> "72.566514"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.299598    0.954065
    0.000000   -0.954065    0.299598

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.6019569"
 Parameter: YPOS -> "-16.3859471"
 Parameter: ZPOS -> "20.9578474"
 Parameter: YPHI -> "212.400365"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.844325    0.000000    0.535832
    0.000000    1.000000    0.000000
   -0.535832    0.000000   -0.844325

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  147.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.6019569"
 Parameter: YPOS -> "-16.3859471"
 Parameter: ZPOS -> "20.9578474"
 Parameter: ZPHI -> "245.656039"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.412214   -0.911087    0.000000
    0.911087   -0.412214    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  114.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.601957 XMAX =   36.601957 XAVE =   36.601957
    YMIN =  -16.385947 YMAX =  -16.385947 YAVE =  -16.385947
    ZMIN =   20.957847 ZMAX =   20.957847 ZAVE =   20.957847
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.6019569"
Evaluating: 36.6019569+3.5
 Parameter: XMAX <- "40.1019569"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.3859471"
Evaluating: -16.3859471+3.5
 Parameter: YMAX <- "-12.8859471"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.9578474"
Evaluating: 20.9578474+3.5
 Parameter: ZMAX <- "24.4578474"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.6019569"
Evaluating: 36.6019569-3.5
 Parameter: XMIN <- "33.1019569"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.3859471"
Evaluating: -16.3859471-3.5
 Parameter: YMIN <- "-19.8859471"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.9578474"
Evaluating: 20.9578474-3.5
 Parameter: ZMIN <- "17.4578474"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.1019569"
 Parameter: XMIN -> "33.1019569"
 Parameter: YMAX -> "-12.8859471"
 Parameter: YMIN -> "-19.8859471"
 Parameter: ZMAX -> "24.4578474"
 Parameter: ZMIN -> "17.4578474"
 SELRPN>      3 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      2 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26703 NEG      CLA      1        CLA     -8005 MEMB     POPC     61       O13           3.0548
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "43" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "42"
Evaluating: 43-42
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "1.815923287E-02"
Evaluating: 82.1644692*(1.815923287E-02-0.5)
 Parameter: XPOS <- "-39.5901909"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.792475826"
Evaluating: 82.1644692*(0.792475826-0.5)
 Parameter: YPOS <- "24.031121"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.35937979"
Evaluating: 85*(0.35937979-0.5)+0
 Parameter: ZPOS <- "-11.9527178"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-11.9527178" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-11.9527178" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "43" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "42"
Evaluating: 43-42
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.264448485"
Evaluating: 82.1644692*(0.264448485-0.5)
 Parameter: XPOS <- "-19.3539652"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.663905175"
Evaluating: 82.1644692*(0.663905175-0.5)
 Parameter: YPOS <- "13.4671817"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.344971023"
Evaluating: 85*(0.344971023-0.5)+0
 Parameter: ZPOS <- "-13.177463"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.177463" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.177463" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "43" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "42"
Evaluating: 43-42
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.537300405"
Evaluating: 82.1644692*(0.537300405-0.5)
 Parameter: XPOS <- "3.06476798"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.30135421"
Evaluating: 82.1644692*(0.30135421-0.5)
 Parameter: YPOS <- "-16.3216259"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.214871723"
Evaluating: 85*(0.214871723-0.5)+0
 Parameter: ZPOS <- "-24.2359035"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.2359035" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.601957 XMAX =   36.601957 XAVE =   36.601957
    YMIN =  -16.385947 YMAX =  -16.385947 YAVE =  -16.385947
    ZMIN =   20.957847 ZMAX =   20.957847 ZAVE =   20.957847
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.06476798"
 RDCMND substituted energy or value "?XAVE" to "36.6019569"
Evaluating: 3.06476798-36.6019569
 Parameter: XTRAN <- "-33.5371889"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.3216259"
 RDCMND substituted energy or value "?YAVE" to "-16.3859471"
Evaluating: -16.3216259--16.3859471
 Parameter: YTRAN <- "6.43212E-02"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.2359035"
 RDCMND substituted energy or value "?ZAVE" to "20.9578474"
Evaluating: -24.2359035-20.9578474
 Parameter: ZTRAN <- "-45.1937509"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.5371889"
 Parameter: YTRAN -> "6.43212E-02"
 Parameter: ZTRAN -> "-45.1937509"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -33.537189    0.064321  -45.193751
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179604593"
Evaluating: 0.179604593*360.0
 Parameter: XPHI <- "64.6576535"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.553671678"
Evaluating: 0.553671678*360.0
 Parameter: YPHI <- "199.321804"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.066590955E-02"
Evaluating: 4.066590955E-02*360.0
 Parameter: ZPHI <- "14.6397274"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.06476798"
 Parameter: YPOS -> "-16.3216259"
 Parameter: ZPOS -> "-24.2359035"
 Parameter: XPHI -> "64.6576535"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.428026    0.903766
    0.000000   -0.903766    0.428026

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.06476798"
 Parameter: YPOS -> "-16.3216259"
 Parameter: ZPOS -> "-24.2359035"
 Parameter: YPHI -> "199.321804"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.943675    0.000000    0.330874
    0.000000    1.000000    0.000000
   -0.330874    0.000000   -0.943675

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  160.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.06476798"
 Parameter: YPOS -> "-16.3216259"
 Parameter: ZPOS -> "-24.2359035"
 Parameter: ZPHI -> "14.6397274"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.967534    0.252740    0.000000
   -0.252740    0.967534    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.064768 XMAX =    3.064768 XAVE =    3.064768
    YMIN =  -16.321626 YMAX =  -16.321626 YAVE =  -16.321626
    ZMIN =  -24.235904 ZMAX =  -24.235904 ZAVE =  -24.235904
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.06476795"
Evaluating: 3.06476795+3.5
 Parameter: XMAX <- "6.56476795"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.3216259"
Evaluating: -16.3216259+3.5
 Parameter: YMAX <- "-12.8216259"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.2359035"
Evaluating: -24.2359035+3.5
 Parameter: ZMAX <- "-20.7359035"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.06476795"
Evaluating: 3.06476795-3.5
 Parameter: XMIN <- "-0.43523205"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.3216259"
Evaluating: -16.3216259-3.5
 Parameter: YMIN <- "-19.8216259"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.2359035"
Evaluating: -24.2359035-3.5
 Parameter: ZMIN <- "-27.7359035"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.56476795"
 Parameter: XMIN -> "-0.43523205"
 Parameter: YMAX -> "-12.8216259"
 Parameter: YMIN -> "-19.8216259"
 Parameter: ZMAX -> "-20.7359035"
 Parameter: ZMIN -> "-27.7359035"
 SELRPN>     12 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      4 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26703 NEG      CLA      1        CLA     -**** MEMB     POPC     121      C15           3.9019
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "7"
Evaluating: 7+1
 Parameter: CNTRAND <- "8"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "8" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "43" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "42"
Evaluating: 43-42
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.269212966"
Evaluating: 82.1644692*(0.269212966-0.5)
 Parameter: XPOS <- "-18.9624941"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.707373118"
Evaluating: 82.1644692*(0.707373118-0.5)
 Parameter: YPOS <- "17.0387022"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.91777776"
Evaluating: 85*(0.91777776-0.5)+0
 Parameter: ZPOS <- "35.5111096"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.5111096" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.5111096" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.064768 XMAX =    3.064768 XAVE =    3.064768
    YMIN =  -16.321626 YMAX =  -16.321626 YAVE =  -16.321626
    ZMIN =  -24.235904 ZMAX =  -24.235904 ZAVE =  -24.235904
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.9624941"
 RDCMND substituted energy or value "?XAVE" to "3.06476795"
Evaluating: -18.9624941-3.06476795
 Parameter: XTRAN <- "-22.0272621"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.0387022"
 RDCMND substituted energy or value "?YAVE" to "-16.3216259"
Evaluating: 17.0387022--16.3216259
 Parameter: YTRAN <- "33.3603281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.5111096"
 RDCMND substituted energy or value "?ZAVE" to "-24.2359035"
Evaluating: 35.5111096--24.2359035
 Parameter: ZTRAN <- "59.7470131"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.0272621"
 Parameter: YTRAN -> "33.3603281"
 Parameter: ZTRAN -> "59.7470131"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -22.027262   33.360328   59.747013
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.257973074"
Evaluating: 0.257973074*360.0
 Parameter: XPHI <- "92.8703066"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.115291224"
Evaluating: 0.115291224*360.0
 Parameter: YPHI <- "41.5048406"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.236459282"
Evaluating: 0.236459282*360.0
 Parameter: ZPHI <- "85.1253415"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.9624941"
 Parameter: YPOS -> "17.0387022"
 Parameter: ZPOS -> "35.5111096"
 Parameter: XPHI -> "92.8703066"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.050075    0.998745
    0.000000   -0.998745   -0.050075

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   92.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.9624941"
 Parameter: YPOS -> "17.0387022"
 Parameter: ZPOS -> "35.5111096"
 Parameter: YPHI -> "41.5048406"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.748900    0.000000   -0.662683
    0.000000    1.000000    0.000000
    0.662683    0.000000    0.748900

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   41.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.9624941"
 Parameter: YPOS -> "17.0387022"
 Parameter: ZPOS -> "35.5111096"
 Parameter: ZPHI -> "85.1253415"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.084976    0.996383    0.000000
   -0.996383    0.084976    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   85.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.962494 XMAX =  -18.962494 XAVE =  -18.962494
    YMIN =   17.038702 YMAX =   17.038702 YAVE =   17.038702
    ZMIN =   35.511110 ZMAX =   35.511110 ZAVE =   35.511110
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.9624941"
Evaluating: -18.9624941+3.5
 Parameter: XMAX <- "-15.4624941"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.0387022"
Evaluating: 17.0387022+3.5
 Parameter: YMAX <- "20.5387022"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.5111096"
Evaluating: 35.5111096+3.5
 Parameter: ZMAX <- "39.0111096"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.9624941"
Evaluating: -18.9624941-3.5
 Parameter: XMIN <- "-22.4624941"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.0387022"
Evaluating: 17.0387022-3.5
 Parameter: YMIN <- "13.5387022"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.5111096"
Evaluating: 35.5111096-3.5
 Parameter: ZMIN <- "32.0111096"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.4624941"
 Parameter: XMIN -> "-22.4624941"
 Parameter: YMAX -> "20.5387022"
 Parameter: YMIN -> "13.5387022"
 Parameter: ZMAX -> "39.0111096"
 Parameter: ZMIN -> "32.0111096"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "44" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "44" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "44"
 Parameter: NPOS -> "42"
Evaluating: 44-42
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.745457653"
Evaluating: 82.1644692*(0.745457653-0.5)
 Parameter: XPOS <- "20.1678978"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.108307213"
Evaluating: 82.1644692*(0.108307213-0.5)
 Parameter: YPOS <- "-32.1832299"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.517865948"
Evaluating: 85*(0.517865948-0.5)+0
 Parameter: ZPOS <- "1.51860558"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.51860558" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.51860558" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "44" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "44"
 Parameter: NPOS -> "42"
Evaluating: 44-42
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.148644558"
Evaluating: 82.1644692*(0.148644558-0.5)
 Parameter: XPOS <- "-28.8689334"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.449931891"
Evaluating: 82.1644692*(0.449931891-0.5)
 Parameter: YPOS <- "-4.1138196"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.77511549"
Evaluating: 85*(0.77511549-0.5)+0
 Parameter: ZPOS <- "23.3848167"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.3848167" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.3848167" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.8689334"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.8689334-0
 Parameter: XTRAN <- "-28.8689334"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.1138196"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.1138196-0
 Parameter: YTRAN <- "-4.1138196"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.3848167"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.3848167-0
 Parameter: ZTRAN <- "23.3848167"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.8689334"
 Parameter: YTRAN -> "-4.1138196"
 Parameter: ZTRAN -> "23.3848167"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -28.868933   -4.113820   23.384817
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.507574324"
Evaluating: 0.507574324*360.0
 Parameter: XPHI <- "182.726757"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987828543"
Evaluating: 0.987828543*360.0
 Parameter: YPHI <- "355.618275"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.379934914"
Evaluating: 0.379934914*360.0
 Parameter: ZPHI <- "136.776569"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.8689334"
 Parameter: YPOS -> "-4.1138196"
 Parameter: ZPOS -> "23.3848167"
 Parameter: XPHI -> "182.726757"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998868   -0.047573
    0.000000    0.047573   -0.998868

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  177.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.8689334"
 Parameter: YPOS -> "-4.1138196"
 Parameter: ZPOS -> "23.3848167"
 Parameter: YPHI -> "355.618275"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.997077    0.000000    0.076401
    0.000000    1.000000    0.000000
   -0.076401    0.000000    0.997077

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.8689334"
 Parameter: YPOS -> "-4.1138196"
 Parameter: ZPOS -> "23.3848167"
 Parameter: ZPHI -> "136.776569"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.728689    0.684845    0.000000
   -0.684845   -0.728689    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  136.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.868933 XMAX =  -28.868933 XAVE =  -28.868933
    YMIN =   -4.113820 YMAX =   -4.113820 YAVE =   -4.113820
    ZMIN =   23.384817 ZMAX =   23.384817 ZAVE =   23.384817
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.8689334"
Evaluating: -28.8689334+3.5
 Parameter: XMAX <- "-25.3689334"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.1138196"
Evaluating: -4.1138196+3.5
 Parameter: YMAX <- "-0.6138196"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.3848167"
Evaluating: 23.3848167+3.5
 Parameter: ZMAX <- "26.8848167"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.8689334"
Evaluating: -28.8689334-3.5
 Parameter: XMIN <- "-32.3689334"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.1138196"
Evaluating: -4.1138196-3.5
 Parameter: YMIN <- "-7.6138196"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.3848167"
Evaluating: 23.3848167-3.5
 Parameter: ZMIN <- "19.8848167"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.3689334"
 Parameter: XMIN -> "-32.3689334"
 Parameter: YMAX -> "-0.6138196"
 Parameter: YMIN -> "-7.6138196"
 Parameter: ZMAX -> "26.8848167"
 Parameter: ZMIN -> "19.8848167"
 SELRPN>      8 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      5 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26704 NEG      CLA      2        CLA     -4541 MEMB     POPC     35       P             3.1082
26704 NEG      CLA      2        CLA     -4542 MEMB     POPC     35       O13           3.7884
26704 NEG      CLA      2        CLA     -4543 MEMB     POPC     35       O14           1.7552
26704 NEG      CLA      2        CLA     -4544 MEMB     POPC     35       O12           3.6660
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "44" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "44"
 Parameter: NPOS -> "42"
Evaluating: 44-42
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.687788576"
Evaluating: 82.1644692*(0.687788576-0.5)
 Parameter: XPOS <- "15.4295487"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.918249807"
Evaluating: 82.1644692*(0.918249807-0.5)
 Parameter: YPOS <- "34.3652734"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.416343192"
Evaluating: 85*(0.416343192-0.5)+0
 Parameter: ZPOS <- "-7.11082868"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.11082868" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.11082868" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "44" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "44"
 Parameter: NPOS -> "42"
Evaluating: 44-42
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.646232205"
Evaluating: 82.1644692*(0.646232205-0.5)
 Parameter: XPOS <- "12.0150915"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.89779696"
Evaluating: 82.1644692*(0.89779696-0.5)
 Parameter: YPOS <- "32.6847761"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.154798122"
Evaluating: 85*(0.154798122-0.5)+0
 Parameter: ZPOS <- "-29.3421596"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.3421596" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.868933 XMAX =  -28.868933 XAVE =  -28.868933
    YMIN =   -4.113820 YMAX =   -4.113820 YAVE =   -4.113820
    ZMIN =   23.384817 ZMAX =   23.384817 ZAVE =   23.384817
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.0150915"
 RDCMND substituted energy or value "?XAVE" to "-28.8689334"
Evaluating: 12.0150915--28.8689334
 Parameter: XTRAN <- "40.8840249"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.6847761"
 RDCMND substituted energy or value "?YAVE" to "-4.1138196"
Evaluating: 32.6847761--4.1138196
 Parameter: YTRAN <- "36.7985957"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.3421596"
 RDCMND substituted energy or value "?ZAVE" to "23.3848167"
Evaluating: -29.3421596-23.3848167
 Parameter: ZTRAN <- "-52.7269763"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.8840249"
 Parameter: YTRAN -> "36.7985957"
 Parameter: ZTRAN -> "-52.7269763"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    40.884025   36.798596  -52.726976
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.934173521"
Evaluating: 0.934173521*360.0
 Parameter: XPHI <- "336.302468"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.988330715"
Evaluating: 0.988330715*360.0
 Parameter: YPHI <- "355.799057"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.743208504"
Evaluating: 0.743208504*360.0
 Parameter: ZPHI <- "267.555061"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.0150915"
 Parameter: YPOS -> "32.6847761"
 Parameter: ZPOS -> "-29.3421596"
 Parameter: XPHI -> "336.302468"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.915680   -0.401908
    0.000000    0.401908    0.915680

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.0150915"
 Parameter: YPOS -> "32.6847761"
 Parameter: ZPOS -> "-29.3421596"
 Parameter: YPHI -> "355.799057"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.997313    0.000000    0.073255
    0.000000    1.000000    0.000000
   -0.073255    0.000000    0.997313

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.0150915"
 Parameter: YPOS -> "32.6847761"
 Parameter: ZPOS -> "-29.3421596"
 Parameter: ZPHI -> "267.555061"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.042659   -0.999090    0.000000
    0.999090   -0.042659    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.015092 XMAX =   12.015092 XAVE =   12.015092
    YMIN =   32.684776 YMAX =   32.684776 YAVE =   32.684776
    ZMIN =  -29.342160 ZMAX =  -29.342160 ZAVE =  -29.342160
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.0150915"
Evaluating: 12.0150915+3.5
 Parameter: XMAX <- "15.5150915"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.6847761"
Evaluating: 32.6847761+3.5
 Parameter: YMAX <- "36.1847761"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.3421596"
Evaluating: -29.3421596+3.5
 Parameter: ZMAX <- "-25.8421596"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.0150915"
Evaluating: 12.0150915-3.5
 Parameter: XMIN <- "8.5150915"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.6847761"
Evaluating: 32.6847761-3.5
 Parameter: YMIN <- "29.1847761"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.3421596"
Evaluating: -29.3421596-3.5
 Parameter: ZMIN <- "-32.8421596"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.5150915"
 Parameter: XMIN -> "8.5150915"
 Parameter: YMAX -> "36.1847761"
 Parameter: YMIN -> "29.1847761"
 Parameter: ZMAX -> "-25.8421596"
 Parameter: ZMIN -> "-32.8421596"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "45" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "45" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "45"
 Parameter: NPOS -> "42"
Evaluating: 45-42
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.305101228"
Evaluating: 82.1644692*(0.305101228-0.5)
 Parameter: XPOS <- "-16.0137541"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.499847375"
Evaluating: 82.1644692*(0.499847375-0.5)
 Parameter: YPOS <- "-1.254035211E-02"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.789941095"
Evaluating: 85*(0.789941095-0.5)+0
 Parameter: ZPOS <- "24.6449931"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.6449931" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.6449931" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.0137541"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.0137541-0
 Parameter: XTRAN <- "-16.0137541"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.254035211E-02"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.254035211E-02-0
 Parameter: YTRAN <- "-1.254035211E-02"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.6449931"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.6449931-0
 Parameter: ZTRAN <- "24.6449931"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.0137541"
 Parameter: YTRAN -> "-1.254035211E-02"
 Parameter: ZTRAN -> "24.6449931"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -16.013754   -0.012540   24.644993
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.735153918"
Evaluating: 0.735153918*360.0
 Parameter: XPHI <- "264.65541"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.648786646E-02"
Evaluating: 4.648786646E-02*360.0
 Parameter: YPHI <- "16.7356319"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.972098688"
Evaluating: 0.972098688*360.0
 Parameter: ZPHI <- "349.955528"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.0137541"
 Parameter: YPOS -> "-1.254035211E-02"
 Parameter: ZPOS -> "24.6449931"
 Parameter: XPHI -> "264.65541"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.093145   -0.995653
    0.000000    0.995653   -0.093145

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   95.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.0137541"
 Parameter: YPOS -> "-1.254035211E-02"
 Parameter: ZPOS -> "24.6449931"
 Parameter: YPHI -> "16.7356319"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.957644    0.000000   -0.287956
    0.000000    1.000000    0.000000
    0.287956    0.000000    0.957644

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   16.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.0137541"
 Parameter: YPOS -> "-1.254035211E-02"
 Parameter: ZPOS -> "24.6449931"
 Parameter: ZPHI -> "349.955528"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.984673   -0.174413    0.000000
    0.174413    0.984673    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.013754 XMAX =  -16.013754 XAVE =  -16.013754
    YMIN =   -0.012540 YMAX =   -0.012540 YAVE =   -0.012540
    ZMIN =   24.644993 ZMAX =   24.644993 ZAVE =   24.644993
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.0137541"
Evaluating: -16.0137541+3.5
 Parameter: XMAX <- "-12.5137541"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.254035211E-02"
Evaluating: -1.254035211E-02+3.5
 Parameter: YMAX <- "3.48745965"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.6449931"
Evaluating: 24.6449931+3.5
 Parameter: ZMAX <- "28.1449931"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.0137541"
Evaluating: -16.0137541-3.5
 Parameter: XMIN <- "-19.5137541"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.254035211E-02"
Evaluating: -1.254035211E-02-3.5
 Parameter: YMIN <- "-3.51254035"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.6449931"
Evaluating: 24.6449931-3.5
 Parameter: ZMIN <- "21.1449931"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.5137541"
 Parameter: XMIN -> "-19.5137541"
 Parameter: YMAX -> "3.48745965"
 Parameter: YMIN -> "-3.51254035"
 Parameter: ZMAX -> "28.1449931"
 Parameter: ZMIN -> "21.1449931"
 SELRPN>      2 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "46" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "46" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "46"
 Parameter: NPOS -> "42"
Evaluating: 46-42
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.102593704"
Evaluating: 82.1644692*(0.102593704-0.5)
 Parameter: XPOS <- "-32.6526774"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.791566167"
Evaluating: 82.1644692*(0.791566167-0.5)
 Parameter: YPOS <- "23.9563793"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.414648704"
Evaluating: 85*(0.414648704-0.5)+0
 Parameter: ZPOS <- "-7.25486016"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.25486016" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.25486016" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "46" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "46"
 Parameter: NPOS -> "42"
Evaluating: 46-42
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.458698115"
Evaluating: 82.1644692*(0.458698115-0.5)
 Parameter: XPOS <- "-3.39354746"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.855824505"
Evaluating: 82.1644692*(0.855824505-0.5)
 Parameter: YPOS <- "29.2361316"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.59672914"
Evaluating: 85*(0.59672914-0.5)+0
 Parameter: ZPOS <- "8.2219769"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.2219769" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.2219769" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "46" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "46"
 Parameter: NPOS -> "42"
Evaluating: 46-42
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.888941652"
Evaluating: 82.1644692*(0.888941652-0.5)
 Parameter: XPOS <- "31.9571844"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.162009644"
Evaluating: 82.1644692*(0.162009644-0.5)
 Parameter: YPOS <- "-27.7707982"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.958328471"
Evaluating: 85*(0.958328471-0.5)+0
 Parameter: ZPOS <- "38.95792"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.95792" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.95792" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.9571844"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.9571844-0
 Parameter: XTRAN <- "31.9571844"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.7707982"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.7707982-0
 Parameter: YTRAN <- "-27.7707982"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.95792"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.95792-0
 Parameter: ZTRAN <- "38.95792"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.9571844"
 Parameter: YTRAN -> "-27.7707982"
 Parameter: ZTRAN -> "38.95792"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    31.957184  -27.770798   38.957920
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291251177"
Evaluating: 0.291251177*360.0
 Parameter: XPHI <- "104.850424"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.794411466"
Evaluating: 0.794411466*360.0
 Parameter: YPHI <- "285.988128"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.944170293E-02"
Evaluating: 3.944170293E-02*360.0
 Parameter: ZPHI <- "14.1990131"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.9571844"
 Parameter: YPOS -> "-27.7707982"
 Parameter: ZPOS -> "38.95792"
 Parameter: XPHI -> "104.850424"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.256297    0.966598
    0.000000   -0.966598   -0.256297

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.9571844"
 Parameter: YPOS -> "-27.7707982"
 Parameter: ZPOS -> "38.95792"
 Parameter: YPHI -> "285.988128"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.275438    0.000000    0.961319
    0.000000    1.000000    0.000000
   -0.961319    0.000000    0.275438

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.9571844"
 Parameter: YPOS -> "-27.7707982"
 Parameter: ZPOS -> "38.95792"
 Parameter: ZPHI -> "14.1990131"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.969450    0.245291    0.000000
   -0.245291    0.969450    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.957184 XMAX =   31.957184 XAVE =   31.957184
    YMIN =  -27.770798 YMAX =  -27.770798 YAVE =  -27.770798
    ZMIN =   38.957920 ZMAX =   38.957920 ZAVE =   38.957920
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.9571844"
Evaluating: 31.9571844+3.5
 Parameter: XMAX <- "35.4571844"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.7707982"
Evaluating: -27.7707982+3.5
 Parameter: YMAX <- "-24.2707982"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.95792"
Evaluating: 38.95792+3.5
 Parameter: ZMAX <- "42.45792"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.9571844"
Evaluating: 31.9571844-3.5
 Parameter: XMIN <- "28.4571844"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.7707982"
Evaluating: -27.7707982-3.5
 Parameter: YMIN <- "-31.2707982"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.95792"
Evaluating: 38.95792-3.5
 Parameter: ZMIN <- "35.45792"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.4571844"
 Parameter: XMIN -> "28.4571844"
 Parameter: YMAX -> "-24.2707982"
 Parameter: YMIN -> "-31.2707982"
 Parameter: ZMAX -> "42.45792"
 Parameter: ZMIN -> "35.45792"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "47" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "47" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "47"
 Parameter: NPOS -> "42"
Evaluating: 47-42
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "1.831672117E-02"
Evaluating: 82.1644692*(1.831672117E-02-0.5)
 Parameter: XPOS <- "-39.5772509"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.377211298"
Evaluating: 82.1644692*(0.377211298-0.5)
 Parameter: YPOS <- "-10.0888685"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.462025727"
Evaluating: 85*(0.462025727-0.5)+0
 Parameter: ZPOS <- "-3.22781321"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.22781321" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.22781321" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "47" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "47"
 Parameter: NPOS -> "42"
Evaluating: 47-42
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.337912342"
Evaluating: 82.1644692*(0.337912342-0.5)
 Parameter: XPOS <- "-13.3178464"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.861312404"
Evaluating: 82.1644692*(0.861312404-0.5)
 Parameter: YPOS <- "29.6870419"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.469116249"
Evaluating: 85*(0.469116249-0.5)+0
 Parameter: ZPOS <- "-2.62511883"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.62511883" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.62511883" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "47" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "47"
 Parameter: NPOS -> "42"
Evaluating: 47-42
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.10261009"
Evaluating: 82.1644692*(0.10261009-0.5)
 Parameter: XPOS <- "-32.651331"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.723333326"
Evaluating: 82.1644692*(0.723333326-0.5)
 Parameter: YPOS <- "18.3500642"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.669596435"
Evaluating: 85*(0.669596435-0.5)+0
 Parameter: ZPOS <- "14.415697"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.415697" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.415697" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "47" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "47"
 Parameter: NPOS -> "42"
Evaluating: 47-42
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.462330347"
Evaluating: 82.1644692*(0.462330347-0.5)
 Parameter: XPOS <- "-3.09510704"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.748541852"
Evaluating: 82.1644692*(0.748541852-0.5)
 Parameter: YPOS <- "20.4213093"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.531054479"
Evaluating: 85*(0.531054479-0.5)+0
 Parameter: ZPOS <- "2.63963072"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.63963072" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.63963072" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "47" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "47"
 Parameter: NPOS -> "42"
Evaluating: 47-42
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.246313719"
Evaluating: 82.1644692*(0.246313719-0.5)
 Parameter: XPOS <- "-20.8439986"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "1.137223987E-02"
Evaluating: 82.1644692*(1.137223987E-02-0.5)
 Parameter: YPOS <- "-40.1478405"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.944209568"
Evaluating: 85*(0.944209568-0.5)+0
 Parameter: ZPOS <- "37.7578133"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.7578133" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.7578133" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.8439986"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.8439986-0
 Parameter: XTRAN <- "-20.8439986"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.1478405"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.1478405-0
 Parameter: YTRAN <- "-40.1478405"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.7578133"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.7578133-0
 Parameter: ZTRAN <- "37.7578133"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.8439986"
 Parameter: YTRAN -> "-40.1478405"
 Parameter: ZTRAN -> "37.7578133"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -20.843999  -40.147841   37.757813
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.966230553"
Evaluating: 0.966230553*360.0
 Parameter: XPHI <- "347.842999"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.723421048"
Evaluating: 0.723421048*360.0
 Parameter: YPHI <- "260.431577"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.695114328"
Evaluating: 0.695114328*360.0
 Parameter: ZPHI <- "250.241158"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.8439986"
 Parameter: YPOS -> "-40.1478405"
 Parameter: ZPOS -> "37.7578133"
 Parameter: XPHI -> "347.842999"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.977574   -0.210591
    0.000000    0.210591    0.977574

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   12.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.8439986"
 Parameter: YPOS -> "-40.1478405"
 Parameter: ZPOS -> "37.7578133"
 Parameter: YPHI -> "260.431577"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.166225    0.000000    0.986088
    0.000000    1.000000    0.000000
   -0.986088    0.000000   -0.166225

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   99.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.8439986"
 Parameter: YPOS -> "-40.1478405"
 Parameter: ZPOS -> "37.7578133"
 Parameter: ZPHI -> "250.241158"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.338062   -0.941124    0.000000
    0.941124   -0.338062    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  109.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.843999 XMAX =  -20.843999 XAVE =  -20.843999
    YMIN =  -40.147841 YMAX =  -40.147841 YAVE =  -40.147841
    ZMIN =   37.757813 ZMAX =   37.757813 ZAVE =   37.757813
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.8439986"
Evaluating: -20.8439986+3.5
 Parameter: XMAX <- "-17.3439986"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.1478405"
Evaluating: -40.1478405+3.5
 Parameter: YMAX <- "-36.6478405"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.7578133"
Evaluating: 37.7578133+3.5
 Parameter: ZMAX <- "41.2578133"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.8439986"
Evaluating: -20.8439986-3.5
 Parameter: XMIN <- "-24.3439986"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.1478405"
Evaluating: -40.1478405-3.5
 Parameter: YMIN <- "-43.6478405"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.7578133"
Evaluating: 37.7578133-3.5
 Parameter: ZMIN <- "34.2578133"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.3439986"
 Parameter: XMIN -> "-24.3439986"
 Parameter: YMAX -> "-36.6478405"
 Parameter: YMIN -> "-43.6478405"
 Parameter: ZMAX -> "41.2578133"
 Parameter: ZMIN -> "34.2578133"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "48" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "48" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "48"
 Parameter: NPOS -> "42"
Evaluating: 48-42
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.36990236"
Evaluating: 82.1644692*(0.36990236-0.5)
 Parameter: XPOS <- "-10.6894035"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.67057249"
Evaluating: 82.1644692*(0.67057249-0.5)
 Parameter: YPOS <- "14.0149981"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.89464016"
Evaluating: 85*(0.89464016-0.5)+0
 Parameter: ZPOS <- "33.5444136"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.5444136" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.5444136" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.6894035"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.6894035-0
 Parameter: XTRAN <- "-10.6894035"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.0149981"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.0149981-0
 Parameter: YTRAN <- "14.0149981"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.5444136"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.5444136-0
 Parameter: ZTRAN <- "33.5444136"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.6894035"
 Parameter: YTRAN -> "14.0149981"
 Parameter: ZTRAN -> "33.5444136"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -10.689403   14.014998   33.544414
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.399238976"
Evaluating: 0.399238976*360.0
 Parameter: XPHI <- "143.726031"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.830307425"
Evaluating: 0.830307425*360.0
 Parameter: YPHI <- "298.910673"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.939939569"
Evaluating: 0.939939569*360.0
 Parameter: ZPHI <- "338.378245"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.6894035"
 Parameter: YPOS -> "14.0149981"
 Parameter: ZPOS -> "33.5444136"
 Parameter: XPHI -> "143.726031"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.806197    0.591647
    0.000000   -0.591647   -0.806197

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  143.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.6894035"
 Parameter: YPOS -> "14.0149981"
 Parameter: ZPOS -> "33.5444136"
 Parameter: YPHI -> "298.910673"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.483445    0.000000    0.875374
    0.000000    1.000000    0.000000
   -0.875374    0.000000    0.483445

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   61.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.6894035"
 Parameter: YPOS -> "14.0149981"
 Parameter: ZPOS -> "33.5444136"
 Parameter: ZPHI -> "338.378245"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.929637   -0.368478    0.000000
    0.368478    0.929637    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   21.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.689403 XMAX =  -10.689403 XAVE =  -10.689403
    YMIN =   14.014998 YMAX =   14.014998 YAVE =   14.014998
    ZMIN =   33.544414 ZMAX =   33.544414 ZAVE =   33.544414
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.6894035"
Evaluating: -10.6894035+3.5
 Parameter: XMAX <- "-7.1894035"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.0149981"
Evaluating: 14.0149981+3.5
 Parameter: YMAX <- "17.5149981"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.5444136"
Evaluating: 33.5444136+3.5
 Parameter: ZMAX <- "37.0444136"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.6894035"
Evaluating: -10.6894035-3.5
 Parameter: XMIN <- "-14.1894035"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.0149981"
Evaluating: 14.0149981-3.5
 Parameter: YMIN <- "10.5149981"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.5444136"
Evaluating: 33.5444136-3.5
 Parameter: ZMIN <- "30.0444136"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.1894035"
 Parameter: XMIN -> "-14.1894035"
 Parameter: YMAX -> "17.5149981"
 Parameter: YMIN -> "10.5149981"
 Parameter: ZMAX -> "37.0444136"
 Parameter: ZMIN -> "30.0444136"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "49" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "49" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "49"
 Parameter: NPOS -> "42"
Evaluating: 49-42
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.85772798"
Evaluating: 82.1644692*(0.85772798-0.5)
 Parameter: XPOS <- "29.3925296"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.426922723"
Evaluating: 82.1644692*(0.426922723-0.5)
 Parameter: YPOS <- "-6.00435568"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.583963349"
Evaluating: 85*(0.583963349-0.5)+0
 Parameter: ZPOS <- "7.13688467"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.13688467" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.13688467" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "49" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "49"
 Parameter: NPOS -> "42"
Evaluating: 49-42
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.414119158"
Evaluating: 82.1644692*(0.414119158-0.5)
 Parameter: XPOS <- "-7.0563538"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.47258025"
Evaluating: 82.1644692*(0.47258025-0.5)
 Parameter: YPOS <- "-2.2529292"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.329004863"
Evaluating: 85*(0.329004863-0.5)+0
 Parameter: ZPOS <- "-14.5345866"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.5345866" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.5345866" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "49" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "49"
 Parameter: NPOS -> "42"
Evaluating: 49-42
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "2.971244298E-02"
Evaluating: 82.1644692*(2.971244298E-02-0.5)
 Parameter: XPOS <- "-38.6409275"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.252435927"
Evaluating: 82.1644692*(0.252435927-0.5)
 Parameter: YPOS <- "-20.3409707"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.139249196"
Evaluating: 85*(0.139249196-0.5)+0
 Parameter: ZPOS <- "-30.6638183"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.6638183" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.6409275"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.6409275-0
 Parameter: XTRAN <- "-38.6409275"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.3409707"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.3409707-0
 Parameter: YTRAN <- "-20.3409707"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.6638183"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.6638183-0
 Parameter: ZTRAN <- "-30.6638183"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.6409275"
 Parameter: YTRAN -> "-20.3409707"
 Parameter: ZTRAN -> "-30.6638183"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -38.640927  -20.340971  -30.663818
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392180598"
Evaluating: 0.392180598*360.0
 Parameter: XPHI <- "141.185015"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.561436878"
Evaluating: 0.561436878*360.0
 Parameter: YPHI <- "202.117276"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.123179618"
Evaluating: 0.123179618*360.0
 Parameter: ZPHI <- "44.3446625"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.6409275"
 Parameter: YPOS -> "-20.3409707"
 Parameter: ZPOS -> "-30.6638183"
 Parameter: XPHI -> "141.185015"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.779174    0.626808
    0.000000   -0.626808   -0.779174

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.6409275"
 Parameter: YPOS -> "-20.3409707"
 Parameter: ZPOS -> "-30.6638183"
 Parameter: YPHI -> "202.117276"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.926415    0.000000    0.376504
    0.000000    1.000000    0.000000
   -0.376504    0.000000   -0.926415

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  157.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.6409275"
 Parameter: YPOS -> "-20.3409707"
 Parameter: ZPOS -> "-30.6638183"
 Parameter: ZPHI -> "44.3446625"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.715148    0.698973    0.000000
   -0.698973    0.715148    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   44.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.640927 XMAX =  -38.640927 XAVE =  -38.640927
    YMIN =  -20.340971 YMAX =  -20.340971 YAVE =  -20.340971
    ZMIN =  -30.663818 ZMAX =  -30.663818 ZAVE =  -30.663818
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.6409275"
Evaluating: -38.6409275+3.5
 Parameter: XMAX <- "-35.1409275"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.3409707"
Evaluating: -20.3409707+3.5
 Parameter: YMAX <- "-16.8409707"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.6638183"
Evaluating: -30.6638183+3.5
 Parameter: ZMAX <- "-27.1638183"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.6409275"
Evaluating: -38.6409275-3.5
 Parameter: XMIN <- "-42.1409275"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.3409707"
Evaluating: -20.3409707-3.5
 Parameter: YMIN <- "-23.8409707"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.6638183"
Evaluating: -30.6638183-3.5
 Parameter: ZMIN <- "-34.1638183"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.1409275"
 Parameter: XMIN -> "-42.1409275"
 Parameter: YMAX -> "-16.8409707"
 Parameter: YMIN -> "-23.8409707"
 Parameter: ZMAX -> "-27.1638183"
 Parameter: ZMIN -> "-34.1638183"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "50" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "50" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "50"
 Parameter: NPOS -> "42"
Evaluating: 50-42
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.41376639"
Evaluating: 82.1644692*(0.41376639-0.5)
 Parameter: XPOS <- "-7.08533879"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "8.546978432E-02"
Evaluating: 82.1644692*(8.546978432E-02-0.5)
 Parameter: YPOS <- "-34.0596551"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.605508842"
Evaluating: 85*(0.605508842-0.5)+0
 Parameter: ZPOS <- "8.96825157"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.96825157" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.96825157" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "50" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "50"
 Parameter: NPOS -> "42"
Evaluating: 50-42
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.390999787"
Evaluating: 82.1644692*(0.390999787-0.5)
 Parameter: XPOS <- "-8.95594464"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.457761951"
Evaluating: 82.1644692*(0.457761951-0.5)
 Parameter: YPOS <- "-3.47046688"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.305588122"
Evaluating: 85*(0.305588122-0.5)+0
 Parameter: ZPOS <- "-16.5250096"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.5250096" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.95594464"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.95594464-0
 Parameter: XTRAN <- "-8.95594464"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.47046688"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.47046688-0
 Parameter: YTRAN <- "-3.47046688"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.5250096"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.5250096-0
 Parameter: ZTRAN <- "-16.5250096"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.95594464"
 Parameter: YTRAN -> "-3.47046688"
 Parameter: ZTRAN -> "-16.5250096"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -8.955945   -3.470467  -16.525010
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.814479522"
Evaluating: 0.814479522*360.0
 Parameter: XPHI <- "293.212628"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.384573383"
Evaluating: 0.384573383*360.0
 Parameter: YPHI <- "138.446418"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.981901382"
Evaluating: 0.981901382*360.0
 Parameter: ZPHI <- "353.484498"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.95594464"
 Parameter: YPOS -> "-3.47046688"
 Parameter: ZPOS -> "-16.5250096"
 Parameter: XPHI -> "293.212628"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.394144   -0.919048
    0.000000    0.919048    0.394144

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   66.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.95594464"
 Parameter: YPOS -> "-3.47046688"
 Parameter: ZPOS -> "-16.5250096"
 Parameter: YPHI -> "138.446418"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.748336    0.000000   -0.663320
    0.000000    1.000000    0.000000
    0.663320    0.000000   -0.748336

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  138.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.95594464"
 Parameter: YPOS -> "-3.47046688"
 Parameter: ZPOS -> "-16.5250096"
 Parameter: ZPHI -> "353.484498"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.993541   -0.113472    0.000000
    0.113472    0.993541    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    6.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.955945 XMAX =   -8.955945 XAVE =   -8.955945
    YMIN =   -3.470467 YMAX =   -3.470467 YAVE =   -3.470467
    ZMIN =  -16.525010 ZMAX =  -16.525010 ZAVE =  -16.525010
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.95594464"
Evaluating: -8.95594464+3.5
 Parameter: XMAX <- "-5.45594464"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.47046688"
Evaluating: -3.47046688+3.5
 Parameter: YMAX <- "2.953312E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.5250096"
Evaluating: -16.5250096+3.5
 Parameter: ZMAX <- "-13.0250096"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.95594464"
Evaluating: -8.95594464-3.5
 Parameter: XMIN <- "-12.4559446"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.47046688"
Evaluating: -3.47046688-3.5
 Parameter: YMIN <- "-6.97046688"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.5250096"
Evaluating: -16.5250096-3.5
 Parameter: ZMIN <- "-20.0250096"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.45594464"
 Parameter: XMIN -> "-12.4559446"
 Parameter: YMAX -> "2.953312E-02"
 Parameter: YMIN -> "-6.97046688"
 Parameter: ZMAX -> "-13.0250096"
 Parameter: ZMIN -> "-20.0250096"
 SELRPN>     22 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     14 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26710 NEG      CLA      8        CLA     -**** MEMB     POPC     106      N             3.7055
26710 NEG      CLA      8        CLA     -**** MEMB     POPC     106      C13           2.5114
26710 NEG      CLA      8        CLA     -**** MEMB     POPC     106      P             3.6057
26710 NEG      CLA      8        CLA     -**** MEMB     POPC     106      O14           2.2422
26710 NEG      CLA      8        CLA     -**** MEMB     POPC     106      O22           3.2457
26710 NEG      CLA      8        CLA     -**** MEMB     POPC     112      O22           3.7531
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "50" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "50"
 Parameter: NPOS -> "42"
Evaluating: 50-42
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.492330166"
Evaluating: 82.1644692*(0.492330166-0.5)
 Parameter: XPOS <- "-0.630187839"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.408611318"
Evaluating: 82.1644692*(0.408611318-0.5)
 Parameter: YPOS <- "-7.50890255"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.20968137"
Evaluating: 85*(0.20968137-0.5)+0
 Parameter: ZPOS <- "-24.6770836"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.6770836" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.955945 XMAX =   -8.955945 XAVE =   -8.955945
    YMIN =   -3.470467 YMAX =   -3.470467 YAVE =   -3.470467
    ZMIN =  -16.525010 ZMAX =  -16.525010 ZAVE =  -16.525010
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.630187839"
 RDCMND substituted energy or value "?XAVE" to "-8.95594464"
Evaluating: -0.630187839--8.95594464
 Parameter: XTRAN <- "8.3257568"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.50890255"
 RDCMND substituted energy or value "?YAVE" to "-3.47046688"
Evaluating: -7.50890255--3.47046688
 Parameter: YTRAN <- "-4.03843567"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.6770836"
 RDCMND substituted energy or value "?ZAVE" to "-16.5250096"
Evaluating: -24.6770836--16.5250096
 Parameter: ZTRAN <- "-8.152074"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.3257568"
 Parameter: YTRAN -> "-4.03843567"
 Parameter: ZTRAN -> "-8.152074"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     8.325757   -4.038436   -8.152074
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.939718103"
Evaluating: 0.939718103*360.0
 Parameter: XPHI <- "338.298517"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.586259719"
Evaluating: 0.586259719*360.0
 Parameter: YPHI <- "211.053499"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.786317511"
Evaluating: 0.786317511*360.0
 Parameter: ZPHI <- "283.074304"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.630187839"
 Parameter: YPOS -> "-7.50890255"
 Parameter: ZPOS -> "-24.6770836"
 Parameter: XPHI -> "338.298517"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.929123   -0.369771
    0.000000    0.369771    0.929123

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   21.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.630187839"
 Parameter: YPOS -> "-7.50890255"
 Parameter: ZPOS -> "-24.6770836"
 Parameter: YPHI -> "211.053499"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.856686    0.000000    0.515838
    0.000000    1.000000    0.000000
   -0.515838    0.000000   -0.856686

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.630187839"
 Parameter: YPOS -> "-7.50890255"
 Parameter: ZPOS -> "-24.6770836"
 Parameter: ZPHI -> "283.074304"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.226214   -0.974078    0.000000
    0.974078    0.226214    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   76.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.630188 XMAX =   -0.630188 XAVE =   -0.630188
    YMIN =   -7.508903 YMAX =   -7.508903 YAVE =   -7.508903
    ZMIN =  -24.677084 ZMAX =  -24.677084 ZAVE =  -24.677084
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.630187839"
Evaluating: -0.630187839+3.5
 Parameter: XMAX <- "2.86981216"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.50890255"
Evaluating: -7.50890255+3.5
 Parameter: YMAX <- "-4.00890255"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.6770836"
Evaluating: -24.6770836+3.5
 Parameter: ZMAX <- "-21.1770836"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.630187839"
Evaluating: -0.630187839-3.5
 Parameter: XMIN <- "-4.13018784"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.50890255"
Evaluating: -7.50890255-3.5
 Parameter: YMIN <- "-11.0089026"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.6770836"
Evaluating: -24.6770836-3.5
 Parameter: ZMIN <- "-28.1770836"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.86981216"
 Parameter: XMIN -> "-4.13018784"
 Parameter: YMAX -> "-4.00890255"
 Parameter: YMIN -> "-11.0089026"
 Parameter: ZMAX -> "-21.1770836"
 Parameter: ZMIN -> "-28.1770836"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "51" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "51" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "51"
 Parameter: NPOS -> "42"
Evaluating: 51-42
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.800852084"
Evaluating: 82.1644692*(0.800852084-0.5)
 Parameter: XPOS <- "24.7193518"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.502421331"
Evaluating: 82.1644692*(0.502421331-0.5)
 Parameter: YPOS <- "0.198947376"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.201961571"
Evaluating: 85*(0.201961571-0.5)+0
 Parameter: ZPOS <- "-25.3332665"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.3332665" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.7193518"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.7193518-0
 Parameter: XTRAN <- "24.7193518"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.198947376"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.198947376-0
 Parameter: YTRAN <- "0.198947376"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.3332665"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.3332665-0
 Parameter: ZTRAN <- "-25.3332665"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.7193518"
 Parameter: YTRAN -> "0.198947376"
 Parameter: ZTRAN -> "-25.3332665"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    24.719352    0.198947  -25.333267
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.461890531"
Evaluating: 0.461890531*360.0
 Parameter: XPHI <- "166.280591"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330804727"
Evaluating: 0.330804727*360.0
 Parameter: YPHI <- "119.089702"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.521651649"
Evaluating: 0.521651649*360.0
 Parameter: ZPHI <- "187.794594"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.7193518"
 Parameter: YPOS -> "0.198947376"
 Parameter: ZPOS -> "-25.3332665"
 Parameter: XPHI -> "166.280591"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.971469    0.237167
    0.000000   -0.237167   -0.971469

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  166.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.7193518"
 Parameter: YPOS -> "0.198947376"
 Parameter: ZPOS -> "-25.3332665"
 Parameter: YPHI -> "119.089702"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.486178    0.000000   -0.873860
    0.000000    1.000000    0.000000
    0.873860    0.000000   -0.486178

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  119.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.7193518"
 Parameter: YPOS -> "0.198947376"
 Parameter: ZPOS -> "-25.3332665"
 Parameter: ZPHI -> "187.794594"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.990761   -0.135622    0.000000
    0.135622   -0.990761    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  172.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.719352 XMAX =   24.719352 XAVE =   24.719352
    YMIN =    0.198947 YMAX =    0.198947 YAVE =    0.198947
    ZMIN =  -25.333267 ZMAX =  -25.333267 ZAVE =  -25.333267
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.7193518"
Evaluating: 24.7193518+3.5
 Parameter: XMAX <- "28.2193518"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.198947376"
Evaluating: 0.198947376+3.5
 Parameter: YMAX <- "3.69894738"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.3332665"
Evaluating: -25.3332665+3.5
 Parameter: ZMAX <- "-21.8332665"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.7193518"
Evaluating: 24.7193518-3.5
 Parameter: XMIN <- "21.2193518"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.198947376"
Evaluating: 0.198947376-3.5
 Parameter: YMIN <- "-3.30105262"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.3332665"
Evaluating: -25.3332665-3.5
 Parameter: ZMIN <- "-28.8332665"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.2193518"
 Parameter: XMIN -> "21.2193518"
 Parameter: YMAX -> "3.69894738"
 Parameter: YMIN -> "-3.30105262"
 Parameter: ZMAX -> "-21.8332665"
 Parameter: ZMIN -> "-28.8332665"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "52" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "52" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "52"
 Parameter: NPOS -> "42"
Evaluating: 52-42
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.503630507"
Evaluating: 82.1644692*(0.503630507-0.5)
 Parameter: XPOS <- "0.298298681"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.134802034"
Evaluating: 82.1644692*(0.134802034-0.5)
 Parameter: YPOS <- "-30.006297"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.267537307"
Evaluating: 85*(0.267537307-0.5)+0
 Parameter: ZPOS <- "-19.7593289"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.7593289" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.298298681"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.298298681-0
 Parameter: XTRAN <- "0.298298681"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.006297"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.006297-0
 Parameter: YTRAN <- "-30.006297"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.7593289"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.7593289-0
 Parameter: ZTRAN <- "-19.7593289"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.298298681"
 Parameter: YTRAN -> "-30.006297"
 Parameter: ZTRAN -> "-19.7593289"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     0.298299  -30.006297  -19.759329
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.572366646"
Evaluating: 0.572366646*360.0
 Parameter: XPHI <- "206.051993"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457589697"
Evaluating: 0.457589697*360.0
 Parameter: YPHI <- "164.732291"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.283039197"
Evaluating: 0.283039197*360.0
 Parameter: ZPHI <- "101.894111"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.298298681"
 Parameter: YPOS -> "-30.006297"
 Parameter: ZPOS -> "-19.7593289"
 Parameter: XPHI -> "206.051993"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.898396   -0.439187
    0.000000    0.439187   -0.898396

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  153.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.298298681"
 Parameter: YPOS -> "-30.006297"
 Parameter: ZPOS -> "-19.7593289"
 Parameter: YPHI -> "164.732291"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.964706    0.000000   -0.263329
    0.000000    1.000000    0.000000
    0.263329    0.000000   -0.964706

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  164.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.298298681"
 Parameter: YPOS -> "-30.006297"
 Parameter: ZPOS -> "-19.7593289"
 Parameter: ZPHI -> "101.894111"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.206104    0.978530    0.000000
   -0.978530   -0.206104    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  101.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.298299 XMAX =    0.298299 XAVE =    0.298299
    YMIN =  -30.006297 YMAX =  -30.006297 YAVE =  -30.006297
    ZMIN =  -19.759329 ZMAX =  -19.759329 ZAVE =  -19.759329
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.298298681"
Evaluating: 0.298298681+3.5
 Parameter: XMAX <- "3.79829868"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.006297"
Evaluating: -30.006297+3.5
 Parameter: YMAX <- "-26.506297"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.7593289"
Evaluating: -19.7593289+3.5
 Parameter: ZMAX <- "-16.2593289"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.298298681"
Evaluating: 0.298298681-3.5
 Parameter: XMIN <- "-3.20170132"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.006297"
Evaluating: -30.006297-3.5
 Parameter: YMIN <- "-33.506297"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.7593289"
Evaluating: -19.7593289-3.5
 Parameter: ZMIN <- "-23.2593289"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.79829868"
 Parameter: XMIN -> "-3.20170132"
 Parameter: YMAX -> "-26.506297"
 Parameter: YMIN -> "-33.506297"
 Parameter: ZMAX -> "-16.2593289"
 Parameter: ZMIN -> "-23.2593289"
 SELRPN>     18 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      8 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     139      C14           3.8810
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     139      C15           3.8106
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     140      C12           3.5455
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     140      C11           3.7894
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "52" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "52"
 Parameter: NPOS -> "42"
Evaluating: 52-42
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.867285762"
Evaluating: 82.1644692*(0.867285762-0.5)
 Parameter: XPOS <- "30.1778397"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.310949265"
Evaluating: 82.1644692*(0.310949265-0.5)
 Parameter: YPOS <- "-15.5332533"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.225759804"
Evaluating: 85*(0.225759804-0.5)+0
 Parameter: ZPOS <- "-23.3104167"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.3104167" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.298299 XMAX =    0.298299 XAVE =    0.298299
    YMIN =  -30.006297 YMAX =  -30.006297 YAVE =  -30.006297
    ZMIN =  -19.759329 ZMAX =  -19.759329 ZAVE =  -19.759329
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.1778397"
 RDCMND substituted energy or value "?XAVE" to "0.298298681"
Evaluating: 30.1778397-0.298298681
 Parameter: XTRAN <- "29.879541"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.5332533"
 RDCMND substituted energy or value "?YAVE" to "-30.006297"
Evaluating: -15.5332533--30.006297
 Parameter: YTRAN <- "14.4730437"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.3104167"
 RDCMND substituted energy or value "?ZAVE" to "-19.7593289"
Evaluating: -23.3104167--19.7593289
 Parameter: ZTRAN <- "-3.5510878"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.879541"
 Parameter: YTRAN -> "14.4730437"
 Parameter: ZTRAN -> "-3.5510878"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    29.879541   14.473044   -3.551088
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274420736"
Evaluating: 0.274420736*360.0
 Parameter: XPHI <- "98.791465"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.959875439E-03"
Evaluating: 9.959875439E-03*360.0
 Parameter: YPHI <- "3.58555516"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.305132923"
Evaluating: 0.305132923*360.0
 Parameter: ZPHI <- "109.847852"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.1778397"
 Parameter: YPOS -> "-15.5332533"
 Parameter: ZPOS -> "-23.3104167"
 Parameter: XPHI -> "98.791465"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.152839    0.988251
    0.000000   -0.988251   -0.152839

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.1778397"
 Parameter: YPOS -> "-15.5332533"
 Parameter: ZPOS -> "-23.3104167"
 Parameter: YPHI -> "3.58555516"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.998043    0.000000   -0.062539
    0.000000    1.000000    0.000000
    0.062539    0.000000    0.998043

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    3.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.1778397"
 Parameter: YPOS -> "-15.5332533"
 Parameter: ZPOS -> "-23.3104167"
 Parameter: ZPHI -> "109.847852"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.339524    0.940598    0.000000
   -0.940598   -0.339524    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  109.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.177840 XMAX =   30.177840 XAVE =   30.177840
    YMIN =  -15.533253 YMAX =  -15.533253 YAVE =  -15.533253
    ZMIN =  -23.310417 ZMAX =  -23.310417 ZAVE =  -23.310417
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.1778397"
Evaluating: 30.1778397+3.5
 Parameter: XMAX <- "33.6778397"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.5332533"
Evaluating: -15.5332533+3.5
 Parameter: YMAX <- "-12.0332533"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.3104167"
Evaluating: -23.3104167+3.5
 Parameter: ZMAX <- "-19.8104167"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.1778397"
Evaluating: 30.1778397-3.5
 Parameter: XMIN <- "26.6778397"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.5332533"
Evaluating: -15.5332533-3.5
 Parameter: YMIN <- "-19.0332533"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.3104167"
Evaluating: -23.3104167-3.5
 Parameter: ZMIN <- "-26.8104167"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.6778397"
 Parameter: XMIN -> "26.6778397"
 Parameter: YMAX -> "-12.0332533"
 Parameter: YMIN -> "-19.0332533"
 Parameter: ZMAX -> "-19.8104167"
 Parameter: ZMIN -> "-26.8104167"
 SELRPN>      8 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      4 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     154      C14           3.5704
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "52" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "52"
 Parameter: NPOS -> "42"
Evaluating: 52-42
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.571892997"
Evaluating: 82.1644692*(0.571892997-0.5)
 Parameter: XPOS <- "5.90704994"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.22627396"
Evaluating: 82.1644692*(0.22627396-0.5)
 Parameter: YPOS <- "-22.4905548"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.757682494"
Evaluating: 85*(0.757682494-0.5)+0
 Parameter: ZPOS <- "21.903012"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.903012" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.903012" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.177840 XMAX =   30.177840 XAVE =   30.177840
    YMIN =  -15.533253 YMAX =  -15.533253 YAVE =  -15.533253
    ZMIN =  -23.310417 ZMAX =  -23.310417 ZAVE =  -23.310417
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.90704994"
 RDCMND substituted energy or value "?XAVE" to "30.1778397"
Evaluating: 5.90704994-30.1778397
 Parameter: XTRAN <- "-24.2707898"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.4905548"
 RDCMND substituted energy or value "?YAVE" to "-15.5332533"
Evaluating: -22.4905548--15.5332533
 Parameter: YTRAN <- "-6.9573015"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.903012"
 RDCMND substituted energy or value "?ZAVE" to "-23.3104167"
Evaluating: 21.903012--23.3104167
 Parameter: ZTRAN <- "45.2134287"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.2707898"
 Parameter: YTRAN -> "-6.9573015"
 Parameter: ZTRAN -> "45.2134287"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -24.270790   -6.957301   45.213429
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.398831469"
Evaluating: 0.398831469*360.0
 Parameter: XPHI <- "143.579329"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.984279947E-02"
Evaluating: 7.984279947E-02*360.0
 Parameter: YPHI <- "28.7434078"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.211189791E-02"
Evaluating: 8.211189791E-02*360.0
 Parameter: ZPHI <- "29.5602832"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.90704994"
 Parameter: YPOS -> "-22.4905548"
 Parameter: ZPOS -> "21.903012"
 Parameter: XPHI -> "143.579329"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.804680    0.593709
    0.000000   -0.593709   -0.804680

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  143.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.90704994"
 Parameter: YPOS -> "-22.4905548"
 Parameter: ZPOS -> "21.903012"
 Parameter: YPHI -> "28.7434078"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.876782    0.000000   -0.480888
    0.000000    1.000000    0.000000
    0.480888    0.000000    0.876782

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   28.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.90704994"
 Parameter: YPOS -> "-22.4905548"
 Parameter: ZPOS -> "21.903012"
 Parameter: ZPHI -> "29.5602832"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.869837    0.493339    0.000000
   -0.493339    0.869837    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   29.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.907050 XMAX =    5.907050 XAVE =    5.907050
    YMIN =  -22.490555 YMAX =  -22.490555 YAVE =  -22.490555
    ZMIN =   21.903012 ZMAX =   21.903012 ZAVE =   21.903012
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.90704991"
Evaluating: 5.90704991+3.5
 Parameter: XMAX <- "9.40704991"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.4905548"
Evaluating: -22.4905548+3.5
 Parameter: YMAX <- "-18.9905548"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.903012"
Evaluating: 21.903012+3.5
 Parameter: ZMAX <- "25.403012"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.90704991"
Evaluating: 5.90704991-3.5
 Parameter: XMIN <- "2.40704991"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.4905548"
Evaluating: -22.4905548-3.5
 Parameter: YMIN <- "-25.9905548"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.903012"
Evaluating: 21.903012-3.5
 Parameter: ZMIN <- "18.403012"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.40704991"
 Parameter: XMIN -> "2.40704991"
 Parameter: YMAX -> "-18.9905548"
 Parameter: YMIN -> "-25.9905548"
 Parameter: ZMAX -> "25.403012"
 Parameter: ZMIN -> "18.403012"
 SELRPN>      6 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      4 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26712 NEG      CLA      10       CLA     -4401 MEMB     POPS     34       C13           3.2454
26712 NEG      CLA      10       CLA     -4402 MEMB     POPS     34       O13A          3.1258
26712 NEG      CLA      10       CLA     -4403 MEMB     POPS     34       O13B          3.1807
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "52" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "52"
 Parameter: NPOS -> "42"
Evaluating: 52-42
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.585873814"
Evaluating: 82.1644692*(0.585873814-0.5)
 Parameter: XPOS <- "7.05577635"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.454570353"
Evaluating: 82.1644692*(0.454570353-0.5)
 Parameter: YPOS <- "-3.73270283"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.275662547"
Evaluating: 85*(0.275662547-0.5)+0
 Parameter: ZPOS <- "-19.0686835"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.0686835" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.907050 XMAX =    5.907050 XAVE =    5.907050
    YMIN =  -22.490555 YMAX =  -22.490555 YAVE =  -22.490555
    ZMIN =   21.903012 ZMAX =   21.903012 ZAVE =   21.903012
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.05577635"
 RDCMND substituted energy or value "?XAVE" to "5.90704991"
Evaluating: 7.05577635-5.90704991
 Parameter: XTRAN <- "1.14872644"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.73270283"
 RDCMND substituted energy or value "?YAVE" to "-22.4905548"
Evaluating: -3.73270283--22.4905548
 Parameter: YTRAN <- "18.757852"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.0686835"
 RDCMND substituted energy or value "?ZAVE" to "21.903012"
Evaluating: -19.0686835-21.903012
 Parameter: ZTRAN <- "-40.9716955"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.14872644"
 Parameter: YTRAN -> "18.757852"
 Parameter: ZTRAN -> "-40.9716955"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     1.148726   18.757852  -40.971696
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.471087876"
Evaluating: 0.471087876*360.0
 Parameter: XPHI <- "169.591635"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.844944416"
Evaluating: 0.844944416*360.0
 Parameter: YPHI <- "304.17999"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.34572024E-02"
Evaluating: 3.34572024E-02*360.0
 Parameter: ZPHI <- "12.0445929"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.05577635"
 Parameter: YPOS -> "-3.73270283"
 Parameter: ZPOS -> "-19.0686835"
 Parameter: XPHI -> "169.591635"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.983545    0.180663
    0.000000   -0.180663   -0.983545

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  169.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.05577635"
 Parameter: YPOS -> "-3.73270283"
 Parameter: ZPOS -> "-19.0686835"
 Parameter: YPHI -> "304.17999"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.561794    0.000000    0.827277
    0.000000    1.000000    0.000000
   -0.827277    0.000000    0.561794

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   55.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.05577635"
 Parameter: YPOS -> "-3.73270283"
 Parameter: ZPOS -> "-19.0686835"
 Parameter: ZPHI -> "12.0445929"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.977985    0.208673    0.000000
   -0.208673    0.977985    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.055776 XMAX =    7.055776 XAVE =    7.055776
    YMIN =   -3.732703 YMAX =   -3.732703 YAVE =   -3.732703
    ZMIN =  -19.068683 ZMAX =  -19.068683 ZAVE =  -19.068683
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.05577636"
Evaluating: 7.05577636+3.5
 Parameter: XMAX <- "10.5557764"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.73270287"
Evaluating: -3.73270287+3.5
 Parameter: YMAX <- "-0.23270287"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.0686835"
Evaluating: -19.0686835+3.5
 Parameter: ZMAX <- "-15.5686835"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.05577636"
Evaluating: 7.05577636-3.5
 Parameter: XMIN <- "3.55577636"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.73270287"
Evaluating: -3.73270287-3.5
 Parameter: YMIN <- "-7.23270287"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.0686835"
Evaluating: -19.0686835-3.5
 Parameter: ZMIN <- "-22.5686835"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.5557764"
 Parameter: XMIN -> "3.55577636"
 Parameter: YMAX -> "-0.23270287"
 Parameter: YMIN -> "-7.23270287"
 Parameter: ZMAX -> "-15.5686835"
 Parameter: ZMIN -> "-22.5686835"
 SELRPN>     21 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     10 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     105      N             3.5525
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     105      C14           3.4160
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     105      C15           2.6962
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     105      C11           3.6951
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     105      P             2.9653
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     105      O13           2.7476
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     105      O14           3.3692
26712 NEG      CLA      10       CLA     -**** MEMB     POPC     105      O12           2.4469
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "52" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "52"
 Parameter: NPOS -> "42"
Evaluating: 52-42
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.872319107"
Evaluating: 82.1644692*(0.872319107-0.5)
 Parameter: XPOS <- "30.5914018"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.908032677"
Evaluating: 82.1644692*(0.908032677-0.5)
 Parameter: YPOS <- "33.5257883"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.810784885"
Evaluating: 85*(0.810784885-0.5)+0
 Parameter: ZPOS <- "26.4167152"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.4167152" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.4167152" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.055776 XMAX =    7.055776 XAVE =    7.055776
    YMIN =   -3.732703 YMAX =   -3.732703 YAVE =   -3.732703
    ZMIN =  -19.068683 ZMAX =  -19.068683 ZAVE =  -19.068683
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.5914018"
 RDCMND substituted energy or value "?XAVE" to "7.05577636"
Evaluating: 30.5914018-7.05577636
 Parameter: XTRAN <- "23.5356254"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.5257883"
 RDCMND substituted energy or value "?YAVE" to "-3.73270287"
Evaluating: 33.5257883--3.73270287
 Parameter: YTRAN <- "37.2584912"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.4167152"
 RDCMND substituted energy or value "?ZAVE" to "-19.0686835"
Evaluating: 26.4167152--19.0686835
 Parameter: ZTRAN <- "45.4853987"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.5356254"
 Parameter: YTRAN -> "37.2584912"
 Parameter: ZTRAN -> "45.4853987"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    23.535625   37.258491   45.485399
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.112938643"
Evaluating: 0.112938643*360.0
 Parameter: XPHI <- "40.6579115"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.954894656"
Evaluating: 0.954894656*360.0
 Parameter: YPHI <- "343.762076"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.759715455"
Evaluating: 0.759715455*360.0
 Parameter: ZPHI <- "273.497564"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.5914018"
 Parameter: YPOS -> "33.5257883"
 Parameter: ZPOS -> "26.4167152"
 Parameter: XPHI -> "40.6579115"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.758613    0.651541
    0.000000   -0.651541    0.758613

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   40.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.5914018"
 Parameter: YPOS -> "33.5257883"
 Parameter: ZPOS -> "26.4167152"
 Parameter: YPHI -> "343.762076"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.960109    0.000000    0.279627
    0.000000    1.000000    0.000000
   -0.279627    0.000000    0.960109

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   16.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.5914018"
 Parameter: YPOS -> "33.5257883"
 Parameter: ZPOS -> "26.4167152"
 Parameter: ZPHI -> "273.497564"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.061006   -0.998137    0.000000
    0.998137    0.061006    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   86.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.591402 XMAX =   30.591402 XAVE =   30.591402
    YMIN =   33.525788 YMAX =   33.525788 YAVE =   33.525788
    ZMIN =   26.416715 ZMAX =   26.416715 ZAVE =   26.416715
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.5914018"
Evaluating: 30.5914018+3.5
 Parameter: XMAX <- "34.0914018"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.5257883"
Evaluating: 33.5257883+3.5
 Parameter: YMAX <- "37.0257883"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.4167152"
Evaluating: 26.4167152+3.5
 Parameter: ZMAX <- "29.9167152"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.5914018"
Evaluating: 30.5914018-3.5
 Parameter: XMIN <- "27.0914018"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.5257883"
Evaluating: 33.5257883-3.5
 Parameter: YMIN <- "30.0257883"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.4167152"
Evaluating: 26.4167152-3.5
 Parameter: ZMIN <- "22.9167152"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.0914018"
 Parameter: XMIN -> "27.0914018"
 Parameter: YMAX -> "37.0257883"
 Parameter: YMIN -> "30.0257883"
 Parameter: ZMAX -> "29.9167152"
 Parameter: ZMIN -> "22.9167152"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "53" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "53" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "53"
 Parameter: NPOS -> "42"
Evaluating: 53-42
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.693346014"
Evaluating: 82.1644692*(0.693346014-0.5)
 Parameter: XPOS <- "15.8861726"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.582564502"
Evaluating: 82.1644692*(0.582564502-0.5)
 Parameter: YPOS <- "6.78386848"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.666107649"
Evaluating: 85*(0.666107649-0.5)+0
 Parameter: ZPOS <- "14.1191502"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.1191502" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.1191502" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "53" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "53"
 Parameter: NPOS -> "42"
Evaluating: 53-42
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.442032618"
Evaluating: 82.1644692*(0.442032618-0.5)
 Parameter: XPOS <- "-4.76285917"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.440698579"
Evaluating: 82.1644692*(0.440698579-0.5)
 Parameter: YPOS <- "-4.87246978"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.713743953E-02"
Evaluating: 85*(2.713743953E-02-0.5)+0
 Parameter: ZPOS <- "-40.1933176"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.1933176" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.76285917"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.76285917-0
 Parameter: XTRAN <- "-4.76285917"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.87246978"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.87246978-0
 Parameter: YTRAN <- "-4.87246978"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.1933176"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.1933176-0
 Parameter: ZTRAN <- "-40.1933176"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.76285917"
 Parameter: YTRAN -> "-4.87246978"
 Parameter: ZTRAN -> "-40.1933176"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -4.762859   -4.872470  -40.193318
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324987415"
Evaluating: 0.324987415*360.0
 Parameter: XPHI <- "116.995469"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.983973465"
Evaluating: 0.983973465*360.0
 Parameter: YPHI <- "354.230447"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.120388644"
Evaluating: 0.120388644*360.0
 Parameter: ZPHI <- "43.3399118"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.76285917"
 Parameter: YPOS -> "-4.87246978"
 Parameter: ZPOS -> "-40.1933176"
 Parameter: XPHI -> "116.995469"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.453920    0.891042
    0.000000   -0.891042   -0.453920

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  117.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.76285917"
 Parameter: YPOS -> "-4.87246978"
 Parameter: ZPOS -> "-40.1933176"
 Parameter: YPHI -> "354.230447"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.994934    0.000000    0.100528
    0.000000    1.000000    0.000000
   -0.100528    0.000000    0.994934

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    5.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.76285917"
 Parameter: YPOS -> "-4.87246978"
 Parameter: ZPOS -> "-40.1933176"
 Parameter: ZPHI -> "43.3399118"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.727295    0.686325    0.000000
   -0.686325    0.727295    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   43.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.762859 XMAX =   -4.762859 XAVE =   -4.762859
    YMIN =   -4.872470 YMAX =   -4.872470 YAVE =   -4.872470
    ZMIN =  -40.193318 ZMAX =  -40.193318 ZAVE =  -40.193318
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.76285917"
Evaluating: -4.76285917+3.5
 Parameter: XMAX <- "-1.26285917"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.87246978"
Evaluating: -4.87246978+3.5
 Parameter: YMAX <- "-1.37246978"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.1933176"
Evaluating: -40.1933176+3.5
 Parameter: ZMAX <- "-36.6933176"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.76285917"
Evaluating: -4.76285917-3.5
 Parameter: XMIN <- "-8.26285917"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.87246978"
Evaluating: -4.87246978-3.5
 Parameter: YMIN <- "-8.37246978"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.1933176"
Evaluating: -40.1933176-3.5
 Parameter: ZMIN <- "-43.6933176"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.26285917"
 Parameter: XMIN -> "-8.26285917"
 Parameter: YMAX -> "-1.37246978"
 Parameter: YMIN -> "-8.37246978"
 Parameter: ZMAX -> "-36.6933176"
 Parameter: ZMIN -> "-43.6933176"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "54" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "54" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "54"
 Parameter: NPOS -> "42"
Evaluating: 54-42
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.977092365"
Evaluating: 82.1644692*(0.977092365-0.5)
 Parameter: XPOS <- "39.2000409"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "9.797556199E-02"
Evaluating: 82.1644692*(9.797556199E-02-0.5)
 Parameter: YPOS <- "-33.0321246"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.890395272"
Evaluating: 85*(0.890395272-0.5)+0
 Parameter: ZPOS <- "33.1835981"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.1835981" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.1835981" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.2000409"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.2000409-0
 Parameter: XTRAN <- "39.2000409"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.0321246"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.0321246-0
 Parameter: YTRAN <- "-33.0321246"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.1835981"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.1835981-0
 Parameter: ZTRAN <- "33.1835981"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.2000409"
 Parameter: YTRAN -> "-33.0321246"
 Parameter: ZTRAN -> "33.1835981"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    39.200041  -33.032125   33.183598
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863470694"
Evaluating: 0.863470694*360.0
 Parameter: XPHI <- "310.84945"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.933485498"
Evaluating: 0.933485498*360.0
 Parameter: YPHI <- "336.054779"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.270513947E-02"
Evaluating: 1.270513947E-02*360.0
 Parameter: ZPHI <- "4.57385021"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.2000409"
 Parameter: YPOS -> "-33.0321246"
 Parameter: ZPOS -> "33.1835981"
 Parameter: XPHI -> "310.84945"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.654074   -0.756431
    0.000000    0.756431    0.654074

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   49.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.2000409"
 Parameter: YPOS -> "-33.0321246"
 Parameter: ZPOS -> "33.1835981"
 Parameter: YPHI -> "336.054779"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.913934    0.000000    0.405863
    0.000000    1.000000    0.000000
   -0.405863    0.000000    0.913934

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   23.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.2000409"
 Parameter: YPOS -> "-33.0321246"
 Parameter: ZPOS -> "33.1835981"
 Parameter: ZPHI -> "4.57385021"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.996815    0.079744    0.000000
   -0.079744    0.996815    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    4.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.200041 XMAX =   39.200041 XAVE =   39.200041
    YMIN =  -33.032125 YMAX =  -33.032125 YAVE =  -33.032125
    ZMIN =   33.183598 ZMAX =   33.183598 ZAVE =   33.183598
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.2000409"
Evaluating: 39.2000409+3.5
 Parameter: XMAX <- "42.7000409"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.0321246"
Evaluating: -33.0321246+3.5
 Parameter: YMAX <- "-29.5321246"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.1835981"
Evaluating: 33.1835981+3.5
 Parameter: ZMAX <- "36.6835981"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.2000409"
Evaluating: 39.2000409-3.5
 Parameter: XMIN <- "35.7000409"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.0321246"
Evaluating: -33.0321246-3.5
 Parameter: YMIN <- "-36.5321246"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.1835981"
Evaluating: 33.1835981-3.5
 Parameter: ZMIN <- "29.6835981"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.7000409"
 Parameter: XMIN -> "35.7000409"
 Parameter: YMAX -> "-29.5321246"
 Parameter: YMIN -> "-36.5321246"
 Parameter: ZMAX -> "36.6835981"
 Parameter: ZMIN -> "29.6835981"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "55" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "55" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "55"
 Parameter: NPOS -> "42"
Evaluating: 55-42
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.447864524"
Evaluating: 82.1644692*(0.447864524-0.5)
 Parameter: XPOS <- "-4.28368371"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.609414957"
Evaluating: 82.1644692*(0.609414957-0.5)
 Parameter: YPOS <- "8.99002186"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.218304838"
Evaluating: 85*(0.218304838-0.5)+0
 Parameter: ZPOS <- "-23.9440888"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.9440888" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.28368371"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.28368371-0
 Parameter: XTRAN <- "-4.28368371"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.99002186"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.99002186-0
 Parameter: YTRAN <- "8.99002186"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.9440888"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.9440888-0
 Parameter: ZTRAN <- "-23.9440888"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.28368371"
 Parameter: YTRAN -> "8.99002186"
 Parameter: ZTRAN -> "-23.9440888"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -4.283684    8.990022  -23.944089
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.52990658E-02"
Evaluating: 6.52990658E-02*360.0
 Parameter: XPHI <- "23.5076637"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.632550478"
Evaluating: 0.632550478*360.0
 Parameter: YPHI <- "227.718172"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.180027351"
Evaluating: 0.180027351*360.0
 Parameter: ZPHI <- "64.8098464"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.28368371"
 Parameter: YPOS -> "8.99002186"
 Parameter: ZPOS -> "-23.9440888"
 Parameter: XPHI -> "23.5076637"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.917007    0.398872
    0.000000   -0.398872    0.917007

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   23.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.28368371"
 Parameter: YPOS -> "8.99002186"
 Parameter: ZPOS -> "-23.9440888"
 Parameter: YPHI -> "227.718172"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.672778    0.000000    0.739845
    0.000000    1.000000    0.000000
   -0.739845    0.000000   -0.672778

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  132.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.28368371"
 Parameter: YPOS -> "8.99002186"
 Parameter: ZPOS -> "-23.9440888"
 Parameter: ZPHI -> "64.8098464"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.425624    0.904900    0.000000
   -0.904900    0.425624    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.283684 XMAX =   -4.283684 XAVE =   -4.283684
    YMIN =    8.990022 YMAX =    8.990022 YAVE =    8.990022
    ZMIN =  -23.944089 ZMAX =  -23.944089 ZAVE =  -23.944089
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.28368371"
Evaluating: -4.28368371+3.5
 Parameter: XMAX <- "-0.78368371"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.99002186"
Evaluating: 8.99002186+3.5
 Parameter: YMAX <- "12.4900219"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.9440888"
Evaluating: -23.9440888+3.5
 Parameter: ZMAX <- "-20.4440888"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.28368371"
Evaluating: -4.28368371-3.5
 Parameter: XMIN <- "-7.78368371"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.99002186"
Evaluating: 8.99002186-3.5
 Parameter: YMIN <- "5.49002186"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.9440888"
Evaluating: -23.9440888-3.5
 Parameter: ZMIN <- "-27.4440888"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.78368371"
 Parameter: XMIN -> "-7.78368371"
 Parameter: YMAX -> "12.4900219"
 Parameter: YMIN -> "5.49002186"
 Parameter: ZMAX -> "-20.4440888"
 Parameter: ZMIN -> "-27.4440888"
 SELRPN>      3 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      2 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26715 NEG      CLA      13       CLA     -**** MEMB     POPC     104      O13           3.6120
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "55" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "55"
 Parameter: NPOS -> "42"
Evaluating: 55-42
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.580677793"
Evaluating: 82.1644692*(0.580677793-0.5)
 Parameter: XPOS <- "6.62884804"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.34631243"
Evaluating: 82.1644692*(0.34631243-0.5)
 Parameter: YPOS <- "-12.6276576"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.617634048"
Evaluating: 85*(0.617634048-0.5)+0
 Parameter: ZPOS <- "9.99889408"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.99889408" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.99889408" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "55" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "55"
 Parameter: NPOS -> "42"
Evaluating: 55-42
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.978295903"
Evaluating: 82.1644692*(0.978295903-0.5)
 Parameter: XPOS <- "39.298929"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.929276645"
Evaluating: 82.1644692*(0.929276645-0.5)
 Parameter: YPOS <- "35.2712877"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.360499515E-03"
Evaluating: 85*(9.360499515E-03-0.5)+0
 Parameter: ZPOS <- "-41.7043575"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.7043575" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.283684 XMAX =   -4.283684 XAVE =   -4.283684
    YMIN =    8.990022 YMAX =    8.990022 YAVE =    8.990022
    ZMIN =  -23.944089 ZMAX =  -23.944089 ZAVE =  -23.944089
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.298929"
 RDCMND substituted energy or value "?XAVE" to "-4.28368371"
Evaluating: 39.298929--4.28368371
 Parameter: XTRAN <- "43.5826127"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.2712877"
 RDCMND substituted energy or value "?YAVE" to "8.99002186"
Evaluating: 35.2712877-8.99002186
 Parameter: YTRAN <- "26.2812658"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.7043575"
 RDCMND substituted energy or value "?ZAVE" to "-23.9440888"
Evaluating: -41.7043575--23.9440888
 Parameter: ZTRAN <- "-17.7602687"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.5826127"
 Parameter: YTRAN -> "26.2812658"
 Parameter: ZTRAN -> "-17.7602687"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    43.582613   26.281266  -17.760269
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.127455007"
Evaluating: 0.127455007*360.0
 Parameter: XPHI <- "45.8838025"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107446606"
Evaluating: 0.107446606*360.0
 Parameter: YPHI <- "38.6807782"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318316812"
Evaluating: 0.318316812*360.0
 Parameter: ZPHI <- "114.594052"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.298929"
 Parameter: YPOS -> "35.2712877"
 Parameter: ZPOS -> "-41.7043575"
 Parameter: XPHI -> "45.8838025"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.696116    0.717930
    0.000000   -0.717930    0.696116

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   45.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.298929"
 Parameter: YPOS -> "35.2712877"
 Parameter: ZPOS -> "-41.7043575"
 Parameter: YPHI -> "38.6807782"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.780640    0.000000   -0.624981
    0.000000    1.000000    0.000000
    0.624981    0.000000    0.780640

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   38.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.298929"
 Parameter: YPOS -> "35.2712877"
 Parameter: ZPOS -> "-41.7043575"
 Parameter: ZPHI -> "114.594052"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.416186    0.909279    0.000000
   -0.909279   -0.416186    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.298929 XMAX =   39.298929 XAVE =   39.298929
    YMIN =   35.271288 YMAX =   35.271288 YAVE =   35.271288
    ZMIN =  -41.704357 ZMAX =  -41.704357 ZAVE =  -41.704357
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.298929"
Evaluating: 39.298929+3.5
 Parameter: XMAX <- "42.798929"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.2712877"
Evaluating: 35.2712877+3.5
 Parameter: YMAX <- "38.7712877"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.7043575"
Evaluating: -41.7043575+3.5
 Parameter: ZMAX <- "-38.2043575"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.298929"
Evaluating: 39.298929-3.5
 Parameter: XMIN <- "35.798929"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.2712877"
Evaluating: 35.2712877-3.5
 Parameter: YMIN <- "31.7712877"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.7043575"
Evaluating: -41.7043575-3.5
 Parameter: ZMIN <- "-45.2043575"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.798929"
 Parameter: XMIN -> "35.798929"
 Parameter: YMAX -> "38.7712877"
 Parameter: YMIN -> "31.7712877"
 Parameter: ZMAX -> "-38.2043575"
 Parameter: ZMIN -> "-45.2043575"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "56" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "56" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "42"
Evaluating: 56-42
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.85203049"
Evaluating: 82.1644692*(0.85203049-0.5)
 Parameter: XPOS <- "28.9243984"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.596258684"
Evaluating: 82.1644692*(0.596258684-0.5)
 Parameter: YPOS <- "7.90904368"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.335251829"
Evaluating: 85*(0.335251829-0.5)+0
 Parameter: ZPOS <- "-14.0035945"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.0035945" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.0035945" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "56" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "42"
Evaluating: 56-42
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.999066997"
Evaluating: 82.1644692*(0.999066997-0.5)
 Parameter: XPOS <- "41.0055749"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.43184888"
Evaluating: 82.1644692*(0.43184888-0.5)
 Parameter: YPOS <- "-5.5996006"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.309111835"
Evaluating: 85*(0.309111835-0.5)+0
 Parameter: ZPOS <- "-16.225494"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.225494" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.0055749"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.0055749-0
 Parameter: XTRAN <- "41.0055749"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.5996006"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.5996006-0
 Parameter: YTRAN <- "-5.5996006"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.225494"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.225494-0
 Parameter: ZTRAN <- "-16.225494"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.0055749"
 Parameter: YTRAN -> "-5.5996006"
 Parameter: ZTRAN -> "-16.225494"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    41.005575   -5.599601  -16.225494
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.54889686E-02"
Evaluating: 4.54889686E-02*360.0
 Parameter: XPHI <- "16.3760287"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957390666"
Evaluating: 0.957390666*360.0
 Parameter: YPHI <- "344.66064"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536123308"
Evaluating: 0.536123308*360.0
 Parameter: ZPHI <- "193.004391"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.0055749"
 Parameter: YPOS -> "-5.5996006"
 Parameter: ZPOS -> "-16.225494"
 Parameter: XPHI -> "16.3760287"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.959432    0.281940
    0.000000   -0.281940    0.959432

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.0055749"
 Parameter: YPOS -> "-5.5996006"
 Parameter: ZPOS -> "-16.225494"
 Parameter: YPHI -> "344.66064"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.964376    0.000000    0.264536
    0.000000    1.000000    0.000000
   -0.264536    0.000000    0.964376

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.0055749"
 Parameter: YPOS -> "-5.5996006"
 Parameter: ZPOS -> "-16.225494"
 Parameter: ZPHI -> "193.004391"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.974353   -0.225026    0.000000
    0.225026   -0.974353    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  167.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.005575 XMAX =   41.005575 XAVE =   41.005575
    YMIN =   -5.599601 YMAX =   -5.599601 YAVE =   -5.599601
    ZMIN =  -16.225494 ZMAX =  -16.225494 ZAVE =  -16.225494
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.0055749"
Evaluating: 41.0055749+3.5
 Parameter: XMAX <- "44.5055749"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.5996006"
Evaluating: -5.5996006+3.5
 Parameter: YMAX <- "-2.0996006"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.225494"
Evaluating: -16.225494+3.5
 Parameter: ZMAX <- "-12.725494"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.0055749"
Evaluating: 41.0055749-3.5
 Parameter: XMIN <- "37.5055749"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.5996006"
Evaluating: -5.5996006-3.5
 Parameter: YMIN <- "-9.0996006"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.225494"
Evaluating: -16.225494-3.5
 Parameter: ZMIN <- "-19.725494"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.5055749"
 Parameter: XMIN -> "37.5055749"
 Parameter: YMAX -> "-2.0996006"
 Parameter: YMIN -> "-9.0996006"
 Parameter: ZMAX -> "-12.725494"
 Parameter: ZMIN -> "-19.725494"
 SELRPN>     21 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      9 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26716 NEG      CLA      14       CLA     -**** MEMB     POPC     161      C22           3.2359
26716 NEG      CLA      14       CLA     -**** MEMB     POPC     161      C23           2.0249
26716 NEG      CLA      14       CLA     -**** MEMB     POPC     161      C24           2.6873
26716 NEG      CLA      14       CLA     -**** MEMB     POPC     161      C25           3.9449
26716 NEG      CLA      14       CLA     -**** MEMB     POPC     185      C21           3.7636
26716 NEG      CLA      14       CLA     -**** MEMB     POPC     185      O22           3.2197
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "56" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "42"
Evaluating: 56-42
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.973594528"
Evaluating: 82.1644692*(0.973594528-0.5)
 Parameter: XPOS <- "38.912643"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.517629425"
Evaluating: 82.1644692*(0.517629425-0.5)
 Parameter: YPOS <- "1.44851235"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.384699625"
Evaluating: 85*(0.384699625-0.5)+0
 Parameter: ZPOS <- "-9.80053187"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.80053187" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.80053187" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "56" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "42"
Evaluating: 56-42
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.105149089"
Evaluating: 82.1644692*(0.105149089-0.5)
 Parameter: XPOS <- "-32.4427155"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.315295915"
Evaluating: 82.1644692*(0.315295915-0.5)
 Parameter: YPOS <- "-15.1761131"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.818595364"
Evaluating: 85*(0.818595364-0.5)+0
 Parameter: ZPOS <- "27.0806059"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.0806059" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.0806059" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.005575 XMAX =   41.005575 XAVE =   41.005575
    YMIN =   -5.599601 YMAX =   -5.599601 YAVE =   -5.599601
    ZMIN =  -16.225494 ZMAX =  -16.225494 ZAVE =  -16.225494
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.4427155"
 RDCMND substituted energy or value "?XAVE" to "41.0055749"
Evaluating: -32.4427155-41.0055749
 Parameter: XTRAN <- "-73.4482904"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.1761131"
 RDCMND substituted energy or value "?YAVE" to "-5.5996006"
Evaluating: -15.1761131--5.5996006
 Parameter: YTRAN <- "-9.5765125"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.0806059"
 RDCMND substituted energy or value "?ZAVE" to "-16.225494"
Evaluating: 27.0806059--16.225494
 Parameter: ZTRAN <- "43.3060999"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.4482904"
 Parameter: YTRAN -> "-9.5765125"
 Parameter: ZTRAN -> "43.3060999"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -73.448290   -9.576512   43.306100
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.627107482"
Evaluating: 0.627107482*360.0
 Parameter: XPHI <- "225.758694"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824768797"
Evaluating: 0.824768797*360.0
 Parameter: YPHI <- "296.916767"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314576726"
Evaluating: 0.314576726*360.0
 Parameter: ZPHI <- "113.247621"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.4427155"
 Parameter: YPOS -> "-15.1761131"
 Parameter: ZPOS -> "27.0806059"
 Parameter: XPHI -> "225.758694"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.697682   -0.716408
    0.000000    0.716408   -0.697682

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  134.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.4427155"
 Parameter: YPOS -> "-15.1761131"
 Parameter: ZPOS -> "27.0806059"
 Parameter: YPHI -> "296.916767"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.452696    0.000000    0.891665
    0.000000    1.000000    0.000000
   -0.891665    0.000000    0.452696

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   63.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.4427155"
 Parameter: YPOS -> "-15.1761131"
 Parameter: ZPOS -> "27.0806059"
 Parameter: ZPHI -> "113.247621"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.394706    0.918808    0.000000
   -0.918808   -0.394706    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  113.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.442715 XMAX =  -32.442715 XAVE =  -32.442715
    YMIN =  -15.176113 YMAX =  -15.176113 YAVE =  -15.176113
    ZMIN =   27.080606 ZMAX =   27.080606 ZAVE =   27.080606
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.4427155"
Evaluating: -32.4427155+3.5
 Parameter: XMAX <- "-28.9427155"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.1761131"
Evaluating: -15.1761131+3.5
 Parameter: YMAX <- "-11.6761131"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.0806059"
Evaluating: 27.0806059+3.5
 Parameter: ZMAX <- "30.5806059"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.4427155"
Evaluating: -32.4427155-3.5
 Parameter: XMIN <- "-35.9427155"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.1761131"
Evaluating: -15.1761131-3.5
 Parameter: YMIN <- "-18.6761131"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.0806059"
Evaluating: 27.0806059-3.5
 Parameter: ZMIN <- "23.5806059"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.9427155"
 Parameter: XMIN -> "-35.9427155"
 Parameter: YMAX -> "-11.6761131"
 Parameter: YMIN -> "-18.6761131"
 Parameter: ZMAX -> "30.5806059"
 Parameter: ZMIN -> "23.5806059"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "57" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "57" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "57"
 Parameter: NPOS -> "42"
Evaluating: 57-42
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.579427588"
Evaluating: 82.1644692*(0.579427588-0.5)
 Parameter: XPOS <- "6.52612561"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.234431874"
Evaluating: 82.1644692*(0.234431874-0.5)
 Parameter: YPOS <- "-21.8202641"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.521565617"
Evaluating: 85*(0.521565617-0.5)+0
 Parameter: ZPOS <- "1.83307744"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.83307744" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.83307744" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "57" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "57"
 Parameter: NPOS -> "42"
Evaluating: 57-42
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.975632958"
Evaluating: 82.1644692*(0.975632958-0.5)
 Parameter: XPOS <- "39.0801295"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.236094105"
Evaluating: 82.1644692*(0.236094105-0.5)
 Parameter: YPOS <- "-21.6836878"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.180437564"
Evaluating: 85*(0.180437564-0.5)+0
 Parameter: ZPOS <- "-27.1628071"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.1628071" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.0801295"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.0801295-0
 Parameter: XTRAN <- "39.0801295"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.6836878"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.6836878-0
 Parameter: YTRAN <- "-21.6836878"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.1628071"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.1628071-0
 Parameter: ZTRAN <- "-27.1628071"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.0801295"
 Parameter: YTRAN -> "-21.6836878"
 Parameter: ZTRAN -> "-27.1628071"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    39.080129  -21.683688  -27.162807
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.2165515"
Evaluating: 0.2165515*360.0
 Parameter: XPHI <- "77.95854"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.274720814E-02"
Evaluating: 4.274720814E-02*360.0
 Parameter: YPHI <- "15.3889949"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.601326733"
Evaluating: 0.601326733*360.0
 Parameter: ZPHI <- "216.477624"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.0801295"
 Parameter: YPOS -> "-21.6836878"
 Parameter: ZPOS -> "-27.1628071"
 Parameter: XPHI -> "77.95854"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.208619    0.977997
    0.000000   -0.977997    0.208619

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.0801295"
 Parameter: YPOS -> "-21.6836878"
 Parameter: ZPOS -> "-27.1628071"
 Parameter: YPHI -> "15.3889949"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.964146    0.000000   -0.265371
    0.000000    1.000000    0.000000
    0.265371    0.000000    0.964146

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   15.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.0801295"
 Parameter: YPOS -> "-21.6836878"
 Parameter: ZPOS -> "-27.1628071"
 Parameter: ZPHI -> "216.477624"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.804089   -0.594509    0.000000
    0.594509   -0.804089    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  143.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.080129 XMAX =   39.080129 XAVE =   39.080129
    YMIN =  -21.683688 YMAX =  -21.683688 YAVE =  -21.683688
    ZMIN =  -27.162807 ZMAX =  -27.162807 ZAVE =  -27.162807
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.0801295"
Evaluating: 39.0801295+3.5
 Parameter: XMAX <- "42.5801295"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.6836878"
Evaluating: -21.6836878+3.5
 Parameter: YMAX <- "-18.1836878"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.1628071"
Evaluating: -27.1628071+3.5
 Parameter: ZMAX <- "-23.6628071"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.0801295"
Evaluating: 39.0801295-3.5
 Parameter: XMIN <- "35.5801295"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.6836878"
Evaluating: -21.6836878-3.5
 Parameter: YMIN <- "-25.1836878"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.1628071"
Evaluating: -27.1628071-3.5
 Parameter: ZMIN <- "-30.6628071"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.5801295"
 Parameter: XMIN -> "35.5801295"
 Parameter: YMAX -> "-18.1836878"
 Parameter: YMIN -> "-25.1836878"
 Parameter: ZMAX -> "-23.6628071"
 Parameter: ZMIN -> "-30.6628071"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "58" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "58" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "58"
 Parameter: NPOS -> "42"
Evaluating: 58-42
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.935661352"
Evaluating: 82.1644692*(0.935661352-0.5)
 Parameter: XPOS <- "35.7958837"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.555593508"
Evaluating: 82.1644692*(0.555593508-0.5)
 Parameter: YPOS <- "4.56781108"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.476736913"
Evaluating: 85*(0.476736913-0.5)+0
 Parameter: ZPOS <- "-1.97736239"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.97736239" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.97736239" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "58" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "58"
 Parameter: NPOS -> "42"
Evaluating: 58-42
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.438560444"
Evaluating: 82.1644692*(0.438560444-0.5)
 Parameter: XPOS <- "-5.04814851"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "2.757624343E-02"
Evaluating: 82.1644692*(2.757624343E-02-0.5)
 Parameter: YPOS <- "-38.8164472"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.739646711E-02"
Evaluating: 85*(3.739646711E-02-0.5)+0
 Parameter: ZPOS <- "-39.3213003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.3213003" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.04814851"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.04814851-0
 Parameter: XTRAN <- "-5.04814851"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.8164472"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.8164472-0
 Parameter: YTRAN <- "-38.8164472"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.3213003"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.3213003-0
 Parameter: ZTRAN <- "-39.3213003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.04814851"
 Parameter: YTRAN -> "-38.8164472"
 Parameter: ZTRAN -> "-39.3213003"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -5.048149  -38.816447  -39.321300
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.342578958"
Evaluating: 0.342578958*360.0
 Parameter: XPHI <- "123.328425"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.826928575"
Evaluating: 0.826928575*360.0
 Parameter: YPHI <- "297.694287"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.84549561"
Evaluating: 0.84549561*360.0
 Parameter: ZPHI <- "304.37842"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.04814851"
 Parameter: YPOS -> "-38.8164472"
 Parameter: ZPOS -> "-39.3213003"
 Parameter: XPHI -> "123.328425"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.549437    0.835535
    0.000000   -0.835535   -0.549437

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.04814851"
 Parameter: YPOS -> "-38.8164472"
 Parameter: ZPOS -> "-39.3213003"
 Parameter: YPHI -> "297.694287"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.464754    0.000000    0.885440
    0.000000    1.000000    0.000000
   -0.885440    0.000000    0.464754

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   62.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.04814851"
 Parameter: YPOS -> "-38.8164472"
 Parameter: ZPOS -> "-39.3213003"
 Parameter: ZPHI -> "304.37842"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.564656   -0.825326    0.000000
    0.825326    0.564656    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   55.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.048149 XMAX =   -5.048149 XAVE =   -5.048149
    YMIN =  -38.816447 YMAX =  -38.816447 YAVE =  -38.816447
    ZMIN =  -39.321300 ZMAX =  -39.321300 ZAVE =  -39.321300
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.04814851"
Evaluating: -5.04814851+3.5
 Parameter: XMAX <- "-1.54814851"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.8164472"
Evaluating: -38.8164472+3.5
 Parameter: YMAX <- "-35.3164472"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.3213003"
Evaluating: -39.3213003+3.5
 Parameter: ZMAX <- "-35.8213003"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.04814851"
Evaluating: -5.04814851-3.5
 Parameter: XMIN <- "-8.54814851"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.8164472"
Evaluating: -38.8164472-3.5
 Parameter: YMIN <- "-42.3164472"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.3213003"
Evaluating: -39.3213003-3.5
 Parameter: ZMIN <- "-42.8213003"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.54814851"
 Parameter: XMIN -> "-8.54814851"
 Parameter: YMAX -> "-35.3164472"
 Parameter: YMIN -> "-42.3164472"
 Parameter: ZMAX -> "-35.8213003"
 Parameter: ZMIN -> "-42.8213003"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "59" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "59" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "59"
 Parameter: NPOS -> "42"
Evaluating: 59-42
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.461852887"
Evaluating: 82.1644692*(0.461852887-0.5)
 Parameter: XPOS <- "-3.13433729"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.330704791"
Evaluating: 82.1644692*(0.330704791-0.5)
 Parameter: YPOS <- "-13.910051"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.925232684"
Evaluating: 85*(0.925232684-0.5)+0
 Parameter: ZPOS <- "36.1447781"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.1447781" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.1447781" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.13433729"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.13433729-0
 Parameter: XTRAN <- "-3.13433729"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.910051"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.910051-0
 Parameter: YTRAN <- "-13.910051"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.1447781"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.1447781-0
 Parameter: ZTRAN <- "36.1447781"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.13433729"
 Parameter: YTRAN -> "-13.910051"
 Parameter: ZTRAN -> "36.1447781"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -3.134337  -13.910051   36.144778
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.604379309"
Evaluating: 0.604379309*360.0
 Parameter: XPHI <- "217.576551"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.2964351"
Evaluating: 0.2964351*360.0
 Parameter: YPHI <- "106.716636"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.803620979"
Evaluating: 0.803620979*360.0
 Parameter: ZPHI <- "289.303552"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.13433729"
 Parameter: YPOS -> "-13.910051"
 Parameter: ZPOS -> "36.1447781"
 Parameter: XPHI -> "217.576551"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.792539   -0.609821
    0.000000    0.609821   -0.792539

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  142.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.13433729"
 Parameter: YPOS -> "-13.910051"
 Parameter: ZPOS -> "36.1447781"
 Parameter: YPHI -> "106.716636"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.287639    0.000000   -0.957739
    0.000000    1.000000    0.000000
    0.957739    0.000000   -0.287639

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  106.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.13433729"
 Parameter: YPOS -> "-13.910051"
 Parameter: ZPOS -> "36.1447781"
 Parameter: ZPHI -> "289.303552"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.330573   -0.943780    0.000000
    0.943780    0.330573    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.134337 XMAX =   -3.134337 XAVE =   -3.134337
    YMIN =  -13.910051 YMAX =  -13.910051 YAVE =  -13.910051
    ZMIN =   36.144778 ZMAX =   36.144778 ZAVE =   36.144778
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.13433729"
Evaluating: -3.13433729+3.5
 Parameter: XMAX <- "0.36566271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.910051"
Evaluating: -13.910051+3.5
 Parameter: YMAX <- "-10.410051"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.1447781"
Evaluating: 36.1447781+3.5
 Parameter: ZMAX <- "39.6447781"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.13433729"
Evaluating: -3.13433729-3.5
 Parameter: XMIN <- "-6.63433729"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.910051"
Evaluating: -13.910051-3.5
 Parameter: YMIN <- "-17.410051"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.1447781"
Evaluating: 36.1447781-3.5
 Parameter: ZMIN <- "32.6447781"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.36566271"
 Parameter: XMIN -> "-6.63433729"
 Parameter: YMAX -> "-10.410051"
 Parameter: YMIN -> "-17.410051"
 Parameter: ZMAX -> "39.6447781"
 Parameter: ZMIN -> "32.6447781"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "60" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "60" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "60"
 Parameter: NPOS -> "42"
Evaluating: 60-42
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "6.790821452E-02"
Evaluating: 82.1644692*(6.790821452E-02-0.5)
 Parameter: XPOS <- "-35.5025922"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.829093761"
Evaluating: 82.1644692*(0.829093761-0.5)
 Parameter: YPOS <- "27.0398142"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.296050933"
Evaluating: 85*(0.296050933-0.5)+0
 Parameter: ZPOS <- "-17.3356707"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.3356707" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.5025922"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.5025922-0
 Parameter: XTRAN <- "-35.5025922"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.0398142"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.0398142-0
 Parameter: YTRAN <- "27.0398142"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.3356707"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.3356707-0
 Parameter: ZTRAN <- "-17.3356707"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.5025922"
 Parameter: YTRAN -> "27.0398142"
 Parameter: ZTRAN -> "-17.3356707"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -35.502592   27.039814  -17.335671
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.548722793"
Evaluating: 0.548722793*360.0
 Parameter: XPHI <- "197.540205"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420639508"
Evaluating: 0.420639508*360.0
 Parameter: YPHI <- "151.430223"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.810463843"
Evaluating: 0.810463843*360.0
 Parameter: ZPHI <- "291.766983"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.5025922"
 Parameter: YPOS -> "27.0398142"
 Parameter: ZPOS -> "-17.3356707"
 Parameter: XPHI -> "197.540205"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.953506   -0.301375
    0.000000    0.301375   -0.953506

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.5025922"
 Parameter: YPOS -> "27.0398142"
 Parameter: ZPOS -> "-17.3356707"
 Parameter: YPHI -> "151.430223"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.878235    0.000000   -0.478229
    0.000000    1.000000    0.000000
    0.478229    0.000000   -0.878235

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  151.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.5025922"
 Parameter: YPOS -> "27.0398142"
 Parameter: ZPOS -> "-17.3356707"
 Parameter: ZPHI -> "291.766983"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.370833   -0.928700    0.000000
    0.928700    0.370833    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.502592 XMAX =  -35.502592 XAVE =  -35.502592
    YMIN =   27.039814 YMAX =   27.039814 YAVE =   27.039814
    ZMIN =  -17.335671 ZMAX =  -17.335671 ZAVE =  -17.335671
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.5025922"
Evaluating: -35.5025922+3.5
 Parameter: XMAX <- "-32.0025922"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.0398142"
Evaluating: 27.0398142+3.5
 Parameter: YMAX <- "30.5398142"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.3356707"
Evaluating: -17.3356707+3.5
 Parameter: ZMAX <- "-13.8356707"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.5025922"
Evaluating: -35.5025922-3.5
 Parameter: XMIN <- "-39.0025922"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.0398142"
Evaluating: 27.0398142-3.5
 Parameter: YMIN <- "23.5398142"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.3356707"
Evaluating: -17.3356707-3.5
 Parameter: ZMIN <- "-20.8356707"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.0025922"
 Parameter: XMIN -> "-39.0025922"
 Parameter: YMAX -> "30.5398142"
 Parameter: YMIN -> "23.5398142"
 Parameter: ZMAX -> "-13.8356707"
 Parameter: ZMIN -> "-20.8356707"
 SELRPN>     13 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      5 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26720 NEG      CLA      18       CLA     -**** MEMB     POPC     172      C14           2.9243
26720 NEG      CLA      18       CLA     -**** MEMB     POPS     189      O13B          2.9206
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "60" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "60"
 Parameter: NPOS -> "42"
Evaluating: 60-42
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.442473844"
Evaluating: 82.1644692*(0.442473844-0.5)
 Parameter: XPOS <- "-4.72660607"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "1.893389102E-02"
Evaluating: 82.1644692*(1.893389102E-02-0.5)
 Parameter: YPOS <- "-39.5265415"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.302257701"
Evaluating: 85*(0.302257701-0.5)+0
 Parameter: ZPOS <- "-16.8080954"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.8080954" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.502592 XMAX =  -35.502592 XAVE =  -35.502592
    YMIN =   27.039814 YMAX =   27.039814 YAVE =   27.039814
    ZMIN =  -17.335671 ZMAX =  -17.335671 ZAVE =  -17.335671
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.72660607"
 RDCMND substituted energy or value "?XAVE" to "-35.5025922"
Evaluating: -4.72660607--35.5025922
 Parameter: XTRAN <- "30.7759861"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.5265415"
 RDCMND substituted energy or value "?YAVE" to "27.0398142"
Evaluating: -39.5265415-27.0398142
 Parameter: YTRAN <- "-66.5663557"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.8080954"
 RDCMND substituted energy or value "?ZAVE" to "-17.3356707"
Evaluating: -16.8080954--17.3356707
 Parameter: ZTRAN <- "0.5275753"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.7759861"
 Parameter: YTRAN -> "-66.5663557"
 Parameter: ZTRAN -> "0.5275753"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    30.775986  -66.566356    0.527575
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.998093943E-02"
Evaluating: 2.998093943E-02*360.0
 Parameter: XPHI <- "10.7931382"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.605119362"
Evaluating: 0.605119362*360.0
 Parameter: YPHI <- "217.84297"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.204106034"
Evaluating: 0.204106034*360.0
 Parameter: ZPHI <- "73.4781722"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.72660607"
 Parameter: YPOS -> "-39.5265415"
 Parameter: ZPOS -> "-16.8080954"
 Parameter: XPHI -> "10.7931382"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.982310    0.187264
    0.000000   -0.187264    0.982310

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   10.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.72660607"
 Parameter: YPOS -> "-39.5265415"
 Parameter: ZPOS -> "-16.8080954"
 Parameter: YPHI -> "217.84297"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.789695    0.000000    0.613499
    0.000000    1.000000    0.000000
   -0.613499    0.000000   -0.789695

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  142.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.72660607"
 Parameter: YPOS -> "-39.5265415"
 Parameter: ZPOS -> "-16.8080954"
 Parameter: ZPHI -> "73.4781722"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.284381    0.958711    0.000000
   -0.958711    0.284381    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   73.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.726606 XMAX =   -4.726606 XAVE =   -4.726606
    YMIN =  -39.526542 YMAX =  -39.526542 YAVE =  -39.526542
    ZMIN =  -16.808095 ZMAX =  -16.808095 ZAVE =  -16.808095
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.72660606"
Evaluating: -4.72660606+3.5
 Parameter: XMAX <- "-1.22660606"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.5265415"
Evaluating: -39.5265415+3.5
 Parameter: YMAX <- "-36.0265415"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.8080954"
Evaluating: -16.8080954+3.5
 Parameter: ZMAX <- "-13.3080954"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.72660606"
Evaluating: -4.72660606-3.5
 Parameter: XMIN <- "-8.22660606"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.5265415"
Evaluating: -39.5265415-3.5
 Parameter: YMIN <- "-43.0265415"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.8080954"
Evaluating: -16.8080954-3.5
 Parameter: ZMIN <- "-20.3080954"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.22660606"
 Parameter: XMIN -> "-8.22660606"
 Parameter: YMAX -> "-36.0265415"
 Parameter: YMIN -> "-43.0265415"
 Parameter: ZMAX -> "-13.3080954"
 Parameter: ZMIN -> "-20.3080954"
 SELRPN>     10 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      4 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26720 NEG      CLA      18       CLA     -**** MEMB     POPC     166      C12           2.7675
26720 NEG      CLA      18       CLA     -**** MEMB     POPC     166      C11           2.7585
26720 NEG      CLA      18       CLA     -**** MEMB     POPC     166      O12           3.9452
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "60" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "60"
 Parameter: NPOS -> "42"
Evaluating: 60-42
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.510849387"
Evaluating: 82.1644692*(0.510849387-0.5)
 Parameter: XPOS <- "0.891434124"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.940580039"
Evaluating: 82.1644692*(0.940580039-0.5)
 Parameter: YPOS <- "36.200025"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.863562024"
Evaluating: 85*(0.863562024-0.5)+0
 Parameter: ZPOS <- "30.902772"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.902772" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.902772" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.726606 XMAX =   -4.726606 XAVE =   -4.726606
    YMIN =  -39.526542 YMAX =  -39.526542 YAVE =  -39.526542
    ZMIN =  -16.808095 ZMAX =  -16.808095 ZAVE =  -16.808095
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.891434124"
 RDCMND substituted energy or value "?XAVE" to "-4.72660606"
Evaluating: 0.891434124--4.72660606
 Parameter: XTRAN <- "5.61804018"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.200025"
 RDCMND substituted energy or value "?YAVE" to "-39.5265415"
Evaluating: 36.200025--39.5265415
 Parameter: YTRAN <- "75.7265665"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.902772"
 RDCMND substituted energy or value "?ZAVE" to "-16.8080954"
Evaluating: 30.902772--16.8080954
 Parameter: ZTRAN <- "47.7108674"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.61804018"
 Parameter: YTRAN -> "75.7265665"
 Parameter: ZTRAN -> "47.7108674"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     5.618040   75.726567   47.710867
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.4865419E-02"
Evaluating: 9.4865419E-02*360.0
 Parameter: XPHI <- "34.1515508"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.982353789"
Evaluating: 0.982353789*360.0
 Parameter: YPHI <- "353.647364"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.303085666"
Evaluating: 0.303085666*360.0
 Parameter: ZPHI <- "109.11084"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.891434124"
 Parameter: YPOS -> "36.200025"
 Parameter: ZPOS -> "30.902772"
 Parameter: XPHI -> "34.1515508"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.827556    0.561384
    0.000000   -0.561384    0.827556

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.891434124"
 Parameter: YPOS -> "36.200025"
 Parameter: ZPOS -> "30.902772"
 Parameter: YPHI -> "353.647364"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.993860    0.000000    0.110647
    0.000000    1.000000    0.000000
   -0.110647    0.000000    0.993860

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    6.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.891434124"
 Parameter: YPOS -> "36.200025"
 Parameter: ZPOS -> "30.902772"
 Parameter: ZPHI -> "109.11084"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.327397    0.944887    0.000000
   -0.944887   -0.327397    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  109.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.891434 XMAX =    0.891434 XAVE =    0.891434
    YMIN =   36.200025 YMAX =   36.200025 YAVE =   36.200025
    ZMIN =   30.902772 ZMAX =   30.902772 ZAVE =   30.902772
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.891434117"
Evaluating: 0.891434117+3.5
 Parameter: XMAX <- "4.39143412"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.200025"
Evaluating: 36.200025+3.5
 Parameter: YMAX <- "39.700025"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.902772"
Evaluating: 30.902772+3.5
 Parameter: ZMAX <- "34.402772"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.891434117"
Evaluating: 0.891434117-3.5
 Parameter: XMIN <- "-2.60856588"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.200025"
Evaluating: 36.200025-3.5
 Parameter: YMIN <- "32.700025"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.902772"
Evaluating: 30.902772-3.5
 Parameter: ZMIN <- "27.402772"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.39143412"
 Parameter: XMIN -> "-2.60856588"
 Parameter: YMAX -> "39.700025"
 Parameter: YMIN -> "32.700025"
 Parameter: ZMAX -> "34.402772"
 Parameter: ZMIN -> "27.402772"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "61" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "61" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "42"
Evaluating: 61-42
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.527572192"
Evaluating: 82.1644692*(0.527572192-0.5)
 Parameter: XPOS <- "2.26545452"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.198484556"
Evaluating: 82.1644692*(0.198484556-0.5)
 Parameter: YPOS <- "-24.7738564"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.844212233"
Evaluating: 85*(0.844212233-0.5)+0
 Parameter: ZPOS <- "29.2580398"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.2580398" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.2580398" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.26545452"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 2.26545452-0
 Parameter: XTRAN <- "2.26545452"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.7738564"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.7738564-0
 Parameter: YTRAN <- "-24.7738564"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.2580398"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.2580398-0
 Parameter: ZTRAN <- "29.2580398"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.26545452"
 Parameter: YTRAN -> "-24.7738564"
 Parameter: ZTRAN -> "29.2580398"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR     2.265455  -24.773856   29.258040
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598784985"
Evaluating: 0.598784985*360.0
 Parameter: XPHI <- "215.562595"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.686565363"
Evaluating: 0.686565363*360.0
 Parameter: YPHI <- "247.163531"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274928537"
Evaluating: 0.274928537*360.0
 Parameter: ZPHI <- "98.9742733"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.26545452"
 Parameter: YPOS -> "-24.7738564"
 Parameter: ZPOS -> "29.2580398"
 Parameter: XPHI -> "215.562595"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.813481   -0.581592
    0.000000    0.581592   -0.813481

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  144.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.26545452"
 Parameter: YPOS -> "-24.7738564"
 Parameter: ZPOS -> "29.2580398"
 Parameter: YPHI -> "247.163531"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.388102    0.000000    0.921616
    0.000000    1.000000    0.000000
   -0.921616    0.000000   -0.388102

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  112.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.26545452"
 Parameter: YPOS -> "-24.7738564"
 Parameter: ZPOS -> "29.2580398"
 Parameter: ZPHI -> "98.9742733"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.155991    0.987758    0.000000
   -0.987758   -0.155991    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   98.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.265455 XMAX =    2.265455 XAVE =    2.265455
    YMIN =  -24.773856 YMAX =  -24.773856 YAVE =  -24.773856
    ZMIN =   29.258040 ZMAX =   29.258040 ZAVE =   29.258040
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.26545452"
Evaluating: 2.26545452+3.5
 Parameter: XMAX <- "5.76545452"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.7738564"
Evaluating: -24.7738564+3.5
 Parameter: YMAX <- "-21.2738564"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.2580398"
Evaluating: 29.2580398+3.5
 Parameter: ZMAX <- "32.7580398"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.26545452"
Evaluating: 2.26545452-3.5
 Parameter: XMIN <- "-1.23454548"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.7738564"
Evaluating: -24.7738564-3.5
 Parameter: YMIN <- "-28.2738564"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.2580398"
Evaluating: 29.2580398-3.5
 Parameter: ZMIN <- "25.7580398"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.76545452"
 Parameter: XMIN -> "-1.23454548"
 Parameter: YMAX -> "-21.2738564"
 Parameter: YMIN -> "-28.2738564"
 Parameter: ZMAX -> "32.7580398"
 Parameter: ZMIN -> "25.7580398"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      1 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26721 NEG      CLA      19       CLA     -**** POS      POT      7        POT           3.1462
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "61" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "61"
 Parameter: NPOS -> "42"
Evaluating: 61-42
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.48903158"
Evaluating: 82.1644692*(0.48903158-0.5)
 Parameter: XPOS <- "-0.901214407"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "8.998926883E-02"
Evaluating: 82.1644692*(8.998926883E-02-0.5)
 Parameter: YPOS <- "-33.6883141"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.973142343"
Evaluating: 85*(0.973142343-0.5)+0
 Parameter: ZPOS <- "40.2170992"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.2170992" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.2170992" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.265455 XMAX =    2.265455 XAVE =    2.265455
    YMIN =  -24.773856 YMAX =  -24.773856 YAVE =  -24.773856
    ZMIN =   29.258040 ZMAX =   29.258040 ZAVE =   29.258040
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.901214407"
 RDCMND substituted energy or value "?XAVE" to "2.26545452"
Evaluating: -0.901214407-2.26545452
 Parameter: XTRAN <- "-3.16666893"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.6883141"
 RDCMND substituted energy or value "?YAVE" to "-24.7738564"
Evaluating: -33.6883141--24.7738564
 Parameter: YTRAN <- "-8.9144577"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.2170992"
 RDCMND substituted energy or value "?ZAVE" to "29.2580398"
Evaluating: 40.2170992-29.2580398
 Parameter: ZTRAN <- "10.9590594"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.16666893"
 Parameter: YTRAN -> "-8.9144577"
 Parameter: ZTRAN -> "10.9590594"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -3.166669   -8.914458   10.959059
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.744158489"
Evaluating: 0.744158489*360.0
 Parameter: XPHI <- "267.897056"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.633568398"
Evaluating: 0.633568398*360.0
 Parameter: YPHI <- "228.084623"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.935308378"
Evaluating: 0.935308378*360.0
 Parameter: ZPHI <- "336.711016"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.901214407"
 Parameter: YPOS -> "-33.6883141"
 Parameter: ZPOS -> "40.2170992"
 Parameter: XPHI -> "267.897056"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.036695   -0.999327
    0.000000    0.999327   -0.036695

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   92.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.901214407"
 Parameter: YPOS -> "-33.6883141"
 Parameter: ZPOS -> "40.2170992"
 Parameter: YPHI -> "228.084623"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.668032    0.000000    0.744132
    0.000000    1.000000    0.000000
   -0.744132    0.000000   -0.668032

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  131.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.901214407"
 Parameter: YPOS -> "-33.6883141"
 Parameter: ZPOS -> "40.2170992"
 Parameter: ZPHI -> "336.711016"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.918522   -0.395369    0.000000
    0.395369    0.918522    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.901214 XMAX =   -0.901214 XAVE =   -0.901214
    YMIN =  -33.688314 YMAX =  -33.688314 YAVE =  -33.688314
    ZMIN =   40.217099 ZMAX =   40.217099 ZAVE =   40.217099
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.901214405"
Evaluating: -0.901214405+3.5
 Parameter: XMAX <- "2.59878559"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.6883141"
Evaluating: -33.6883141+3.5
 Parameter: YMAX <- "-30.1883141"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.2170992"
Evaluating: 40.2170992+3.5
 Parameter: ZMAX <- "43.7170992"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.901214405"
Evaluating: -0.901214405-3.5
 Parameter: XMIN <- "-4.40121441"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.6883141"
Evaluating: -33.6883141-3.5
 Parameter: YMIN <- "-37.1883141"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.2170992"
Evaluating: 40.2170992-3.5
 Parameter: ZMIN <- "36.7170992"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.59878559"
 Parameter: XMIN -> "-4.40121441"
 Parameter: YMAX -> "-30.1883141"
 Parameter: YMIN -> "-37.1883141"
 Parameter: ZMAX -> "43.7170992"
 Parameter: ZMIN -> "36.7170992"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "62" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "62" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "62"
 Parameter: NPOS -> "42"
Evaluating: 62-42
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.928518032"
Evaluating: 82.1644692*(0.928518032-0.5)
 Parameter: XPOS <- "35.2089566"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.939310947"
Evaluating: 82.1644692*(0.939310947-0.5)
 Parameter: YPOS <- "36.0957508"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.307160372"
Evaluating: 85*(0.307160372-0.5)+0
 Parameter: ZPOS <- "-16.3913684"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.3913684" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.2089566"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 35.2089566-0
 Parameter: XTRAN <- "35.2089566"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.0957508"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 36.0957508-0
 Parameter: YTRAN <- "36.0957508"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.3913684"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.3913684-0
 Parameter: ZTRAN <- "-16.3913684"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "35.2089566"
 Parameter: YTRAN -> "36.0957508"
 Parameter: ZTRAN -> "-16.3913684"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    35.208957   36.095751  -16.391368
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.935572768"
Evaluating: 0.935572768*360.0
 Parameter: XPHI <- "336.806196"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.991861888"
Evaluating: 0.991861888*360.0
 Parameter: YPHI <- "357.07028"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.528461474"
Evaluating: 0.528461474*360.0
 Parameter: ZPHI <- "190.246131"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.2089566"
 Parameter: YPOS -> "36.0957508"
 Parameter: ZPOS -> "-16.3913684"
 Parameter: XPHI -> "336.806196"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.919178   -0.393843
    0.000000    0.393843    0.919178

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.2089566"
 Parameter: YPOS -> "36.0957508"
 Parameter: ZPOS -> "-16.3913684"
 Parameter: YPHI -> "357.07028"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.998693    0.000000    0.051111
    0.000000    1.000000    0.000000
   -0.051111    0.000000    0.998693

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    2.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.2089566"
 Parameter: YPOS -> "36.0957508"
 Parameter: ZPOS -> "-16.3913684"
 Parameter: ZPHI -> "190.246131"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.984053   -0.177877    0.000000
    0.177877   -0.984053    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  169.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.208957 XMAX =   35.208957 XAVE =   35.208957
    YMIN =   36.095751 YMAX =   36.095751 YAVE =   36.095751
    ZMIN =  -16.391368 ZMAX =  -16.391368 ZAVE =  -16.391368
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.2089566"
Evaluating: 35.2089566+3.5
 Parameter: XMAX <- "38.7089566"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.0957508"
Evaluating: 36.0957508+3.5
 Parameter: YMAX <- "39.5957508"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.3913684"
Evaluating: -16.3913684+3.5
 Parameter: ZMAX <- "-12.8913684"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.2089566"
Evaluating: 35.2089566-3.5
 Parameter: XMIN <- "31.7089566"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.0957508"
Evaluating: 36.0957508-3.5
 Parameter: YMIN <- "32.5957508"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.3913684"
Evaluating: -16.3913684-3.5
 Parameter: ZMIN <- "-19.8913684"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.7089566"
 Parameter: XMIN -> "31.7089566"
 Parameter: YMAX -> "39.5957508"
 Parameter: YMIN -> "32.5957508"
 Parameter: ZMAX -> "-12.8913684"
 Parameter: ZMIN -> "-19.8913684"
 SELRPN>     26 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     13 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26722 NEG      CLA      20       CLA     -**** MEMB     POPC     187      O22           3.2155
26722 NEG      CLA      20       CLA     -**** MEMB     POPC     195      C22           3.7418
26722 NEG      CLA      20       CLA     -**** MEMB     POPC     199      C13           3.9909
26722 NEG      CLA      20       CLA     -**** MEMB     POPC     199      C14           3.0888
26722 NEG      CLA      20       CLA     -**** MEMB     POPC     199      C21           3.2475
26722 NEG      CLA      20       CLA     -**** MEMB     POPC     199      O22           3.1105
26722 NEG      CLA      20       CLA     -**** MEMB     POPC     199      C22           3.4996
26722 NEG      CLA      20       CLA     -**** MEMB     POPC     199      C23           3.0714
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "62" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "62"
 Parameter: NPOS -> "42"
Evaluating: 62-42
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.214044407"
Evaluating: 82.1644692*(0.214044407-0.5)
 Parameter: XPOS <- "-23.4953895"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.364841802"
Evaluating: 82.1644692*(0.364841802-0.5)
 Parameter: YPOS <- "-11.1052016"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.838883532"
Evaluating: 85*(0.838883532-0.5)+0
 Parameter: ZPOS <- "28.8051002"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.8051002" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.8051002" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.208957 XMAX =   35.208957 XAVE =   35.208957
    YMIN =   36.095751 YMAX =   36.095751 YAVE =   36.095751
    ZMIN =  -16.391368 ZMAX =  -16.391368 ZAVE =  -16.391368
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.4953895"
 RDCMND substituted energy or value "?XAVE" to "35.2089566"
Evaluating: -23.4953895-35.2089566
 Parameter: XTRAN <- "-58.7043461"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.1052016"
 RDCMND substituted energy or value "?YAVE" to "36.0957508"
Evaluating: -11.1052016-36.0957508
 Parameter: YTRAN <- "-47.2009524"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.8051002"
 RDCMND substituted energy or value "?ZAVE" to "-16.3913684"
Evaluating: 28.8051002--16.3913684
 Parameter: ZTRAN <- "45.1964686"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.7043461"
 Parameter: YTRAN -> "-47.2009524"
 Parameter: ZTRAN -> "45.1964686"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR   -58.704346  -47.200952   45.196469
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71322708"
Evaluating: 0.71322708*360.0
 Parameter: XPHI <- "256.761749"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537157517"
Evaluating: 0.537157517*360.0
 Parameter: YPHI <- "193.376706"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.88831352"
Evaluating: 0.88831352*360.0
 Parameter: ZPHI <- "319.792867"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.4953895"
 Parameter: YPOS -> "-11.1052016"
 Parameter: ZPOS -> "28.8051002"
 Parameter: XPHI -> "256.761749"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.229001   -0.973426
    0.000000    0.973426   -0.229001

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.4953895"
 Parameter: YPOS -> "-11.1052016"
 Parameter: ZPOS -> "28.8051002"
 Parameter: YPHI -> "193.376706"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.972870    0.000000    0.231352
    0.000000    1.000000    0.000000
   -0.231352    0.000000   -0.972870

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.4953895"
 Parameter: YPOS -> "-11.1052016"
 Parameter: ZPOS -> "28.8051002"
 Parameter: ZPHI -> "319.792867"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.763716   -0.645553    0.000000
    0.645553    0.763716    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   40.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.495389 XMAX =  -23.495389 XAVE =  -23.495389
    YMIN =  -11.105202 YMAX =  -11.105202 YAVE =  -11.105202
    ZMIN =   28.805100 ZMAX =   28.805100 ZAVE =   28.805100
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.4953895"
Evaluating: -23.4953895+3.5
 Parameter: XMAX <- "-19.9953895"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.1052016"
Evaluating: -11.1052016+3.5
 Parameter: YMAX <- "-7.6052016"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.8051002"
Evaluating: 28.8051002+3.5
 Parameter: ZMAX <- "32.3051002"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.4953895"
Evaluating: -23.4953895-3.5
 Parameter: XMIN <- "-26.9953895"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.1052016"
Evaluating: -11.1052016-3.5
 Parameter: YMIN <- "-14.6052016"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.8051002"
Evaluating: 28.8051002-3.5
 Parameter: ZMIN <- "25.3051002"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.9953895"
 Parameter: XMIN -> "-26.9953895"
 Parameter: YMAX -> "-7.6052016"
 Parameter: YMIN -> "-14.6052016"
 Parameter: ZMAX -> "32.3051002"
 Parameter: ZMIN -> "25.3051002"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "63" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "63" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "63"
 Parameter: NPOS -> "42"
Evaluating: 63-42
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.690723591"
Evaluating: 82.1644692*(0.690723591-0.5)
 Parameter: XPOS <- "15.6707026"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.556887254"
Evaluating: 82.1644692*(0.556887254-0.5)
 Parameter: YPOS <- "4.67411103"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.589595372"
Evaluating: 85*(0.589595372-0.5)+0
 Parameter: ZPOS <- "7.61560662"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.61560662" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.61560662" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "63" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "63"
 Parameter: NPOS -> "42"
Evaluating: 63-42
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.690186064"
Evaluating: 82.1644692*(0.690186064-0.5)
 Parameter: XPOS <- "15.626537"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.200803574"
Evaluating: 82.1644692*(0.200803574-0.5)
 Parameter: YPOS <- "-24.5833155"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.836998701"
Evaluating: 85*(0.836998701-0.5)+0
 Parameter: ZPOS <- "28.6448896"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.6448896" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.6448896" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.626537"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.626537-0
 Parameter: XTRAN <- "15.626537"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.5833155"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.5833155-0
 Parameter: YTRAN <- "-24.5833155"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.6448896"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.6448896-0
 Parameter: ZTRAN <- "28.6448896"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.626537"
 Parameter: YTRAN -> "-24.5833155"
 Parameter: ZTRAN -> "28.6448896"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    15.626537  -24.583316   28.644890
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.552979626"
Evaluating: 0.552979626*360.0
 Parameter: XPHI <- "199.072665"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.243656097"
Evaluating: 0.243656097*360.0
 Parameter: YPHI <- "87.7161949"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.328809422"
Evaluating: 0.328809422*360.0
 Parameter: ZPHI <- "118.371392"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.626537"
 Parameter: YPOS -> "-24.5833155"
 Parameter: ZPOS -> "28.6448896"
 Parameter: XPHI -> "199.072665"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.945105   -0.326767
    0.000000    0.326767   -0.945105

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  160.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.626537"
 Parameter: YPOS -> "-24.5833155"
 Parameter: ZPOS -> "28.6448896"
 Parameter: YPHI -> "87.7161949"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.039849    0.000000   -0.999206
    0.000000    1.000000    0.000000
    0.999206    0.000000    0.039849

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   87.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.626537"
 Parameter: YPOS -> "-24.5833155"
 Parameter: ZPOS -> "28.6448896"
 Parameter: ZPHI -> "118.371392"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.475185    0.879886    0.000000
   -0.879886   -0.475185    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  118.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.626537 XMAX =   15.626537 XAVE =   15.626537
    YMIN =  -24.583316 YMAX =  -24.583316 YAVE =  -24.583316
    ZMIN =   28.644890 ZMAX =   28.644890 ZAVE =   28.644890
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.626537"
Evaluating: 15.626537+3.5
 Parameter: XMAX <- "19.126537"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.5833155"
Evaluating: -24.5833155+3.5
 Parameter: YMAX <- "-21.0833155"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.6448896"
Evaluating: 28.6448896+3.5
 Parameter: ZMAX <- "32.1448896"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.626537"
Evaluating: 15.626537-3.5
 Parameter: XMIN <- "12.126537"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.5833155"
Evaluating: -24.5833155-3.5
 Parameter: YMIN <- "-28.0833155"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.6448896"
Evaluating: 28.6448896-3.5
 Parameter: ZMIN <- "25.1448896"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.126537"
 Parameter: XMIN -> "12.126537"
 Parameter: YMAX -> "-21.0833155"
 Parameter: YMIN -> "-28.0833155"
 Parameter: ZMAX -> "32.1448896"
 Parameter: ZMIN -> "25.1448896"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "64" and "64".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "64" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "64"
 Parameter: NPOS -> "42"
Evaluating: 64-42
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.431363047"
Evaluating: 82.1644692*(0.431363047-0.5)
 Parameter: XPOS <- "-5.63951881"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.688934786"
Evaluating: 82.1644692*(0.688934786-0.5)
 Parameter: YPOS <- "15.5237264"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.318293178"
Evaluating: 85*(0.318293178-0.5)+0
 Parameter: ZPOS <- "-15.4450799"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.4450799" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.63951881"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.63951881-0
 Parameter: XTRAN <- "-5.63951881"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.5237264"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.5237264-0
 Parameter: YTRAN <- "15.5237264"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.4450799"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.4450799-0
 Parameter: ZTRAN <- "-15.4450799"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.63951881"
 Parameter: YTRAN -> "15.5237264"
 Parameter: ZTRAN -> "-15.4450799"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    -5.639519   15.523726  -15.445080
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.983397269"
Evaluating: 0.983397269*360.0
 Parameter: XPHI <- "354.023017"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.437204773"
Evaluating: 0.437204773*360.0
 Parameter: YPHI <- "157.393718"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802824564"
Evaluating: 0.802824564*360.0
 Parameter: ZPHI <- "289.016843"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.63951881"
 Parameter: YPOS -> "15.5237264"
 Parameter: ZPOS -> "-15.4450799"
 Parameter: XPHI -> "354.023017"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994564   -0.104129
    0.000000    0.104129    0.994564

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    5.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.63951881"
 Parameter: YPOS -> "15.5237264"
 Parameter: ZPOS -> "-15.4450799"
 Parameter: YPHI -> "157.393718"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.923168    0.000000   -0.384397
    0.000000    1.000000    0.000000
    0.384397    0.000000   -0.923168

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  157.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.63951881"
 Parameter: YPOS -> "15.5237264"
 Parameter: ZPOS -> "-15.4450799"
 Parameter: ZPHI -> "289.016843"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.325846   -0.945423    0.000000
    0.945423    0.325846    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.639519 XMAX =   -5.639519 XAVE =   -5.639519
    YMIN =   15.523726 YMAX =   15.523726 YAVE =   15.523726
    ZMIN =  -15.445080 ZMAX =  -15.445080 ZAVE =  -15.445080
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.63951881"
Evaluating: -5.63951881+3.5
 Parameter: XMAX <- "-2.13951881"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.5237264"
Evaluating: 15.5237264+3.5
 Parameter: YMAX <- "19.0237264"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.4450799"
Evaluating: -15.4450799+3.5
 Parameter: ZMAX <- "-11.9450799"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.63951881"
Evaluating: -5.63951881-3.5
 Parameter: XMIN <- "-9.13951881"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.5237264"
Evaluating: 15.5237264-3.5
 Parameter: YMIN <- "12.0237264"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.4450799"
Evaluating: -15.4450799-3.5
 Parameter: ZMIN <- "-18.9450799"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.13951881"
 Parameter: XMIN -> "-9.13951881"
 Parameter: YMAX -> "19.0237264"
 Parameter: YMIN -> "12.0237264"
 Parameter: ZMAX -> "-11.9450799"
 Parameter: ZMIN -> "-18.9450799"
 SELRPN>     32 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>     12 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     104      C21           3.7257
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     104      O22           3.1330
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     104      C22           3.8740
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     104      C23           3.6960
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     117      N             3.2190
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     117      C12           3.7049
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     117      C15           1.9230
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     117      C11           3.8882
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     117      C23           3.8123
26724 NEG      CLA      22       CLA     -**** MEMB     POPC     117      C24           3.1695
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "42"
 Comparing "64" and "42".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "64"
 Parameter: NPOS -> "42"
Evaluating: 64-42
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.667874306"
Evaluating: 82.1644692*(0.667874306-0.5)
 Parameter: XPOS <- "13.7933032"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "82.1644692"
 RDCMND substituted energy or value "?RANDOM" to "0.933090452"
Evaluating: 82.1644692*(0.933090452-0.5)
 Parameter: YPOS <- "35.5846471"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.08922728E-02"
Evaluating: 85*(4.08922728E-02-0.5)+0
 Parameter: ZPOS <- "-39.0241568"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.0241568" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.639519 XMAX =   -5.639519 XAVE =   -5.639519
    YMIN =   15.523726 YMAX =   15.523726 YAVE =   15.523726
    ZMIN =  -15.445080 ZMAX =  -15.445080 ZAVE =  -15.445080
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.7933032"
 RDCMND substituted energy or value "?XAVE" to "-5.63951881"
Evaluating: 13.7933032--5.63951881
 Parameter: XTRAN <- "19.432822"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.5846471"
 RDCMND substituted energy or value "?YAVE" to "15.5237264"
Evaluating: 35.5846471-15.5237264
 Parameter: YTRAN <- "20.0609207"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.0241568"
 RDCMND substituted energy or value "?ZAVE" to "-15.4450799"
Evaluating: -39.0241568--15.4450799
 Parameter: ZTRAN <- "-23.5790769"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.432822"
 Parameter: YTRAN -> "20.0609207"
 Parameter: ZTRAN -> "-23.5790769"
 SELRPN>      1 atoms have been selected out of  26724
 TRANSLATION VECTOR    19.432822   20.060921  -23.579077
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452988014"
Evaluating: 0.452988014*360.0
 Parameter: XPHI <- "163.075685"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.980984866"
Evaluating: 0.980984866*360.0
 Parameter: YPHI <- "353.154552"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479681534"
Evaluating: 0.479681534*360.0
 Parameter: ZPHI <- "172.685352"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.7933032"
 Parameter: YPOS -> "35.5846471"
 Parameter: ZPOS -> "-39.0241568"
 Parameter: XPHI -> "163.075685"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.956690    0.291108
    0.000000   -0.291108   -0.956690

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.7933032"
 Parameter: YPOS -> "35.5846471"
 Parameter: ZPOS -> "-39.0241568"
 Parameter: YPHI -> "353.154552"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
    0.992871    0.000000    0.119192
    0.000000    1.000000    0.000000
   -0.119192    0.000000    0.992871

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    6.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.7933032"
 Parameter: YPOS -> "35.5846471"
 Parameter: ZPOS -> "-39.0241568"
 Parameter: ZPHI -> "172.685352"
 SELRPN>      1 atoms have been selected out of  26724
 ROTATION MATRIX
   -0.991862    0.127318    0.000000
   -0.127318   -0.991862    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  172.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26724
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.793303 XMAX =   13.793303 XAVE =   13.793303
    YMIN =   35.584647 YMAX =   35.584647 YAVE =   35.584647
    ZMIN =  -39.024157 ZMAX =  -39.024157 ZAVE =  -39.024157
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.7933032"
Evaluating: 13.7933032+3.5
 Parameter: XMAX <- "17.2933032"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.5846471"
Evaluating: 35.5846471+3.5
 Parameter: YMAX <- "39.0846471"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.0241568"
Evaluating: -39.0241568+3.5
 Parameter: ZMAX <- "-35.5241568"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.7933032"
Evaluating: 13.7933032-3.5
 Parameter: XMIN <- "10.2933032"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.5846471"
Evaluating: 35.5846471-3.5
 Parameter: YMIN <- "32.0846471"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.0241568"
Evaluating: -39.0241568-3.5
 Parameter: ZMIN <- "-42.5241568"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.2933032"
 Parameter: XMIN -> "10.2933032"
 Parameter: YMAX -> "39.0846471"
 Parameter: YMIN -> "32.0846471"
 Parameter: ZMAX -> "-35.5241568"
 Parameter: ZMIN -> "-42.5241568"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38875
 SELRPN>      0 atoms have been selected out of  38875

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "64"
 Comparing "65" and "64".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "POT"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "42"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "22"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     42 atoms have been selected out of  26724
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "26661"
 Parameter: POSAT <- "26661"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     22 atoms have been selected out of  26724
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "26703"
 Parameter: NEGAT <- "26703"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "26703" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "26703"
 Comparing "26661" and "26703".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of  26724
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>     42 atoms have been selected out of  26724
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "42"
 Parameter: NPOSATOMS <- "42"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     22 atoms have been selected out of  26724
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "22"
 Parameter: NNEGATOMS <- "22"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>     42 atoms have been selected out of  26724
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>     42 atoms have been selected out of  26724
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "42"
 Parameter: NIONATOMS <- "42"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "42" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      264
         Number of atoms         =    26724   Number of groups     =     6884
         Number of bonds         =    26460   Number of angles     =    50900
         Number of dihedrals     =    70780   Number of impropers  =      420
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4.3_ion_protmemb.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON OCT, 27. 2023. JOB
 TITLE> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 TITLE> *  DATE:    10/27/23     17:28:56      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for 26660 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-4.654054919E-13"
Evaluating: -4.654054919E-13
 Parameter: CGTOTINIT <- "-4.654054919E-13"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-4.654054919E-13"
Evaluating: INT(-4.654054919E-13)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "-4.654054919E-13"
Evaluating: ABS(0--4.654054919E-13)
 Parameter: CGDIFF <- "4.654054919E-13"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "4.654054919E-13" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>  26660 atoms have been selected out of  26724

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:        200 residues deleted.

 Message from MAPIC:          1 segments deleted.
 DELTIC:     26460 bonds deleted
 DELTIC:     50900 angles deleted
 DELTIC:     70780 dihedrals deleted
 DELTIC:       420 improper dihedrals deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =       64
         Number of atoms         =       64   Number of groups     =       64
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   20.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 42
 RDTITL> * SET NNEGTOT = 22
 RDTITL> * SET NIONTOT = 64
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     40.51 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    40.51  SECONDS 
                         CPU TIME:    16.02  SECONDS 
