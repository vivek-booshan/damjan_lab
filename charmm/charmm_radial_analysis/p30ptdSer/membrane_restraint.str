* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v3.7 on Oct, 19. 2023. JOBID=9750720263
* POSITIONAL RESTRAINT POTENTIALS FOR LIPID BILAYER
*

! keep the water molecules away from the hydrophobic core
define twater sele ( resname TIP3 .and. type OH2 .and. .not. ( segid PWAT .or. segid WAT* ) ) end

MMFP
GEO  plane -
     xref 0.0 yref 0.0 zref 0.0 zdir 1.0 -
     harmonic outside force @wforce droff 11.0 select twater end
END

! keep the lipid head groups close to target values
! keep the lipid tail below +/- %

calc NLipid = @nliptop + @nlipbot
calc nmemb = @NLipid

set i 1
calc ntop = 0
calc nbot = 0
label DOMMFP

   if i .le. @nmemb then
      coor stat sele segid MEMB .and. resid @i end 
      set lipid = ?selresn
      goto continue
   endif
   calc j = @i - @nmemb

   label continue

   define HEAD sele none end
   define TAIL sele none end

   if lipid .eq. CHL1 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. ERG then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. DPOP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C29 .or. type C30 ) end
   endif
   if lipid .eq. SITO then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. STIG then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. CHSD then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 .or. type C4' .or. type O2' .or. type C5' ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. CHSP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 .or. type C4' .or. type O2' .or. type C5' ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. CAMP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. GCAMP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type 2O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. GSITO then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type 2O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. GSTIG then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type 2O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. LANO then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 ) end
   endif
   if lipid .eq. PGCAMP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type 2O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 .or. type 3C16 ) end
   endif
   if lipid .eq. PGSITO then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type 2O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 .or. type 3C16 ) end
   endif
   if lipid .eq. PGSTIG then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type 2O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C26 .or. type C27 .or. type 3C16 ) end
   endif
   if lipid .eq. DLPA then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C212 .or. type C312 ) end
   endif
   if lipid .eq. DMPA then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PSPA then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DSPA then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. POPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. SOPA then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SLPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DYPA then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. YOPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DOPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DGPA then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DEPA then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DNPA then
      calc zpostop = 25
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C224 .or. type C324 ) end
   endif
   if lipid .eq. DDPC then
      calc zpostop = 13
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C210 .or. type C310 ) end
   endif
   if lipid .eq. DCPC then
      calc zpostop = 14
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C211 .or. type C311 ) end
   endif
   if lipid .eq. DLPC then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C212 .or. type C312 ) end
   endif
   if lipid .eq. DMPC then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DSPC then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. PYPC then
      calc zpostop = 21.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. POPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPC then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PILPC then
      calc zpostop = 18.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PDOPC then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C322 ) end
   endif
   if lipid .eq. SOPC then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SLPC then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DRPC then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DYPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. YOPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DOPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DUPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DGPC then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DEPC then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DDOPC then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DNPC then
      calc zpostop = 25
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C224 .or. type C324 ) end
   endif
   if lipid .eq. DLIPC then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. LLPC then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DLPE then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C212 .or. type C312 ) end
   endif
   if lipid .eq. DMPE then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PSPE then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DSPE then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. PYPE then
      calc zpostop = 21.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. POPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPE then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PDOPE then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C322 ) end
   endif
   if lipid .eq. SOPE then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SLPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DYPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. YOPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. OYPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 ) end
   endif
   if lipid .eq. DOPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DGPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DEPE then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DDOPE then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DNPE then
      calc zpostop = 25
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C224 .or. type C324 ) end
   endif
   if lipid .eq. DLIPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. LLPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DLPG then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C212 .or. type C312 ) end
   endif
   if lipid .eq. DMPG then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPPG then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PSPG then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DSPG then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. PYPG then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. YPPG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. POPG then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. OPPG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 ) end
   endif
   if lipid .eq. PLPG then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. SOPG then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SLPG then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DYPG then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DOPG then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DGPG then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DEPG then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DNPG then
      calc zpostop = 25
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C224 .or. type C324 ) end
   endif
   if lipid .eq. DLPS then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C212 .or. type C312 ) end
   endif
   if lipid .eq. DMPS then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPPS then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PSPS then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DSPS then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. POPS then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PSPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PAPC then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C316 ) end
   endif
   if lipid .eq. PLPS then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. SOPS then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SLPS then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. OLPS then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C316 ) end
   endif
   if lipid .eq. DYPS then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. YOPS then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DOPS then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DGPS then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DEPS then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DDOPS then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DNPS then
      calc zpostop = 25
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C224 .or. type C324 ) end
   endif
   if lipid .eq. LLPS then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. POPP1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type C1 .or. type O1+','OP2+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPP2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type C1 .or. type O1+','OP2+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPP3 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type C1 .or. type O1+','OP2+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DOPP1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type C1 .or. type O1+','OP2+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DOPP2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type C1 .or. type O1+','OP2+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DOPP3 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type C1 .or. type O1+','OP2+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DMPI then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI13 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI14 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI15 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI24 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI25 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI2A then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI2B then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI2C then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI2D then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI33 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI34 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMPI35 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPPI then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PYPI then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PSPI then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI13 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI14 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI15 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI24 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI25 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI2A then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI2B then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI2C then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI2D then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI33 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI34 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. POPI35 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI13 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI14 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI15 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI24 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI25 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI2A then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI2B then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI2C then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI2D then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI33 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI34 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLPI35 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI13 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI14 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI15 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI24 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI25 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI2A then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI2B then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI2C then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI2D then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI33 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI34 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PNPI35 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. SLPI then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SAPI then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI13 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI14 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI15 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI24 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI25 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI2A then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI2B then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI2C then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI2D then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI33 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI34 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPI35 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SDPI then
      calc zpostop = 20.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. DLIPI then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. LINPI then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. TMCL1 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%14 ) end
   endif
   if lipid .eq. TMCL2 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%14 ) end
   endif
   if lipid .eq. PMCL1 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%16 ) end
   endif
   if lipid .eq. PMCL2 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%16 ) end
   endif
   if lipid .eq. PAICL2 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA14 .or. type CB16 .or. type CC14 .or. type CD16 ) end
   endif
   if lipid .eq. PVCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA18 .or. type CB16 .or. type CC18 .or. type CD16 ) end
   endif
   if lipid .eq. POCL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA18 .or. type CB16 .or. type CC18 .or. type CD16 ) end
   endif
   if lipid .eq. POCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA18 .or. type CB16 .or. type CC18 .or. type CD16 ) end
   endif
   if lipid .eq. TYCL1 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%16 ) end
   endif
   if lipid .eq. TYCL2 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%16 ) end
   endif
   if lipid .eq. TOCL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. TOCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LOACL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LOACL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LOCCL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LOCCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. TLCL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. TLCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LNCCL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LNCCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LNACL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LNACL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LNDCL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LNDCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LNBCL1 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. LNBCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C%18 ) end
   endif
   if lipid .eq. DLGL then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C212 .or. type C312 ) end
   endif
   if lipid .eq. DMGL then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DSGL then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. POGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. SOGL then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SLGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SAGL then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SDGL then
      calc zpostop = 20.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. DYGL then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DOGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DGGL then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DEGL then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C322 ) end
   endif
   if lipid .eq. DNGL then
      calc zpostop = 25
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C224 .or. type C324 ) end
   endif
   if lipid .eq. DTGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. TIGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 ) end
   endif
   if lipid .eq. DIGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. LLGL then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DAGL then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. LOSTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. OOOTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. OPOTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C216 .or. type C318 ) end
   endif
   if lipid .eq. POOTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. POSTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. SOOTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. SPOTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C216 .or. type C318 ) end
   endif
   if lipid .eq. PPPTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 .or. type C316 ) end
   endif
   if lipid .eq. OOLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. POLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. PPLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 .or. type C318 ) end
   endif
   if lipid .eq. PLLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. OLLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. LLLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. SOLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. SLLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. PSLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. LLNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. PLNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. OLNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. PONTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. OONTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. SNLTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. SLNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. ONNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. LNNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. PPNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 .or. type C318 ) end
   endif
   if lipid .eq. PPOTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 .or. type C318 ) end
   endif
   if lipid .eq. PNNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. PSOTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. NNNTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. SONTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C318 ) end
   endif
   if lipid .eq. PLATG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. SLATG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. OLATG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. ONATG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. LLATG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. LLGTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. SLGTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. SNGTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. OLGTG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O11 .or. type C1 .or. type O21 .or. type C2 .or. type O31 .or. type C3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 .or. type C320 ) end
   endif
   if lipid .eq. SAPA then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPC then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPE then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPG then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SAPS then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. SDPA then
      calc zpostop = 20.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. SDPC then
      calc zpostop = 20.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. SDPE then
      calc zpostop = 20.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. SDPG then
      calc zpostop = 20.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. SDPS then
      calc zpostop = 20.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. DAPA then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DAPC then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DAPE then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DAPG then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. DAPS then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. PEPS then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C316 ) end
   endif
   if lipid .eq. OEPS then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. TSPC then
      calc zpostop = 20.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C332 ) end
   endif
   if lipid .eq. DTPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. TIPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 ) end
   endif
   if lipid .eq. DIPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. LLPA then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. LLPG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. PLEPC then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLEPE then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLEPS then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type OC+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLEPA then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PLEPG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PAPE then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C316 ) end
   endif
   if lipid .eq. PAPS then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C316 ) end
   endif
   if lipid .eq. PAPG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C316 ) end
   endif
   if lipid .eq. PAPA then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C316 ) end
   endif
   if lipid .eq. LYPG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 ) end
   endif
   if lipid .eq. YLIPG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. SLEPC then
      calc zpostop = 20.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. SODPC then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. SEPPC then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C319 ) end
   endif
   if lipid .eq. TSM then
      calc zpostop = 25.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C22F ) end
   endif
   if lipid .eq. DSM then
      calc zpostop = 25.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C24F ) end
   endif
   if lipid .eq. PSM then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C16F ) end
   endif
   if lipid .eq. SSM then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C18F ) end
   endif
   if lipid .eq. ASM then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C20F ) end
   endif
   if lipid .eq. BSM then
      calc zpostop = 25
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C22F ) end
   endif
   if lipid .eq. 23SM then
      calc zpostop = 26
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C23F ) end
   endif
   if lipid .eq. LSM then
      calc zpostop = 27
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C24F ) end
   endif
   if lipid .eq. OSM then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C18F ) end
   endif
   if lipid .eq. NSM then
      calc zpostop = 27
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C24F ) end
   endif
   if lipid .eq. CER160 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C16F .or. type C18S ) end
   endif
   if lipid .eq. CER180 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18F .or. type C18S ) end
   endif
   if lipid .eq. CER181 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18F .or. type C18S ) end
   endif
   if lipid .eq. CER200 then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20F .or. type C18S ) end
   endif
   if lipid .eq. CER220 then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22F .or. type C18S ) end
   endif
   if lipid .eq. CER240 then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24F .or. type C18S ) end
   endif
   if lipid .eq. CER241 then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24F .or. type C18S ) end
   endif
   if lipid .eq. CER3E then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18F .or. type C18S ) end
   endif
   if lipid .eq. CER6 then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C24F ) end
   endif
   if lipid .eq. CER3 then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C24F ) end
   endif
   if lipid .eq. CER1 then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C48F ) end
   endif
   if lipid .eq. MAIPC then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. MAIPG then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. MAIPE then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. AIPC then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. AIPG then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. AIPE then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. QMPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C315 ) end
   endif
   if lipid .eq. PAIPC then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C316 ) end
   endif
   if lipid .eq. PAIPG then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C316 ) end
   endif
   if lipid .eq. PAIPE then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C316 ) end
   endif
   if lipid .eq. APPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C215 .or. type C316 ) end
   endif
   if lipid .eq. IPPC then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C215 .or. type C316 ) end
   endif
   if lipid .eq. PMPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PMPG then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PHPC then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PPPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PVPE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PVPG then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PEPC then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C316 ) end
   endif
   if lipid .eq. PEPE then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C316 ) end
   endif
   if lipid .eq. OEPE then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. OEPC then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. DPPGK then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PGMAR then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. AROL then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PGAR then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. PEAR then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. MEN7 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type OR5 .or. type OR8 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C228 ) end
   endif
   if lipid .eq. MEN8 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type OR5 .or. type OR8 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C232 ) end
   endif
   if lipid .eq. MEN9 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type OR5 .or. type OR8 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C236 ) end
   endif
   if lipid .eq. MKOL8 then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type OR5 .or. type OR8 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C232 ) end
   endif
   if lipid .eq. ARCL2 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CB16 .or. type CA20 .or. type CD16 .or. type CC20 ) end
   endif
   if lipid .eq. UQ1 then
      calc zpostop = 5
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. UQ2 then
      calc zpostop = 10
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C29 ) end
   endif
   if lipid .eq. UQ3 then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 ) end
   endif
   if lipid .eq. UQ4 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C219 ) end
   endif
   if lipid .eq. UQ5 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C224 ) end
   endif
   if lipid .eq. UQ6 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C229 ) end
   endif
   if lipid .eq. UQ7 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C234 ) end
   endif
   if lipid .eq. UQ8 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C239 ) end
   endif
   if lipid .eq. UQ9 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C244 ) end
   endif
   if lipid .eq. UQ10 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C249 ) end
   endif
   if lipid .eq. UQOL1 then
      calc zpostop = 5
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. UQOL2 then
      calc zpostop = 10
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C29 ) end
   endif
   if lipid .eq. UQOL3 then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 ) end
   endif
   if lipid .eq. UQOL4 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C219 ) end
   endif
   if lipid .eq. UQOL5 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C224 ) end
   endif
   if lipid .eq. UQOL6 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C229 ) end
   endif
   if lipid .eq. UQOL7 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C234 ) end
   endif
   if lipid .eq. UQOL8 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C239 ) end
   endif
   if lipid .eq. UQOL9 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C244 ) end
   endif
   if lipid .eq. UQOL10 then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O* .or. type CR* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C249 ) end
   endif
   if lipid .eq. LAU then
      calc zpostop = 12
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. MYR then
      calc zpostop = 14
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C14 ) end
   endif
   if lipid .eq. PAL then
      calc zpostop = 16
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C16 ) end
   endif
   if lipid .eq. STE then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. ARA then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. BEH then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. TRI then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C23 ) end
   endif
   if lipid .eq. LIGN then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. MYRO then
      calc zpostop = 14
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C14 ) end
   endif
   if lipid .eq. PALO then
      calc zpostop = 16
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C16 ) end
   endif
   if lipid .eq. HTA then
      calc zpostop = 16
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C16 ) end
   endif
   if lipid .eq. OLE then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. LIN then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. ALIN then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. SDA then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. GLA then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. EICO then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. EDA then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. MEA then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. DGLA then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. ETE then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. ETA then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. EPA then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. ARAN then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. HPA then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C21 ) end
   endif
   if lipid .eq. ERU then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. DDA then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. ADR then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. DPT then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. DPA then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. DHA then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. NER then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. TTA then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. TPT then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. TPA then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. THA then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. LAUP then
      calc zpostop = 12
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. MYRP then
      calc zpostop = 14
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C14 ) end
   endif
   if lipid .eq. PALP then
      calc zpostop = 16
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C16 ) end
   endif
   if lipid .eq. STEP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. ARAP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. BEHP then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. TRIP then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C23 ) end
   endif
   if lipid .eq. LIGNP then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. MYROP then
      calc zpostop = 14
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C14 ) end
   endif
   if lipid .eq. PALOP then
      calc zpostop = 16
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C16 ) end
   endif
   if lipid .eq. HTAP then
      calc zpostop = 16
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C16 ) end
   endif
   if lipid .eq. OLEP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. LINP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. ALINP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. SDAP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. GLAP then
      calc zpostop = 18
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 ) end
   endif
   if lipid .eq. EICOP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. EDAP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. MEAP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. DGLAP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. ETEP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. ETAP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. EPAP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. ARANP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C20 ) end
   endif
   if lipid .eq. HPAP then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C21 ) end
   endif
   if lipid .eq. ERUP then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. DDAP then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. ADRP then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. DPTP then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. DPAP then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. DHAP then
      calc zpostop = 22
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C22 ) end
   endif
   if lipid .eq. NERP then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. TTAP then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. TPTP then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. TPAP then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. THAP then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C24 ) end
   endif
   if lipid .eq. SB3-10 then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. SB3-12 then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. SB3-14 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C14 ) end
   endif
   if lipid .eq. CHAPS then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C3 ) end
   endif
   if lipid .eq. CHAPSO then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C3 ) end
   endif
   if lipid .eq. DDMG then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. DOMG then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. DDAO then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. UDAO then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C11 ) end
   endif
   if lipid .eq. LDAO then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. LAPAO then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C212 ) end
   endif
   if lipid .eq. TRIPAO then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C27 .or. type C37 ) end
   endif
   if lipid .eq. FOS10 then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C310 ) end
   endif
   if lipid .eq. FOS12 then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C312 ) end
   endif
   if lipid .eq. FOS13 then
      calc zpostop = 16.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C313 ) end
   endif
   if lipid .eq. FOS14 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C314 ) end
   endif
   if lipid .eq. FOS15 then
      calc zpostop = 18.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C315 ) end
   endif
   if lipid .eq. FOS16 then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C316 ) end
   endif
   if lipid .eq. UFOS10 then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C311 ) end
   endif
   if lipid .eq. LPC12 then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C312 ) end
   endif
   if lipid .eq. LPC14 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C314 ) end
   endif
   if lipid .eq. LPC16 then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C316 ) end
   endif
   if lipid .eq. FOIS9 then
      calc zpostop = 8.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C34 .or. type C39 ) end
   endif
   if lipid .eq. FOIS11 then
      calc zpostop = 9.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C35 .or. type C311 ) end
   endif
   if lipid .eq. C6DHPC then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C36 .or. type C26 ) end
   endif
   if lipid .eq. C7DHPC then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C37 .or. type C27 ) end
   endif
   if lipid .eq. CYFOS3 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. CYFOS4 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. CYFOS5 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. CYFOS6 then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. CYFOS7 then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. SDS then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type S ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. LMPG then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C314 ) end
   endif
   if lipid .eq. LPPG then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type P ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C316 ) end
   endif
   if lipid .eq. DDAOP then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. UDAOP then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C11 ) end
   endif
   if lipid .eq. LDAOP then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. LAPAOP then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C212 ) end
   endif
   if lipid .eq. TRPAOP then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C27 .or. type C37 ) end
   endif
   if lipid .eq. C6EG3 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C6 ) end
   endif
   if lipid .eq. C6EG4 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C6 ) end
   endif
   if lipid .eq. C6EG5 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C6 ) end
   endif
   if lipid .eq. C7EG4 then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C7 ) end
   endif
   if lipid .eq. C7EG5 then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C7 ) end
   endif
   if lipid .eq. C8EG4 then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. C8EG5 then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. C8EG6 then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. C10EG5 then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. C10EG6 then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. C10EG9 then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. C12EG7 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. C12EG8 then
      calc zpostop = 20.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. C12EG9 then
      calc zpostop = 20.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. C12DEG then
      calc zpostop = 20.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. C13EG8 then
      calc zpostop = 18.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C13 ) end
   endif
   if lipid .eq. NIDP40 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4 ) end
   endif
   if lipid .eq. TX100 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4 ) end
   endif
   if lipid .eq. TX114 then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 1O1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4 ) end
   endif
   if lipid .eq. AOG then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. BOG then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. ANG then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C9 ) end
   endif
   if lipid .eq. BNG then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C9 ) end
   endif
   if lipid .eq. ADG then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. BDG then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. ADDG then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. BDDG then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. ACY3G then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. BCY3G then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. AMHCG then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. BMHCG then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. AOM then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. BOM then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. ANM then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C9 ) end
   endif
   if lipid .eq. BNM then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C9 ) end
   endif
   if lipid .eq. ADM then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. BDM then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. AUDM then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C11 ) end
   endif
   if lipid .eq. BUDM then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C11 ) end
   endif
   if lipid .eq. A2UDM then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C11 ) end
   endif
   if lipid .eq. B2UDM then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C11 ) end
   endif
   if lipid .eq. ADDM then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. BDDM then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. ADMHM then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4 .or. type C8 ) end
   endif
   if lipid .eq. BDMHM then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4 .or. type C8 ) end
   endif
   if lipid .eq. APPM then
      calc zpostop = 7.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C5 .or. type C8 ) end
   endif
   if lipid .eq. BPPM then
      calc zpostop = 7.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C5 .or. type C8 ) end
   endif
   if lipid .eq. ATM then
      calc zpostop = 16.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C13 ) end
   endif
   if lipid .eq. BTM then
      calc zpostop = 16.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C13 ) end
   endif
   if lipid .eq. ACY3M then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. BCY3M then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. ACY4M then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. BCY4M then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. ACY5M then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. BCY5M then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. ACY6M then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. BCY6M then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. ACY7M then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. BCY7M then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C4A ) end
   endif
   if lipid .eq. NHEG then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type NF ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C9 ) end
   endif
   if lipid .eq. DHEG then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type NF ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. NMG then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type NF ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C9 ) end
   endif
   if lipid .eq. DMG then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type NF ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. CTB10 then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C310 ) end
   endif
   if lipid .eq. CTB11 then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C311 ) end
   endif
   if lipid .eq. CTB12 then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C312 ) end
   endif
   if lipid .eq. CTB13 then
      calc zpostop = 16
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C313 ) end
   endif
   if lipid .eq. CTB14 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C314 ) end
   endif
   if lipid .eq. CTB15 then
      calc zpostop = 18.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C315 ) end
   endif
   if lipid .eq. CTB16 then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C316 ) end
   endif
   if lipid .eq. GMS1 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C318 ) end
   endif
   if lipid .eq. GMS2 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 ) end
   endif
   if lipid .eq. MLN1 then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C318 ) end
   endif
   if lipid .eq. MLN2 then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 ) end
   endif
   if lipid .eq. MGTM10 then
      calc zpostop = 30.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type CC1 .or. type 3C2 .or. type 6C2 .or. type 9C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C+10 ) end
   endif
   if lipid .eq. MGTM11 then
      calc zpostop = 31.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type CC1 .or. type 3C2 .or. type 6C2 .or. type 9C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C+11 ) end
   endif
   if lipid .eq. EGTM10 then
      calc zpostop = 30.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type CC1 .or. type 3C2 .or. type 6C2 .or. type 9C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C+10 ) end
   endif
   if lipid .eq. EGTM11 then
      calc zpostop = 31.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type CC1 .or. type 3C2 .or. type 6C2 .or. type 9C2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C+11 ) end
   endif
   if lipid .eq. TZMH9 then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C19 .or. type C29 .or. type C39 .or. type C49 ) end
   endif
   if lipid .eq. TZMH10 then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C110 .or. type C210 .or. type C310 .or. type C410 ) end
   endif
   if lipid .eq. TZME9 then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C19 .or. type C29 .or. type C39 .or. type C49 ) end
   endif
   if lipid .eq. TZME10 then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C110 .or. type C210 .or. type C310 .or. type C410 ) end
   endif
   if lipid .eq. SMDD then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C5 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. BBPHG then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 5C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C27 .or. type C37 ) end
   endif
   if lipid .eq. BBCYG then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 5C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C27 .or. type C37 ) end
   endif
   if lipid .eq. BOGNG then
      calc zpostop = 16.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type 3C8P .or. type 6C8P ) end
   endif
   if lipid .eq. BLMNG then
      calc zpostop = 20.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type 3C12P .or. type 6C12P ) end
   endif
   if lipid .eq. BDMNG then
      calc zpostop = 18.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type 3C10P .or. type 6C10P ) end
   endif
   if lipid .eq. C5MNG then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type 3C4A .or. type 6C4A ) end
   endif
   if lipid .eq. C6MNG then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type 3C4A .or. type 6C4A ) end
   endif
   if lipid .eq. BOTGNG then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type 3C8P .or. type 6C8P ) end
   endif
   if lipid .eq. BOING then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C* ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type 3C8P .or. type 6C8P ) end
   endif
   if lipid .eq. AHTG then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C7 ) end
   endif
   if lipid .eq. BHTG then
      calc zpostop = 10.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C7 ) end
   endif
   if lipid .eq. AOTG then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. BOTG then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. AOTM then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. BOTM then
      calc zpostop = 11.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C8 ) end
   endif
   if lipid .eq. ANTM then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C9 ) end
   endif
   if lipid .eq. BNTM then
      calc zpostop = 12.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C9 ) end
   endif
   if lipid .eq. ADTM then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. BDTM then
      calc zpostop = 13.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C10 ) end
   endif
   if lipid .eq. AUDTM then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C11 ) end
   endif
   if lipid .eq. BUDTM then
      calc zpostop = 14.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C11 ) end
   endif
   if lipid .eq. ADDTM then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. BDDTM then
      calc zpostop = 15.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type 2C1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C12 ) end
   endif
   if lipid .eq. DHPCE then
      calc zpostop = 16
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. POPCE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DOPCE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DMPCE then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. POPEE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. DOPEE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DPPEE then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DMPEE then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. PLA20 then
      calc zpostop = 19.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. PLA18 then
      calc zpostop = 19.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. PLC22 then
      calc zpostop = 19.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C222 .or. type C318 ) end
   endif
   if lipid .eq. PLC20 then
      calc zpostop = 19.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. PLC18 then
      calc zpostop = 19.5
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. BMGP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type C1 .or. type C11 .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DMTAP then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type N .or. type C1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPTAP then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type N .or. type C1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DOTAP then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type N .or. type C1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DSTAP then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type N .or. type C1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DLTAP then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DMDAP then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMDAPH then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPDAP then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DPDAPH then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DSDAP then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DSDAPH then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DODAP then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DODAPH then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DLDAP then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DLDAPH then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DMDMA then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DMDMAH then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C214 .or. type C314 ) end
   endif
   if lipid .eq. DPDMA then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DPDMAH then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 ) end
   endif
   if lipid .eq. DSDMA then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DSDMAH then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DODMA then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DODMAH then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DLDMA then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DLDMAH then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C318 ) end
   endif
   if lipid .eq. DMKC1 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C114 .or. type C214 ) end
   endif
   if lipid .eq. DMKC1H then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C114 .or. type C214 ) end
   endif
   if lipid .eq. DPKC1 then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 ) end
   endif
   if lipid .eq. DPKC1H then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 ) end
   endif
   if lipid .eq. DSKC1 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DSKC1H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DOKC1 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DOKC1H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DLKC1 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DLKC1H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DMKC2 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C114 .or. type C214 ) end
   endif
   if lipid .eq. DMKC2H then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C114 .or. type C214 ) end
   endif
   if lipid .eq. DPKC2 then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 ) end
   endif
   if lipid .eq. DPKC2H then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 ) end
   endif
   if lipid .eq. DSKC2 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DSKC2H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DOKC2 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DOKC2H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DLKC2 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DLKC2H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DMMC3 then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C114 .or. type C214 ) end
   endif
   if lipid .eq. DMMC3H then
      calc zpostop = 17.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C114 .or. type C214 ) end
   endif
   if lipid .eq. DPMC3 then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 ) end
   endif
   if lipid .eq. DPMC3H then
      calc zpostop = 19.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C116 .or. type C216 ) end
   endif
   if lipid .eq. DSMC3 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DSMC3H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DOMC3 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DOMC3H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DLMC3 then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. DLMC3H then
      calc zpostop = 21.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type N1 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C118 .or. type C218 ) end
   endif
   if lipid .eq. TDM then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O6 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C75 ) end
   endif
   if lipid .eq. TMM then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O6 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C75 ) end
   endif
   if lipid .eq. DAT then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O6 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 .or. type C22 ) end
   endif
   if lipid .eq. PAT then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O6 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18 .or. type C24 ) end
   endif
   if lipid .eq. SGL then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O6 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C16 .or. type C30 .or. type C32 ) end
   endif
   if lipid .eq. AMC78 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C75 ) end
   endif
   if lipid .eq. AMC80 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C77 ) end
   endif
   if lipid .eq. CMMC84 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C81 ) end
   endif
   if lipid .eq. CMMC86 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C83 ) end
   endif
   if lipid .eq. TMMC85 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C82 ) end
   endif
   if lipid .eq. TMMC87 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C84 ) end
   endif
   if lipid .eq. CKMC84 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C82 ) end
   endif
   if lipid .eq. TKMC85 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C83 ) end
   endif
   if lipid .eq. TKMC87 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C85 ) end
   endif
   if lipid .eq. TKMC89 then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type O2 .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C87 ) end
   endif
   if lipid .eq. PDIM then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type CO2 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C83 ) end
   endif
   if lipid .eq. PIMA then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type C1 .or. type C2 .or. type O21 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 .or. type C416 .or. type C616 ) end
   endif
   if lipid .eq. PIMB then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type C1 .or. type C2 .or. type O21 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 .or. type C416 .or. type C616 ) end
   endif
   if lipid .eq. PIMC then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type C1 .or. type C2 .or. type O21 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 .or. type C416 .or. type C616 ) end
   endif
   if lipid .eq. PIMD then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type C1 .or. type C2 .or. type O21 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C318 .or. type C616 ) end
   endif
   if lipid .eq. PIME then
      calc zpostop = 27.0
      define HEAD sele segid MEMB .and. resi @i .and. ( type C3 .or. type C1 .or. type C2 .or. type O21 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C216 .or. type C316 .or. type C416 .or. type C616 ) end
   endif
   if lipid .eq. ODOPC then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C322 ) end
   endif
   if lipid .eq. MEPPC then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C314 ) end
   endif
   if lipid .eq. PLEEA then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C322 ) end
   endif
   if lipid .eq. PLEEEP then
      calc zpostop = 23
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C322 ) end
   endif
   if lipid .eq. PLEPEP then
      calc zpostop = 21
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C320 ) end
   endif
   if lipid .eq. PLESEP then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C220 .or. type C318 ) end
   endif
   if lipid .eq. LPE18 then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C318 ) end
   endif
   if lipid .eq. LPCO then
      calc zpostop = 20
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C318 ) end
   endif
   if lipid .eq. DMPGM then
      calc zpostop = 15
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA14,CB14,CC14 ) end
   endif
   if lipid .eq. DPPGH then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA15,CB15,CC17 ) end
   endif
   if lipid .eq. DPPGP then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA16,CB16,CC16 ) end
   endif
   if lipid .eq. PHPGH then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA15,CB17,CC17 ) end
   endif
   if lipid .eq. PHPGP then
      calc zpostop = 17
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CA15,CB17,CC15 ) end
   endif
   if lipid .eq. CER6X then
      calc zpostop = 24
      define HEAD sele segid MEMB .and. resi @i .and. ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C18S .or. type C24F ) end
   endif
   if lipid .eq. MPCL2 then
      calc zpostop = 19
      define HEAD sele segid MEMB .and. resi @i .and. ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type CB18 .or. type CD18 .or. type CA16 .or. type CC16 ) end
   endif
   if lipid .eq. PMSPE then
      calc zpostop = 19.8
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif
   if lipid .eq. PMSPG then
      calc zpostop = 19.8
      define HEAD sele segid MEMB .and. resi @i .and. ( type P .or. type N .or. type C1+ .or. type O1+ .or. type OC+ ) end
      define TAIL sele segid MEMB .and. resi @i .and. ( type C218 .or. type C316 ) end
   endif

   coor stat sele HEAD end

   if ?zave gt 0 then 
      MMFP
      GEO plane  RCM -
          xref 0.0  yref 0.0  zref  @zpostop  zdir 1.0 -
          force  @mforce   select HEAD show end
      END
      calc ntop = @ntop + 1
   endif
   if ?zave le 0 then
      MMFP
      GEO plane  RCM -
          xref 0.0  yref 0.0  zref -@zpostop  zdir 1.0 -
          force  @mforce   select HEAD show end
      END
      calc nbot = @nbot + 1
   endif

   MMFP
   GEO plane -
       xref 0.0 yref 0.0 zref 0.0 zdir 1.0 -
       harmonic inside  force @tforce droff 5.0 select TAIL show end
   END

incr i by 1
if i le @NLipid goto DOMMFP
calc ntot = @nbot + @ntop
