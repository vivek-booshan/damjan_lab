1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 47a2   February 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.80.1.el7.x86_64(x86_64)       
                 Created on  7/5/23 at 14:34:03 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUL, 05. 2023. JOBID=8858096327
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUL, 05. 2023. JOBID=8858096327
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10950): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "455"
 Parameter: NAT <- "455"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "455"
 Parameter: NAT -> "455"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""455"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "455" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "472"
 Parameter: NAT <- "472"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "472"
 Parameter: NAT -> "472"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""472"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "472" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "475"
 Parameter: NAT <- "475"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "475"
 Parameter: NAT -> "475"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""475"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "475" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/cam.str
 VOPEN> Attempting to open::toppar/cam.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/cam.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY GENERATED BY PARMED
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY PARMED
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for CAM interacting with
 CHARMM>    ! water.
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CAM AND WATER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "541"
 Parameter: NAT <- "541"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "541"
 Parameter: NAT -> "541"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""541"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "541" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides, Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "572"
 Parameter: NAT <- "572"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "572"
 Parameter: NAT -> "572"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""572"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "572" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14696): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14717): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "577"
 Parameter: NAT <- "577"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "577"
 Parameter: NAT -> "577"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""577"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "577" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "577"
 Parameter: NAT <- "577"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "577"
 Parameter: NAT -> "577"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""577"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "577" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 15056): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15057): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15058): OG31  CG30  CG3C  HGA1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15056): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15057): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15058): OG31  CG30  CG3C  HGA1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF, PAR_ALL36_LIPID.PRM
 RDTITL> * AND
 RDTITL> * TOPPAR_ALL36_LIPID_BACTERIAL.STR
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated ANGLE parameter (  4990): CEL1  CEL1  CTL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15290): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15291): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15290): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15291): CTL2  CG2O  CTL1  CTL3 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "577"
 Parameter: NAT <- "577"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "577"
 Parameter: NAT -> "577"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""577"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "577" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "577"
 Parameter: NAT <- "577"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "577"
 Parameter: NAT -> "577"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""577"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "577" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    define PROT sele none end
 SELRPN>      0 atoms have been selected out of      0
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 81.6823114
 Parameter: A <- "81.6823114"
  
 CHARMM>     SET B        = 81.6823114
 Parameter: B <- "81.6823114"
  
 CHARMM>     SET C        = 85
 Parameter: C <- "85"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = 0
 Parameter: ZCEN <- "0"
  
 CHARMM>     SET NLIPTOP  = 100
 Parameter: NLIPTOP <- "100"
  
 CHARMM>     SET NLIPBOT  = 100
 Parameter: NLIPBOT <- "100"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 22.5
 Parameter: WATBOXZ <- "22.5"
  
 CHARMM>     SET NCHARGE  = -40
 Parameter: NCHARGE <- "-40"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being appended from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUL, 05. 2023. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:     7/ 5/23     14:25: 6      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      200
         Number of atoms         =    26520   Number of groups     =     6840
         Number of bonds         =    26320   Number of angles     =    50600
         Number of dihedrals     =    70360   Number of impropers  =      440
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =  -40.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUL, 05. 2023. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:     7/ 5/23     14:25: 7      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    ! Write coordinates
 CHARMM>    open write unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for WRITE access to step4.3_ion_protmemb.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of  26520
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR     26520 SELECTED ATOMS:
    XMIN =  -45.486428 XMAX =   44.708069 XAVE =   -0.526090
    YMIN =  -49.689648 YMAX =   48.111417 YAVE =   -0.314009
    ZMIN =  -23.234512 ZMAX =   23.345592 ZAVE =    0.151689
    WMIN =    0.000000 WMAX =    0.000000 WAVE =    0.000000
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "44.7080686"
 RDCMND substituted energy or value "?XMIN" to "-45.4864283"
Evaluating: INT((44.7080686--45.4864283+5.0)/0.5)+1
 Parameter: XDIM <- "191"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "48.1114167"
 RDCMND substituted energy or value "?YMIN" to "-49.6896482"
Evaluating: INT((48.1114167--49.6896482+5.0)/0.5)+1
 Parameter: YDIM <- "206"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "23.345592"
 RDCMND substituted energy or value "?ZMIN" to "-23.2345118"
Evaluating: INT((23.345592--23.2345118+5.0)/0.5)+1
 Parameter: ZDIM <- "104"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "191"
 Parameter: YDIM -> "206"
 Parameter: ZDIM -> "104"
Evaluating: 191*206*104
 Parameter: SPACE <- "4091984"
  
 CHARMM>     
  
 CHARMM>    ! prevent overflow on integer conversion
 CHARMM>    calc maxint = 2**32 / 2 - 1
Evaluating: 2**32/2-1
 Parameter: MAXINT <- "2.147483647E+09"
  
 CHARMM>    if space .gt. @maxint calc space = @maxint
 Parameter: MAXINT -> "2.147483647E+09"
 Parameter: MAXINT -> "2.147483647E+09"
 Comparing "4091984" and "2.147483647E+09".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "4091984"
 SELRPN>  26520 atoms have been selected out of  26520
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -48.3719 XMAX=     47.4481 NX= 190
   YMIN=    -52.4601 YMAX=     50.8514 NY= 205
   ZMIN=    -26.2550 ZMAX=     26.0290 NZ= 104


 A TOTAL OF    13415   VACUUM POINTS WERE FOUND
 A TOTAL OF  2516805 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  1520580 EXTERNAL POINTS WERE FOUND
 A TOTAL OF  4037385 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  321575.042127
 TOTAL SELECTED  VOLUME =  515861.281051
 TOTAL FREE      VOLUME =    1714.049833
 FRACTIONAL FREE VOLUME =       0.530191
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "321575.042"
 Parameter: SYSVOL <- "321575.042"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "81.6823114"
 Parameter: B -> "81.6823114"
 Parameter: C -> "85"
 Parameter: SYSVOL -> "321575.042"
Evaluating: (81.6823114*81.6823114*85)-321575.042
 Parameter: VOLUMN <- "245544.958"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of  26520
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of  26520
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of  26520
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = POT
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "POT"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-40"
Evaluating: INT(-40)
 Parameter: NCHARGE <- "-40"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-40"
Evaluating: -40
 Parameter: CGTOT <- "-40"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "-40"
 Parameter: POSCHARGE -> "1"
 Comparing "-40" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(-40)/1)
 Parameter: NPOS <- "40"
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "-40"
 Parameter: NEGCHARGE -> "1"
 Comparing "-40" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-40"
 Parameter: NPOS -> "40"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-40+40*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "40"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-40"
 Parameter: NPOS -> "40"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-40+40*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "40"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "245544.958"
 Parameter: NEGVAL -> "1"
Evaluating: 40+INT(0.15*6.021*0.0001*245544.958)*1
 Parameter: NPOS <- "62"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "245544.958"
 Parameter: POSVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*245544.958)*1
 Parameter: NNEG <- "22"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "62" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "22" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "62" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "POT"
 Parameter: NPOS -> "62"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   2 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      262
         Number of atoms         =    26582   Number of groups     =     6902
         Number of bonds         =    26320   Number of angles     =    50600
         Number of dihedrals     =    70360   Number of impropers  =      440
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   22.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     62 atoms have been selected out of  26582
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>     62 atoms have been selected out of  26582
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "22"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   3 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      284
         Number of atoms         =    26604   Number of groups     =     6924
         Number of bonds         =    26320   Number of angles     =    50600
         Number of dihedrals     =    70360   Number of impropers  =      440
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     22 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>     22 atoms have been selected out of  26604
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>     84 atoms have been selected out of  26604
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>     84 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "62"
 Parameter: NNEG -> "22"
Evaluating: 62+22
 Parameter: NION <- "84"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "62"
 Parameter: NPOSTOT <- "62"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "22"
 Parameter: NNEGTOT <- "22"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "84"
 Parameter: NIONTOT <- "84"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "84" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "81.6823114"
 Parameter: B -> "81.6823114"
 Parameter: C -> "85"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =   81.68231 B    =   81.68231 C     =   85.00000
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUL, 05. 2023. JOBID=8858096327
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUL, 05. 2023. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN 0.0 YCEN 0.0 ZCEN @zcen
 Parameter: ZCEN -> "0"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  0.000000
 RESIDUE   81 OPERATED ON BY TRANSFORMATION Z0P1Z0R1
 RESIDUE   94 OPERATED ON BY TRANSFORMATION Z0P1Z0R1
 RESIDUE   96 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE   99 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  100 OPERATED ON BY TRANSFORMATION Z0P1Z0R1

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0       40.40
    2  N1Z0N1R1 has       0       0       0       39.12
    3  N1P1N1R1 has       0       0       0       39.15
    4  Z0N1N1R1 has       0       0       0       39.16
    5  Z0Z0N1R1 has       0       0       0       38.42
    6  Z0P1N1R1 has       0       0       0       38.68
    7  N1N1Z0R1 has     507     123       7        0.00
    8  N1Z0Z0R1 has    5435    1392      50        0.00
    9  N1P1Z0R1 has     796     202       8        0.00
   10  Z0N1Z0R1 has    5414    1388      48        0.00
   12  N1N1P1R1 has       0       0       0       38.66
   13  N1Z0P1R1 has       0       0       0       38.66
   14  N1P1P1R1 has       0       0       0       39.34
 Total of38756 atoms and10029 groups and  397 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. ( POS .OR. NEG ) END
 SELRPN>  26520 atoms have been selected out of  26604
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "1" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.129120849"
Evaluating: 81.6823114*(0.129120849-0.5)
 Parameter: XPOS <- "-30.2942663"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.412716368"
Evaluating: 81.6823114*(0.412716368-0.5)
 Parameter: YPOS <- "-7.12952881"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.555426402"
Evaluating: 85*(0.555426402-0.5)+0
 Parameter: ZPOS <- "4.71124417"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.71124417" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.71124417" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "1" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.297413854"
Evaluating: 81.6823114*(0.297413854-0.5)
 Parameter: XPOS <- "-16.5477047"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.347800307"
Evaluating: 81.6823114*(0.347800307-0.5)
 Parameter: YPOS <- "-12.4320227"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.005472438E-02"
Evaluating: 85*(6.005472438E-02-0.5)+0
 Parameter: ZPOS <- "-37.3953484"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.3953484" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.5477047"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.5477047-0
 Parameter: XTRAN <- "-16.5477047"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.4320227"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.4320227-0
 Parameter: YTRAN <- "-12.4320227"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.3953484"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.3953484-0
 Parameter: ZTRAN <- "-37.3953484"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.5477047"
 Parameter: YTRAN -> "-12.4320227"
 Parameter: ZTRAN -> "-37.3953484"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -16.547705  -12.432023  -37.395348
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.502572996"
Evaluating: 0.502572996*360.0
 Parameter: XPHI <- "180.926279"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.302173747"
Evaluating: 0.302173747*360.0
 Parameter: YPHI <- "108.782549"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824518519"
Evaluating: 0.824518519*360.0
 Parameter: ZPHI <- "296.826667"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.5477047"
 Parameter: YPOS -> "-12.4320227"
 Parameter: ZPOS -> "-37.3953484"
 Parameter: XPHI -> "180.926279"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999869   -0.016166
    0.000000    0.016166   -0.999869

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  179.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.5477047"
 Parameter: YPOS -> "-12.4320227"
 Parameter: ZPOS -> "-37.3953484"
 Parameter: YPHI -> "108.782549"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.321977    0.000000   -0.946747
    0.000000    1.000000    0.000000
    0.946747    0.000000   -0.321977

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  108.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.5477047"
 Parameter: YPOS -> "-12.4320227"
 Parameter: ZPOS -> "-37.3953484"
 Parameter: ZPHI -> "296.826667"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.451293   -0.892376    0.000000
    0.892376    0.451293    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   63.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.547705 XMAX =  -16.547705 XAVE =  -16.547705
    YMIN =  -12.432023 YMAX =  -12.432023 YAVE =  -12.432023
    ZMIN =  -37.395348 ZMAX =  -37.395348 ZAVE =  -37.395348
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.5477047"
Evaluating: -16.5477047+3.5
 Parameter: XMAX <- "-13.0477047"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.4320227"
Evaluating: -12.4320227+3.5
 Parameter: YMAX <- "-8.9320227"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.3953484"
Evaluating: -37.3953484+3.5
 Parameter: ZMAX <- "-33.8953484"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.5477047"
Evaluating: -16.5477047-3.5
 Parameter: XMIN <- "-20.0477047"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.4320227"
Evaluating: -12.4320227-3.5
 Parameter: YMIN <- "-15.9320227"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.3953484"
Evaluating: -37.3953484-3.5
 Parameter: ZMIN <- "-40.8953484"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.0477047"
 Parameter: XMIN -> "-20.0477047"
 Parameter: YMAX -> "-8.9320227"
 Parameter: YMIN -> "-15.9320227"
 Parameter: ZMAX -> "-33.8953484"
 Parameter: ZMIN -> "-40.8953484"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "2" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "2" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.597298071"
Evaluating: 81.6823114*(0.597298071-0.5)
 Parameter: XPOS <- "7.94753133"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.101368277"
Evaluating: 81.6823114*(0.101368277-0.5)
 Parameter: YPOS <- "-32.5611605"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.868737775"
Evaluating: 85*(0.868737775-0.5)+0
 Parameter: ZPOS <- "31.3427109"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.3427109" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.3427109" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.94753133"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.94753133-0
 Parameter: XTRAN <- "7.94753133"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.5611605"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.5611605-0
 Parameter: YTRAN <- "-32.5611605"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.3427109"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.3427109-0
 Parameter: ZTRAN <- "31.3427109"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.94753133"
 Parameter: YTRAN -> "-32.5611605"
 Parameter: ZTRAN -> "31.3427109"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     7.947531  -32.561160   31.342711
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.210128922"
Evaluating: 0.210128922*360.0
 Parameter: XPHI <- "75.6464119"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.322103967"
Evaluating: 0.322103967*360.0
 Parameter: YPHI <- "115.957428"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.408226788"
Evaluating: 0.408226788*360.0
 Parameter: ZPHI <- "146.961644"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.94753133"
 Parameter: YPOS -> "-32.5611605"
 Parameter: ZPOS -> "31.3427109"
 Parameter: XPHI -> "75.6464119"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.247905    0.968784
    0.000000   -0.968784    0.247905

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   75.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.94753133"
 Parameter: YPOS -> "-32.5611605"
 Parameter: ZPOS -> "31.3427109"
 Parameter: YPHI -> "115.957428"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.437703    0.000000   -0.899120
    0.000000    1.000000    0.000000
    0.899120    0.000000   -0.437703

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  115.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.94753133"
 Parameter: YPOS -> "-32.5611605"
 Parameter: ZPOS -> "31.3427109"
 Parameter: ZPHI -> "146.961644"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.838306    0.545200    0.000000
   -0.545200   -0.838306    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.947531 XMAX =    7.947531 XAVE =    7.947531
    YMIN =  -32.561160 YMAX =  -32.561160 YAVE =  -32.561160
    ZMIN =   31.342711 ZMAX =   31.342711 ZAVE =   31.342711
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.94753133"
Evaluating: 7.94753133+3.5
 Parameter: XMAX <- "11.4475313"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.5611605"
Evaluating: -32.5611605+3.5
 Parameter: YMAX <- "-29.0611605"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.3427109"
Evaluating: 31.3427109+3.5
 Parameter: ZMAX <- "34.8427109"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.94753133"
Evaluating: 7.94753133-3.5
 Parameter: XMIN <- "4.44753133"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.5611605"
Evaluating: -32.5611605-3.5
 Parameter: YMIN <- "-36.0611605"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.3427109"
Evaluating: 31.3427109-3.5
 Parameter: ZMIN <- "27.8427109"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.4475313"
 Parameter: XMIN -> "4.44753133"
 Parameter: YMAX -> "-29.0611605"
 Parameter: YMIN -> "-36.0611605"
 Parameter: ZMAX -> "34.8427109"
 Parameter: ZMIN -> "27.8427109"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "3" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "3" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.547599119"
Evaluating: 81.6823114*(0.547599119-0.5)
 Parameter: XPOS <- "3.88800606"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.550287324"
Evaluating: 81.6823114*(0.550287324-0.5)
 Parameter: YPOS <- "4.10758486"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.595736035"
Evaluating: 85*(0.595736035-0.5)+0
 Parameter: ZPOS <- "8.13756298"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.13756298" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.13756298" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "3" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.723174355"
Evaluating: 81.6823114*(0.723174355-0.5)
 Parameter: XPOS <- "18.2293972"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.736451972"
Evaluating: 81.6823114*(0.736451972-0.5)
 Parameter: YPOS <- "19.3139436"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.807091987"
Evaluating: 85*(0.807091987-0.5)+0
 Parameter: ZPOS <- "26.1028189"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.1028189" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.1028189" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.2293972"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.2293972-0
 Parameter: XTRAN <- "18.2293972"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.3139436"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.3139436-0
 Parameter: YTRAN <- "19.3139436"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.1028189"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.1028189-0
 Parameter: ZTRAN <- "26.1028189"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.2293972"
 Parameter: YTRAN -> "19.3139436"
 Parameter: ZTRAN -> "26.1028189"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    18.229397   19.313944   26.102819
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367909749"
Evaluating: 0.367909749*360.0
 Parameter: XPHI <- "132.44751"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.570726274"
Evaluating: 0.570726274*360.0
 Parameter: YPHI <- "205.461459"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.401390721"
Evaluating: 0.401390721*360.0
 Parameter: ZPHI <- "144.50066"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.2293972"
 Parameter: YPOS -> "19.3139436"
 Parameter: ZPOS -> "26.1028189"
 Parameter: XPHI -> "132.44751"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.674914    0.737896
    0.000000   -0.737896   -0.674914

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.2293972"
 Parameter: YPOS -> "19.3139436"
 Parameter: ZPOS -> "26.1028189"
 Parameter: YPHI -> "205.461459"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.902875    0.000000    0.429904
    0.000000    1.000000    0.000000
   -0.429904    0.000000   -0.902875

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.2293972"
 Parameter: YPOS -> "19.3139436"
 Parameter: ZPOS -> "26.1028189"
 Parameter: ZPHI -> "144.50066"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.814122    0.580694    0.000000
   -0.580694   -0.814122    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.229397 XMAX =   18.229397 XAVE =   18.229397
    YMIN =   19.313944 YMAX =   19.313944 YAVE =   19.313944
    ZMIN =   26.102819 ZMAX =   26.102819 ZAVE =   26.102819
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.2293972"
Evaluating: 18.2293972+3.5
 Parameter: XMAX <- "21.7293972"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.3139436"
Evaluating: 19.3139436+3.5
 Parameter: YMAX <- "22.8139436"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.1028189"
Evaluating: 26.1028189+3.5
 Parameter: ZMAX <- "29.6028189"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.2293972"
Evaluating: 18.2293972-3.5
 Parameter: XMIN <- "14.7293972"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.3139436"
Evaluating: 19.3139436-3.5
 Parameter: YMIN <- "15.8139436"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.1028189"
Evaluating: 26.1028189-3.5
 Parameter: ZMIN <- "22.6028189"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.7293972"
 Parameter: XMIN -> "14.7293972"
 Parameter: YMAX -> "22.8139436"
 Parameter: YMIN -> "15.8139436"
 Parameter: ZMAX -> "29.6028189"
 Parameter: ZMIN -> "22.6028189"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "4" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "4" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.584631384"
Evaluating: 81.6823114*(0.584631384-0.5)
 Parameter: XPOS <- "6.91288706"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.981676194"
Evaluating: 81.6823114*(0.981676194-0.5)
 Parameter: YPOS <- "39.3444249"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.225826856"
Evaluating: 85*(0.225826856-0.5)+0
 Parameter: ZPOS <- "-23.3047172"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.3047172" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.91288706"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.91288706-0
 Parameter: XTRAN <- "6.91288706"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.3444249"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.3444249-0
 Parameter: YTRAN <- "39.3444249"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.3047172"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.3047172-0
 Parameter: ZTRAN <- "-23.3047172"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.91288706"
 Parameter: YTRAN -> "39.3444249"
 Parameter: ZTRAN -> "-23.3047172"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     6.912887   39.344425  -23.304717
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.855835622"
Evaluating: 0.855835622*360.0
 Parameter: XPHI <- "308.100824"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.765018449"
Evaluating: 0.765018449*360.0
 Parameter: YPHI <- "275.406642"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.758046169"
Evaluating: 0.758046169*360.0
 Parameter: ZPHI <- "272.896621"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.91288706"
 Parameter: YPOS -> "39.3444249"
 Parameter: ZPOS -> "-23.3047172"
 Parameter: XPHI -> "308.100824"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.617047   -0.786926
    0.000000    0.786926    0.617047

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   51.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.91288706"
 Parameter: YPOS -> "39.3444249"
 Parameter: ZPOS -> "-23.3047172"
 Parameter: YPHI -> "275.406642"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.094224    0.000000    0.995551
    0.000000    1.000000    0.000000
   -0.995551    0.000000    0.094224

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.91288706"
 Parameter: YPOS -> "39.3444249"
 Parameter: ZPOS -> "-23.3047172"
 Parameter: ZPHI -> "272.896621"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.050534   -0.998722    0.000000
    0.998722    0.050534    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.912887 XMAX =    6.912887 XAVE =    6.912887
    YMIN =   39.344425 YMAX =   39.344425 YAVE =   39.344425
    ZMIN =  -23.304717 ZMAX =  -23.304717 ZAVE =  -23.304717
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.91288706"
Evaluating: 6.91288706+3.5
 Parameter: XMAX <- "10.4128871"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.3444249"
Evaluating: 39.3444249+3.5
 Parameter: YMAX <- "42.8444249"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.3047172"
Evaluating: -23.3047172+3.5
 Parameter: ZMAX <- "-19.8047172"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.91288706"
Evaluating: 6.91288706-3.5
 Parameter: XMIN <- "3.41288706"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.3444249"
Evaluating: 39.3444249-3.5
 Parameter: YMIN <- "35.8444249"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.3047172"
Evaluating: -23.3047172-3.5
 Parameter: ZMIN <- "-26.8047172"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.4128871"
 Parameter: XMIN -> "3.41288706"
 Parameter: YMAX -> "42.8444249"
 Parameter: YMIN -> "35.8444249"
 Parameter: ZMAX -> "-19.8047172"
 Parameter: ZMIN -> "-26.8047172"
 SELRPN>     11 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      4 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26524 POS      POT      4        POT     -**** MEMB     POPC     179      N             3.8502
26524 POS      POT      4        POT     -**** MEMB     POPC     179      C12           3.4666
26524 POS      POT      4        POT     -**** MEMB     POPC     179      C13           3.7764
26524 POS      POT      4        POT     -**** MEMB     POPC     179      C14           3.5649
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "4" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.149645804"
Evaluating: 81.6823114*(0.149645804-0.5)
 Parameter: XPOS <- "-28.6177405"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.832369582"
Evaluating: 81.6823114*(0.832369582-0.5)
 Parameter: YPOS <- "27.1487157"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.403562928"
Evaluating: 85*(0.403562928-0.5)+0
 Parameter: ZPOS <- "-8.19715112"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.19715112" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.19715112" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "4" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.585846515"
Evaluating: 81.6823114*(0.585846515-0.5)
 Parameter: XPOS <- "7.01214177"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.74030748"
Evaluating: 81.6823114*(0.74030748-0.5)
 Parameter: YPOS <- "19.6288704"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.952313938"
Evaluating: 85*(0.952313938-0.5)+0
 Parameter: ZPOS <- "38.4466847"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.4466847" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.4466847" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.912887 XMAX =    6.912887 XAVE =    6.912887
    YMIN =   39.344425 YMAX =   39.344425 YAVE =   39.344425
    ZMIN =  -23.304717 ZMAX =  -23.304717 ZAVE =  -23.304717
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.01214177"
 RDCMND substituted energy or value "?XAVE" to "6.91288706"
Evaluating: 7.01214177-6.91288706
 Parameter: XTRAN <- "9.925471E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.6288704"
 RDCMND substituted energy or value "?YAVE" to "39.3444249"
Evaluating: 19.6288704-39.3444249
 Parameter: YTRAN <- "-19.7155545"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.4466847"
 RDCMND substituted energy or value "?ZAVE" to "-23.3047172"
Evaluating: 38.4466847--23.3047172
 Parameter: ZTRAN <- "61.7514019"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.925471E-02"
 Parameter: YTRAN -> "-19.7155545"
 Parameter: ZTRAN -> "61.7514019"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     0.099255  -19.715554   61.751402
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569277288"
Evaluating: 0.569277288*360.0
 Parameter: XPHI <- "204.939824"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.474188579"
Evaluating: 0.474188579*360.0
 Parameter: YPHI <- "170.707888"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.352499751E-03"
Evaluating: 8.352499751E-03*360.0
 Parameter: ZPHI <- "3.00689991"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.01214177"
 Parameter: YPOS -> "19.6288704"
 Parameter: ZPOS -> "38.4466847"
 Parameter: XPHI -> "204.939824"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.906751   -0.421666
    0.000000    0.421666   -0.906751

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  155.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.01214177"
 Parameter: YPOS -> "19.6288704"
 Parameter: ZPOS -> "38.4466847"
 Parameter: YPHI -> "170.707888"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.986878    0.000000   -0.161468
    0.000000    1.000000    0.000000
    0.161468    0.000000   -0.986878

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  170.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.01214177"
 Parameter: YPOS -> "19.6288704"
 Parameter: ZPOS -> "38.4466847"
 Parameter: ZPHI -> "3.00689991"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.998623    0.052456    0.000000
   -0.052456    0.998623    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    3.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.012142 XMAX =    7.012142 XAVE =    7.012142
    YMIN =   19.628870 YMAX =   19.628870 YAVE =   19.628870
    ZMIN =   38.446685 ZMAX =   38.446685 ZAVE =   38.446685
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.01214177"
Evaluating: 7.01214177+3.5
 Parameter: XMAX <- "10.5121418"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.6288704"
Evaluating: 19.6288704+3.5
 Parameter: YMAX <- "23.1288704"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.4466847"
Evaluating: 38.4466847+3.5
 Parameter: ZMAX <- "41.9466847"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.01214177"
Evaluating: 7.01214177-3.5
 Parameter: XMIN <- "3.51214177"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.6288704"
Evaluating: 19.6288704-3.5
 Parameter: YMIN <- "16.1288704"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.4466847"
Evaluating: 38.4466847-3.5
 Parameter: ZMIN <- "34.9466847"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.5121418"
 Parameter: XMIN -> "3.51214177"
 Parameter: YMAX -> "23.1288704"
 Parameter: YMIN -> "16.1288704"
 Parameter: ZMAX -> "41.9466847"
 Parameter: ZMIN -> "34.9466847"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "5" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "5" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.765411433"
Evaluating: 81.6823114*(0.765411433-0.5)
 Parameter: XPOS <- "21.6794193"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.345226302"
Evaluating: 81.6823114*(0.345226302-0.5)
 Parameter: YPOS <- "-12.6422734"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.88053563"
Evaluating: 85*(0.88053563-0.5)+0
 Parameter: ZPOS <- "32.3455286"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.3455286" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.3455286" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.6794193"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.6794193-0
 Parameter: XTRAN <- "21.6794193"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.6422734"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.6422734-0
 Parameter: YTRAN <- "-12.6422734"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.3455286"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.3455286-0
 Parameter: ZTRAN <- "32.3455286"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.6794193"
 Parameter: YTRAN -> "-12.6422734"
 Parameter: ZTRAN -> "32.3455286"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    21.679419  -12.642273   32.345529
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.690327471"
Evaluating: 0.690327471*360.0
 Parameter: XPHI <- "248.51789"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.188251828"
Evaluating: 0.188251828*360.0
 Parameter: YPHI <- "67.7706581"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.596620184"
Evaluating: 0.596620184*360.0
 Parameter: ZPHI <- "214.783266"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.6794193"
 Parameter: YPOS -> "-12.6422734"
 Parameter: ZPOS -> "32.3455286"
 Parameter: XPHI -> "248.51789"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.366211   -0.930532
    0.000000    0.930532   -0.366211

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  111.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.6794193"
 Parameter: YPOS -> "-12.6422734"
 Parameter: ZPOS -> "32.3455286"
 Parameter: YPHI -> "67.7706581"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.378315    0.000000   -0.925677
    0.000000    1.000000    0.000000
    0.925677    0.000000    0.378315

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.6794193"
 Parameter: YPOS -> "-12.6422734"
 Parameter: ZPOS -> "32.3455286"
 Parameter: ZPHI -> "214.783266"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.821316   -0.570474    0.000000
    0.570474   -0.821316    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  145.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.679419 XMAX =   21.679419 XAVE =   21.679419
    YMIN =  -12.642273 YMAX =  -12.642273 YAVE =  -12.642273
    ZMIN =   32.345529 ZMAX =   32.345529 ZAVE =   32.345529
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.6794193"
Evaluating: 21.6794193+3.5
 Parameter: XMAX <- "25.1794193"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.6422734"
Evaluating: -12.6422734+3.5
 Parameter: YMAX <- "-9.1422734"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.3455286"
Evaluating: 32.3455286+3.5
 Parameter: ZMAX <- "35.8455286"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.6794193"
Evaluating: 21.6794193-3.5
 Parameter: XMIN <- "18.1794193"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.6422734"
Evaluating: -12.6422734-3.5
 Parameter: YMIN <- "-16.1422734"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.3455286"
Evaluating: 32.3455286-3.5
 Parameter: ZMIN <- "28.8455286"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.1794193"
 Parameter: XMIN -> "18.1794193"
 Parameter: YMAX -> "-9.1422734"
 Parameter: YMIN -> "-16.1422734"
 Parameter: ZMAX -> "35.8455286"
 Parameter: ZMIN -> "28.8455286"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "6" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "6" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.317271246"
Evaluating: 81.6823114*(0.317271246-0.5)
 Parameter: XPOS <- "-14.925707"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.309186577"
Evaluating: 81.6823114*(0.309186577-0.5)
 Parameter: YPOS <- "-15.5860814"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.700974306"
Evaluating: 85*(0.700974306-0.5)+0
 Parameter: ZPOS <- "17.082816"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.082816" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.082816" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.925707"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.925707-0
 Parameter: XTRAN <- "-14.925707"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.5860814"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.5860814-0
 Parameter: YTRAN <- "-15.5860814"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.082816"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.082816-0
 Parameter: ZTRAN <- "17.082816"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.925707"
 Parameter: YTRAN -> "-15.5860814"
 Parameter: ZTRAN -> "17.082816"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -14.925707  -15.586081   17.082816
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.501838745"
Evaluating: 0.501838745*360.0
 Parameter: XPHI <- "180.661948"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.745644301"
Evaluating: 0.745644301*360.0
 Parameter: YPHI <- "268.431948"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453357557"
Evaluating: 0.453357557*360.0
 Parameter: ZPHI <- "163.208721"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.925707"
 Parameter: YPOS -> "-15.5860814"
 Parameter: ZPOS -> "17.082816"
 Parameter: XPHI -> "180.661948"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999933   -0.011553
    0.000000    0.011553   -0.999933

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  179.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.925707"
 Parameter: YPOS -> "-15.5860814"
 Parameter: ZPOS -> "17.082816"
 Parameter: YPHI -> "268.431948"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.027364    0.000000    0.999626
    0.000000    1.000000    0.000000
   -0.999626    0.000000   -0.027364

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.925707"
 Parameter: YPOS -> "-15.5860814"
 Parameter: ZPOS -> "17.082816"
 Parameter: ZPHI -> "163.208721"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.957363    0.288886    0.000000
   -0.288886   -0.957363    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.925707 XMAX =  -14.925707 XAVE =  -14.925707
    YMIN =  -15.586081 YMAX =  -15.586081 YAVE =  -15.586081
    ZMIN =   17.082816 ZMAX =   17.082816 ZAVE =   17.082816
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.925707"
Evaluating: -14.925707+3.5
 Parameter: XMAX <- "-11.425707"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.5860814"
Evaluating: -15.5860814+3.5
 Parameter: YMAX <- "-12.0860814"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.082816"
Evaluating: 17.082816+3.5
 Parameter: ZMAX <- "20.582816"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.925707"
Evaluating: -14.925707-3.5
 Parameter: XMIN <- "-18.425707"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.5860814"
Evaluating: -15.5860814-3.5
 Parameter: YMIN <- "-19.0860814"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.082816"
Evaluating: 17.082816-3.5
 Parameter: ZMIN <- "13.582816"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.425707"
 Parameter: XMIN -> "-18.425707"
 Parameter: YMAX -> "-12.0860814"
 Parameter: YMIN -> "-19.0860814"
 Parameter: ZMAX -> "20.582816"
 Parameter: ZMIN -> "13.582816"
 SELRPN>     32 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     18 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26526 POS      POT      6        POT     -3361 MEMB     POPC     26       C1            3.6799
26526 POS      POT      6        POT     -3364 MEMB     POPC     26       C2            2.7676
26526 POS      POT      6        POT     -3366 MEMB     POPC     26       O21           3.8091
26526 POS      POT      6        POT     -3367 MEMB     POPC     26       C21           3.8375
26526 POS      POT      6        POT     -3368 MEMB     POPC     26       O22           3.1854
26526 POS      POT      6        POT     -3372 MEMB     POPC     26       C3            3.0781
26526 POS      POT      6        POT     -3613 MEMB     POPC     28       C14           3.4136
26526 POS      POT      6        POT     -3624 MEMB     POPC     28       P             3.2262
26526 POS      POT      6        POT     -3625 MEMB     POPC     28       O13           3.1880
26526 POS      POT      6        POT     -3626 MEMB     POPC     28       O14           2.5907
26526 POS      POT      6        POT     -3627 MEMB     POPC     28       O12           3.9553
26526 POS      POT      6        POT     -3658 MEMB     POPC     28       C26           3.3437
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "6" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.92491021"
Evaluating: 81.6823114*(0.92491021-0.5)
 Parameter: XPOS <- "34.7076481"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.270901118"
Evaluating: 81.6823114*(0.270901118-0.5)
 Parameter: YPOS <- "-18.7133262"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.740806212"
Evaluating: 85*(0.740806212-0.5)+0
 Parameter: ZPOS <- "20.468528"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.468528" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.468528" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.925707 XMAX =  -14.925707 XAVE =  -14.925707
    YMIN =  -15.586081 YMAX =  -15.586081 YAVE =  -15.586081
    ZMIN =   17.082816 ZMAX =   17.082816 ZAVE =   17.082816
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.7076481"
 RDCMND substituted energy or value "?XAVE" to "-14.925707"
Evaluating: 34.7076481--14.925707
 Parameter: XTRAN <- "49.6333551"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.7133262"
 RDCMND substituted energy or value "?YAVE" to "-15.5860814"
Evaluating: -18.7133262--15.5860814
 Parameter: YTRAN <- "-3.1272448"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.468528"
 RDCMND substituted energy or value "?ZAVE" to "17.082816"
Evaluating: 20.468528-17.082816
 Parameter: ZTRAN <- "3.385712"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.6333551"
 Parameter: YTRAN -> "-3.1272448"
 Parameter: ZTRAN -> "3.385712"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    49.633355   -3.127245    3.385712
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.112881013"
Evaluating: 0.112881013*360.0
 Parameter: XPHI <- "40.6371647"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174776519"
Evaluating: 0.174776519*360.0
 Parameter: YPHI <- "62.9195468"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.620283745"
Evaluating: 0.620283745*360.0
 Parameter: ZPHI <- "223.302148"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.7076481"
 Parameter: YPOS -> "-18.7133262"
 Parameter: ZPOS -> "20.468528"
 Parameter: XPHI -> "40.6371647"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.758849    0.651267
    0.000000   -0.651267    0.758849

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   40.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.7076481"
 Parameter: YPOS -> "-18.7133262"
 Parameter: ZPOS -> "20.468528"
 Parameter: YPHI -> "62.9195468"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.455241    0.000000   -0.890368
    0.000000    1.000000    0.000000
    0.890368    0.000000    0.455241

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   62.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.7076481"
 Parameter: YPOS -> "-18.7133262"
 Parameter: ZPOS -> "20.468528"
 Parameter: ZPHI -> "223.302148"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.727747   -0.685846    0.000000
    0.685846   -0.727747    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  136.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.707648 XMAX =   34.707648 XAVE =   34.707648
    YMIN =  -18.713326 YMAX =  -18.713326 YAVE =  -18.713326
    ZMIN =   20.468528 ZMAX =   20.468528 ZAVE =   20.468528
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.7076481"
Evaluating: 34.7076481+3.5
 Parameter: XMAX <- "38.2076481"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.7133262"
Evaluating: -18.7133262+3.5
 Parameter: YMAX <- "-15.2133262"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.468528"
Evaluating: 20.468528+3.5
 Parameter: ZMAX <- "23.968528"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.7076481"
Evaluating: 34.7076481-3.5
 Parameter: XMIN <- "31.2076481"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.7133262"
Evaluating: -18.7133262-3.5
 Parameter: YMIN <- "-22.2133262"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.468528"
Evaluating: 20.468528-3.5
 Parameter: ZMIN <- "16.968528"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.2076481"
 Parameter: XMIN -> "31.2076481"
 Parameter: YMAX -> "-15.2133262"
 Parameter: YMIN -> "-22.2133262"
 Parameter: ZMAX -> "23.968528"
 Parameter: ZMIN -> "16.968528"
 SELRPN>     14 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      7 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26526 POS      POT      6        POT     -7573 MEMB     POPC     58       C13           2.9227
26526 POS      POT      6        POT     -**** MEMB     POPC     87       P             2.8055
26526 POS      POT      6        POT     -**** MEMB     POPC     87       O13           1.6687
26526 POS      POT      6        POT     -**** MEMB     POPC     87       O14           3.5836
26526 POS      POT      6        POT     -**** MEMB     POPC     87       O12           3.3606
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "6" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.251271716"
Evaluating: 81.6823114*(0.251271716-0.5)
 Parameter: XPOS <- "-20.3167011"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "8.366950543E-02"
Evaluating: 81.6823114*(8.366950543E-02-0.5)
 Parameter: YPOS <- "-34.0068371"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.45614318"
Evaluating: 85*(0.45614318-0.5)+0
 Parameter: ZPOS <- "-3.7278297"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.7278297" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.7278297" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "6" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "8.475284618E-02"
Evaluating: 81.6823114*(8.475284618E-02-0.5)
 Parameter: XPOS <- "-33.9183473"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.683757294"
Evaluating: 81.6823114*(0.683757294-0.5)
 Parameter: YPOS <- "15.0097205"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.988785736"
Evaluating: 85*(0.988785736-0.5)+0
 Parameter: ZPOS <- "41.5467876"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.5467876" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.5467876" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.707648 XMAX =   34.707648 XAVE =   34.707648
    YMIN =  -18.713326 YMAX =  -18.713326 YAVE =  -18.713326
    ZMIN =   20.468528 ZMAX =   20.468528 ZAVE =   20.468528
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.9183473"
 RDCMND substituted energy or value "?XAVE" to "34.7076481"
Evaluating: -33.9183473-34.7076481
 Parameter: XTRAN <- "-68.6259954"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.0097205"
 RDCMND substituted energy or value "?YAVE" to "-18.7133262"
Evaluating: 15.0097205--18.7133262
 Parameter: YTRAN <- "33.7230467"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.5467876"
 RDCMND substituted energy or value "?ZAVE" to "20.468528"
Evaluating: 41.5467876-20.468528
 Parameter: ZTRAN <- "21.0782596"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-68.6259954"
 Parameter: YTRAN -> "33.7230467"
 Parameter: ZTRAN -> "21.0782596"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -68.625995   33.723047   21.078260
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824828563"
Evaluating: 0.824828563*360.0
 Parameter: XPHI <- "296.938283"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.769843718"
Evaluating: 0.769843718*360.0
 Parameter: YPHI <- "277.143738"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.503785988"
Evaluating: 0.503785988*360.0
 Parameter: ZPHI <- "181.362956"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.9183473"
 Parameter: YPOS -> "15.0097205"
 Parameter: ZPOS -> "41.5467876"
 Parameter: XPHI -> "296.938283"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.453030   -0.891495
    0.000000    0.891495    0.453030

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   63.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.9183473"
 Parameter: YPOS -> "15.0097205"
 Parameter: ZPOS -> "41.5467876"
 Parameter: YPHI -> "277.143738"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.124359    0.000000    0.992237
    0.000000    1.000000    0.000000
   -0.992237    0.000000    0.124359

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.9183473"
 Parameter: YPOS -> "15.0097205"
 Parameter: ZPOS -> "41.5467876"
 Parameter: ZPHI -> "181.362956"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.999717   -0.023786    0.000000
    0.023786   -0.999717    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  178.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.918347 XMAX =  -33.918347 XAVE =  -33.918347
    YMIN =   15.009721 YMAX =   15.009721 YAVE =   15.009721
    ZMIN =   41.546788 ZMAX =   41.546788 ZAVE =   41.546788
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.9183473"
Evaluating: -33.9183473+3.5
 Parameter: XMAX <- "-30.4183473"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.0097205"
Evaluating: 15.0097205+3.5
 Parameter: YMAX <- "18.5097205"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.5467876"
Evaluating: 41.5467876+3.5
 Parameter: ZMAX <- "45.0467876"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.9183473"
Evaluating: -33.9183473-3.5
 Parameter: XMIN <- "-37.4183473"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.0097205"
Evaluating: 15.0097205-3.5
 Parameter: YMIN <- "11.5097205"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.5467876"
Evaluating: 41.5467876-3.5
 Parameter: ZMIN <- "38.0467876"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.4183473"
 Parameter: XMIN -> "-37.4183473"
 Parameter: YMAX -> "18.5097205"
 Parameter: YMIN -> "11.5097205"
 Parameter: ZMAX -> "45.0467876"
 Parameter: ZMIN -> "38.0467876"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "7" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "7" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.555398294"
Evaluating: 81.6823114*(0.555398294-0.5)
 Parameter: XPOS <- "4.5250607"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.343368296"
Evaluating: 81.6823114*(0.343368296-0.5)
 Parameter: YPOS <- "-12.7940396"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "5.983966407E-03"
Evaluating: 85*(5.983966407E-03-0.5)+0
 Parameter: ZPOS <- "-41.9913629"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.9913629" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.5250607"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.5250607-0
 Parameter: XTRAN <- "4.5250607"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.7940396"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.7940396-0
 Parameter: YTRAN <- "-12.7940396"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.9913629"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.9913629-0
 Parameter: ZTRAN <- "-41.9913629"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.5250607"
 Parameter: YTRAN -> "-12.7940396"
 Parameter: ZTRAN -> "-41.9913629"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     4.525061  -12.794040  -41.991363
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824930202"
Evaluating: 0.824930202*360.0
 Parameter: XPHI <- "296.974873"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452590656"
Evaluating: 0.452590656*360.0
 Parameter: YPHI <- "162.932636"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.893698236"
Evaluating: 0.893698236*360.0
 Parameter: ZPHI <- "321.731365"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.5250607"
 Parameter: YPOS -> "-12.7940396"
 Parameter: ZPOS -> "-41.9913629"
 Parameter: XPHI -> "296.974873"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.453600   -0.891206
    0.000000    0.891206    0.453600

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   63.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.5250607"
 Parameter: YPOS -> "-12.7940396"
 Parameter: ZPOS -> "-41.9913629"
 Parameter: YPHI -> "162.932636"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.955960    0.000000   -0.293496
    0.000000    1.000000    0.000000
    0.293496    0.000000   -0.955960

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.5250607"
 Parameter: YPOS -> "-12.7940396"
 Parameter: ZPOS -> "-41.9913629"
 Parameter: ZPHI -> "321.731365"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.785116   -0.619349    0.000000
    0.619349    0.785116    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   38.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.525061 XMAX =    4.525061 XAVE =    4.525061
    YMIN =  -12.794040 YMAX =  -12.794040 YAVE =  -12.794040
    ZMIN =  -41.991363 ZMAX =  -41.991363 ZAVE =  -41.991363
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.5250607"
Evaluating: 4.5250607+3.5
 Parameter: XMAX <- "8.0250607"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.7940396"
Evaluating: -12.7940396+3.5
 Parameter: YMAX <- "-9.2940396"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.9913629"
Evaluating: -41.9913629+3.5
 Parameter: ZMAX <- "-38.4913629"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.5250607"
Evaluating: 4.5250607-3.5
 Parameter: XMIN <- "1.0250607"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.7940396"
Evaluating: -12.7940396-3.5
 Parameter: YMIN <- "-16.2940396"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.9913629"
Evaluating: -41.9913629-3.5
 Parameter: ZMIN <- "-45.4913629"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.0250607"
 Parameter: XMIN -> "1.0250607"
 Parameter: YMAX -> "-9.2940396"
 Parameter: YMIN -> "-16.2940396"
 Parameter: ZMAX -> "-38.4913629"
 Parameter: ZMIN -> "-45.4913629"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "8" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "8" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.572923751"
Evaluating: 81.6823114*(0.572923751-0.5)
 Parameter: XPOS <- "5.95658054"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.620198822"
Evaluating: 81.6823114*(0.620198822-0.5)
 Parameter: YPOS <- "9.81811761"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.47115807"
Evaluating: 85*(0.47115807-0.5)+0
 Parameter: ZPOS <- "-2.45156405"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.45156405" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.45156405" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "8" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.43417597"
Evaluating: 81.6823114*(0.43417597-0.5)
 Parameter: XPOS <- "-5.37665892"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.493349833"
Evaluating: 81.6823114*(0.493349833-0.5)
 Parameter: YPOS <- "-0.543201012"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.659202194"
Evaluating: 85*(0.659202194-0.5)+0
 Parameter: ZPOS <- "13.5321865"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.5321865" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.5321865" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "8" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.567150165"
Evaluating: 81.6823114*(0.567150165-0.5)
 Parameter: XPOS <- "5.48498069"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.596162358"
Evaluating: 81.6823114*(0.596162358-0.5)
 Parameter: YPOS <- "7.85476367"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.172277151"
Evaluating: 85*(0.172277151-0.5)+0
 Parameter: ZPOS <- "-27.8564422"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.8564422" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.48498069"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.48498069-0
 Parameter: XTRAN <- "5.48498069"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.85476367"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.85476367-0
 Parameter: YTRAN <- "7.85476367"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.8564422"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.8564422-0
 Parameter: ZTRAN <- "-27.8564422"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.48498069"
 Parameter: YTRAN -> "7.85476367"
 Parameter: ZTRAN -> "-27.8564422"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     5.484981    7.854764  -27.856442
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.331112833"
Evaluating: 0.331112833*360.0
 Parameter: XPHI <- "119.20062"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201406751"
Evaluating: 0.201406751*360.0
 Parameter: YPHI <- "72.5064304"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.368809729"
Evaluating: 0.368809729*360.0
 Parameter: ZPHI <- "132.771502"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.48498069"
 Parameter: YPOS -> "7.85476367"
 Parameter: ZPOS -> "-27.8564422"
 Parameter: XPHI -> "119.20062"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.487869    0.872917
    0.000000   -0.872917   -0.487869

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  119.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.48498069"
 Parameter: YPOS -> "7.85476367"
 Parameter: ZPOS -> "-27.8564422"
 Parameter: YPHI -> "72.5064304"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.300599    0.000000   -0.953751
    0.000000    1.000000    0.000000
    0.953751    0.000000    0.300599

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   72.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.48498069"
 Parameter: YPOS -> "7.85476367"
 Parameter: ZPOS -> "-27.8564422"
 Parameter: ZPHI -> "132.771502"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.679076    0.734068    0.000000
   -0.734068   -0.679076    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  132.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.484981 XMAX =    5.484981 XAVE =    5.484981
    YMIN =    7.854764 YMAX =    7.854764 YAVE =    7.854764
    ZMIN =  -27.856442 ZMAX =  -27.856442 ZAVE =  -27.856442
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.48498069"
Evaluating: 5.48498069+3.5
 Parameter: XMAX <- "8.98498069"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.85476367"
Evaluating: 7.85476367+3.5
 Parameter: YMAX <- "11.3547637"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.8564422"
Evaluating: -27.8564422+3.5
 Parameter: ZMAX <- "-24.3564422"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.48498069"
Evaluating: 5.48498069-3.5
 Parameter: XMIN <- "1.98498069"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.85476367"
Evaluating: 7.85476367-3.5
 Parameter: YMIN <- "4.35476367"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.8564422"
Evaluating: -27.8564422-3.5
 Parameter: ZMIN <- "-31.3564422"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.98498069"
 Parameter: XMIN -> "1.98498069"
 Parameter: YMAX -> "11.3547637"
 Parameter: YMIN -> "4.35476367"
 Parameter: ZMAX -> "-24.3564422"
 Parameter: ZMIN -> "-31.3564422"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "9" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "9" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.335561241"
Evaluating: 81.6823114*(0.335561241-0.5)
 Parameter: XPOS <- "-13.4317379"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.921003651"
Evaluating: 81.6823114*(0.921003651-0.5)
 Parameter: YPOS <- "34.3885513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.420283097"
Evaluating: 85*(0.420283097-0.5)+0
 Parameter: ZPOS <- "-6.77593676"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.77593676" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.77593676" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "9" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.455380562"
Evaluating: 81.6823114*(0.455380562-0.5)
 Parameter: XPOS <- "-3.64461883"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.211998692"
Evaluating: 81.6823114*(0.211998692-0.5)
 Parameter: YPOS <- "-23.5246125"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.549019157"
Evaluating: 85*(0.549019157-0.5)+0
 Parameter: ZPOS <- "4.16662835"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.16662835" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.16662835" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "9" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.785069001"
Evaluating: 81.6823114*(0.785069001-0.5)
 Parameter: XPOS <- "23.2850949"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.749463672"
Evaluating: 81.6823114*(0.749463672-0.5)
 Parameter: YPOS <- "20.3767693"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.580691326"
Evaluating: 85*(0.580691326-0.5)+0
 Parameter: ZPOS <- "6.85876271"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.85876271" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.85876271" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "9" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.111758767"
Evaluating: 81.6823114*(0.111758767-0.5)
 Parameter: XPOS <- "-31.7124413"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.925157706"
Evaluating: 81.6823114*(0.925157706-0.5)
 Parameter: YPOS <- "34.7278641"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.541166133"
Evaluating: 85*(0.541166133-0.5)+0
 Parameter: ZPOS <- "3.49912131"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.49912131" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.49912131" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "9" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.938754538"
Evaluating: 81.6823114*(0.938754538-0.5)
 Parameter: XPOS <- "35.8384848"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.678265306"
Evaluating: 81.6823114*(0.678265306-0.5)
 Parameter: YPOS <- "14.5611222"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.355522663"
Evaluating: 85*(0.355522663-0.5)+0
 Parameter: ZPOS <- "-12.2805736"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.2805736" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.2805736" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "9" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.434977745"
Evaluating: 81.6823114*(0.434977745-0.5)
 Parameter: XPOS <- "-5.31116808"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.151278903"
Evaluating: 81.6823114*(0.151278903-0.5)
 Parameter: YPOS <- "-28.4843452"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.776482107"
Evaluating: 85*(0.776482107-0.5)+0
 Parameter: ZPOS <- "23.5009791"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.5009791" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.5009791" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.31116808"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.31116808-0
 Parameter: XTRAN <- "-5.31116808"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.4843452"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.4843452-0
 Parameter: YTRAN <- "-28.4843452"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.5009791"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.5009791-0
 Parameter: ZTRAN <- "23.5009791"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.31116808"
 Parameter: YTRAN -> "-28.4843452"
 Parameter: ZTRAN -> "23.5009791"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -5.311168  -28.484345   23.500979
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.729293979"
Evaluating: 0.729293979*360.0
 Parameter: XPHI <- "262.545832"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.520328368"
Evaluating: 0.520328368*360.0
 Parameter: YPHI <- "187.318212"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.808751187"
Evaluating: 0.808751187*360.0
 Parameter: ZPHI <- "291.150427"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.31116808"
 Parameter: YPOS -> "-28.4843452"
 Parameter: ZPOS -> "23.5009791"
 Parameter: XPHI -> "262.545832"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.129733   -0.991549
    0.000000    0.991549   -0.129733

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   97.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.31116808"
 Parameter: YPOS -> "-28.4843452"
 Parameter: ZPOS -> "23.5009791"
 Parameter: YPHI -> "187.318212"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.991854    0.000000    0.127380
    0.000000    1.000000    0.000000
   -0.127380    0.000000   -0.991854

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  172.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.31116808"
 Parameter: YPOS -> "-28.4843452"
 Parameter: ZPOS -> "23.5009791"
 Parameter: ZPHI -> "291.150427"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.360818   -0.932636    0.000000
    0.932636    0.360818    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.311168 XMAX =   -5.311168 XAVE =   -5.311168
    YMIN =  -28.484345 YMAX =  -28.484345 YAVE =  -28.484345
    ZMIN =   23.500979 ZMAX =   23.500979 ZAVE =   23.500979
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.31116808"
Evaluating: -5.31116808+3.5
 Parameter: XMAX <- "-1.81116808"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.4843452"
Evaluating: -28.4843452+3.5
 Parameter: YMAX <- "-24.9843452"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.5009791"
Evaluating: 23.5009791+3.5
 Parameter: ZMAX <- "27.0009791"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.31116808"
Evaluating: -5.31116808-3.5
 Parameter: XMIN <- "-8.81116808"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.4843452"
Evaluating: -28.4843452-3.5
 Parameter: YMIN <- "-31.9843452"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.5009791"
Evaluating: 23.5009791-3.5
 Parameter: ZMIN <- "20.0009791"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.81116808"
 Parameter: XMIN -> "-8.81116808"
 Parameter: YMAX -> "-24.9843452"
 Parameter: YMIN -> "-31.9843452"
 Parameter: ZMAX -> "27.0009791"
 Parameter: ZMIN -> "20.0009791"
 SELRPN>     10 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      4 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26529 POS      POT      9        POT     -4011 MEMB     POPC     31       C13           3.3446
26529 POS      POT      9        POT     -4015 MEMB     POPC     31       C14           3.9805
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "9" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.523584444"
Evaluating: 81.6823114*(0.523584444-0.5)
 Parameter: XPOS <- "1.9264319"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.848819826"
Evaluating: 81.6823114*(0.848819826-0.5)
 Parameter: YPOS <- "28.4924096"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.969151973"
Evaluating: 85*(0.969151973-0.5)+0
 Parameter: ZPOS <- "39.8779177"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.8779177" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.8779177" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.311168 XMAX =   -5.311168 XAVE =   -5.311168
    YMIN =  -28.484345 YMAX =  -28.484345 YAVE =  -28.484345
    ZMIN =   23.500979 ZMAX =   23.500979 ZAVE =   23.500979
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.9264319"
 RDCMND substituted energy or value "?XAVE" to "-5.31116808"
Evaluating: 1.9264319--5.31116808
 Parameter: XTRAN <- "7.23759998"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.4924096"
 RDCMND substituted energy or value "?YAVE" to "-28.4843452"
Evaluating: 28.4924096--28.4843452
 Parameter: YTRAN <- "56.9767548"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.8779177"
 RDCMND substituted energy or value "?ZAVE" to "23.5009791"
Evaluating: 39.8779177-23.5009791
 Parameter: ZTRAN <- "16.3769386"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.23759998"
 Parameter: YTRAN -> "56.9767548"
 Parameter: ZTRAN -> "16.3769386"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     7.237600   56.976755   16.376939
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.411223843"
Evaluating: 0.411223843*360.0
 Parameter: XPHI <- "148.040583"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369502166"
Evaluating: 0.369502166*360.0
 Parameter: YPHI <- "133.02078"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.788184884"
Evaluating: 0.788184884*360.0
 Parameter: ZPHI <- "283.746558"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.9264319"
 Parameter: YPOS -> "28.4924096"
 Parameter: ZPOS -> "39.8779177"
 Parameter: XPHI -> "148.040583"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.848423    0.529318
    0.000000   -0.529318   -0.848423

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  148.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.9264319"
 Parameter: YPOS -> "28.4924096"
 Parameter: ZPOS -> "39.8779177"
 Parameter: YPHI -> "133.02078"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.682264    0.000000   -0.731106
    0.000000    1.000000    0.000000
    0.731106    0.000000   -0.682264

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  133.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.9264319"
 Parameter: YPOS -> "28.4924096"
 Parameter: ZPOS -> "39.8779177"
 Parameter: ZPHI -> "283.746558"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.237628   -0.971356    0.000000
    0.971356    0.237628    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   76.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.926432 XMAX =    1.926432 XAVE =    1.926432
    YMIN =   28.492410 YMAX =   28.492410 YAVE =   28.492410
    ZMIN =   39.877918 ZMAX =   39.877918 ZAVE =   39.877918
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.9264319"
Evaluating: 1.9264319+3.5
 Parameter: XMAX <- "5.4264319"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.4924096"
Evaluating: 28.4924096+3.5
 Parameter: YMAX <- "31.9924096"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.8779177"
Evaluating: 39.8779177+3.5
 Parameter: ZMAX <- "43.3779177"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.9264319"
Evaluating: 1.9264319-3.5
 Parameter: XMIN <- "-1.5735681"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.4924096"
Evaluating: 28.4924096-3.5
 Parameter: YMIN <- "24.9924096"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.8779177"
Evaluating: 39.8779177-3.5
 Parameter: ZMIN <- "36.3779177"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.4264319"
 Parameter: XMIN -> "-1.5735681"
 Parameter: YMAX -> "31.9924096"
 Parameter: YMIN -> "24.9924096"
 Parameter: ZMAX -> "43.3779177"
 Parameter: ZMIN -> "36.3779177"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "10" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "10" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.462089074"
Evaluating: 81.6823114*(0.462089074-0.5)
 Parameter: XPOS <- "-3.09665206"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.51063529"
Evaluating: 81.6823114*(0.51063529-0.5)
 Parameter: YPOS <- "0.86871507"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.685794008"
Evaluating: 85*(0.685794008-0.5)+0
 Parameter: ZPOS <- "15.7924907"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.7924907" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.7924907" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.09665206"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.09665206-0
 Parameter: XTRAN <- "-3.09665206"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.86871507"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.86871507-0
 Parameter: YTRAN <- "0.86871507"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.7924907"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.7924907-0
 Parameter: ZTRAN <- "15.7924907"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.09665206"
 Parameter: YTRAN -> "0.86871507"
 Parameter: ZTRAN -> "15.7924907"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -3.096652    0.868715   15.792491
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.718884345"
Evaluating: 0.718884345*360.0
 Parameter: XPHI <- "258.798364"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.55583083"
Evaluating: 0.55583083*360.0
 Parameter: YPHI <- "200.099099"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.639413851"
Evaluating: 0.639413851*360.0
 Parameter: ZPHI <- "230.188986"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.09665206"
 Parameter: YPOS -> "0.86871507"
 Parameter: ZPOS -> "15.7924907"
 Parameter: XPHI -> "258.798364"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.194262   -0.980950
    0.000000    0.980950   -0.194262

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.09665206"
 Parameter: YPOS -> "0.86871507"
 Parameter: ZPOS -> "15.7924907"
 Parameter: YPHI -> "200.099099"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.939100    0.000000    0.343645
    0.000000    1.000000    0.000000
   -0.343645    0.000000   -0.939100

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  159.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.09665206"
 Parameter: YPOS -> "0.86871507"
 Parameter: ZPOS -> "15.7924907"
 Parameter: ZPHI -> "230.188986"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.640257   -0.768160    0.000000
    0.768160   -0.640257    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  129.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.096652 XMAX =   -3.096652 XAVE =   -3.096652
    YMIN =    0.868715 YMAX =    0.868715 YAVE =    0.868715
    ZMIN =   15.792491 ZMAX =   15.792491 ZAVE =   15.792491
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.09665206"
Evaluating: -3.09665206+3.5
 Parameter: XMAX <- "0.40334794"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.86871507"
Evaluating: 0.86871507+3.5
 Parameter: YMAX <- "4.36871507"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.7924907"
Evaluating: 15.7924907+3.5
 Parameter: ZMAX <- "19.2924907"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.09665206"
Evaluating: -3.09665206-3.5
 Parameter: XMIN <- "-6.59665206"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.86871507"
Evaluating: 0.86871507-3.5
 Parameter: YMIN <- "-2.63128493"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.7924907"
Evaluating: 15.7924907-3.5
 Parameter: ZMIN <- "12.2924907"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.40334794"
 Parameter: XMIN -> "-6.59665206"
 Parameter: YMAX -> "4.36871507"
 Parameter: YMIN -> "-2.63128493"
 Parameter: ZMAX -> "19.2924907"
 Parameter: ZMIN -> "12.2924907"
 SELRPN>      7 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      5 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26530 POS      POT      10       POT     - 154 MEMB     POPC     2        P             2.5797
26530 POS      POT      10       POT     - 155 MEMB     POPC     2        O13           1.4930
26530 POS      POT      10       POT     - 156 MEMB     POPC     2        O14           3.0973
26530 POS      POT      10       POT     - 157 MEMB     POPC     2        O12           3.6981
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "10" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.634479166"
Evaluating: 81.6823114*(0.634479166-0.5)
 Parameter: XPOS <- "10.9845691"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.828438617"
Evaluating: 81.6823114*(0.828438617-0.5)
 Parameter: YPOS <- "26.8276254"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.787951159"
Evaluating: 85*(0.787951159-0.5)+0
 Parameter: ZPOS <- "24.4758485"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.4758485" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.4758485" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.096652 XMAX =   -3.096652 XAVE =   -3.096652
    YMIN =    0.868715 YMAX =    0.868715 YAVE =    0.868715
    ZMIN =   15.792491 ZMAX =   15.792491 ZAVE =   15.792491
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.9845691"
 RDCMND substituted energy or value "?XAVE" to "-3.09665206"
Evaluating: 10.9845691--3.09665206
 Parameter: XTRAN <- "14.0812212"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.8276254"
 RDCMND substituted energy or value "?YAVE" to "0.86871507"
Evaluating: 26.8276254-0.86871507
 Parameter: YTRAN <- "25.9589103"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.4758485"
 RDCMND substituted energy or value "?ZAVE" to "15.7924907"
Evaluating: 24.4758485-15.7924907
 Parameter: ZTRAN <- "8.6833578"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.0812212"
 Parameter: YTRAN -> "25.9589103"
 Parameter: ZTRAN -> "8.6833578"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    14.081221   25.958910    8.683358
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.240931673"
Evaluating: 0.240931673*360.0
 Parameter: XPHI <- "86.7354023"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.670338575"
Evaluating: 0.670338575*360.0
 Parameter: YPHI <- "241.321887"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658248132"
Evaluating: 0.658248132*360.0
 Parameter: ZPHI <- "236.969328"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.9845691"
 Parameter: YPOS -> "26.8276254"
 Parameter: ZPOS -> "24.4758485"
 Parameter: XPHI -> "86.7354023"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.056947    0.998377
    0.000000   -0.998377    0.056947

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   86.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.9845691"
 Parameter: YPOS -> "26.8276254"
 Parameter: ZPOS -> "24.4758485"
 Parameter: YPHI -> "241.321887"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.479888    0.000000    0.877330
    0.000000    1.000000    0.000000
   -0.877330    0.000000   -0.479888

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  118.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.9845691"
 Parameter: YPOS -> "26.8276254"
 Parameter: ZPOS -> "24.4758485"
 Parameter: ZPHI -> "236.969328"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.545088   -0.838379    0.000000
    0.838379   -0.545088    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  123.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.984569 XMAX =   10.984569 XAVE =   10.984569
    YMIN =   26.827625 YMAX =   26.827625 YAVE =   26.827625
    ZMIN =   24.475848 ZMAX =   24.475848 ZAVE =   24.475848
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.9845691"
Evaluating: 10.9845691+3.5
 Parameter: XMAX <- "14.4845691"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.8276254"
Evaluating: 26.8276254+3.5
 Parameter: YMAX <- "30.3276254"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.4758485"
Evaluating: 24.4758485+3.5
 Parameter: ZMAX <- "27.9758485"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.9845691"
Evaluating: 10.9845691-3.5
 Parameter: XMIN <- "7.4845691"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.8276254"
Evaluating: 26.8276254-3.5
 Parameter: YMIN <- "23.3276254"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.4758485"
Evaluating: 24.4758485-3.5
 Parameter: ZMIN <- "20.9758485"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.4845691"
 Parameter: XMIN -> "7.4845691"
 Parameter: YMAX -> "30.3276254"
 Parameter: YMIN -> "23.3276254"
 Parameter: ZMAX -> "27.9758485"
 Parameter: ZMIN -> "20.9758485"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "11" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "11" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.842603809"
Evaluating: 81.6823114*(0.842603809-0.5)
 Parameter: XPOS <- "27.984671"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "9.713992543E-02"
Evaluating: 81.6823114*(9.713992543E-02-0.5)
 Parameter: YPOS <- "-32.9065421"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "7.451181217E-02"
Evaluating: 85*(7.451181217E-02-0.5)+0
 Parameter: ZPOS <- "-36.166496"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.166496" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.984671"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.984671-0
 Parameter: XTRAN <- "27.984671"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.9065421"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.9065421-0
 Parameter: YTRAN <- "-32.9065421"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.166496"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.166496-0
 Parameter: ZTRAN <- "-36.166496"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.984671"
 Parameter: YTRAN -> "-32.9065421"
 Parameter: ZTRAN -> "-36.166496"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    27.984671  -32.906542  -36.166496
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.631114344"
Evaluating: 0.631114344*360.0
 Parameter: XPHI <- "227.201164"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406936295"
Evaluating: 0.406936295*360.0
 Parameter: YPHI <- "146.497066"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.912668821"
Evaluating: 0.912668821*360.0
 Parameter: ZPHI <- "328.560776"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.984671"
 Parameter: YPOS -> "-32.9065421"
 Parameter: ZPOS -> "-36.166496"
 Parameter: XPHI -> "227.201164"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.679426   -0.733744
    0.000000    0.733744   -0.679426

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  132.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.984671"
 Parameter: YPOS -> "-32.9065421"
 Parameter: ZPOS -> "-36.166496"
 Parameter: YPHI -> "146.497066"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.833858    0.000000   -0.551980
    0.000000    1.000000    0.000000
    0.551980    0.000000   -0.833858

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  146.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.984671"
 Parameter: YPOS -> "-32.9065421"
 Parameter: ZPOS -> "-36.166496"
 Parameter: ZPHI -> "328.560776"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.853194   -0.521594    0.000000
    0.521594    0.853194    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   31.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.984671 XMAX =   27.984671 XAVE =   27.984671
    YMIN =  -32.906542 YMAX =  -32.906542 YAVE =  -32.906542
    ZMIN =  -36.166496 ZMAX =  -36.166496 ZAVE =  -36.166496
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.984671"
Evaluating: 27.984671+3.5
 Parameter: XMAX <- "31.484671"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.9065421"
Evaluating: -32.9065421+3.5
 Parameter: YMAX <- "-29.4065421"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.166496"
Evaluating: -36.166496+3.5
 Parameter: ZMAX <- "-32.666496"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.984671"
Evaluating: 27.984671-3.5
 Parameter: XMIN <- "24.484671"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.9065421"
Evaluating: -32.9065421-3.5
 Parameter: YMIN <- "-36.4065421"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.166496"
Evaluating: -36.166496-3.5
 Parameter: ZMIN <- "-39.666496"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.484671"
 Parameter: XMIN -> "24.484671"
 Parameter: YMAX -> "-29.4065421"
 Parameter: YMIN -> "-36.4065421"
 Parameter: ZMAX -> "-32.666496"
 Parameter: ZMIN -> "-39.666496"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "12" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "12" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.804982401"
Evaluating: 81.6823114*(0.804982401-0.5)
 Parameter: XPOS <- "24.9116675"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "1.18878375E-03"
Evaluating: 81.6823114*(1.18878375E-03-0.5)
 Parameter: YPOS <- "-40.7440531"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.187149383"
Evaluating: 85*(0.187149383-0.5)+0
 Parameter: ZPOS <- "-26.5923024"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.5923024" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.9116675"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 24.9116675-0
 Parameter: XTRAN <- "24.9116675"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.7440531"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.7440531-0
 Parameter: YTRAN <- "-40.7440531"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.5923024"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.5923024-0
 Parameter: ZTRAN <- "-26.5923024"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.9116675"
 Parameter: YTRAN -> "-40.7440531"
 Parameter: ZTRAN -> "-26.5923024"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    24.911668  -40.744053  -26.592302
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.380941002"
Evaluating: 0.380941002*360.0
 Parameter: XPHI <- "137.138761"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.771947553"
Evaluating: 0.771947553*360.0
 Parameter: YPHI <- "277.901119"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335885808"
Evaluating: 0.335885808*360.0
 Parameter: ZPHI <- "120.918891"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.9116675"
 Parameter: YPOS -> "-40.7440531"
 Parameter: ZPOS -> "-26.5923024"
 Parameter: XPHI -> "137.138761"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.733003    0.680225
    0.000000   -0.680225   -0.733003

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.9116675"
 Parameter: YPOS -> "-40.7440531"
 Parameter: ZPOS -> "-26.5923024"
 Parameter: YPHI -> "277.901119"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.137464    0.000000    0.990507
    0.000000    1.000000    0.000000
   -0.990507    0.000000    0.137464

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.9116675"
 Parameter: YPOS -> "-40.7440531"
 Parameter: ZPOS -> "-26.5923024"
 Parameter: ZPHI -> "120.918891"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.513824    0.857896    0.000000
   -0.857896   -0.513824    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.911668 XMAX =   24.911668 XAVE =   24.911668
    YMIN =  -40.744053 YMAX =  -40.744053 YAVE =  -40.744053
    ZMIN =  -26.592302 ZMAX =  -26.592302 ZAVE =  -26.592302
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.9116675"
Evaluating: 24.9116675+3.5
 Parameter: XMAX <- "28.4116675"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.7440531"
Evaluating: -40.7440531+3.5
 Parameter: YMAX <- "-37.2440531"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.5923024"
Evaluating: -26.5923024+3.5
 Parameter: ZMAX <- "-23.0923024"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.9116675"
Evaluating: 24.9116675-3.5
 Parameter: XMIN <- "21.4116675"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.7440531"
Evaluating: -40.7440531-3.5
 Parameter: YMIN <- "-44.2440531"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.5923024"
Evaluating: -26.5923024-3.5
 Parameter: ZMIN <- "-30.0923024"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.4116675"
 Parameter: XMIN -> "21.4116675"
 Parameter: YMAX -> "-37.2440531"
 Parameter: YMIN -> "-44.2440531"
 Parameter: ZMAX -> "-23.0923024"
 Parameter: ZMIN -> "-30.0923024"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "13" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "13" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.24082606"
Evaluating: 81.6823114*(0.24082606-0.5)
 Parameter: XPOS <- "-21.1699265"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.907713223"
Evaluating: 81.6823114*(0.907713223-0.5)
 Parameter: YPOS <- "33.3029584"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.453277939"
Evaluating: 85*(0.453277939-0.5)+0
 Parameter: ZPOS <- "-3.97137519"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.97137519" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.97137519" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "13" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.172622109"
Evaluating: 81.6823114*(0.172622109-0.5)
 Parameter: XPOS <- "-26.7409828"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.244476058"
Evaluating: 81.6823114*(0.244476058-0.5)
 Parameter: YPOS <- "-20.8717862"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.249080753"
Evaluating: 85*(0.249080753-0.5)+0
 Parameter: ZPOS <- "-21.328136"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.328136" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.7409828"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.7409828-0
 Parameter: XTRAN <- "-26.7409828"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.8717862"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.8717862-0
 Parameter: YTRAN <- "-20.8717862"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.328136"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.328136-0
 Parameter: ZTRAN <- "-21.328136"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.7409828"
 Parameter: YTRAN -> "-20.8717862"
 Parameter: ZTRAN -> "-21.328136"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -26.740983  -20.871786  -21.328136
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.135997036"
Evaluating: 0.135997036*360.0
 Parameter: XPHI <- "48.958933"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.615154009"
Evaluating: 0.615154009*360.0
 Parameter: YPHI <- "221.455443"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.87316178"
Evaluating: 0.87316178*360.0
 Parameter: ZPHI <- "314.338241"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.7409828"
 Parameter: YPOS -> "-20.8717862"
 Parameter: ZPOS -> "-21.328136"
 Parameter: XPHI -> "48.958933"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.656600    0.754239
    0.000000   -0.754239    0.656600

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   48.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.7409828"
 Parameter: YPOS -> "-20.8717862"
 Parameter: ZPOS -> "-21.328136"
 Parameter: YPHI -> "221.455443"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.749471    0.000000    0.662037
    0.000000    1.000000    0.000000
   -0.662037    0.000000   -0.749471

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  138.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.7409828"
 Parameter: YPOS -> "-20.8717862"
 Parameter: ZPOS -> "-21.328136"
 Parameter: ZPHI -> "314.338241"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.698893   -0.715226    0.000000
    0.715226    0.698893    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.740983 XMAX =  -26.740983 XAVE =  -26.740983
    YMIN =  -20.871786 YMAX =  -20.871786 YAVE =  -20.871786
    ZMIN =  -21.328136 ZMAX =  -21.328136 ZAVE =  -21.328136
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.7409828"
Evaluating: -26.7409828+3.5
 Parameter: XMAX <- "-23.2409828"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.8717862"
Evaluating: -20.8717862+3.5
 Parameter: YMAX <- "-17.3717862"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.328136"
Evaluating: -21.328136+3.5
 Parameter: ZMAX <- "-17.828136"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.7409828"
Evaluating: -26.7409828-3.5
 Parameter: XMIN <- "-30.2409828"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.8717862"
Evaluating: -20.8717862-3.5
 Parameter: YMIN <- "-24.3717862"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.328136"
Evaluating: -21.328136-3.5
 Parameter: ZMIN <- "-24.828136"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.2409828"
 Parameter: XMIN -> "-30.2409828"
 Parameter: YMAX -> "-17.3717862"
 Parameter: YMIN -> "-24.3717862"
 Parameter: ZMAX -> "-17.828136"
 Parameter: ZMIN -> "-24.828136"
 SELRPN>     10 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      6 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26533 POS      POT      13       POT     -**** MEMB     POPC     145      C13           3.3428
26533 POS      POT      13       POT     -**** MEMB     POPC     145      P             3.7744
26533 POS      POT      13       POT     -**** MEMB     POPC     145      O13           2.7707
26533 POS      POT      13       POT     -**** MEMB     POPC     145      O12           3.4238
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "13" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.269725757"
Evaluating: 81.6823114*(0.269725757-0.5)
 Parameter: XPOS <- "-18.8093324"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.854544105"
Evaluating: 81.6823114*(0.854544105-0.5)
 Parameter: YPOS <- "28.959982"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "9.341935199E-02"
Evaluating: 85*(9.341935199E-02-0.5)+0
 Parameter: ZPOS <- "-34.5593551"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.5593551" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.740983 XMAX =  -26.740983 XAVE =  -26.740983
    YMIN =  -20.871786 YMAX =  -20.871786 YAVE =  -20.871786
    ZMIN =  -21.328136 ZMAX =  -21.328136 ZAVE =  -21.328136
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.8093324"
 RDCMND substituted energy or value "?XAVE" to "-26.7409828"
Evaluating: -18.8093324--26.7409828
 Parameter: XTRAN <- "7.9316504"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.959982"
 RDCMND substituted energy or value "?YAVE" to "-20.8717862"
Evaluating: 28.959982--20.8717862
 Parameter: YTRAN <- "49.8317682"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.5593551"
 RDCMND substituted energy or value "?ZAVE" to "-21.328136"
Evaluating: -34.5593551--21.328136
 Parameter: ZTRAN <- "-13.2312191"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.9316504"
 Parameter: YTRAN -> "49.8317682"
 Parameter: ZTRAN -> "-13.2312191"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     7.931650   49.831768  -13.231219
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.720913534E-02"
Evaluating: 2.720913534E-02*360.0
 Parameter: XPHI <- "9.79528872"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.8926891"
Evaluating: 0.8926891*360.0
 Parameter: YPHI <- "321.368076"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.599283336"
Evaluating: 0.599283336*360.0
 Parameter: ZPHI <- "215.742001"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.8093324"
 Parameter: YPOS -> "28.959982"
 Parameter: ZPOS -> "-34.5593551"
 Parameter: XPHI -> "9.79528872"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.985422    0.170128
    0.000000   -0.170128    0.985422

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.8093324"
 Parameter: YPOS -> "28.959982"
 Parameter: ZPOS -> "-34.5593551"
 Parameter: YPHI -> "321.368076"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.781173    0.000000    0.624315
    0.000000    1.000000    0.000000
   -0.624315    0.000000    0.781173

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   38.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.8093324"
 Parameter: YPOS -> "28.959982"
 Parameter: ZPOS -> "-34.5593551"
 Parameter: ZPHI -> "215.742001"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.811656   -0.584136    0.000000
    0.584136   -0.811656    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.809332 XMAX =  -18.809332 XAVE =  -18.809332
    YMIN =   28.959982 YMAX =   28.959982 YAVE =   28.959982
    ZMIN =  -34.559355 ZMAX =  -34.559355 ZAVE =  -34.559355
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.8093324"
Evaluating: -18.8093324+3.5
 Parameter: XMAX <- "-15.3093324"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.959982"
Evaluating: 28.959982+3.5
 Parameter: YMAX <- "32.459982"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.5593551"
Evaluating: -34.5593551+3.5
 Parameter: ZMAX <- "-31.0593551"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.8093324"
Evaluating: -18.8093324-3.5
 Parameter: XMIN <- "-22.3093324"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.959982"
Evaluating: 28.959982-3.5
 Parameter: YMIN <- "25.459982"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.5593551"
Evaluating: -34.5593551-3.5
 Parameter: ZMIN <- "-38.0593551"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.3093324"
 Parameter: XMIN -> "-22.3093324"
 Parameter: YMAX -> "32.459982"
 Parameter: YMIN -> "25.459982"
 Parameter: ZMAX -> "-31.0593551"
 Parameter: ZMIN -> "-38.0593551"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "14" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "14" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.373295577"
Evaluating: 81.6823114*(0.373295577-0.5)
 Parameter: XPOS <- "-10.3495101"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.630463914"
Evaluating: 81.6823114*(0.630463914-0.5)
 Parameter: YPOS <- "10.656594"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.174263939"
Evaluating: 85*(0.174263939-0.5)+0
 Parameter: ZPOS <- "-27.6875652"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.6875652" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.3495101"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.3495101-0
 Parameter: XTRAN <- "-10.3495101"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.656594"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.656594-0
 Parameter: YTRAN <- "10.656594"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.6875652"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.6875652-0
 Parameter: ZTRAN <- "-27.6875652"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.3495101"
 Parameter: YTRAN -> "10.656594"
 Parameter: ZTRAN -> "-27.6875652"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -10.349510   10.656594  -27.687565
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.714551362"
Evaluating: 0.714551362*360.0
 Parameter: XPHI <- "257.23849"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.551659023"
Evaluating: 0.551659023*360.0
 Parameter: YPHI <- "198.597248"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.25814974"
Evaluating: 0.25814974*360.0
 Parameter: ZPHI <- "92.9339064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.3495101"
 Parameter: YPOS -> "10.656594"
 Parameter: ZPOS -> "-27.6875652"
 Parameter: XPHI -> "257.23849"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.220893   -0.975298
    0.000000    0.975298   -0.220893

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  102.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.3495101"
 Parameter: YPOS -> "10.656594"
 Parameter: ZPOS -> "-27.6875652"
 Parameter: YPHI -> "198.597248"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.947784    0.000000    0.318914
    0.000000    1.000000    0.000000
   -0.318914    0.000000   -0.947784

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  161.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.3495101"
 Parameter: YPOS -> "10.656594"
 Parameter: ZPOS -> "-27.6875652"
 Parameter: ZPHI -> "92.9339064"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.051184    0.998689    0.000000
   -0.998689   -0.051184    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.349510 XMAX =  -10.349510 XAVE =  -10.349510
    YMIN =   10.656594 YMAX =   10.656594 YAVE =   10.656594
    ZMIN =  -27.687565 ZMAX =  -27.687565 ZAVE =  -27.687565
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.3495101"
Evaluating: -10.3495101+3.5
 Parameter: XMAX <- "-6.8495101"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.656594"
Evaluating: 10.656594+3.5
 Parameter: YMAX <- "14.156594"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.6875652"
Evaluating: -27.6875652+3.5
 Parameter: ZMAX <- "-24.1875652"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.3495101"
Evaluating: -10.3495101-3.5
 Parameter: XMIN <- "-13.8495101"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.656594"
Evaluating: 10.656594-3.5
 Parameter: YMIN <- "7.156594"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.6875652"
Evaluating: -27.6875652-3.5
 Parameter: ZMIN <- "-31.1875652"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.8495101"
 Parameter: XMIN -> "-13.8495101"
 Parameter: YMAX -> "14.156594"
 Parameter: YMIN -> "7.156594"
 Parameter: ZMAX -> "-24.1875652"
 Parameter: ZMIN -> "-31.1875652"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "15" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "15" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.182812972"
Evaluating: 81.6823114*(0.182812972-0.5)
 Parameter: XPOS <- "-25.9085696"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.358406697"
Evaluating: 81.6823114*(0.358406697-0.5)
 Parameter: YPOS <- "-11.5656683"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.418647115"
Evaluating: 85*(0.418647115-0.5)+0
 Parameter: ZPOS <- "-6.91499523"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.91499523" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.91499523" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "15" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.659186512"
Evaluating: 81.6823114*(0.659186512-0.5)
 Parameter: XPOS <- "13.0027222"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.744551091"
Evaluating: 81.6823114*(0.744551091-0.5)
 Parameter: YPOS <- "19.9754984"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.707611983"
Evaluating: 85*(0.707611983-0.5)+0
 Parameter: ZPOS <- "17.6470186"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.6470186" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.6470186" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.0027222"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.0027222-0
 Parameter: XTRAN <- "13.0027222"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.9754984"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.9754984-0
 Parameter: YTRAN <- "19.9754984"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.6470186"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.6470186-0
 Parameter: ZTRAN <- "17.6470186"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.0027222"
 Parameter: YTRAN -> "19.9754984"
 Parameter: ZTRAN -> "17.6470186"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    13.002722   19.975498   17.647019
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.104085803"
Evaluating: 0.104085803*360.0
 Parameter: XPHI <- "37.4708891"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.610380404"
Evaluating: 0.610380404*360.0
 Parameter: YPHI <- "219.736945"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.541252787E-02"
Evaluating: 9.541252787E-02*360.0
 Parameter: ZPHI <- "34.34851"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.0027222"
 Parameter: YPOS -> "19.9754984"
 Parameter: ZPOS -> "17.6470186"
 Parameter: XPHI -> "37.4708891"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.793663    0.608358
    0.000000   -0.608358    0.793663

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   37.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.0027222"
 Parameter: YPOS -> "19.9754984"
 Parameter: ZPOS -> "17.6470186"
 Parameter: YPHI -> "219.736945"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.768988    0.000000    0.639264
    0.000000    1.000000    0.000000
   -0.639264    0.000000   -0.768988

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  140.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.0027222"
 Parameter: YPOS -> "19.9754984"
 Parameter: ZPOS -> "17.6470186"
 Parameter: ZPHI -> "34.34851"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.825621    0.564225    0.000000
   -0.564225    0.825621    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   34.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.002722 XMAX =   13.002722 XAVE =   13.002722
    YMIN =   19.975498 YMAX =   19.975498 YAVE =   19.975498
    ZMIN =   17.647019 ZMAX =   17.647019 ZAVE =   17.647019
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.0027222"
Evaluating: 13.0027222+3.5
 Parameter: XMAX <- "16.5027222"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.9754984"
Evaluating: 19.9754984+3.5
 Parameter: YMAX <- "23.4754984"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.6470186"
Evaluating: 17.6470186+3.5
 Parameter: ZMAX <- "21.1470186"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.0027222"
Evaluating: 13.0027222-3.5
 Parameter: XMIN <- "9.5027222"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.9754984"
Evaluating: 19.9754984-3.5
 Parameter: YMIN <- "16.4754984"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.6470186"
Evaluating: 17.6470186-3.5
 Parameter: ZMIN <- "14.1470186"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.5027222"
 Parameter: XMIN -> "9.5027222"
 Parameter: YMAX -> "23.4754984"
 Parameter: YMIN -> "16.4754984"
 Parameter: ZMAX -> "21.1470186"
 Parameter: ZMIN -> "14.1470186"
 SELRPN>     35 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     15 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26535 POS      POT      15       POT     -3471 MEMB     POPC     27       N             3.0248
26535 POS      POT      15       POT     -3472 MEMB     POPC     27       C12           2.2102
26535 POS      POT      15       POT     -3483 MEMB     POPC     27       C15           2.6541
26535 POS      POT      15       POT     -3487 MEMB     POPC     27       C11           3.4482
26535 POS      POT      15       POT     -3494 MEMB     POPC     27       O11           3.9014
26535 POS      POT      15       POT     -3506 MEMB     POPC     27       C3            3.3616
26535 POS      POT      15       POT     -3509 MEMB     POPC     27       O31           2.5359
26535 POS      POT      15       POT     -3510 MEMB     POPC     27       C31           2.1061
26535 POS      POT      15       POT     -3511 MEMB     POPC     27       O32           2.5165
26535 POS      POT      15       POT     -3512 MEMB     POPC     27       C32           2.4136
26535 POS      POT      15       POT     -5200 MEMB     POPC     40       C14           3.3049
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "15" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.306010725"
Evaluating: 81.6823114*(0.306010725-0.5)
 Parameter: XPOS <- "-15.8454924"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "5.319056743E-02"
Evaluating: 81.6823114*(5.319056743E-02-0.5)
 Parameter: YPOS <- "-36.4964272"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.731030047E-02"
Evaluating: 85*(1.731030047E-02-0.5)+0
 Parameter: ZPOS <- "-41.0286245"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.0286245" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.002722 XMAX =   13.002722 XAVE =   13.002722
    YMIN =   19.975498 YMAX =   19.975498 YAVE =   19.975498
    ZMIN =   17.647019 ZMAX =   17.647019 ZAVE =   17.647019
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.8454924"
 RDCMND substituted energy or value "?XAVE" to "13.0027222"
Evaluating: -15.8454924-13.0027222
 Parameter: XTRAN <- "-28.8482146"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.4964272"
 RDCMND substituted energy or value "?YAVE" to "19.9754984"
Evaluating: -36.4964272-19.9754984
 Parameter: YTRAN <- "-56.4719256"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.0286245"
 RDCMND substituted energy or value "?ZAVE" to "17.6470186"
Evaluating: -41.0286245-17.6470186
 Parameter: ZTRAN <- "-58.6756431"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.8482146"
 Parameter: YTRAN -> "-56.4719256"
 Parameter: ZTRAN -> "-58.6756431"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -28.848215  -56.471926  -58.675643
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56731819"
Evaluating: 0.56731819*360.0
 Parameter: XPHI <- "204.234548"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.991190742"
Evaluating: 0.991190742*360.0
 Parameter: YPHI <- "356.828667"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.757048006"
Evaluating: 0.757048006*360.0
 Parameter: ZPHI <- "272.537282"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.8454924"
 Parameter: YPOS -> "-36.4964272"
 Parameter: ZPOS -> "-41.0286245"
 Parameter: XPHI -> "204.234548"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.911873   -0.410473
    0.000000    0.410473   -0.911873

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  155.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.8454924"
 Parameter: YPOS -> "-36.4964272"
 Parameter: ZPOS -> "-41.0286245"
 Parameter: YPHI -> "356.828667"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.998469    0.000000    0.055322
    0.000000    1.000000    0.000000
   -0.055322    0.000000    0.998469

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    3.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.8454924"
 Parameter: YPOS -> "-36.4964272"
 Parameter: ZPOS -> "-41.0286245"
 Parameter: ZPHI -> "272.537282"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.044269   -0.999020    0.000000
    0.999020    0.044269    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.845492 XMAX =  -15.845492 XAVE =  -15.845492
    YMIN =  -36.496427 YMAX =  -36.496427 YAVE =  -36.496427
    ZMIN =  -41.028624 ZMAX =  -41.028624 ZAVE =  -41.028624
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.8454924"
Evaluating: -15.8454924+3.5
 Parameter: XMAX <- "-12.3454924"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.4964272"
Evaluating: -36.4964272+3.5
 Parameter: YMAX <- "-32.9964272"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.0286245"
Evaluating: -41.0286245+3.5
 Parameter: ZMAX <- "-37.5286245"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.8454924"
Evaluating: -15.8454924-3.5
 Parameter: XMIN <- "-19.3454924"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.4964272"
Evaluating: -36.4964272-3.5
 Parameter: YMIN <- "-39.9964272"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.0286245"
Evaluating: -41.0286245-3.5
 Parameter: ZMIN <- "-44.5286245"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.3454924"
 Parameter: XMIN -> "-19.3454924"
 Parameter: YMAX -> "-32.9964272"
 Parameter: YMIN -> "-39.9964272"
 Parameter: ZMAX -> "-37.5286245"
 Parameter: ZMIN -> "-44.5286245"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "16" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "16" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.189726323"
Evaluating: 81.6823114*(0.189726323-0.5)
 Parameter: XPOS <- "-25.3438711"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.650675377"
Evaluating: 81.6823114*(0.650675377-0.5)
 Parameter: YPOS <- "12.3075131"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.133473291"
Evaluating: 85*(0.133473291-0.5)+0
 Parameter: ZPOS <- "-31.1547703"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.1547703" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.3438711"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.3438711-0
 Parameter: XTRAN <- "-25.3438711"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.3075131"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.3075131-0
 Parameter: YTRAN <- "12.3075131"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.1547703"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.1547703-0
 Parameter: ZTRAN <- "-31.1547703"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.3438711"
 Parameter: YTRAN -> "12.3075131"
 Parameter: ZTRAN -> "-31.1547703"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -25.343871   12.307513  -31.154770
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.146534327E-02"
Evaluating: 3.146534327E-02*360.0
 Parameter: XPHI <- "11.3275236"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.657331361"
Evaluating: 0.657331361*360.0
 Parameter: YPHI <- "236.63929"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.591748245"
Evaluating: 0.591748245*360.0
 Parameter: ZPHI <- "213.029368"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.3438711"
 Parameter: YPOS -> "12.3075131"
 Parameter: ZPOS -> "-31.1547703"
 Parameter: XPHI -> "11.3275236"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.980520    0.196417
    0.000000   -0.196417    0.980520

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.3438711"
 Parameter: YPOS -> "12.3075131"
 Parameter: ZPOS -> "-31.1547703"
 Parameter: YPHI -> "236.63929"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.549908    0.000000    0.835225
    0.000000    1.000000    0.000000
   -0.835225    0.000000   -0.549908

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  123.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.3438711"
 Parameter: YPOS -> "12.3075131"
 Parameter: ZPOS -> "-31.1547703"
 Parameter: ZPHI -> "213.029368"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.838391   -0.545069    0.000000
    0.545069   -0.838391    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.343871 XMAX =  -25.343871 XAVE =  -25.343871
    YMIN =   12.307513 YMAX =   12.307513 YAVE =   12.307513
    ZMIN =  -31.154770 ZMAX =  -31.154770 ZAVE =  -31.154770
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.3438711"
Evaluating: -25.3438711+3.5
 Parameter: XMAX <- "-21.8438711"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.3075131"
Evaluating: 12.3075131+3.5
 Parameter: YMAX <- "15.8075131"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.1547703"
Evaluating: -31.1547703+3.5
 Parameter: ZMAX <- "-27.6547703"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.3438711"
Evaluating: -25.3438711-3.5
 Parameter: XMIN <- "-28.8438711"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.3075131"
Evaluating: 12.3075131-3.5
 Parameter: YMIN <- "8.8075131"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.1547703"
Evaluating: -31.1547703-3.5
 Parameter: ZMIN <- "-34.6547703"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.8438711"
 Parameter: XMIN -> "-28.8438711"
 Parameter: YMAX -> "15.8075131"
 Parameter: YMIN -> "8.8075131"
 Parameter: ZMAX -> "-27.6547703"
 Parameter: ZMIN -> "-34.6547703"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "17" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "17" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.218238075"
Evaluating: 81.6823114*(0.218238075-0.5)
 Parameter: XPOS <- "-23.0149653"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "2.156992389E-02"
Evaluating: 81.6823114*(2.156992389E-02-0.5)
 Parameter: YPOS <- "-39.0792745"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.567983808"
Evaluating: 85*(0.567983808-0.5)+0
 Parameter: ZPOS <- "5.77862368"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.77862368" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.77862368" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "17" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.999729544"
Evaluating: 81.6823114*(0.999729544-0.5)
 Parameter: XPOS <- "40.8190642"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.248063109"
Evaluating: 81.6823114*(0.248063109-0.5)
 Parameter: YPOS <- "-20.5787876"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.920399983"
Evaluating: 85*(0.920399983-0.5)+0
 Parameter: ZPOS <- "35.7339986"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.7339986" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.7339986" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.8190642"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.8190642-0
 Parameter: XTRAN <- "40.8190642"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.5787876"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.5787876-0
 Parameter: YTRAN <- "-20.5787876"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.7339986"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.7339986-0
 Parameter: ZTRAN <- "35.7339986"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.8190642"
 Parameter: YTRAN -> "-20.5787876"
 Parameter: ZTRAN -> "35.7339986"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    40.819064  -20.578788   35.733999
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.501165837"
Evaluating: 0.501165837*360.0
 Parameter: XPHI <- "180.419701"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.586450108"
Evaluating: 0.586450108*360.0
 Parameter: YPHI <- "211.122039"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.817045852"
Evaluating: 0.817045852*360.0
 Parameter: ZPHI <- "294.136507"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.8190642"
 Parameter: YPOS -> "-20.5787876"
 Parameter: ZPOS -> "35.7339986"
 Parameter: XPHI -> "180.419701"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999973   -0.007325
    0.000000    0.007325   -0.999973

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  179.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.8190642"
 Parameter: YPOS -> "-20.5787876"
 Parameter: ZPOS -> "35.7339986"
 Parameter: YPHI -> "211.122039"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.856068    0.000000    0.516863
    0.000000    1.000000    0.000000
   -0.516863    0.000000   -0.856068

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.8190642"
 Parameter: YPOS -> "-20.5787876"
 Parameter: ZPOS -> "35.7339986"
 Parameter: ZPHI -> "294.136507"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.408912   -0.912574    0.000000
    0.912574    0.408912    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   65.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.819064 XMAX =   40.819064 XAVE =   40.819064
    YMIN =  -20.578788 YMAX =  -20.578788 YAVE =  -20.578788
    ZMIN =   35.733999 ZMAX =   35.733999 ZAVE =   35.733999
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.8190642"
Evaluating: 40.8190642+3.5
 Parameter: XMAX <- "44.3190642"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.5787876"
Evaluating: -20.5787876+3.5
 Parameter: YMAX <- "-17.0787876"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.7339986"
Evaluating: 35.7339986+3.5
 Parameter: ZMAX <- "39.2339986"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.8190642"
Evaluating: 40.8190642-3.5
 Parameter: XMIN <- "37.3190642"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.5787876"
Evaluating: -20.5787876-3.5
 Parameter: YMIN <- "-24.0787876"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.7339986"
Evaluating: 35.7339986-3.5
 Parameter: ZMIN <- "32.2339986"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.3190642"
 Parameter: XMIN -> "37.3190642"
 Parameter: YMAX -> "-17.0787876"
 Parameter: YMIN -> "-24.0787876"
 Parameter: ZMAX -> "39.2339986"
 Parameter: ZMIN -> "32.2339986"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "18" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "18" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.325060954"
Evaluating: 81.6823114*(0.325060954-0.5)
 Parameter: XPOS <- "-14.2894256"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.695535786"
Evaluating: 81.6823114*(0.695535786-0.5)
 Parameter: YPOS <- "15.971815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.623883092"
Evaluating: 85*(0.623883092-0.5)+0
 Parameter: ZPOS <- "10.5300628"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.5300628" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.5300628" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "18" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.342077947"
Evaluating: 81.6823114*(0.342077947-0.5)
 Parameter: XPOS <- "-12.8994383"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.841388102"
Evaluating: 81.6823114*(0.841388102-0.5)
 Parameter: YPOS <- "27.8853693"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.40642043"
Evaluating: 85*(0.40642043-0.5)+0
 Parameter: ZPOS <- "-7.95426345"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.95426345" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.95426345" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "18" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.437839733"
Evaluating: 81.6823114*(0.437839733-0.5)
 Parameter: XPOS <- "-5.07739429"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.384719902"
Evaluating: 81.6823114*(0.384719902-0.5)
 Parameter: YPOS <- "-9.41634486"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.398926643"
Evaluating: 85*(0.398926643-0.5)+0
 Parameter: ZPOS <- "-8.59123534"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.59123534" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.59123534" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "18" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "2.057260158E-02"
Evaluating: 81.6823114*(2.057260158E-02-0.5)
 Parameter: XPOS <- "-39.1607381"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.638353933"
Evaluating: 81.6823114*(0.638353933-0.5)
 Parameter: YPOS <- "11.301069"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.689528212"
Evaluating: 85*(0.689528212-0.5)+0
 Parameter: ZPOS <- "16.109898"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.109898" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.109898" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.1607381"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.1607381-0
 Parameter: XTRAN <- "-39.1607381"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.301069"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.301069-0
 Parameter: YTRAN <- "11.301069"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.109898"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.109898-0
 Parameter: ZTRAN <- "16.109898"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.1607381"
 Parameter: YTRAN -> "11.301069"
 Parameter: ZTRAN -> "16.109898"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -39.160738   11.301069   16.109898
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.703903716E-02"
Evaluating: 9.703903716E-02*360.0
 Parameter: XPHI <- "34.9340534"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.907216043"
Evaluating: 0.907216043*360.0
 Parameter: YPHI <- "326.597775"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404053515"
Evaluating: 0.404053515*360.0
 Parameter: ZPHI <- "145.459265"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.1607381"
 Parameter: YPOS -> "11.301069"
 Parameter: ZPOS -> "16.109898"
 Parameter: XPHI -> "34.9340534"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.819812    0.572633
    0.000000   -0.572633    0.819812

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.1607381"
 Parameter: YPOS -> "11.301069"
 Parameter: ZPOS -> "16.109898"
 Parameter: YPHI -> "326.597775"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.834826    0.000000    0.550513
    0.000000    1.000000    0.000000
   -0.550513    0.000000    0.834826

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   33.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.1607381"
 Parameter: YPOS -> "11.301069"
 Parameter: ZPOS -> "16.109898"
 Parameter: ZPHI -> "145.459265"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.823723    0.566992    0.000000
   -0.566992   -0.823723    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  145.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.160738 XMAX =  -39.160738 XAVE =  -39.160738
    YMIN =   11.301069 YMAX =   11.301069 YAVE =   11.301069
    ZMIN =   16.109898 ZMAX =   16.109898 ZAVE =   16.109898
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.1607381"
Evaluating: -39.1607381+3.5
 Parameter: XMAX <- "-35.6607381"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.301069"
Evaluating: 11.301069+3.5
 Parameter: YMAX <- "14.801069"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.109898"
Evaluating: 16.109898+3.5
 Parameter: ZMAX <- "19.609898"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.1607381"
Evaluating: -39.1607381-3.5
 Parameter: XMIN <- "-42.6607381"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.301069"
Evaluating: 11.301069-3.5
 Parameter: YMIN <- "7.801069"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.109898"
Evaluating: 16.109898-3.5
 Parameter: ZMIN <- "12.609898"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.6607381"
 Parameter: XMIN -> "-42.6607381"
 Parameter: YMAX -> "14.801069"
 Parameter: YMIN -> "7.801069"
 Parameter: ZMAX -> "19.609898"
 Parameter: ZMIN -> "12.609898"
 SELRPN>     21 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      8 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26538 POS      POT      18       POT     -8122 MEMB     POPC     62       C1            3.2083
26538 POS      POT      18       POT     -8125 MEMB     POPC     62       C2            2.5271
26538 POS      POT      18       POT     -8127 MEMB     POPC     62       O21           2.0327
26538 POS      POT      18       POT     -8128 MEMB     POPC     62       C21           1.4226
26538 POS      POT      18       POT     -8129 MEMB     POPC     62       O22           1.1726
26538 POS      POT      18       POT     -8130 MEMB     POPC     62       C22           2.6748
26538 POS      POT      18       POT     -8133 MEMB     POPC     62       C3            3.9359
26538 POS      POT      18       POT     -8142 MEMB     POPC     62       C23           3.4699
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "18" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.848427878"
Evaluating: 81.6823114*(0.848427878-0.5)
 Parameter: XPOS <- "28.4603944"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.471451898"
Evaluating: 81.6823114*(0.471451898-0.5)
 Parameter: YPOS <- "-2.33187496"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.735300087E-02"
Evaluating: 85*(2.735300087E-02-0.5)+0
 Parameter: ZPOS <- "-40.1749949"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.1749949" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.160738 XMAX =  -39.160738 XAVE =  -39.160738
    YMIN =   11.301069 YMAX =   11.301069 YAVE =   11.301069
    ZMIN =   16.109898 ZMAX =   16.109898 ZAVE =   16.109898
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.4603944"
 RDCMND substituted energy or value "?XAVE" to "-39.1607381"
Evaluating: 28.4603944--39.1607381
 Parameter: XTRAN <- "67.6211325"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.33187496"
 RDCMND substituted energy or value "?YAVE" to "11.301069"
Evaluating: -2.33187496-11.301069
 Parameter: YTRAN <- "-13.632944"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.1749949"
 RDCMND substituted energy or value "?ZAVE" to "16.109898"
Evaluating: -40.1749949-16.109898
 Parameter: ZTRAN <- "-56.2848929"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "67.6211325"
 Parameter: YTRAN -> "-13.632944"
 Parameter: ZTRAN -> "-56.2848929"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    67.621133  -13.632944  -56.284893
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.202019823"
Evaluating: 0.202019823*360.0
 Parameter: XPHI <- "72.7271363"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957234328"
Evaluating: 0.957234328*360.0
 Parameter: YPHI <- "344.604358"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395885443"
Evaluating: 0.395885443*360.0
 Parameter: ZPHI <- "142.518759"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.4603944"
 Parameter: YPOS -> "-2.33187496"
 Parameter: ZPOS -> "-40.1749949"
 Parameter: XPHI -> "72.7271363"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.296923    0.954902
    0.000000   -0.954902    0.296923

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.4603944"
 Parameter: YPOS -> "-2.33187496"
 Parameter: ZPOS -> "-40.1749949"
 Parameter: YPHI -> "344.604358"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.964116    0.000000    0.265483
    0.000000    1.000000    0.000000
   -0.265483    0.000000    0.964116

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.4603944"
 Parameter: YPOS -> "-2.33187496"
 Parameter: ZPOS -> "-40.1749949"
 Parameter: ZPHI -> "142.518759"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.793553    0.608502    0.000000
   -0.608502   -0.793553    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.460394 XMAX =   28.460394 XAVE =   28.460394
    YMIN =   -2.331875 YMAX =   -2.331875 YAVE =   -2.331875
    ZMIN =  -40.174995 ZMAX =  -40.174995 ZAVE =  -40.174995
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.4603944"
Evaluating: 28.4603944+3.5
 Parameter: XMAX <- "31.9603944"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.33187496"
Evaluating: -2.33187496+3.5
 Parameter: YMAX <- "1.16812504"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.1749949"
Evaluating: -40.1749949+3.5
 Parameter: ZMAX <- "-36.6749949"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.4603944"
Evaluating: 28.4603944-3.5
 Parameter: XMIN <- "24.9603944"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.33187496"
Evaluating: -2.33187496-3.5
 Parameter: YMIN <- "-5.83187496"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.1749949"
Evaluating: -40.1749949-3.5
 Parameter: ZMIN <- "-43.6749949"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.9603944"
 Parameter: XMIN -> "24.9603944"
 Parameter: YMAX -> "1.16812504"
 Parameter: YMIN -> "-5.83187496"
 Parameter: ZMAX -> "-36.6749949"
 Parameter: ZMIN -> "-43.6749949"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "19" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "19" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.202651726"
Evaluating: 81.6823114*(0.202651726-0.5)
 Parameter: XPOS <- "-24.2880943"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.486516583"
Evaluating: 81.6823114*(0.486516583-0.5)
 Parameter: YPOS <- "-1.10135667"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.875312779"
Evaluating: 85*(0.875312779-0.5)+0
 Parameter: ZPOS <- "31.9015862"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.9015862" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.9015862" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.2880943"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.2880943-0
 Parameter: XTRAN <- "-24.2880943"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.10135667"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.10135667-0
 Parameter: YTRAN <- "-1.10135667"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.9015862"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.9015862-0
 Parameter: ZTRAN <- "31.9015862"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.2880943"
 Parameter: YTRAN -> "-1.10135667"
 Parameter: ZTRAN -> "31.9015862"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -24.288094   -1.101357   31.901586
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.94781775"
Evaluating: 0.94781775*360.0
 Parameter: XPHI <- "341.21439"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.781684677"
Evaluating: 0.781684677*360.0
 Parameter: YPHI <- "281.406484"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67037893"
Evaluating: 0.67037893*360.0
 Parameter: ZPHI <- "241.336415"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.2880943"
 Parameter: YPOS -> "-1.10135667"
 Parameter: ZPOS -> "31.9015862"
 Parameter: XPHI -> "341.21439"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.946730   -0.322028
    0.000000    0.322028    0.946730

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.2880943"
 Parameter: YPOS -> "-1.10135667"
 Parameter: ZPOS -> "31.9015862"
 Parameter: YPHI -> "281.406484"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.197768    0.000000    0.980249
    0.000000    1.000000    0.000000
   -0.980249    0.000000    0.197768

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   78.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.2880943"
 Parameter: YPOS -> "-1.10135667"
 Parameter: ZPOS -> "31.9015862"
 Parameter: ZPHI -> "241.336415"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.479666   -0.877451    0.000000
    0.877451   -0.479666    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.288094 XMAX =  -24.288094 XAVE =  -24.288094
    YMIN =   -1.101357 YMAX =   -1.101357 YAVE =   -1.101357
    ZMIN =   31.901586 ZMAX =   31.901586 ZAVE =   31.901586
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.2880943"
Evaluating: -24.2880943+3.5
 Parameter: XMAX <- "-20.7880943"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.10135667"
Evaluating: -1.10135667+3.5
 Parameter: YMAX <- "2.39864333"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.9015862"
Evaluating: 31.9015862+3.5
 Parameter: ZMAX <- "35.4015862"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.2880943"
Evaluating: -24.2880943-3.5
 Parameter: XMIN <- "-27.7880943"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.10135667"
Evaluating: -1.10135667-3.5
 Parameter: YMIN <- "-4.60135667"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.9015862"
Evaluating: 31.9015862-3.5
 Parameter: ZMIN <- "28.4015862"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.7880943"
 Parameter: XMIN -> "-27.7880943"
 Parameter: YMAX -> "2.39864333"
 Parameter: YMIN -> "-4.60135667"
 Parameter: ZMAX -> "35.4015862"
 Parameter: ZMIN -> "28.4015862"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "20" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "20" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "7.848387991E-02"
Evaluating: 81.6823114*(7.848387991E-02-0.5)
 Parameter: XPOS <- "-34.430411"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.686696852"
Evaluating: 81.6823114*(0.686696852-0.5)
 Parameter: YPOS <- "15.2498304"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.933290044"
Evaluating: 85*(0.933290044-0.5)+0
 Parameter: ZPOS <- "36.8296537"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.8296537" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.8296537" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.430411"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.430411-0
 Parameter: XTRAN <- "-34.430411"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.2498304"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.2498304-0
 Parameter: YTRAN <- "15.2498304"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.8296537"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.8296537-0
 Parameter: ZTRAN <- "36.8296537"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.430411"
 Parameter: YTRAN -> "15.2498304"
 Parameter: ZTRAN -> "36.8296537"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -34.430411   15.249830   36.829654
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.458559316"
Evaluating: 0.458559316*360.0
 Parameter: XPHI <- "165.081354"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.800828797"
Evaluating: 0.800828797*360.0
 Parameter: YPHI <- "288.298367"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.469358336"
Evaluating: 0.469358336*360.0
 Parameter: ZPHI <- "168.969001"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.430411"
 Parameter: YPOS -> "15.2498304"
 Parameter: ZPOS -> "36.8296537"
 Parameter: XPHI -> "165.081354"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.966292    0.257447
    0.000000   -0.257447   -0.966292

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  165.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.430411"
 Parameter: YPOS -> "15.2498304"
 Parameter: ZPOS -> "36.8296537"
 Parameter: YPHI -> "288.298367"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.313965    0.000000    0.949434
    0.000000    1.000000    0.000000
   -0.949434    0.000000    0.313965

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.430411"
 Parameter: YPOS -> "15.2498304"
 Parameter: ZPOS -> "36.8296537"
 Parameter: ZPHI -> "168.969001"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.981524    0.191340    0.000000
   -0.191340   -0.981524    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  168.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.430411 XMAX =  -34.430411 XAVE =  -34.430411
    YMIN =   15.249830 YMAX =   15.249830 YAVE =   15.249830
    ZMIN =   36.829654 ZMAX =   36.829654 ZAVE =   36.829654
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.430411"
Evaluating: -34.430411+3.5
 Parameter: XMAX <- "-30.930411"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.2498304"
Evaluating: 15.2498304+3.5
 Parameter: YMAX <- "18.7498304"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.8296537"
Evaluating: 36.8296537+3.5
 Parameter: ZMAX <- "40.3296537"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.430411"
Evaluating: -34.430411-3.5
 Parameter: XMIN <- "-37.930411"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.2498304"
Evaluating: 15.2498304-3.5
 Parameter: YMIN <- "11.7498304"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.8296537"
Evaluating: 36.8296537-3.5
 Parameter: ZMIN <- "33.3296537"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.930411"
 Parameter: XMIN -> "-37.930411"
 Parameter: YMAX -> "18.7498304"
 Parameter: YMIN -> "11.7498304"
 Parameter: ZMAX -> "40.3296537"
 Parameter: ZMIN -> "33.3296537"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "21" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "21" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.807582661"
Evaluating: 81.6823114*(0.807582661-0.5)
 Parameter: XPOS <- "25.1240627"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.254096125"
Evaluating: 81.6823114*(0.254096125-0.5)
 Parameter: YPOS <- "-20.0859969"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.274494276"
Evaluating: 85*(0.274494276-0.5)+0
 Parameter: ZPOS <- "-19.1679865"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.1679865" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.1240627"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.1240627-0
 Parameter: XTRAN <- "25.1240627"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.0859969"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.0859969-0
 Parameter: YTRAN <- "-20.0859969"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.1679865"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.1679865-0
 Parameter: ZTRAN <- "-19.1679865"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.1240627"
 Parameter: YTRAN -> "-20.0859969"
 Parameter: ZTRAN -> "-19.1679865"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    25.124063  -20.085997  -19.167987
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.647595837E-02"
Evaluating: 9.647595837E-02*360.0
 Parameter: XPHI <- "34.731345"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.748591056"
Evaluating: 0.748591056*360.0
 Parameter: YPHI <- "269.49278"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.207441268E-02"
Evaluating: 3.207441268E-02*360.0
 Parameter: ZPHI <- "11.5467886"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.1240627"
 Parameter: YPOS -> "-20.0859969"
 Parameter: ZPOS -> "-19.1679865"
 Parameter: XPHI -> "34.731345"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.821832    0.569729
    0.000000   -0.569729    0.821832

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.1240627"
 Parameter: YPOS -> "-20.0859969"
 Parameter: ZPOS -> "-19.1679865"
 Parameter: YPHI -> "269.49278"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.008853    0.000000    0.999961
    0.000000    1.000000    0.000000
   -0.999961    0.000000   -0.008853

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   90.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.1240627"
 Parameter: YPOS -> "-20.0859969"
 Parameter: ZPOS -> "-19.1679865"
 Parameter: ZPHI -> "11.5467886"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.979762    0.200168    0.000000
   -0.200168    0.979762    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   11.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.124063 XMAX =   25.124063 XAVE =   25.124063
    YMIN =  -20.085997 YMAX =  -20.085997 YAVE =  -20.085997
    ZMIN =  -19.167987 ZMAX =  -19.167987 ZAVE =  -19.167987
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.1240627"
Evaluating: 25.1240627+3.5
 Parameter: XMAX <- "28.6240627"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.0859969"
Evaluating: -20.0859969+3.5
 Parameter: YMAX <- "-16.5859969"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.1679865"
Evaluating: -19.1679865+3.5
 Parameter: ZMAX <- "-15.6679865"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.1240627"
Evaluating: 25.1240627-3.5
 Parameter: XMIN <- "21.6240627"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.0859969"
Evaluating: -20.0859969-3.5
 Parameter: YMIN <- "-23.5859969"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.1679865"
Evaluating: -19.1679865-3.5
 Parameter: ZMIN <- "-22.6679865"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.6240627"
 Parameter: XMIN -> "21.6240627"
 Parameter: YMAX -> "-16.5859969"
 Parameter: YMIN -> "-23.5859969"
 Parameter: ZMAX -> "-15.6679865"
 Parameter: ZMIN -> "-22.6679865"
 SELRPN>     19 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     11 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26541 POS      POT      21       POT     -**** MEMB     POPS     151      N             3.2222
26541 POS      POT      21       POT     -**** MEMB     POPS     151      C12           2.0587
26541 POS      POT      21       POT     -**** MEMB     POPS     151      C13           3.0884
26541 POS      POT      21       POT     -**** MEMB     POPS     151      O13B          3.0691
26541 POS      POT      21       POT     -**** MEMB     POPS     151      C11           1.2620
26541 POS      POT      21       POT     -**** MEMB     POPS     151      P             1.7897
26541 POS      POT      21       POT     -**** MEMB     POPS     151      O13           1.8173
26541 POS      POT      21       POT     -**** MEMB     POPS     151      O14           2.7895
26541 POS      POT      21       POT     -**** MEMB     POPS     151      O12           1.4662
26541 POS      POT      21       POT     -**** MEMB     POPS     151      O11           3.0916
26541 POS      POT      21       POT     -**** MEMB     POPS     151      C1            3.6302
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "21" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.807032508"
Evaluating: 81.6823114*(0.807032508-0.5)
 Parameter: XPOS <- "25.0791249"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.110498945"
Evaluating: 81.6823114*(0.110498945-0.5)
 Parameter: YPOS <- "-31.8153465"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.24921083"
Evaluating: 85*(0.24921083-0.5)+0
 Parameter: ZPOS <- "-21.3170795"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.3170795" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.124063 XMAX =   25.124063 XAVE =   25.124063
    YMIN =  -20.085997 YMAX =  -20.085997 YAVE =  -20.085997
    ZMIN =  -19.167987 ZMAX =  -19.167987 ZAVE =  -19.167987
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.0791249"
 RDCMND substituted energy or value "?XAVE" to "25.1240627"
Evaluating: 25.0791249-25.1240627
 Parameter: XTRAN <- "-4.49378E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.8153465"
 RDCMND substituted energy or value "?YAVE" to "-20.0859969"
Evaluating: -31.8153465--20.0859969
 Parameter: YTRAN <- "-11.7293496"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.3170795"
 RDCMND substituted energy or value "?ZAVE" to "-19.1679865"
Evaluating: -21.3170795--19.1679865
 Parameter: ZTRAN <- "-2.149093"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.49378E-02"
 Parameter: YTRAN -> "-11.7293496"
 Parameter: ZTRAN -> "-2.149093"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -0.044938  -11.729350   -2.149093
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.70855071"
Evaluating: 0.70855071*360.0
 Parameter: XPHI <- "255.078256"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.432936348"
Evaluating: 0.432936348*360.0
 Parameter: YPHI <- "155.857085"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.316320862E-03"
Evaluating: 9.316320862E-03*360.0
 Parameter: ZPHI <- "3.35387551"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.0791249"
 Parameter: YPOS -> "-31.8153465"
 Parameter: ZPOS -> "-21.3170795"
 Parameter: XPHI -> "255.078256"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.257500   -0.966278
    0.000000    0.966278   -0.257500

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  104.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.0791249"
 Parameter: YPOS -> "-31.8153465"
 Parameter: ZPOS -> "-21.3170795"
 Parameter: YPHI -> "155.857085"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.912528    0.000000   -0.409014
    0.000000    1.000000    0.000000
    0.409014    0.000000   -0.912528

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  155.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.0791249"
 Parameter: YPOS -> "-31.8153465"
 Parameter: ZPOS -> "-21.3170795"
 Parameter: ZPHI -> "3.35387551"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.998287    0.058503    0.000000
   -0.058503    0.998287    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    3.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.079125 XMAX =   25.079125 XAVE =   25.079125
    YMIN =  -31.815346 YMAX =  -31.815346 YAVE =  -31.815346
    ZMIN =  -21.317079 ZMAX =  -21.317079 ZAVE =  -21.317079
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.0791249"
Evaluating: 25.0791249+3.5
 Parameter: XMAX <- "28.5791249"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.8153465"
Evaluating: -31.8153465+3.5
 Parameter: YMAX <- "-28.3153465"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.3170795"
Evaluating: -21.3170795+3.5
 Parameter: ZMAX <- "-17.8170795"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.0791249"
Evaluating: 25.0791249-3.5
 Parameter: XMIN <- "21.5791249"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.8153465"
Evaluating: -31.8153465-3.5
 Parameter: YMIN <- "-35.3153465"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.3170795"
Evaluating: -21.3170795-3.5
 Parameter: ZMIN <- "-24.8170795"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.5791249"
 Parameter: XMIN -> "21.5791249"
 Parameter: YMAX -> "-28.3153465"
 Parameter: YMIN -> "-35.3153465"
 Parameter: ZMAX -> "-17.8170795"
 Parameter: ZMIN -> "-24.8170795"
 SELRPN>      7 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      5 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26541 POS      POT      21       POT     -**** MEMB     POPS     177      O14           3.6031
26541 POS      POT      21       POT     -**** MEMB     POPS     182      C13           2.8081
26541 POS      POT      21       POT     -**** MEMB     POPS     182      O13A          2.6896
26541 POS      POT      21       POT     -**** MEMB     POPS     182      O13B          2.2014
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "21" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "7.429548543E-02"
Evaluating: 81.6823114*(7.429548543E-02-0.5)
 Parameter: XPOS <- "-34.7725287"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "7.413216609E-02"
Evaluating: 81.6823114*(7.413216609E-02-0.5)
 Parameter: YPOS <- "-34.785869"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.968183918"
Evaluating: 85*(0.968183918-0.5)+0
 Parameter: ZPOS <- "39.795633"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.795633" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.795633" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.079125 XMAX =   25.079125 XAVE =   25.079125
    YMIN =  -31.815346 YMAX =  -31.815346 YAVE =  -31.815346
    ZMIN =  -21.317079 ZMAX =  -21.317079 ZAVE =  -21.317079
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.7725287"
 RDCMND substituted energy or value "?XAVE" to "25.0791249"
Evaluating: -34.7725287-25.0791249
 Parameter: XTRAN <- "-59.8516536"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.785869"
 RDCMND substituted energy or value "?YAVE" to "-31.8153465"
Evaluating: -34.785869--31.8153465
 Parameter: YTRAN <- "-2.9705225"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.795633"
 RDCMND substituted energy or value "?ZAVE" to "-21.3170795"
Evaluating: 39.795633--21.3170795
 Parameter: ZTRAN <- "61.1127125"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.8516536"
 Parameter: YTRAN -> "-2.9705225"
 Parameter: ZTRAN -> "61.1127125"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -59.851654   -2.970522   61.112713
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.266735355"
Evaluating: 0.266735355*360.0
 Parameter: XPHI <- "96.0247278"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.361431646"
Evaluating: 0.361431646*360.0
 Parameter: YPHI <- "130.115393"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671046353"
Evaluating: 0.671046353*360.0
 Parameter: ZPHI <- "241.576687"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.7725287"
 Parameter: YPOS -> "-34.785869"
 Parameter: ZPOS -> "39.795633"
 Parameter: XPHI -> "96.0247278"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.104958    0.994477
    0.000000   -0.994477   -0.104958

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   96.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.7725287"
 Parameter: YPOS -> "-34.785869"
 Parameter: ZPOS -> "39.795633"
 Parameter: YPHI -> "130.115393"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.644329    0.000000   -0.764748
    0.000000    1.000000    0.000000
    0.764748    0.000000   -0.644329

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  130.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.7725287"
 Parameter: YPOS -> "-34.785869"
 Parameter: ZPOS -> "39.795633"
 Parameter: ZPHI -> "241.576687"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.475982   -0.879455    0.000000
    0.879455   -0.475982    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.772529 XMAX =  -34.772529 XAVE =  -34.772529
    YMIN =  -34.785869 YMAX =  -34.785869 YAVE =  -34.785869
    ZMIN =   39.795633 ZMAX =   39.795633 ZAVE =   39.795633
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.7725287"
Evaluating: -34.7725287+3.5
 Parameter: XMAX <- "-31.2725287"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.785869"
Evaluating: -34.785869+3.5
 Parameter: YMAX <- "-31.285869"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.795633"
Evaluating: 39.795633+3.5
 Parameter: ZMAX <- "43.295633"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.7725287"
Evaluating: -34.7725287-3.5
 Parameter: XMIN <- "-38.2725287"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.785869"
Evaluating: -34.785869-3.5
 Parameter: YMIN <- "-38.285869"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.795633"
Evaluating: 39.795633-3.5
 Parameter: ZMIN <- "36.295633"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.2725287"
 Parameter: XMIN -> "-38.2725287"
 Parameter: YMAX -> "-31.285869"
 Parameter: YMIN -> "-38.285869"
 Parameter: ZMAX -> "43.295633"
 Parameter: ZMIN -> "36.295633"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "22" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "22" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.984873054"
Evaluating: 81.6823114*(0.984873054-0.5)
 Parameter: XPOS <- "39.6055518"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.547244253"
Evaluating: 81.6823114*(0.547244253-0.5)
 Parameter: YPOS <- "3.85901979"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "7.384690474E-02"
Evaluating: 85*(7.384690474E-02-0.5)+0
 Parameter: ZPOS <- "-36.2230131"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.2230131" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.6055518"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.6055518-0
 Parameter: XTRAN <- "39.6055518"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.85901979"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.85901979-0
 Parameter: YTRAN <- "3.85901979"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.2230131"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.2230131-0
 Parameter: ZTRAN <- "-36.2230131"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.6055518"
 Parameter: YTRAN -> "3.85901979"
 Parameter: ZTRAN -> "-36.2230131"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    39.605552    3.859020  -36.223013
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.63087634"
Evaluating: 0.63087634*360.0
 Parameter: XPHI <- "227.115482"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567655423"
Evaluating: 0.567655423*360.0
 Parameter: YPHI <- "204.355952"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.470195026"
Evaluating: 0.470195026*360.0
 Parameter: ZPHI <- "169.270209"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.6055518"
 Parameter: YPOS -> "3.85901979"
 Parameter: ZPOS -> "-36.2230131"
 Parameter: XPHI -> "227.115482"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.680523   -0.732727
    0.000000    0.732727   -0.680523

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  132.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.6055518"
 Parameter: YPOS -> "3.85901979"
 Parameter: ZPOS -> "-36.2230131"
 Parameter: YPHI -> "204.355952"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.911001    0.000000    0.412404
    0.000000    1.000000    0.000000
   -0.412404    0.000000   -0.911001

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.6055518"
 Parameter: YPOS -> "3.85901979"
 Parameter: ZPOS -> "-36.2230131"
 Parameter: ZPHI -> "169.270209"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.982516    0.186178    0.000000
   -0.186178   -0.982516    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  169.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.605552 XMAX =   39.605552 XAVE =   39.605552
    YMIN =    3.859020 YMAX =    3.859020 YAVE =    3.859020
    ZMIN =  -36.223013 ZMAX =  -36.223013 ZAVE =  -36.223013
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.6055518"
Evaluating: 39.6055518+3.5
 Parameter: XMAX <- "43.1055518"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.85901979"
Evaluating: 3.85901979+3.5
 Parameter: YMAX <- "7.35901979"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.2230131"
Evaluating: -36.2230131+3.5
 Parameter: ZMAX <- "-32.7230131"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.6055518"
Evaluating: 39.6055518-3.5
 Parameter: XMIN <- "36.1055518"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.85901979"
Evaluating: 3.85901979-3.5
 Parameter: YMIN <- "0.35901979"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.2230131"
Evaluating: -36.2230131-3.5
 Parameter: ZMIN <- "-39.7230131"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.1055518"
 Parameter: XMIN -> "36.1055518"
 Parameter: YMAX -> "7.35901979"
 Parameter: YMIN -> "0.35901979"
 Parameter: ZMAX -> "-32.7230131"
 Parameter: ZMIN -> "-39.7230131"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "23" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "23" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.183230126"
Evaluating: 81.6823114*(0.183230126-0.5)
 Parameter: XPOS <- "-25.8744955"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.140872151"
Evaluating: 81.6823114*(0.140872151-0.5)
 Parameter: YPOS <- "-29.3343928"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.409886235"
Evaluating: 85*(0.409886235-0.5)+0
 Parameter: ZPOS <- "-7.65967002"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.65967002" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.65967002" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "23" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.806824992"
Evaluating: 81.6823114*(0.806824992-0.5)
 Parameter: XPOS <- "25.0621745"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.18714023"
Evaluating: 81.6823114*(0.18714023-0.5)
 Parameter: YPOS <- "-25.5551092"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.6917261"
Evaluating: 85*(0.6917261-0.5)+0
 Parameter: ZPOS <- "16.2967185"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.2967185" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.2967185" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.0621745"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.0621745-0
 Parameter: XTRAN <- "25.0621745"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.5551092"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.5551092-0
 Parameter: YTRAN <- "-25.5551092"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.2967185"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.2967185-0
 Parameter: ZTRAN <- "16.2967185"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.0621745"
 Parameter: YTRAN -> "-25.5551092"
 Parameter: ZTRAN -> "16.2967185"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    25.062175  -25.555109   16.296719
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.262821416E-02"
Evaluating: 3.262821416E-02*360.0
 Parameter: XPHI <- "11.7461571"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.366659548"
Evaluating: 0.366659548*360.0
 Parameter: YPHI <- "131.997437"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.885138261"
Evaluating: 0.885138261*360.0
 Parameter: ZPHI <- "318.649774"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.0621745"
 Parameter: YPOS -> "-25.5551092"
 Parameter: ZPOS -> "16.2967185"
 Parameter: XPHI -> "11.7461571"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.979059    0.203576
    0.000000   -0.203576    0.979059

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.0621745"
 Parameter: YPOS -> "-25.5551092"
 Parameter: ZPOS -> "16.2967185"
 Parameter: YPHI -> "131.997437"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.669097    0.000000   -0.743175
    0.000000    1.000000    0.000000
    0.743175    0.000000   -0.669097

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.0621745"
 Parameter: YPOS -> "-25.5551092"
 Parameter: ZPOS -> "16.2967185"
 Parameter: ZPHI -> "318.649774"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.750685   -0.660660    0.000000
    0.660660    0.750685    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   41.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.062175 XMAX =   25.062175 XAVE =   25.062175
    YMIN =  -25.555109 YMAX =  -25.555109 YAVE =  -25.555109
    ZMIN =   16.296719 ZMAX =   16.296719 ZAVE =   16.296719
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.0621745"
Evaluating: 25.0621745+3.5
 Parameter: XMAX <- "28.5621745"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.5551092"
Evaluating: -25.5551092+3.5
 Parameter: YMAX <- "-22.0551092"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.2967185"
Evaluating: 16.2967185+3.5
 Parameter: ZMAX <- "19.7967185"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.0621745"
Evaluating: 25.0621745-3.5
 Parameter: XMIN <- "21.5621745"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.5551092"
Evaluating: -25.5551092-3.5
 Parameter: YMIN <- "-29.0551092"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.2967185"
Evaluating: 16.2967185-3.5
 Parameter: ZMIN <- "12.7967185"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.5621745"
 Parameter: XMIN -> "21.5621745"
 Parameter: YMAX -> "-22.0551092"
 Parameter: YMIN -> "-29.0551092"
 Parameter: ZMAX -> "19.7967185"
 Parameter: ZMIN -> "12.7967185"
 SELRPN>     27 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     15 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26543 POS      POT      23       POT     -4888 MEMB     POPC     37       C33           3.6379
26543 POS      POT      23       POT     -8233 MEMB     POPC     63       C12           3.8517
26543 POS      POT      23       POT     -8248 MEMB     POPC     63       C11           2.9685
26543 POS      POT      23       POT     -8251 MEMB     POPC     63       P             1.2329
26543 POS      POT      23       POT     -8252 MEMB     POPC     63       O13           1.7894
26543 POS      POT      23       POT     -8253 MEMB     POPC     63       O14           2.5267
26543 POS      POT      23       POT     -8254 MEMB     POPC     63       O12           2.2105
26543 POS      POT      23       POT     -8255 MEMB     POPC     63       O11           0.8100
26543 POS      POT      23       POT     -8256 MEMB     POPC     63       C1            1.6110
26543 POS      POT      23       POT     -8259 MEMB     POPC     63       C2            2.3201
26543 POS      POT      23       POT     -8261 MEMB     POPC     63       O21           2.9158
26543 POS      POT      23       POT     -8262 MEMB     POPC     63       C21           3.2057
26543 POS      POT      23       POT     -8263 MEMB     POPC     63       O22           3.0873
26543 POS      POT      23       POT     -8267 MEMB     POPC     63       C3            3.7238
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "23" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.778623722"
Evaluating: 81.6823114*(0.778623722-0.5)
 Parameter: XPOS <- "22.7586296"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.405700937"
Evaluating: 81.6823114*(0.405700937-0.5)
 Parameter: YPOS <- "-7.70256543"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.303956668"
Evaluating: 85*(0.303956668-0.5)+0
 Parameter: ZPOS <- "-16.6636832"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.6636832" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.062175 XMAX =   25.062175 XAVE =   25.062175
    YMIN =  -25.555109 YMAX =  -25.555109 YAVE =  -25.555109
    ZMIN =   16.296719 ZMAX =   16.296719 ZAVE =   16.296719
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.7586296"
 RDCMND substituted energy or value "?XAVE" to "25.0621745"
Evaluating: 22.7586296-25.0621745
 Parameter: XTRAN <- "-2.3035449"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.70256543"
 RDCMND substituted energy or value "?YAVE" to "-25.5551092"
Evaluating: -7.70256543--25.5551092
 Parameter: YTRAN <- "17.8525438"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.6636832"
 RDCMND substituted energy or value "?ZAVE" to "16.2967185"
Evaluating: -16.6636832-16.2967185
 Parameter: ZTRAN <- "-32.9604017"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.3035449"
 Parameter: YTRAN -> "17.8525438"
 Parameter: ZTRAN -> "-32.9604017"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -2.303545   17.852544  -32.960402
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513517067"
Evaluating: 0.513517067*360.0
 Parameter: XPHI <- "184.866144"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.16195021"
Evaluating: 0.16195021*360.0
 Parameter: YPHI <- "58.3020756"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.469922141"
Evaluating: 0.469922141*360.0
 Parameter: ZPHI <- "169.171971"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.7586296"
 Parameter: YPOS -> "-7.70256543"
 Parameter: ZPOS -> "-16.6636832"
 Parameter: XPHI -> "184.866144"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996396   -0.084828
    0.000000    0.084828   -0.996396

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  175.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.7586296"
 Parameter: YPOS -> "-7.70256543"
 Parameter: ZPOS -> "-16.6636832"
 Parameter: YPHI -> "58.3020756"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.525441    0.000000   -0.850830
    0.000000    1.000000    0.000000
    0.850830    0.000000    0.525441

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   58.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.7586296"
 Parameter: YPOS -> "-7.70256543"
 Parameter: ZPOS -> "-16.6636832"
 Parameter: ZPHI -> "169.171971"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.982195    0.187862    0.000000
   -0.187862   -0.982195    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  169.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.758630 XMAX =   22.758630 XAVE =   22.758630
    YMIN =   -7.702565 YMAX =   -7.702565 YAVE =   -7.702565
    ZMIN =  -16.663683 ZMAX =  -16.663683 ZAVE =  -16.663683
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.7586296"
Evaluating: 22.7586296+3.5
 Parameter: XMAX <- "26.2586296"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.7025654"
Evaluating: -7.7025654+3.5
 Parameter: YMAX <- "-4.2025654"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.6636832"
Evaluating: -16.6636832+3.5
 Parameter: ZMAX <- "-13.1636832"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.7586296"
Evaluating: 22.7586296-3.5
 Parameter: XMIN <- "19.2586296"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.7025654"
Evaluating: -7.7025654-3.5
 Parameter: YMIN <- "-11.2025654"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.6636832"
Evaluating: -16.6636832-3.5
 Parameter: ZMIN <- "-20.1636832"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.2586296"
 Parameter: XMIN -> "19.2586296"
 Parameter: YMAX -> "-4.2025654"
 Parameter: YMIN -> "-11.2025654"
 Parameter: ZMAX -> "-13.1636832"
 Parameter: ZMIN -> "-20.1636832"
 SELRPN>     39 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     18 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26543 POS      POT      23       POT     -**** MEMB     POPC     118      N             3.7088
26543 POS      POT      23       POT     -**** MEMB     POPC     118      C14           2.3509
26543 POS      POT      23       POT     -**** MEMB     POPC     131      O14           3.2373
26543 POS      POT      23       POT     -**** MEMB     POPC     136      C12           3.9210
26543 POS      POT      23       POT     -**** MEMB     POPC     136      C13           3.3129
26543 POS      POT      23       POT     -**** MEMB     POPC     136      O21           3.5990
26543 POS      POT      23       POT     -**** MEMB     POPC     136      C21           3.5609
26543 POS      POT      23       POT     -**** MEMB     POPC     136      C22           2.4159
26543 POS      POT      23       POT     -**** MEMB     POPC     136      C23           2.4707
26543 POS      POT      23       POT     -**** MEMB     POPC     136      C24           2.4508
26543 POS      POT      23       POT     -**** MEMB     POPC     136      C25           3.3240
26543 POS      POT      23       POT     -**** MEMB     POPC     136      C27           3.7902
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "23" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.998546782"
Evaluating: 81.6823114*(0.998546782-0.5)
 Parameter: XPOS <- "40.7224535"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.202050286"
Evaluating: 81.6823114*(0.202050286-0.5)
 Parameter: YPOS <- "-24.3372213"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.400085562"
Evaluating: 85*(0.400085562-0.5)+0
 Parameter: ZPOS <- "-8.49272723"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.49272723" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.49272723" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "23" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.280674356"
Evaluating: 81.6823114*(0.280674356-0.5)
 Parameter: XPOS <- "-17.9150256"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.917704271"
Evaluating: 81.6823114*(0.917704271-0.5)
 Parameter: YPOS <- "34.1190503"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.817045653"
Evaluating: 85*(0.817045653-0.5)+0
 Parameter: ZPOS <- "26.9488805"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.9488805" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.9488805" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.758630 XMAX =   22.758630 XAVE =   22.758630
    YMIN =   -7.702565 YMAX =   -7.702565 YAVE =   -7.702565
    ZMIN =  -16.663683 ZMAX =  -16.663683 ZAVE =  -16.663683
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.9150256"
 RDCMND substituted energy or value "?XAVE" to "22.7586296"
Evaluating: -17.9150256-22.7586296
 Parameter: XTRAN <- "-40.6736552"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.1190503"
 RDCMND substituted energy or value "?YAVE" to "-7.7025654"
Evaluating: 34.1190503--7.7025654
 Parameter: YTRAN <- "41.8216157"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.9488805"
 RDCMND substituted energy or value "?ZAVE" to "-16.6636832"
Evaluating: 26.9488805--16.6636832
 Parameter: ZTRAN <- "43.6125637"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.6736552"
 Parameter: YTRAN -> "41.8216157"
 Parameter: ZTRAN -> "43.6125637"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -40.673655   41.821616   43.612564
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549608621"
Evaluating: 0.549608621*360.0
 Parameter: XPHI <- "197.859104"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324246942"
Evaluating: 0.324246942*360.0
 Parameter: YPHI <- "116.728899"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.934308323"
Evaluating: 0.934308323*360.0
 Parameter: ZPHI <- "336.350996"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.9150256"
 Parameter: YPOS -> "34.1190503"
 Parameter: ZPOS -> "26.9488805"
 Parameter: XPHI -> "197.859104"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.951814   -0.306677
    0.000000    0.306677   -0.951814

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.9150256"
 Parameter: YPOS -> "34.1190503"
 Parameter: ZPOS -> "26.9488805"
 Parameter: YPHI -> "116.728899"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.449770    0.000000   -0.893145
    0.000000    1.000000    0.000000
    0.893145    0.000000   -0.449770

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  116.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.9150256"
 Parameter: YPOS -> "34.1190503"
 Parameter: ZPOS -> "26.9488805"
 Parameter: ZPHI -> "336.350996"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.916020   -0.401133    0.000000
    0.401133    0.916020    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.915026 XMAX =  -17.915026 XAVE =  -17.915026
    YMIN =   34.119050 YMAX =   34.119050 YAVE =   34.119050
    ZMIN =   26.948880 ZMAX =   26.948880 ZAVE =   26.948880
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.9150256"
Evaluating: -17.9150256+3.5
 Parameter: XMAX <- "-14.4150256"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.1190503"
Evaluating: 34.1190503+3.5
 Parameter: YMAX <- "37.6190503"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.9488805"
Evaluating: 26.9488805+3.5
 Parameter: ZMAX <- "30.4488805"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.9150256"
Evaluating: -17.9150256-3.5
 Parameter: XMIN <- "-21.4150256"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.1190503"
Evaluating: 34.1190503-3.5
 Parameter: YMIN <- "30.6190503"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.9488805"
Evaluating: 26.9488805-3.5
 Parameter: ZMIN <- "23.4488805"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.4150256"
 Parameter: XMIN -> "-21.4150256"
 Parameter: YMAX -> "37.6190503"
 Parameter: YMIN -> "30.6190503"
 Parameter: ZMAX -> "30.4488805"
 Parameter: ZMIN -> "23.4488805"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "24" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "24" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.811789894"
Evaluating: 81.6823114*(0.811789894-0.5)
 Parameter: XPOS <- "25.4677192"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.540127076"
Evaluating: 81.6823114*(0.540127076-0.5)
 Parameter: YPOS <- "3.27767232"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.168395552"
Evaluating: 85*(0.168395552-0.5)+0
 Parameter: ZPOS <- "-28.1863781"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.1863781" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.4677192"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.4677192-0
 Parameter: XTRAN <- "25.4677192"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.27767232"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.27767232-0
 Parameter: YTRAN <- "3.27767232"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.1863781"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.1863781-0
 Parameter: ZTRAN <- "-28.1863781"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.4677192"
 Parameter: YTRAN -> "3.27767232"
 Parameter: ZTRAN -> "-28.1863781"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    25.467719    3.277672  -28.186378
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.801723379"
Evaluating: 0.801723379*360.0
 Parameter: XPHI <- "288.620416"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.35224932"
Evaluating: 0.35224932*360.0
 Parameter: YPHI <- "126.809755"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486408709"
Evaluating: 0.486408709*360.0
 Parameter: ZPHI <- "175.107135"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.4677192"
 Parameter: YPOS -> "3.27767232"
 Parameter: ZPOS -> "-28.1863781"
 Parameter: XPHI -> "288.620416"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.319297   -0.947655
    0.000000    0.947655    0.319297

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   71.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.4677192"
 Parameter: YPOS -> "3.27767232"
 Parameter: ZPOS -> "-28.1863781"
 Parameter: YPHI -> "126.809755"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.599160    0.000000   -0.800629
    0.000000    1.000000    0.000000
    0.800629    0.000000   -0.599160

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  126.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.4677192"
 Parameter: YPOS -> "3.27767232"
 Parameter: ZPOS -> "-28.1863781"
 Parameter: ZPHI -> "175.107135"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.996356    0.085293    0.000000
   -0.085293   -0.996356    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.467719 XMAX =   25.467719 XAVE =   25.467719
    YMIN =    3.277672 YMAX =    3.277672 YAVE =    3.277672
    ZMIN =  -28.186378 ZMAX =  -28.186378 ZAVE =  -28.186378
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.4677192"
Evaluating: 25.4677192+3.5
 Parameter: XMAX <- "28.9677192"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.27767232"
Evaluating: 3.27767232+3.5
 Parameter: YMAX <- "6.77767232"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.1863781"
Evaluating: -28.1863781+3.5
 Parameter: ZMAX <- "-24.6863781"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.4677192"
Evaluating: 25.4677192-3.5
 Parameter: XMIN <- "21.9677192"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.27767232"
Evaluating: 3.27767232-3.5
 Parameter: YMIN <- "-0.22232768"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.1863781"
Evaluating: -28.1863781-3.5
 Parameter: ZMIN <- "-31.6863781"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.9677192"
 Parameter: XMIN -> "21.9677192"
 Parameter: YMAX -> "6.77767232"
 Parameter: YMIN -> "-0.22232768"
 Parameter: ZMAX -> "-24.6863781"
 Parameter: ZMIN -> "-31.6863781"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "25" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "25" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "9.395010934E-02"
Evaluating: 81.6823114*(9.395010934E-02-0.5)
 Parameter: XPOS <- "-33.1670936"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.137429712"
Evaluating: 81.6823114*(0.137429712-0.5)
 Parameter: YPOS <- "-29.6155792"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.833878824"
Evaluating: 85*(0.833878824-0.5)+0
 Parameter: ZPOS <- "28.3797"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.3797" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.3797" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.1670936"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.1670936-0
 Parameter: XTRAN <- "-33.1670936"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.6155792"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.6155792-0
 Parameter: YTRAN <- "-29.6155792"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.3797"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.3797-0
 Parameter: ZTRAN <- "28.3797"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.1670936"
 Parameter: YTRAN -> "-29.6155792"
 Parameter: ZTRAN -> "28.3797"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -33.167094  -29.615579   28.379700
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.496281819"
Evaluating: 0.496281819*360.0
 Parameter: XPHI <- "178.661455"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.931209043"
Evaluating: 0.931209043*360.0
 Parameter: YPHI <- "335.235255"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.939738647E-02"
Evaluating: 5.939738647E-02*360.0
 Parameter: ZPHI <- "21.3830591"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.1670936"
 Parameter: YPOS -> "-29.6155792"
 Parameter: ZPOS -> "28.3797"
 Parameter: XPHI -> "178.661455"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999727    0.023360
    0.000000   -0.023360   -0.999727

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  178.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.1670936"
 Parameter: YPOS -> "-29.6155792"
 Parameter: ZPOS -> "28.3797"
 Parameter: YPHI -> "335.235255"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.908035    0.000000    0.418893
    0.000000    1.000000    0.000000
   -0.418893    0.000000    0.908035

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   24.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.1670936"
 Parameter: YPOS -> "-29.6155792"
 Parameter: ZPOS -> "28.3797"
 Parameter: ZPHI -> "21.3830591"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.931164    0.364601    0.000000
   -0.364601    0.931164    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   21.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.167094 XMAX =  -33.167094 XAVE =  -33.167094
    YMIN =  -29.615579 YMAX =  -29.615579 YAVE =  -29.615579
    ZMIN =   28.379700 ZMAX =   28.379700 ZAVE =   28.379700
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.1670936"
Evaluating: -33.1670936+3.5
 Parameter: XMAX <- "-29.6670936"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.6155792"
Evaluating: -29.6155792+3.5
 Parameter: YMAX <- "-26.1155792"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.3797"
Evaluating: 28.3797+3.5
 Parameter: ZMAX <- "31.8797"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.1670936"
Evaluating: -33.1670936-3.5
 Parameter: XMIN <- "-36.6670936"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.6155792"
Evaluating: -29.6155792-3.5
 Parameter: YMIN <- "-33.1155792"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.3797"
Evaluating: 28.3797-3.5
 Parameter: ZMIN <- "24.8797"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.6670936"
 Parameter: XMIN -> "-36.6670936"
 Parameter: YMAX -> "-26.1155792"
 Parameter: YMIN -> "-33.1155792"
 Parameter: ZMAX -> "31.8797"
 Parameter: ZMIN -> "24.8797"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "26" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "26" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.853308047"
Evaluating: 81.6823114*(0.853308047-0.5)
 Parameter: XPOS <- "28.8590179"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.656159392"
Evaluating: 81.6823114*(0.656159392-0.5)
 Parameter: YPOS <- "12.7554601"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.968552285"
Evaluating: 85*(0.968552285-0.5)+0
 Parameter: ZPOS <- "39.8269442"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.8269442" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.8269442" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.8590179"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.8590179-0
 Parameter: XTRAN <- "28.8590179"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.7554601"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.7554601-0
 Parameter: YTRAN <- "12.7554601"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.8269442"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.8269442-0
 Parameter: ZTRAN <- "39.8269442"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.8590179"
 Parameter: YTRAN -> "12.7554601"
 Parameter: ZTRAN -> "39.8269442"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    28.859018   12.755460   39.826944
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.545769763"
Evaluating: 0.545769763*360.0
 Parameter: XPHI <- "196.477115"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.426046226"
Evaluating: 0.426046226*360.0
 Parameter: YPHI <- "153.376641"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.843811502E-02"
Evaluating: 4.843811502E-02*360.0
 Parameter: ZPHI <- "17.4377214"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.8590179"
 Parameter: YPOS -> "12.7554601"
 Parameter: ZPOS -> "39.8269442"
 Parameter: XPHI -> "196.477115"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.958933   -0.283632
    0.000000    0.283632   -0.958933

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  163.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.8590179"
 Parameter: YPOS -> "12.7554601"
 Parameter: ZPOS -> "39.8269442"
 Parameter: YPHI -> "153.376641"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.893972    0.000000   -0.448124
    0.000000    1.000000    0.000000
    0.448124    0.000000   -0.893972

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  153.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.8590179"
 Parameter: YPOS -> "12.7554601"
 Parameter: ZPOS -> "39.8269442"
 Parameter: ZPHI -> "17.4377214"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.954043    0.299669    0.000000
   -0.299669    0.954043    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.859018 XMAX =   28.859018 XAVE =   28.859018
    YMIN =   12.755460 YMAX =   12.755460 YAVE =   12.755460
    ZMIN =   39.826944 ZMAX =   39.826944 ZAVE =   39.826944
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.8590179"
Evaluating: 28.8590179+3.5
 Parameter: XMAX <- "32.3590179"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.7554601"
Evaluating: 12.7554601+3.5
 Parameter: YMAX <- "16.2554601"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.8269442"
Evaluating: 39.8269442+3.5
 Parameter: ZMAX <- "43.3269442"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.8590179"
Evaluating: 28.8590179-3.5
 Parameter: XMIN <- "25.3590179"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.7554601"
Evaluating: 12.7554601-3.5
 Parameter: YMIN <- "9.2554601"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.8269442"
Evaluating: 39.8269442-3.5
 Parameter: ZMIN <- "36.3269442"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.3590179"
 Parameter: XMIN -> "25.3590179"
 Parameter: YMAX -> "16.2554601"
 Parameter: YMIN -> "9.2554601"
 Parameter: ZMAX -> "43.3269442"
 Parameter: ZMIN -> "36.3269442"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "27" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "27" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.565909162"
Evaluating: 81.6823114*(0.565909162-0.5)
 Parameter: XPOS <- "5.38361269"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.11008324"
Evaluating: 81.6823114*(0.11008324-0.5)
 Parameter: YPOS <- "-31.8493022"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.27637097"
Evaluating: 85*(0.27637097-0.5)+0
 Parameter: ZPOS <- "-19.0084675"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.0084675" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.38361269"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.38361269-0
 Parameter: XTRAN <- "5.38361269"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.8493022"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.8493022-0
 Parameter: YTRAN <- "-31.8493022"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.0084675"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.0084675-0
 Parameter: ZTRAN <- "-19.0084675"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.38361269"
 Parameter: YTRAN -> "-31.8493022"
 Parameter: ZTRAN -> "-19.0084675"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     5.383613  -31.849302  -19.008467
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166816422"
Evaluating: 0.166816422*360.0
 Parameter: XPHI <- "60.0539119"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.927918366"
Evaluating: 0.927918366*360.0
 Parameter: YPHI <- "334.050612"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.488450965"
Evaluating: 0.488450965*360.0
 Parameter: ZPHI <- "175.842347"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.38361269"
 Parameter: YPOS -> "-31.8493022"
 Parameter: ZPOS -> "-19.0084675"
 Parameter: XPHI -> "60.0539119"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.499185    0.866495
    0.000000   -0.866495    0.499185

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   60.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.38361269"
 Parameter: YPOS -> "-31.8493022"
 Parameter: ZPOS -> "-19.0084675"
 Parameter: YPHI -> "334.050612"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.899181    0.000000    0.437577
    0.000000    1.000000    0.000000
   -0.437577    0.000000    0.899181

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   25.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.38361269"
 Parameter: YPOS -> "-31.8493022"
 Parameter: ZPOS -> "-19.0084675"
 Parameter: ZPHI -> "175.842347"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.997368    0.072501    0.000000
   -0.072501   -0.997368    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.383613 XMAX =    5.383613 XAVE =    5.383613
    YMIN =  -31.849302 YMAX =  -31.849302 YAVE =  -31.849302
    ZMIN =  -19.008467 ZMAX =  -19.008467 ZAVE =  -19.008467
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.38361269"
Evaluating: 5.38361269+3.5
 Parameter: XMAX <- "8.88361269"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.8493022"
Evaluating: -31.8493022+3.5
 Parameter: YMAX <- "-28.3493022"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.0084675"
Evaluating: -19.0084675+3.5
 Parameter: ZMAX <- "-15.5084675"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.38361269"
Evaluating: 5.38361269-3.5
 Parameter: XMIN <- "1.88361269"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.8493022"
Evaluating: -31.8493022-3.5
 Parameter: YMIN <- "-35.3493022"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.0084675"
Evaluating: -19.0084675-3.5
 Parameter: ZMIN <- "-22.5084675"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.88361269"
 Parameter: XMIN -> "1.88361269"
 Parameter: YMAX -> "-28.3493022"
 Parameter: YMIN -> "-35.3493022"
 Parameter: ZMAX -> "-15.5084675"
 Parameter: ZMIN -> "-22.5084675"
 SELRPN>     26 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     13 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26547 POS      POT      27       POT     -**** MEMB     POPC     154      N             3.6299
26547 POS      POT      27       POT     -**** MEMB     POPC     154      C12           3.4991
26547 POS      POT      27       POT     -**** MEMB     POPC     154      C13           2.9106
26547 POS      POT      27       POT     -**** MEMB     POPC     154      C14           3.8406
26547 POS      POT      27       POT     -**** MEMB     POPC     154      C11           2.9346
26547 POS      POT      27       POT     -**** MEMB     POPC     154      P             2.0320
26547 POS      POT      27       POT     -**** MEMB     POPC     154      O13           2.1867
26547 POS      POT      27       POT     -**** MEMB     POPC     154      O14           3.4884
26547 POS      POT      27       POT     -**** MEMB     POPC     154      O12           1.7374
26547 POS      POT      27       POT     -**** MEMB     POPC     154      O11           2.1548
26547 POS      POT      27       POT     -**** MEMB     POPC     154      C1            1.7715
26547 POS      POT      27       POT     -**** MEMB     POPC     154      C2            3.2362
26547 POS      POT      27       POT     -**** MEMB     POPC     154      C3            3.8354
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "27" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.37674974"
Evaluating: 81.6823114*(0.37674974-0.5)
 Parameter: XPOS <- "-10.0673661"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.914999412"
Evaluating: 81.6823114*(0.914999412-0.5)
 Parameter: YPOS <- "33.8981112"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.326660837"
Evaluating: 85*(0.326660837-0.5)+0
 Parameter: ZPOS <- "-14.7338289"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.7338289" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.7338289" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "27" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.67098716"
Evaluating: 81.6823114*(0.67098716-0.5)
 Parameter: XPOS <- "13.9666264"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.339896827"
Evaluating: 81.6823114*(0.339896827-0.5)
 Parameter: YPOS <- "-13.0775972"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.927170079"
Evaluating: 85*(0.927170079-0.5)+0
 Parameter: ZPOS <- "36.3094567"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.3094567" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.3094567" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.383613 XMAX =    5.383613 XAVE =    5.383613
    YMIN =  -31.849302 YMAX =  -31.849302 YAVE =  -31.849302
    ZMIN =  -19.008467 ZMAX =  -19.008467 ZAVE =  -19.008467
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.9666264"
 RDCMND substituted energy or value "?XAVE" to "5.38361269"
Evaluating: 13.9666264-5.38361269
 Parameter: XTRAN <- "8.58301371"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.0775972"
 RDCMND substituted energy or value "?YAVE" to "-31.8493022"
Evaluating: -13.0775972--31.8493022
 Parameter: YTRAN <- "18.771705"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.3094567"
 RDCMND substituted energy or value "?ZAVE" to "-19.0084675"
Evaluating: 36.3094567--19.0084675
 Parameter: ZTRAN <- "55.3179242"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.58301371"
 Parameter: YTRAN -> "18.771705"
 Parameter: ZTRAN -> "55.3179242"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     8.583014   18.771705   55.317924
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671695047"
Evaluating: 0.671695047*360.0
 Parameter: XPHI <- "241.810217"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.708447479"
Evaluating: 0.708447479*360.0
 Parameter: YPHI <- "255.041092"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.137357113"
Evaluating: 0.137357113*360.0
 Parameter: ZPHI <- "49.4485607"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.9666264"
 Parameter: YPOS -> "-13.0775972"
 Parameter: ZPOS -> "36.3094567"
 Parameter: XPHI -> "241.810217"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.472394   -0.881388
    0.000000    0.881388   -0.472394

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.9666264"
 Parameter: YPOS -> "-13.0775972"
 Parameter: ZPOS -> "36.3094567"
 Parameter: YPHI -> "255.041092"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.258126    0.000000    0.966111
    0.000000    1.000000    0.000000
   -0.966111    0.000000   -0.258126

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.9666264"
 Parameter: YPOS -> "-13.0775972"
 Parameter: ZPOS -> "36.3094567"
 Parameter: ZPHI -> "49.4485607"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.650130    0.759823    0.000000
   -0.759823    0.650130    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.966626 XMAX =   13.966626 XAVE =   13.966626
    YMIN =  -13.077597 YMAX =  -13.077597 YAVE =  -13.077597
    ZMIN =   36.309457 ZMAX =   36.309457 ZAVE =   36.309457
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.9666264"
Evaluating: 13.9666264+3.5
 Parameter: XMAX <- "17.4666264"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.0775972"
Evaluating: -13.0775972+3.5
 Parameter: YMAX <- "-9.5775972"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.3094567"
Evaluating: 36.3094567+3.5
 Parameter: ZMAX <- "39.8094567"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.9666264"
Evaluating: 13.9666264-3.5
 Parameter: XMIN <- "10.4666264"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.0775972"
Evaluating: -13.0775972-3.5
 Parameter: YMIN <- "-16.5775972"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.3094567"
Evaluating: 36.3094567-3.5
 Parameter: ZMIN <- "32.8094567"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.4666264"
 Parameter: XMIN -> "10.4666264"
 Parameter: YMAX -> "-9.5775972"
 Parameter: YMIN -> "-16.5775972"
 Parameter: ZMAX -> "39.8094567"
 Parameter: ZMIN -> "32.8094567"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "28" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "28" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.784995078"
Evaluating: 81.6823114*(0.784995078-0.5)
 Parameter: XPOS <- "23.2790567"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.109489564"
Evaluating: 81.6823114*(0.109489564-0.5)
 Parameter: YPOS <- "-31.897795"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.218635198"
Evaluating: 85*(0.218635198-0.5)+0
 Parameter: ZPOS <- "-23.9160082"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.9160082" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.2790567"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.2790567-0
 Parameter: XTRAN <- "23.2790567"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.897795"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.897795-0
 Parameter: YTRAN <- "-31.897795"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.9160082"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.9160082-0
 Parameter: ZTRAN <- "-23.9160082"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.2790567"
 Parameter: YTRAN -> "-31.897795"
 Parameter: ZTRAN -> "-23.9160082"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    23.279057  -31.897795  -23.916008
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.897000063"
Evaluating: 0.897000063*360.0
 Parameter: XPHI <- "322.920023"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643314688"
Evaluating: 0.643314688*360.0
 Parameter: YPHI <- "231.593288"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.556995171"
Evaluating: 0.556995171*360.0
 Parameter: ZPHI <- "200.518262"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.2790567"
 Parameter: YPOS -> "-31.897795"
 Parameter: ZPOS -> "-23.9160082"
 Parameter: XPHI -> "322.920023"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.797795   -0.602929
    0.000000    0.602929    0.797795

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   37.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.2790567"
 Parameter: YPOS -> "-31.897795"
 Parameter: ZPOS -> "-23.9160082"
 Parameter: YPHI -> "231.593288"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.621240    0.000000    0.783621
    0.000000    1.000000    0.000000
   -0.783621    0.000000   -0.621240

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  128.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.2790567"
 Parameter: YPOS -> "-31.897795"
 Parameter: ZPOS -> "-23.9160082"
 Parameter: ZPHI -> "200.518262"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.936561   -0.350506    0.000000
    0.350506   -0.936561    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  159.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.279057 XMAX =   23.279057 XAVE =   23.279057
    YMIN =  -31.897795 YMAX =  -31.897795 YAVE =  -31.897795
    ZMIN =  -23.916008 ZMAX =  -23.916008 ZAVE =  -23.916008
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.2790567"
Evaluating: 23.2790567+3.5
 Parameter: XMAX <- "26.7790567"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.897795"
Evaluating: -31.897795+3.5
 Parameter: YMAX <- "-28.397795"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.9160082"
Evaluating: -23.9160082+3.5
 Parameter: ZMAX <- "-20.4160082"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.2790567"
Evaluating: 23.2790567-3.5
 Parameter: XMIN <- "19.7790567"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.897795"
Evaluating: -31.897795-3.5
 Parameter: YMIN <- "-35.397795"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.9160082"
Evaluating: -23.9160082-3.5
 Parameter: ZMIN <- "-27.4160082"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.7790567"
 Parameter: XMIN -> "19.7790567"
 Parameter: YMAX -> "-28.397795"
 Parameter: YMIN -> "-35.397795"
 Parameter: ZMAX -> "-20.4160082"
 Parameter: ZMIN -> "-27.4160082"
 SELRPN>      4 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      3 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26548 POS      POT      28       POT     -**** MEMB     POPS     182      C13           3.8283
26548 POS      POT      28       POT     -**** MEMB     POPS     182      O13A          2.6620
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "28" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.336417584"
Evaluating: 81.6823114*(0.336417584-0.5)
 Parameter: XPOS <- "-13.3617898"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.749093793"
Evaluating: 81.6823114*(0.749093793-0.5)
 Parameter: YPOS <- "20.3465568"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.894584968"
Evaluating: 85*(0.894584968-0.5)+0
 Parameter: ZPOS <- "33.5397223"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.5397223" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.5397223" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.279057 XMAX =   23.279057 XAVE =   23.279057
    YMIN =  -31.897795 YMAX =  -31.897795 YAVE =  -31.897795
    ZMIN =  -23.916008 ZMAX =  -23.916008 ZAVE =  -23.916008
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.3617898"
 RDCMND substituted energy or value "?XAVE" to "23.2790567"
Evaluating: -13.3617898-23.2790567
 Parameter: XTRAN <- "-36.6408465"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.3465568"
 RDCMND substituted energy or value "?YAVE" to "-31.897795"
Evaluating: 20.3465568--31.897795
 Parameter: YTRAN <- "52.2443518"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.5397223"
 RDCMND substituted energy or value "?ZAVE" to "-23.9160082"
Evaluating: 33.5397223--23.9160082
 Parameter: ZTRAN <- "57.4557305"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.6408465"
 Parameter: YTRAN -> "52.2443518"
 Parameter: ZTRAN -> "57.4557305"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -36.640847   52.244352   57.455731
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.650843914"
Evaluating: 0.650843914*360.0
 Parameter: XPHI <- "234.303809"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607072109"
Evaluating: 0.607072109*360.0
 Parameter: YPHI <- "218.545959"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.883217561"
Evaluating: 0.883217561*360.0
 Parameter: ZPHI <- "317.958322"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.3617898"
 Parameter: YPOS -> "20.3465568"
 Parameter: ZPOS -> "33.5397223"
 Parameter: XPHI -> "234.303809"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.583487   -0.812122
    0.000000    0.812122   -0.583487

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.3617898"
 Parameter: YPOS -> "20.3465568"
 Parameter: ZPOS -> "33.5397223"
 Parameter: YPHI -> "218.545959"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.782109    0.000000    0.623142
    0.000000    1.000000    0.000000
   -0.623142    0.000000   -0.782109

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  141.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.3617898"
 Parameter: YPOS -> "20.3465568"
 Parameter: ZPOS -> "33.5397223"
 Parameter: ZPHI -> "317.958322"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.742658   -0.669671    0.000000
    0.669671    0.742658    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   42.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.361790 XMAX =  -13.361790 XAVE =  -13.361790
    YMIN =   20.346557 YMAX =   20.346557 YAVE =   20.346557
    ZMIN =   33.539722 ZMAX =   33.539722 ZAVE =   33.539722
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.3617898"
Evaluating: -13.3617898+3.5
 Parameter: XMAX <- "-9.8617898"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.3465568"
Evaluating: 20.3465568+3.5
 Parameter: YMAX <- "23.8465568"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.5397223"
Evaluating: 33.5397223+3.5
 Parameter: ZMAX <- "37.0397223"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.3617898"
Evaluating: -13.3617898-3.5
 Parameter: XMIN <- "-16.8617898"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.3465568"
Evaluating: 20.3465568-3.5
 Parameter: YMIN <- "16.8465568"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.5397223"
Evaluating: 33.5397223-3.5
 Parameter: ZMIN <- "30.0397223"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.8617898"
 Parameter: XMIN -> "-16.8617898"
 Parameter: YMAX -> "23.8465568"
 Parameter: YMIN -> "16.8465568"
 Parameter: ZMAX -> "37.0397223"
 Parameter: ZMIN -> "30.0397223"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "29" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "29" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.394417096"
Evaluating: 81.6823114*(0.394417096-0.5)
 Parameter: XPOS <- "-8.62425564"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "1.422745138E-03"
Evaluating: 81.6823114*(1.422745138E-03-0.5)
 Parameter: YPOS <- "-40.7249426"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.8398102"
Evaluating: 85*(0.8398102-0.5)+0
 Parameter: ZPOS <- "28.883867"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.883867" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.883867" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.62425564"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.62425564-0
 Parameter: XTRAN <- "-8.62425564"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.7249426"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.7249426-0
 Parameter: YTRAN <- "-40.7249426"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.883867"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.883867-0
 Parameter: ZTRAN <- "28.883867"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.62425564"
 Parameter: YTRAN -> "-40.7249426"
 Parameter: ZTRAN -> "28.883867"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -8.624256  -40.724943   28.883867
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.988782933"
Evaluating: 0.988782933*360.0
 Parameter: XPHI <- "355.961856"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.250138306"
Evaluating: 0.250138306*360.0
 Parameter: YPHI <- "90.0497902"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.122551092"
Evaluating: 0.122551092*360.0
 Parameter: ZPHI <- "44.1183931"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.62425564"
 Parameter: YPOS -> "-40.7249426"
 Parameter: ZPOS -> "28.883867"
 Parameter: XPHI -> "355.961856"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997517   -0.070421
    0.000000    0.070421    0.997517

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    4.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.62425564"
 Parameter: YPOS -> "-40.7249426"
 Parameter: ZPOS -> "28.883867"
 Parameter: YPHI -> "90.0497902"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.000869    0.000000   -1.000000
    0.000000    1.000000    0.000000
    1.000000    0.000000   -0.000869

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   90.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.62425564"
 Parameter: YPOS -> "-40.7249426"
 Parameter: ZPOS -> "28.883867"
 Parameter: ZPHI -> "44.1183931"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.717903    0.696143    0.000000
   -0.696143    0.717903    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   44.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.624256 XMAX =   -8.624256 XAVE =   -8.624256
    YMIN =  -40.724943 YMAX =  -40.724943 YAVE =  -40.724943
    ZMIN =   28.883867 ZMAX =   28.883867 ZAVE =   28.883867
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.62425564"
Evaluating: -8.62425564+3.5
 Parameter: XMAX <- "-5.12425564"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.7249426"
Evaluating: -40.7249426+3.5
 Parameter: YMAX <- "-37.2249426"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.883867"
Evaluating: 28.883867+3.5
 Parameter: ZMAX <- "32.383867"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.62425564"
Evaluating: -8.62425564-3.5
 Parameter: XMIN <- "-12.1242556"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.7249426"
Evaluating: -40.7249426-3.5
 Parameter: YMIN <- "-44.2249426"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.883867"
Evaluating: 28.883867-3.5
 Parameter: ZMIN <- "25.383867"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.12425564"
 Parameter: XMIN -> "-12.1242556"
 Parameter: YMAX -> "-37.2249426"
 Parameter: YMIN -> "-44.2249426"
 Parameter: ZMAX -> "32.383867"
 Parameter: ZMIN -> "25.383867"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "30" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "30" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.555519103"
Evaluating: 81.6823114*(0.555519103-0.5)
 Parameter: XPOS <- "4.53492866"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.890949132"
Evaluating: 81.6823114*(0.890949132-0.5)
 Parameter: YPOS <- "31.9336287"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.140657632"
Evaluating: 85*(0.140657632-0.5)+0
 Parameter: ZPOS <- "-30.5441013"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.5441013" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.53492866"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.53492866-0
 Parameter: XTRAN <- "4.53492866"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.9336287"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.9336287-0
 Parameter: YTRAN <- "31.9336287"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.5441013"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.5441013-0
 Parameter: ZTRAN <- "-30.5441013"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.53492866"
 Parameter: YTRAN -> "31.9336287"
 Parameter: ZTRAN -> "-30.5441013"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     4.534929   31.933629  -30.544101
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.954311542"
Evaluating: 0.954311542*360.0
 Parameter: XPHI <- "343.552155"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587502019"
Evaluating: 0.587502019*360.0
 Parameter: YPHI <- "211.500727"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.646736426"
Evaluating: 0.646736426*360.0
 Parameter: ZPHI <- "232.825113"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.53492866"
 Parameter: YPOS -> "31.9336287"
 Parameter: ZPOS -> "-30.5441013"
 Parameter: XPHI -> "343.552155"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.959078   -0.283142
    0.000000    0.283142    0.959078

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.53492866"
 Parameter: YPOS -> "31.9336287"
 Parameter: ZPOS -> "-30.5441013"
 Parameter: YPHI -> "211.500727"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.852634    0.000000    0.522509
    0.000000    1.000000    0.000000
   -0.522509    0.000000   -0.852634

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.53492866"
 Parameter: YPOS -> "31.9336287"
 Parameter: ZPOS -> "-30.5441013"
 Parameter: ZPHI -> "232.825113"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.604250   -0.796795    0.000000
    0.796795   -0.604250    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  127.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.534929 XMAX =    4.534929 XAVE =    4.534929
    YMIN =   31.933629 YMAX =   31.933629 YAVE =   31.933629
    ZMIN =  -30.544101 ZMAX =  -30.544101 ZAVE =  -30.544101
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.53492866"
Evaluating: 4.53492866+3.5
 Parameter: XMAX <- "8.03492866"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.9336287"
Evaluating: 31.9336287+3.5
 Parameter: YMAX <- "35.4336287"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.5441013"
Evaluating: -30.5441013+3.5
 Parameter: ZMAX <- "-27.0441013"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.53492866"
Evaluating: 4.53492866-3.5
 Parameter: XMIN <- "1.03492866"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.9336287"
Evaluating: 31.9336287-3.5
 Parameter: YMIN <- "28.4336287"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.5441013"
Evaluating: -30.5441013-3.5
 Parameter: ZMIN <- "-34.0441013"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.03492866"
 Parameter: XMIN -> "1.03492866"
 Parameter: YMAX -> "35.4336287"
 Parameter: YMIN -> "28.4336287"
 Parameter: ZMAX -> "-27.0441013"
 Parameter: ZMIN -> "-34.0441013"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "31" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "31" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.374943648"
Evaluating: 81.6823114*(0.374943648-0.5)
 Parameter: XPOS <- "-10.2148919"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.661569114"
Evaluating: 81.6823114*(0.661569114-0.5)
 Parameter: YPOS <- "13.1973387"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.886733106"
Evaluating: 85*(0.886733106-0.5)+0
 Parameter: ZPOS <- "32.872314"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.872314" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.872314" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.2148919"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.2148919-0
 Parameter: XTRAN <- "-10.2148919"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.1973387"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.1973387-0
 Parameter: YTRAN <- "13.1973387"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.872314"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.872314-0
 Parameter: ZTRAN <- "32.872314"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.2148919"
 Parameter: YTRAN -> "13.1973387"
 Parameter: ZTRAN -> "32.872314"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -10.214892   13.197339   32.872314
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.203022377"
Evaluating: 0.203022377*360.0
 Parameter: XPHI <- "73.0880557"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.992011629"
Evaluating: 0.992011629*360.0
 Parameter: YPHI <- "357.124186"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.945879669"
Evaluating: 0.945879669*360.0
 Parameter: ZPHI <- "340.516681"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.2148919"
 Parameter: YPOS -> "13.1973387"
 Parameter: ZPOS -> "32.872314"
 Parameter: XPHI -> "73.0880557"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.290902    0.956753
    0.000000   -0.956753    0.290902

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   73.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.2148919"
 Parameter: YPOS -> "13.1973387"
 Parameter: ZPOS -> "32.872314"
 Parameter: YPHI -> "357.124186"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.998741    0.000000    0.050171
    0.000000    1.000000    0.000000
   -0.050171    0.000000    0.998741

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    2.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.2148919"
 Parameter: YPOS -> "13.1973387"
 Parameter: ZPOS -> "32.872314"
 Parameter: ZPHI -> "340.516681"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.942739   -0.333532    0.000000
    0.333532    0.942739    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   19.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.214892 XMAX =  -10.214892 XAVE =  -10.214892
    YMIN =   13.197339 YMAX =   13.197339 YAVE =   13.197339
    ZMIN =   32.872314 ZMAX =   32.872314 ZAVE =   32.872314
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.2148919"
Evaluating: -10.2148919+3.5
 Parameter: XMAX <- "-6.7148919"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.1973387"
Evaluating: 13.1973387+3.5
 Parameter: YMAX <- "16.6973387"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.872314"
Evaluating: 32.872314+3.5
 Parameter: ZMAX <- "36.372314"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.2148919"
Evaluating: -10.2148919-3.5
 Parameter: XMIN <- "-13.7148919"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.1973387"
Evaluating: 13.1973387-3.5
 Parameter: YMIN <- "9.6973387"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.872314"
Evaluating: 32.872314-3.5
 Parameter: ZMIN <- "29.372314"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.7148919"
 Parameter: XMIN -> "-13.7148919"
 Parameter: YMAX -> "16.6973387"
 Parameter: YMIN -> "9.6973387"
 Parameter: ZMAX -> "36.372314"
 Parameter: ZMIN -> "29.372314"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "32" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "32" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.299877871"
Evaluating: 81.6823114*(0.299877871-0.5)
 Parameter: XPOS <- "-16.3464381"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.661610262"
Evaluating: 81.6823114*(0.661610262-0.5)
 Parameter: YPOS <- "13.2006997"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.329388251"
Evaluating: 85*(0.329388251-0.5)+0
 Parameter: ZPOS <- "-14.5019987"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.5019987" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.5019987" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "32" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.966925678"
Evaluating: 81.6823114*(0.966925678-0.5)
 Parameter: XPOS <- "38.1395686"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.846472941"
Evaluating: 81.6823114*(0.846472941-0.5)
 Parameter: YPOS <- "28.3007107"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.769187363"
Evaluating: 85*(0.769187363-0.5)+0
 Parameter: ZPOS <- "22.8809259"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.8809259" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.8809259" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.1395686"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.1395686-0
 Parameter: XTRAN <- "38.1395686"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.3007107"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.3007107-0
 Parameter: YTRAN <- "28.3007107"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.8809259"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.8809259-0
 Parameter: ZTRAN <- "22.8809259"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.1395686"
 Parameter: YTRAN -> "28.3007107"
 Parameter: ZTRAN -> "22.8809259"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    38.139569   28.300711   22.880926
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.607924472"
Evaluating: 0.607924472*360.0
 Parameter: XPHI <- "218.85281"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.185031169E-02"
Evaluating: 6.185031169E-02*360.0
 Parameter: YPHI <- "22.2661122"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987854514"
Evaluating: 0.987854514*360.0
 Parameter: ZPHI <- "355.627625"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.1395686"
 Parameter: YPOS -> "28.3007107"
 Parameter: ZPOS -> "22.8809259"
 Parameter: XPHI -> "218.85281"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.778760   -0.627322
    0.000000    0.627322   -0.778760

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  141.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.1395686"
 Parameter: YPOS -> "28.3007107"
 Parameter: ZPOS -> "22.8809259"
 Parameter: YPHI -> "22.2661122"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.925434    0.000000   -0.378909
    0.000000    1.000000    0.000000
    0.378909    0.000000    0.925434

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   22.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.1395686"
 Parameter: YPOS -> "28.3007107"
 Parameter: ZPOS -> "22.8809259"
 Parameter: ZPHI -> "355.627625"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.997090   -0.076238    0.000000
    0.076238    0.997090    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    4.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.139569 XMAX =   38.139569 XAVE =   38.139569
    YMIN =   28.300711 YMAX =   28.300711 YAVE =   28.300711
    ZMIN =   22.880926 ZMAX =   22.880926 ZAVE =   22.880926
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.1395686"
Evaluating: 38.1395686+3.5
 Parameter: XMAX <- "41.6395686"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.3007107"
Evaluating: 28.3007107+3.5
 Parameter: YMAX <- "31.8007107"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.8809259"
Evaluating: 22.8809259+3.5
 Parameter: ZMAX <- "26.3809259"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.1395686"
Evaluating: 38.1395686-3.5
 Parameter: XMIN <- "34.6395686"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.3007107"
Evaluating: 28.3007107-3.5
 Parameter: YMIN <- "24.8007107"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.8809259"
Evaluating: 22.8809259-3.5
 Parameter: ZMIN <- "19.3809259"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.6395686"
 Parameter: XMIN -> "34.6395686"
 Parameter: YMAX -> "31.8007107"
 Parameter: YMIN -> "24.8007107"
 Parameter: ZMAX -> "26.3809259"
 Parameter: ZMIN -> "19.3809259"
 SELRPN>      4 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      3 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26552 POS      POT      32       POT     -**** MEMB     POPC     91       O14           3.7834
26552 POS      POT      32       POT     -**** MEMB     POPC     93       O14           3.8607
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "32" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.914561303"
Evaluating: 81.6823114*(0.914561303-0.5)
 Parameter: XPOS <- "33.8623254"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.399890111"
Evaluating: 81.6823114*(0.399890111-0.5)
 Parameter: YPOS <- "-8.17720713"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.467752969"
Evaluating: 85*(0.467752969-0.5)+0
 Parameter: ZPOS <- "-2.74099764"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.74099764" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.74099764" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "32" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.820589423"
Evaluating: 81.6823114*(0.820589423-0.5)
 Parameter: XPOS <- "26.1864851"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.225153589"
Evaluating: 81.6823114*(0.225153589-0.5)
 Parameter: YPOS <- "-22.4500901"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.109713271"
Evaluating: 85*(0.109713271-0.5)+0
 Parameter: ZPOS <- "-33.174372"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.174372" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.139569 XMAX =   38.139569 XAVE =   38.139569
    YMIN =   28.300711 YMAX =   28.300711 YAVE =   28.300711
    ZMIN =   22.880926 ZMAX =   22.880926 ZAVE =   22.880926
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.1864851"
 RDCMND substituted energy or value "?XAVE" to "38.1395686"
Evaluating: 26.1864851-38.1395686
 Parameter: XTRAN <- "-11.9530835"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.4500901"
 RDCMND substituted energy or value "?YAVE" to "28.3007107"
Evaluating: -22.4500901-28.3007107
 Parameter: YTRAN <- "-50.7508008"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.174372"
 RDCMND substituted energy or value "?ZAVE" to "22.8809259"
Evaluating: -33.174372-22.8809259
 Parameter: ZTRAN <- "-56.0552979"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.9530835"
 Parameter: YTRAN -> "-50.7508008"
 Parameter: ZTRAN -> "-56.0552979"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -11.953083  -50.750801  -56.055298
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.81882467"
Evaluating: 0.81882467*360.0
 Parameter: XPHI <- "294.776881"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324687482"
Evaluating: 0.324687482*360.0
 Parameter: YPHI <- "116.887494"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.468473895"
Evaluating: 0.468473895*360.0
 Parameter: ZPHI <- "168.650602"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.1864851"
 Parameter: YPOS -> "-22.4500901"
 Parameter: ZPOS -> "-33.174372"
 Parameter: XPHI -> "294.776881"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.419086   -0.907947
    0.000000    0.907947    0.419086

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   65.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.1864851"
 Parameter: YPOS -> "-22.4500901"
 Parameter: ZPOS -> "-33.174372"
 Parameter: YPHI -> "116.887494"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.452240    0.000000   -0.891896
    0.000000    1.000000    0.000000
    0.891896    0.000000   -0.452240

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  116.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.1864851"
 Parameter: YPOS -> "-22.4500901"
 Parameter: ZPOS -> "-33.174372"
 Parameter: ZPHI -> "168.650602"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.980445    0.196792    0.000000
   -0.196792   -0.980445    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  168.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.186485 XMAX =   26.186485 XAVE =   26.186485
    YMIN =  -22.450090 YMAX =  -22.450090 YAVE =  -22.450090
    ZMIN =  -33.174372 ZMAX =  -33.174372 ZAVE =  -33.174372
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.1864851"
Evaluating: 26.1864851+3.5
 Parameter: XMAX <- "29.6864851"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.4500901"
Evaluating: -22.4500901+3.5
 Parameter: YMAX <- "-18.9500901"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.174372"
Evaluating: -33.174372+3.5
 Parameter: ZMAX <- "-29.674372"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.1864851"
Evaluating: 26.1864851-3.5
 Parameter: XMIN <- "22.6864851"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.4500901"
Evaluating: -22.4500901-3.5
 Parameter: YMIN <- "-25.9500901"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.174372"
Evaluating: -33.174372-3.5
 Parameter: ZMIN <- "-36.674372"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.6864851"
 Parameter: XMIN -> "22.6864851"
 Parameter: YMAX -> "-18.9500901"
 Parameter: YMIN -> "-25.9500901"
 Parameter: ZMAX -> "-29.674372"
 Parameter: ZMIN -> "-36.674372"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "33" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "33" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.210511988"
Evaluating: 81.6823114*(0.210511988-0.5)
 Parameter: XPOS <- "-23.6460499"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.221702067"
Evaluating: 81.6823114*(0.221702067-0.5)
 Parameter: YPOS <- "-22.7320184"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.316354966E-02"
Evaluating: 85*(1.316354966E-02-0.5)+0
 Parameter: ZPOS <- "-41.3810983"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.3810983" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.6460499"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.6460499-0
 Parameter: XTRAN <- "-23.6460499"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.7320184"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.7320184-0
 Parameter: YTRAN <- "-22.7320184"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.3810983"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.3810983-0
 Parameter: ZTRAN <- "-41.3810983"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.6460499"
 Parameter: YTRAN -> "-22.7320184"
 Parameter: ZTRAN -> "-41.3810983"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -23.646050  -22.732018  -41.381098
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.610726688"
Evaluating: 0.610726688*360.0
 Parameter: XPHI <- "219.861608"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.983248881E-02"
Evaluating: 8.983248881E-02*360.0
 Parameter: YPHI <- "32.339696"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.970839271"
Evaluating: 0.970839271*360.0
 Parameter: ZPHI <- "349.502138"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.6460499"
 Parameter: YPOS -> "-22.7320184"
 Parameter: ZPOS -> "-41.3810983"
 Parameter: XPHI -> "219.861608"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.767595   -0.640935
    0.000000    0.640935   -0.767595

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  140.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.6460499"
 Parameter: YPOS -> "-22.7320184"
 Parameter: ZPOS -> "-41.3810983"
 Parameter: YPHI -> "32.339696"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.844891    0.000000   -0.534938
    0.000000    1.000000    0.000000
    0.534938    0.000000    0.844891

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   32.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.6460499"
 Parameter: YPOS -> "-22.7320184"
 Parameter: ZPOS -> "-41.3810983"
 Parameter: ZPHI -> "349.502138"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.983262   -0.182199    0.000000
    0.182199    0.983262    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.646050 XMAX =  -23.646050 XAVE =  -23.646050
    YMIN =  -22.732018 YMAX =  -22.732018 YAVE =  -22.732018
    ZMIN =  -41.381098 ZMAX =  -41.381098 ZAVE =  -41.381098
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.6460499"
Evaluating: -23.6460499+3.5
 Parameter: XMAX <- "-20.1460499"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.7320184"
Evaluating: -22.7320184+3.5
 Parameter: YMAX <- "-19.2320184"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.3810983"
Evaluating: -41.3810983+3.5
 Parameter: ZMAX <- "-37.8810983"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.6460499"
Evaluating: -23.6460499-3.5
 Parameter: XMIN <- "-27.1460499"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.7320184"
Evaluating: -22.7320184-3.5
 Parameter: YMIN <- "-26.2320184"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.3810983"
Evaluating: -41.3810983-3.5
 Parameter: ZMIN <- "-44.8810983"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.1460499"
 Parameter: XMIN -> "-27.1460499"
 Parameter: YMAX -> "-19.2320184"
 Parameter: YMIN -> "-26.2320184"
 Parameter: ZMAX -> "-37.8810983"
 Parameter: ZMIN -> "-44.8810983"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "34" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "34" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "5.332299016E-04"
Evaluating: 81.6823114*(5.332299016E-04-0.5)
 Parameter: XPOS <- "-40.7976002"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.23955231"
Evaluating: 81.6823114*(0.23955231-0.5)
 Parameter: YPOS <- "-21.2739693"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.939214753E-02"
Evaluating: 85*(1.939214753E-02-0.5)+0
 Parameter: ZPOS <- "-40.8516675"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.8516675" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.7976002"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -40.7976002-0
 Parameter: XTRAN <- "-40.7976002"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.2739693"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.2739693-0
 Parameter: YTRAN <- "-21.2739693"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.8516675"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.8516675-0
 Parameter: ZTRAN <- "-40.8516675"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.7976002"
 Parameter: YTRAN -> "-21.2739693"
 Parameter: ZTRAN -> "-40.8516675"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -40.797600  -21.273969  -40.851667
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.636138128"
Evaluating: 0.636138128*360.0
 Parameter: XPHI <- "229.009726"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.464657621"
Evaluating: 0.464657621*360.0
 Parameter: YPHI <- "167.276744"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.811881076"
Evaluating: 0.811881076*360.0
 Parameter: ZPHI <- "292.277187"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.7976002"
 Parameter: YPOS -> "-21.2739693"
 Parameter: ZPOS -> "-40.8516675"
 Parameter: XPHI -> "229.009726"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.655931   -0.754821
    0.000000    0.754821   -0.655931

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  130.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.7976002"
 Parameter: YPOS -> "-21.2739693"
 Parameter: ZPOS -> "-40.8516675"
 Parameter: YPHI -> "167.276744"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.975445    0.000000   -0.220242
    0.000000    1.000000    0.000000
    0.220242    0.000000   -0.975445

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  167.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.7976002"
 Parameter: YPOS -> "-21.2739693"
 Parameter: ZPOS -> "-40.8516675"
 Parameter: ZPHI -> "292.277187"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.379088   -0.925361    0.000000
    0.925361    0.379088    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   67.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.797600 XMAX =  -40.797600 XAVE =  -40.797600
    YMIN =  -21.273969 YMAX =  -21.273969 YAVE =  -21.273969
    ZMIN =  -40.851667 ZMAX =  -40.851667 ZAVE =  -40.851667
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.7976002"
Evaluating: -40.7976002+3.5
 Parameter: XMAX <- "-37.2976002"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.2739693"
Evaluating: -21.2739693+3.5
 Parameter: YMAX <- "-17.7739693"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.8516675"
Evaluating: -40.8516675+3.5
 Parameter: ZMAX <- "-37.3516675"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.7976002"
Evaluating: -40.7976002-3.5
 Parameter: XMIN <- "-44.2976002"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.2739693"
Evaluating: -21.2739693-3.5
 Parameter: YMIN <- "-24.7739693"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.8516675"
Evaluating: -40.8516675-3.5
 Parameter: ZMIN <- "-44.3516675"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.2976002"
 Parameter: XMIN -> "-44.2976002"
 Parameter: YMAX -> "-17.7739693"
 Parameter: YMIN -> "-24.7739693"
 Parameter: ZMAX -> "-37.3516675"
 Parameter: ZMIN -> "-44.3516675"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "35" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "35" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.627367842"
Evaluating: 81.6823114*(0.627367842-0.5)
 Parameter: XPOS <- "10.4036997"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.314671314"
Evaluating: 81.6823114*(0.314671314-0.5)
 Parameter: YPOS <- "-15.1380754"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.409922178"
Evaluating: 85*(0.409922178-0.5)+0
 Parameter: ZPOS <- "-7.65661487"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.65661487" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.65661487" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "35" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.867854419"
Evaluating: 81.6823114*(0.867854419-0.5)
 Parameter: XPOS <- "30.0471992"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "2.684311483E-02"
Evaluating: 81.6823114*(2.684311483E-02-0.5)
 Parameter: YPOS <- "-38.648548"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.519073398E-02"
Evaluating: 85*(3.519073398E-02-0.5)+0
 Parameter: ZPOS <- "-39.5087876"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.5087876" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.0471992"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.0471992-0
 Parameter: XTRAN <- "30.0471992"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.648548"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.648548-0
 Parameter: YTRAN <- "-38.648548"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.5087876"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.5087876-0
 Parameter: ZTRAN <- "-39.5087876"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.0471992"
 Parameter: YTRAN -> "-38.648548"
 Parameter: ZTRAN -> "-39.5087876"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    30.047199  -38.648548  -39.508788
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.472413697"
Evaluating: 0.472413697*360.0
 Parameter: XPHI <- "170.068931"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.495236916"
Evaluating: 0.495236916*360.0
 Parameter: YPHI <- "178.28529"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479143365"
Evaluating: 0.479143365*360.0
 Parameter: ZPHI <- "172.491611"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.0471992"
 Parameter: YPOS -> "-38.648548"
 Parameter: ZPOS -> "-39.5087876"
 Parameter: XPHI -> "170.068931"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.985016    0.172463
    0.000000   -0.172463   -0.985016

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  170.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.0471992"
 Parameter: YPOS -> "-38.648548"
 Parameter: ZPOS -> "-39.5087876"
 Parameter: YPHI -> "178.28529"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.999552    0.000000   -0.029923
    0.000000    1.000000    0.000000
    0.029923    0.000000   -0.999552

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.0471992"
 Parameter: YPOS -> "-38.648548"
 Parameter: ZPOS -> "-39.5087876"
 Parameter: ZPHI -> "172.491611"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.991426    0.130671    0.000000
   -0.130671   -0.991426    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  172.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.047199 XMAX =   30.047199 XAVE =   30.047199
    YMIN =  -38.648548 YMAX =  -38.648548 YAVE =  -38.648548
    ZMIN =  -39.508788 ZMAX =  -39.508788 ZAVE =  -39.508788
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.0471992"
Evaluating: 30.0471992+3.5
 Parameter: XMAX <- "33.5471992"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.648548"
Evaluating: -38.648548+3.5
 Parameter: YMAX <- "-35.148548"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.5087876"
Evaluating: -39.5087876+3.5
 Parameter: ZMAX <- "-36.0087876"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.0471992"
Evaluating: 30.0471992-3.5
 Parameter: XMIN <- "26.5471992"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.648548"
Evaluating: -38.648548-3.5
 Parameter: YMIN <- "-42.148548"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.5087876"
Evaluating: -39.5087876-3.5
 Parameter: ZMIN <- "-43.0087876"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.5471992"
 Parameter: XMIN -> "26.5471992"
 Parameter: YMAX -> "-35.148548"
 Parameter: YMIN -> "-42.148548"
 Parameter: ZMAX -> "-36.0087876"
 Parameter: ZMIN -> "-43.0087876"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "36" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "36" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.261590226"
Evaluating: 81.6823114*(0.261590226-0.5)
 Parameter: XPOS <- "-19.4738614"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.647136212"
Evaluating: 81.6823114*(0.647136212-0.5)
 Parameter: YPOS <- "12.0184259"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.813157616"
Evaluating: 85*(0.813157616-0.5)+0
 Parameter: ZPOS <- "26.6183974"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.6183974" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.6183974" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.4738614"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -19.4738614-0
 Parameter: XTRAN <- "-19.4738614"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.0184259"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.0184259-0
 Parameter: YTRAN <- "12.0184259"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.6183974"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.6183974-0
 Parameter: ZTRAN <- "26.6183974"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.4738614"
 Parameter: YTRAN -> "12.0184259"
 Parameter: ZTRAN -> "26.6183974"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -19.473861   12.018426   26.618397
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314705172"
Evaluating: 0.314705172*360.0
 Parameter: XPHI <- "113.293862"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.546778497"
Evaluating: 0.546778497*360.0
 Parameter: YPHI <- "196.840259"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.381539738"
Evaluating: 0.381539738*360.0
 Parameter: ZPHI <- "137.354306"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.4738614"
 Parameter: YPOS -> "12.0184259"
 Parameter: ZPOS -> "26.6183974"
 Parameter: XPHI -> "113.293862"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.395447    0.918489
    0.000000   -0.918489   -0.395447

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.4738614"
 Parameter: YPOS -> "12.0184259"
 Parameter: ZPOS -> "26.6183974"
 Parameter: YPHI -> "196.840259"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.957116    0.000000    0.289704
    0.000000    1.000000    0.000000
   -0.289704    0.000000   -0.957116

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  163.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.4738614"
 Parameter: YPOS -> "12.0184259"
 Parameter: ZPOS -> "26.6183974"
 Parameter: ZPHI -> "137.354306"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.735557    0.677463    0.000000
   -0.677463   -0.735557    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  137.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.473861 XMAX =  -19.473861 XAVE =  -19.473861
    YMIN =   12.018426 YMAX =   12.018426 YAVE =   12.018426
    ZMIN =   26.618397 ZMAX =   26.618397 ZAVE =   26.618397
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.4738614"
Evaluating: -19.4738614+3.5
 Parameter: XMAX <- "-15.9738614"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.0184259"
Evaluating: 12.0184259+3.5
 Parameter: YMAX <- "15.5184259"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.6183974"
Evaluating: 26.6183974+3.5
 Parameter: ZMAX <- "30.1183974"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.4738614"
Evaluating: -19.4738614-3.5
 Parameter: XMIN <- "-22.9738614"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.0184259"
Evaluating: 12.0184259-3.5
 Parameter: YMIN <- "8.5184259"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.6183974"
Evaluating: 26.6183974-3.5
 Parameter: ZMIN <- "23.1183974"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.9738614"
 Parameter: XMIN -> "-22.9738614"
 Parameter: YMAX -> "15.5184259"
 Parameter: YMIN -> "8.5184259"
 Parameter: ZMAX -> "30.1183974"
 Parameter: ZMIN -> "23.1183974"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "37" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "37" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.123983029"
Evaluating: 81.6823114*(0.123983029-0.5)
 Parameter: XPOS <- "-30.7139353"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.785190743"
Evaluating: 81.6823114*(0.785190743-0.5)
 Parameter: YPOS <- "23.2950391"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.159073103"
Evaluating: 85*(0.159073103-0.5)+0
 Parameter: ZPOS <- "-28.9787862"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.9787862" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.7139353"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.7139353-0
 Parameter: XTRAN <- "-30.7139353"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.2950391"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.2950391-0
 Parameter: YTRAN <- "23.2950391"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.9787862"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.9787862-0
 Parameter: ZTRAN <- "-28.9787862"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.7139353"
 Parameter: YTRAN -> "23.2950391"
 Parameter: ZTRAN -> "-28.9787862"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -30.713935   23.295039  -28.978786
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.692866418"
Evaluating: 0.692866418*360.0
 Parameter: XPHI <- "249.43191"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395609018"
Evaluating: 0.395609018*360.0
 Parameter: YPHI <- "142.419246"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.494230728"
Evaluating: 0.494230728*360.0
 Parameter: ZPHI <- "177.923062"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.7139353"
 Parameter: YPOS -> "23.2950391"
 Parameter: ZPOS -> "-28.9787862"
 Parameter: XPHI -> "249.43191"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.351320   -0.936255
    0.000000    0.936255   -0.351320

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  110.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.7139353"
 Parameter: YPOS -> "23.2950391"
 Parameter: ZPOS -> "-28.9787862"
 Parameter: YPHI -> "142.419246"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.792495    0.000000   -0.609879
    0.000000    1.000000    0.000000
    0.609879    0.000000   -0.792495

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.7139353"
 Parameter: YPOS -> "23.2950391"
 Parameter: ZPOS -> "-28.9787862"
 Parameter: ZPHI -> "177.923062"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.999343    0.036241    0.000000
   -0.036241   -0.999343    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  177.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.713935 XMAX =  -30.713935 XAVE =  -30.713935
    YMIN =   23.295039 YMAX =   23.295039 YAVE =   23.295039
    ZMIN =  -28.978786 ZMAX =  -28.978786 ZAVE =  -28.978786
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.7139353"
Evaluating: -30.7139353+3.5
 Parameter: XMAX <- "-27.2139353"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.2950391"
Evaluating: 23.2950391+3.5
 Parameter: YMAX <- "26.7950391"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.9787862"
Evaluating: -28.9787862+3.5
 Parameter: ZMAX <- "-25.4787862"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.7139353"
Evaluating: -30.7139353-3.5
 Parameter: XMIN <- "-34.2139353"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.2950391"
Evaluating: 23.2950391-3.5
 Parameter: YMIN <- "19.7950391"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.9787862"
Evaluating: -28.9787862-3.5
 Parameter: ZMIN <- "-32.4787862"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.2139353"
 Parameter: XMIN -> "-34.2139353"
 Parameter: YMAX -> "26.7950391"
 Parameter: YMIN -> "19.7950391"
 Parameter: ZMAX -> "-25.4787862"
 Parameter: ZMIN -> "-32.4787862"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "38" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "38" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.560509532"
Evaluating: 81.6823114*(0.560509532-0.5)
 Parameter: XPOS <- "4.94255844"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.930495"
Evaluating: 81.6823114*(0.930495-0.5)
 Parameter: YPOS <- "35.1638266"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "8.93290856E-02"
Evaluating: 85*(8.93290856E-02-0.5)+0
 Parameter: ZPOS <- "-34.9070277"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.9070277" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.94255844"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.94255844-0
 Parameter: XTRAN <- "4.94255844"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.1638266"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.1638266-0
 Parameter: YTRAN <- "35.1638266"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.9070277"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.9070277-0
 Parameter: ZTRAN <- "-34.9070277"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.94255844"
 Parameter: YTRAN -> "35.1638266"
 Parameter: ZTRAN -> "-34.9070277"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     4.942558   35.163827  -34.907028
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.531734684"
Evaluating: 0.531734684*360.0
 Parameter: XPHI <- "191.424486"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.923704102"
Evaluating: 0.923704102*360.0
 Parameter: YPHI <- "332.533477"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661774059"
Evaluating: 0.661774059*360.0
 Parameter: ZPHI <- "238.238661"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.94255844"
 Parameter: YPOS -> "35.1638266"
 Parameter: ZPOS -> "-34.9070277"
 Parameter: XPHI -> "191.424486"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.980187   -0.198076
    0.000000    0.198076   -0.980187

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.94255844"
 Parameter: YPOS -> "35.1638266"
 Parameter: ZPOS -> "-34.9070277"
 Parameter: YPHI -> "332.533477"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.887280    0.000000    0.461230
    0.000000    1.000000    0.000000
   -0.461230    0.000000    0.887280

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   27.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.94255844"
 Parameter: YPOS -> "35.1638266"
 Parameter: ZPOS -> "-34.9070277"
 Parameter: ZPHI -> "238.238661"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.526382   -0.850248    0.000000
    0.850248   -0.526382    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.942558 XMAX =    4.942558 XAVE =    4.942558
    YMIN =   35.163827 YMAX =   35.163827 YAVE =   35.163827
    ZMIN =  -34.907028 ZMAX =  -34.907028 ZAVE =  -34.907028
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.94255844"
Evaluating: 4.94255844+3.5
 Parameter: XMAX <- "8.44255844"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.1638266"
Evaluating: 35.1638266+3.5
 Parameter: YMAX <- "38.6638266"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.9070277"
Evaluating: -34.9070277+3.5
 Parameter: ZMAX <- "-31.4070277"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.94255844"
Evaluating: 4.94255844-3.5
 Parameter: XMIN <- "1.44255844"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.1638266"
Evaluating: 35.1638266-3.5
 Parameter: YMIN <- "31.6638266"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.9070277"
Evaluating: -34.9070277-3.5
 Parameter: ZMIN <- "-38.4070277"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.44255844"
 Parameter: XMIN -> "1.44255844"
 Parameter: YMAX -> "38.6638266"
 Parameter: YMIN -> "31.6638266"
 Parameter: ZMAX -> "-31.4070277"
 Parameter: ZMIN -> "-38.4070277"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "39" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "39" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.887009438"
Evaluating: 81.6823114*(0.887009438-0.5)
 Parameter: XPOS <- "31.6118254"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.966448732"
Evaluating: 81.6823114*(0.966448732-0.5)
 Parameter: YPOS <- "38.1006106"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.540931607E-02"
Evaluating: 85*(4.540931607E-02-0.5)+0
 Parameter: ZPOS <- "-38.6402081"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.6402081" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.6118254"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.6118254-0
 Parameter: XTRAN <- "31.6118254"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.1006106"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.1006106-0
 Parameter: YTRAN <- "38.1006106"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.6402081"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.6402081-0
 Parameter: ZTRAN <- "-38.6402081"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.6118254"
 Parameter: YTRAN -> "38.1006106"
 Parameter: ZTRAN -> "-38.6402081"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    31.611825   38.100611  -38.640208
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355577977"
Evaluating: 0.355577977*360.0
 Parameter: XPHI <- "128.008072"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.21714796"
Evaluating: 0.21714796*360.0
 Parameter: YPHI <- "78.1732656"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.334792243"
Evaluating: 0.334792243*360.0
 Parameter: ZPHI <- "120.525207"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.6118254"
 Parameter: YPOS -> "38.1006106"
 Parameter: ZPOS -> "-38.6402081"
 Parameter: XPHI -> "128.008072"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.615772    0.787924
    0.000000   -0.787924   -0.615772

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  128.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.6118254"
 Parameter: YPOS -> "38.1006106"
 Parameter: ZPOS -> "-38.6402081"
 Parameter: YPHI -> "78.1732656"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.204953    0.000000   -0.978772
    0.000000    1.000000    0.000000
    0.978772    0.000000    0.204953

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   78.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.6118254"
 Parameter: YPOS -> "38.1006106"
 Parameter: ZPOS -> "-38.6402081"
 Parameter: ZPHI -> "120.525207"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.507917    0.861406    0.000000
   -0.861406   -0.507917    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.611825 XMAX =   31.611825 XAVE =   31.611825
    YMIN =   38.100611 YMAX =   38.100611 YAVE =   38.100611
    ZMIN =  -38.640208 ZMAX =  -38.640208 ZAVE =  -38.640208
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.6118254"
Evaluating: 31.6118254+3.5
 Parameter: XMAX <- "35.1118254"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.1006106"
Evaluating: 38.1006106+3.5
 Parameter: YMAX <- "41.6006106"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.6402081"
Evaluating: -38.6402081+3.5
 Parameter: ZMAX <- "-35.1402081"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.6118254"
Evaluating: 31.6118254-3.5
 Parameter: XMIN <- "28.1118254"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.1006106"
Evaluating: 38.1006106-3.5
 Parameter: YMIN <- "34.6006106"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.6402081"
Evaluating: -38.6402081-3.5
 Parameter: ZMIN <- "-42.1402081"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.1118254"
 Parameter: XMIN -> "28.1118254"
 Parameter: YMAX -> "41.6006106"
 Parameter: YMIN -> "34.6006106"
 Parameter: ZMAX -> "-35.1402081"
 Parameter: ZMIN -> "-42.1402081"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "40" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "40" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "9.748746376E-02"
Evaluating: 81.6823114*(9.748746376E-02-0.5)
 Parameter: XPOS <- "-32.8781543"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.878152826"
Evaluating: 81.6823114*(0.878152826-0.5)
 Parameter: YPOS <- "30.8883969"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.757566903"
Evaluating: 85*(0.757566903-0.5)+0
 Parameter: ZPOS <- "21.8931868"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.8931868" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.8931868" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.8781543"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.8781543-0
 Parameter: XTRAN <- "-32.8781543"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.8883969"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.8883969-0
 Parameter: YTRAN <- "30.8883969"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.8931868"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.8931868-0
 Parameter: ZTRAN <- "21.8931868"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.8781543"
 Parameter: YTRAN -> "30.8883969"
 Parameter: ZTRAN -> "21.8931868"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -32.878154   30.888397   21.893187
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.163527014E-02"
Evaluating: 1.163527014E-02*360.0
 Parameter: XPHI <- "4.18869725"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.652904701E-02"
Evaluating: 8.652904701E-02*360.0
 Parameter: YPHI <- "31.1504569"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.863927748"
Evaluating: 0.863927748*360.0
 Parameter: ZPHI <- "311.013989"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.8781543"
 Parameter: YPOS -> "30.8883969"
 Parameter: ZPOS -> "21.8931868"
 Parameter: XPHI -> "4.18869725"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997329    0.073041
    0.000000   -0.073041    0.997329

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    4.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.8781543"
 Parameter: YPOS -> "30.8883969"
 Parameter: ZPOS -> "21.8931868"
 Parameter: YPHI -> "31.1504569"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.855812    0.000000   -0.517287
    0.000000    1.000000    0.000000
    0.517287    0.000000    0.855812

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.8781543"
 Parameter: YPOS -> "30.8883969"
 Parameter: ZPOS -> "21.8931868"
 Parameter: ZPHI -> "311.013989"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.656243   -0.754549    0.000000
    0.754549    0.656243    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.878154 XMAX =  -32.878154 XAVE =  -32.878154
    YMIN =   30.888397 YMAX =   30.888397 YAVE =   30.888397
    ZMIN =   21.893187 ZMAX =   21.893187 ZAVE =   21.893187
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.8781543"
Evaluating: -32.8781543+3.5
 Parameter: XMAX <- "-29.3781543"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.8883969"
Evaluating: 30.8883969+3.5
 Parameter: YMAX <- "34.3883969"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.8931868"
Evaluating: 21.8931868+3.5
 Parameter: ZMAX <- "25.3931868"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.8781543"
Evaluating: -32.8781543-3.5
 Parameter: XMIN <- "-36.3781543"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.8883969"
Evaluating: 30.8883969-3.5
 Parameter: YMIN <- "27.3883969"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.8931868"
Evaluating: 21.8931868-3.5
 Parameter: ZMIN <- "18.3931868"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.3781543"
 Parameter: XMIN -> "-36.3781543"
 Parameter: YMAX -> "34.3883969"
 Parameter: YMIN -> "27.3883969"
 Parameter: ZMAX -> "25.3931868"
 Parameter: ZMIN -> "18.3931868"
 SELRPN>     23 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      8 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26560 POS      POT      40       POT     -**** MEMB     POPC     90       N             2.1335
26560 POS      POT      40       POT     -**** MEMB     POPC     90       C12           2.1938
26560 POS      POT      40       POT     -**** MEMB     POPC     90       C13           2.9982
26560 POS      POT      40       POT     -**** MEMB     POPC     90       C14           3.3360
26560 POS      POT      40       POT     -**** MEMB     POPC     90       C15           1.3874
26560 POS      POT      40       POT     -**** MEMB     POPC     90       C11           3.7265
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "40" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "9.243634669E-02"
Evaluating: 81.6823114*(9.243634669E-02-0.5)
 Parameter: XPOS <- "-33.2907412"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.907732143"
Evaluating: 81.6823114*(0.907732143-0.5)
 Parameter: YPOS <- "33.3045039"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "1.051158578E-02"
Evaluating: 85*(1.051158578E-02-0.5)+0
 Parameter: ZPOS <- "-41.6065152"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.6065152" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.878154 XMAX =  -32.878154 XAVE =  -32.878154
    YMIN =   30.888397 YMAX =   30.888397 YAVE =   30.888397
    ZMIN =   21.893187 ZMAX =   21.893187 ZAVE =   21.893187
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.2907412"
 RDCMND substituted energy or value "?XAVE" to "-32.8781543"
Evaluating: -33.2907412--32.8781543
 Parameter: XTRAN <- "-0.4125869"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.3045039"
 RDCMND substituted energy or value "?YAVE" to "30.8883969"
Evaluating: 33.3045039-30.8883969
 Parameter: YTRAN <- "2.416107"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.6065152"
 RDCMND substituted energy or value "?ZAVE" to "21.8931868"
Evaluating: -41.6065152-21.8931868
 Parameter: ZTRAN <- "-63.499702"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.4125869"
 Parameter: YTRAN -> "2.416107"
 Parameter: ZTRAN -> "-63.499702"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -0.412587    2.416107  -63.499702
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.232476742"
Evaluating: 0.232476742*360.0
 Parameter: XPHI <- "83.6916271"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.783410979"
Evaluating: 0.783410979*360.0
 Parameter: YPHI <- "282.027952"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.70826252"
Evaluating: 0.70826252*360.0
 Parameter: ZPHI <- "254.974507"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.2907412"
 Parameter: YPOS -> "33.3045039"
 Parameter: ZPOS -> "-41.6065152"
 Parameter: XPHI -> "83.6916271"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.109880    0.993945
    0.000000   -0.993945    0.109880

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   83.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.2907412"
 Parameter: YPOS -> "33.3045039"
 Parameter: ZPOS -> "-41.6065152"
 Parameter: YPHI -> "282.027952"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.208389    0.000000    0.978046
    0.000000    1.000000    0.000000
   -0.978046    0.000000    0.208389

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   77.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.2907412"
 Parameter: YPOS -> "33.3045039"
 Parameter: ZPOS -> "-41.6065152"
 Parameter: ZPHI -> "254.974507"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.259249   -0.965811    0.000000
    0.965811   -0.259249    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  105.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.290741 XMAX =  -33.290741 XAVE =  -33.290741
    YMIN =   33.304504 YMAX =   33.304504 YAVE =   33.304504
    ZMIN =  -41.606515 ZMAX =  -41.606515 ZAVE =  -41.606515
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.2907412"
Evaluating: -33.2907412+3.5
 Parameter: XMAX <- "-29.7907412"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.3045039"
Evaluating: 33.3045039+3.5
 Parameter: YMAX <- "36.8045039"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.6065152"
Evaluating: -41.6065152+3.5
 Parameter: ZMAX <- "-38.1065152"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.2907412"
Evaluating: -33.2907412-3.5
 Parameter: XMIN <- "-36.7907412"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.3045039"
Evaluating: 33.3045039-3.5
 Parameter: YMIN <- "29.8045039"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.6065152"
Evaluating: -41.6065152-3.5
 Parameter: ZMIN <- "-45.1065152"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.7907412"
 Parameter: XMIN -> "-36.7907412"
 Parameter: YMAX -> "36.8045039"
 Parameter: YMIN -> "29.8045039"
 Parameter: ZMAX -> "-38.1065152"
 Parameter: ZMIN -> "-45.1065152"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "41" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "41" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.598244841"
Evaluating: 81.6823114*(0.598244841-0.5)
 Parameter: XPOS <- "8.0248657"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.987718196"
Evaluating: 81.6823114*(0.987718196-0.5)
 Parameter: YPOS <- "39.8379496"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.371456706E-02"
Evaluating: 85*(2.371456706E-02-0.5)+0
 Parameter: ZPOS <- "-40.4842618"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.4842618" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.0248657"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.0248657-0
 Parameter: XTRAN <- "8.0248657"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.8379496"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 39.8379496-0
 Parameter: YTRAN <- "39.8379496"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.4842618"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.4842618-0
 Parameter: ZTRAN <- "-40.4842618"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.0248657"
 Parameter: YTRAN -> "39.8379496"
 Parameter: ZTRAN -> "-40.4842618"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     8.024866   39.837950  -40.484262
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392546111"
Evaluating: 0.392546111*360.0
 Parameter: XPHI <- "141.3166"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.945951703"
Evaluating: 0.945951703*360.0
 Parameter: YPHI <- "340.542613"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.704245483"
Evaluating: 0.704245483*360.0
 Parameter: ZPHI <- "253.528374"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.0248657"
 Parameter: YPOS -> "39.8379496"
 Parameter: ZPOS -> "-40.4842618"
 Parameter: XPHI -> "141.3166"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.780612    0.625017
    0.000000   -0.625017   -0.780612

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.0248657"
 Parameter: YPOS -> "39.8379496"
 Parameter: ZPOS -> "-40.4842618"
 Parameter: YPHI -> "340.542613"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.942889    0.000000    0.333106
    0.000000    1.000000    0.000000
   -0.333106    0.000000    0.942889

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   19.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.0248657"
 Parameter: YPOS -> "39.8379496"
 Parameter: ZPOS -> "-40.4842618"
 Parameter: ZPHI -> "253.528374"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.283540   -0.958960    0.000000
    0.958960   -0.283540    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  106.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.024866 XMAX =    8.024866 XAVE =    8.024866
    YMIN =   39.837950 YMAX =   39.837950 YAVE =   39.837950
    ZMIN =  -40.484262 ZMAX =  -40.484262 ZAVE =  -40.484262
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.0248657"
Evaluating: 8.0248657+3.5
 Parameter: XMAX <- "11.5248657"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.8379496"
Evaluating: 39.8379496+3.5
 Parameter: YMAX <- "43.3379496"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.4842618"
Evaluating: -40.4842618+3.5
 Parameter: ZMAX <- "-36.9842618"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.0248657"
Evaluating: 8.0248657-3.5
 Parameter: XMIN <- "4.5248657"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.8379496"
Evaluating: 39.8379496-3.5
 Parameter: YMIN <- "36.3379496"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.4842618"
Evaluating: -40.4842618-3.5
 Parameter: ZMIN <- "-43.9842618"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.5248657"
 Parameter: XMIN -> "4.5248657"
 Parameter: YMAX -> "43.3379496"
 Parameter: YMIN -> "36.3379496"
 Parameter: ZMAX -> "-36.9842618"
 Parameter: ZMIN -> "-43.9842618"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "42" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "42" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.894603843"
Evaluating: 81.6823114*(0.894603843-0.5)
 Parameter: XPOS <- "32.232154"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "7.29280549E-02"
Evaluating: 81.6823114*(7.29280549E-02-0.5)
 Parameter: YPOS <- "-34.8842236"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.560692824"
Evaluating: 85*(0.560692824-0.5)+0
 Parameter: ZPOS <- "5.15889004"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.15889004" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.15889004" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "42" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.823709172"
Evaluating: 81.6823114*(0.823709172-0.5)
 Parameter: XPOS <- "26.4413134"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.136418227"
Evaluating: 81.6823114*(0.136418227-0.5)
 Parameter: YPOS <- "-29.6981996"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.496543478"
Evaluating: 85*(0.496543478-0.5)+0
 Parameter: ZPOS <- "-0.29380437"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.29380437" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.29380437" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "42" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.36240889"
Evaluating: 81.6823114*(0.36240889-0.5)
 Parameter: XPOS <- "-11.2387599"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.530516843"
Evaluating: 81.6823114*(0.530516843-0.5)
 Parameter: YPOS <- "2.49268627"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.112841916"
Evaluating: 85*(0.112841916-0.5)+0
 Parameter: ZPOS <- "-32.9084371"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.9084371" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.2387599"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.2387599-0
 Parameter: XTRAN <- "-11.2387599"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.49268627"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.49268627-0
 Parameter: YTRAN <- "2.49268627"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.9084371"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.9084371-0
 Parameter: ZTRAN <- "-32.9084371"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.2387599"
 Parameter: YTRAN -> "2.49268627"
 Parameter: ZTRAN -> "-32.9084371"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -11.238760    2.492686  -32.908437
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.439293814"
Evaluating: 0.439293814*360.0
 Parameter: XPHI <- "158.145773"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.677801117E-03"
Evaluating: 8.677801117E-03*360.0
 Parameter: YPHI <- "3.1240084"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.342658941"
Evaluating: 0.342658941*360.0
 Parameter: ZPHI <- "123.357219"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.2387599"
 Parameter: YPOS -> "2.49268627"
 Parameter: ZPOS -> "-32.9084371"
 Parameter: XPHI -> "158.145773"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.928134    0.372246
    0.000000   -0.372246   -0.928134

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  158.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.2387599"
 Parameter: YPOS -> "2.49268627"
 Parameter: ZPOS -> "-32.9084371"
 Parameter: YPHI -> "3.1240084"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.998514    0.000000   -0.054497
    0.000000    1.000000    0.000000
    0.054497    0.000000    0.998514

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    3.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.2387599"
 Parameter: YPOS -> "2.49268627"
 Parameter: ZPOS -> "-32.9084371"
 Parameter: ZPHI -> "123.357219"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.549857    0.835259    0.000000
   -0.835259   -0.549857    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.238760 XMAX =  -11.238760 XAVE =  -11.238760
    YMIN =    2.492686 YMAX =    2.492686 YAVE =    2.492686
    ZMIN =  -32.908437 ZMAX =  -32.908437 ZAVE =  -32.908437
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.2387599"
Evaluating: -11.2387599+3.5
 Parameter: XMAX <- "-7.7387599"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.49268627"
Evaluating: 2.49268627+3.5
 Parameter: YMAX <- "5.99268627"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.9084371"
Evaluating: -32.9084371+3.5
 Parameter: ZMAX <- "-29.4084371"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.2387599"
Evaluating: -11.2387599-3.5
 Parameter: XMIN <- "-14.7387599"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.49268627"
Evaluating: 2.49268627-3.5
 Parameter: YMIN <- "-1.00731373"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.9084371"
Evaluating: -32.9084371-3.5
 Parameter: ZMIN <- "-36.4084371"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.7387599"
 Parameter: XMIN -> "-14.7387599"
 Parameter: YMAX -> "5.99268627"
 Parameter: YMIN -> "-1.00731373"
 Parameter: ZMAX -> "-29.4084371"
 Parameter: ZMIN -> "-36.4084371"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "43" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "43" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.62962825"
Evaluating: 81.6823114*(0.62962825-0.5)
 Parameter: XPOS <- "10.5883351"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.993173648"
Evaluating: 81.6823114*(0.993173648-0.5)
 Parameter: YPOS <- "40.2835635"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.246359997"
Evaluating: 85*(0.246359997-0.5)+0
 Parameter: ZPOS <- "-21.5594003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.5594003" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.5883351"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.5883351-0
 Parameter: XTRAN <- "10.5883351"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.2835635"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 40.2835635-0
 Parameter: YTRAN <- "40.2835635"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.5594003"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.5594003-0
 Parameter: ZTRAN <- "-21.5594003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.5883351"
 Parameter: YTRAN -> "40.2835635"
 Parameter: ZTRAN -> "-21.5594003"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    10.588335   40.283563  -21.559400
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.930192161"
Evaluating: 0.930192161*360.0
 Parameter: XPHI <- "334.869178"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.742246508"
Evaluating: 0.742246508*360.0
 Parameter: YPHI <- "267.208743"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.40767608"
Evaluating: 0.40767608*360.0
 Parameter: ZPHI <- "146.763389"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.5883351"
 Parameter: YPOS -> "40.2835635"
 Parameter: ZPOS -> "-21.5594003"
 Parameter: XPHI -> "334.869178"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.905340   -0.424687
    0.000000    0.424687    0.905340

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   25.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.5883351"
 Parameter: YPOS -> "40.2835635"
 Parameter: ZPOS -> "-21.5594003"
 Parameter: YPHI -> "267.208743"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.048697    0.000000    0.998814
    0.000000    1.000000    0.000000
   -0.998814    0.000000   -0.048697

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   92.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.5883351"
 Parameter: YPOS -> "40.2835635"
 Parameter: ZPOS -> "-21.5594003"
 Parameter: ZPHI -> "146.763389"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.836414    0.548098    0.000000
   -0.548098   -0.836414    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.588335 XMAX =   10.588335 XAVE =   10.588335
    YMIN =   40.283563 YMAX =   40.283563 YAVE =   40.283563
    ZMIN =  -21.559400 ZMAX =  -21.559400 ZAVE =  -21.559400
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.5883351"
Evaluating: 10.5883351+3.5
 Parameter: XMAX <- "14.0883351"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.2835635"
Evaluating: 40.2835635+3.5
 Parameter: YMAX <- "43.7835635"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.5594003"
Evaluating: -21.5594003+3.5
 Parameter: ZMAX <- "-18.0594003"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.5883351"
Evaluating: 10.5883351-3.5
 Parameter: XMIN <- "7.0883351"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.2835635"
Evaluating: 40.2835635-3.5
 Parameter: YMIN <- "36.7835635"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.5594003"
Evaluating: -21.5594003-3.5
 Parameter: ZMIN <- "-25.0594003"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.0883351"
 Parameter: XMIN -> "7.0883351"
 Parameter: YMAX -> "43.7835635"
 Parameter: YMIN -> "36.7835635"
 Parameter: ZMAX -> "-18.0594003"
 Parameter: ZMIN -> "-25.0594003"
 SELRPN>      5 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "44" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "44" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.905240776"
Evaluating: 81.6823114*(0.905240776-0.5)
 Parameter: XPOS <- "33.1010033"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.971543727"
Evaluating: 81.6823114*(0.971543727-0.5)
 Parameter: YPOS <- "38.5167815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.44316686E-02"
Evaluating: 85*(4.44316686E-02-0.5)+0
 Parameter: ZPOS <- "-38.7233082"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.7233082" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.1010033"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.1010033-0
 Parameter: XTRAN <- "33.1010033"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.5167815"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.5167815-0
 Parameter: YTRAN <- "38.5167815"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.7233082"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.7233082-0
 Parameter: ZTRAN <- "-38.7233082"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.1010033"
 Parameter: YTRAN -> "38.5167815"
 Parameter: ZTRAN -> "-38.7233082"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    33.101003   38.516782  -38.723308
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.934274744"
Evaluating: 0.934274744*360.0
 Parameter: XPHI <- "336.338908"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.469109168"
Evaluating: 0.469109168*360.0
 Parameter: YPHI <- "168.8793"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.809868285"
Evaluating: 0.809868285*360.0
 Parameter: ZPHI <- "291.552583"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.1010033"
 Parameter: YPOS -> "38.5167815"
 Parameter: ZPOS -> "-38.7233082"
 Parameter: XPHI -> "336.338908"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.915935   -0.401326
    0.000000    0.401326    0.915935

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.1010033"
 Parameter: YPOS -> "38.5167815"
 Parameter: ZPOS -> "-38.7233082"
 Parameter: YPHI -> "168.8793"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.981223    0.000000   -0.192876
    0.000000    1.000000    0.000000
    0.192876    0.000000   -0.981223

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  168.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.1010033"
 Parameter: YPOS -> "38.5167815"
 Parameter: ZPOS -> "-38.7233082"
 Parameter: ZPHI -> "291.552583"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.367355   -0.930081    0.000000
    0.930081    0.367355    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.101003 XMAX =   33.101003 XAVE =   33.101003
    YMIN =   38.516782 YMAX =   38.516782 YAVE =   38.516782
    ZMIN =  -38.723308 ZMAX =  -38.723308 ZAVE =  -38.723308
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.1010033"
Evaluating: 33.1010033+3.5
 Parameter: XMAX <- "36.6010033"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.5167815"
Evaluating: 38.5167815+3.5
 Parameter: YMAX <- "42.0167815"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.7233082"
Evaluating: -38.7233082+3.5
 Parameter: ZMAX <- "-35.2233082"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.1010033"
Evaluating: 33.1010033-3.5
 Parameter: XMIN <- "29.6010033"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.5167815"
Evaluating: 38.5167815-3.5
 Parameter: YMIN <- "35.0167815"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.7233082"
Evaluating: -38.7233082-3.5
 Parameter: ZMIN <- "-42.2233082"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.6010033"
 Parameter: XMIN -> "29.6010033"
 Parameter: YMAX -> "42.0167815"
 Parameter: YMIN -> "35.0167815"
 Parameter: ZMAX -> "-35.2233082"
 Parameter: ZMIN -> "-42.2233082"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      1 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26564 POS      POT      44       POT     -**** POS      POT      39       POT           1.5485
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "44" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.262921881"
Evaluating: 81.6823114*(0.262921881-0.5)
 Parameter: XPOS <- "-19.3650887"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.550558822"
Evaluating: 81.6823114*(0.550558822-0.5)
 Parameter: YPOS <- "4.12976144"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.138897973"
Evaluating: 85*(0.138897973-0.5)+0
 Parameter: ZPOS <- "-30.6936723"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.6936723" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.101003 XMAX =   33.101003 XAVE =   33.101003
    YMIN =   38.516782 YMAX =   38.516782 YAVE =   38.516782
    ZMIN =  -38.723308 ZMAX =  -38.723308 ZAVE =  -38.723308
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.3650887"
 RDCMND substituted energy or value "?XAVE" to "33.1010033"
Evaluating: -19.3650887-33.1010033
 Parameter: XTRAN <- "-52.466092"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.12976144"
 RDCMND substituted energy or value "?YAVE" to "38.5167815"
Evaluating: 4.12976144-38.5167815
 Parameter: YTRAN <- "-34.3870201"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.6936723"
 RDCMND substituted energy or value "?ZAVE" to "-38.7233082"
Evaluating: -30.6936723--38.7233082
 Parameter: ZTRAN <- "8.0296359"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.466092"
 Parameter: YTRAN -> "-34.3870201"
 Parameter: ZTRAN -> "8.0296359"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -52.466092  -34.387020    8.029636
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.233353819"
Evaluating: 0.233353819*360.0
 Parameter: XPHI <- "84.0073748"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71238941"
Evaluating: 0.71238941*360.0
 Parameter: YPHI <- "256.460188"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.428309502"
Evaluating: 0.428309502*360.0
 Parameter: ZPHI <- "154.191421"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.3650887"
 Parameter: YPOS -> "4.12976144"
 Parameter: ZPOS -> "-30.6936723"
 Parameter: XPHI -> "84.0073748"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.104400    0.994535
    0.000000   -0.994535    0.104400

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   84.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.3650887"
 Parameter: YPOS -> "4.12976144"
 Parameter: ZPOS -> "-30.6936723"
 Parameter: YPHI -> "256.460188"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.234121    0.000000    0.972207
    0.000000    1.000000    0.000000
   -0.972207    0.000000   -0.234121

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  103.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.3650887"
 Parameter: YPOS -> "4.12976144"
 Parameter: ZPOS -> "-30.6936723"
 Parameter: ZPHI -> "154.191421"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.900254    0.435366    0.000000
   -0.435366   -0.900254    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.365089 XMAX =  -19.365089 XAVE =  -19.365089
    YMIN =    4.129761 YMAX =    4.129761 YAVE =    4.129761
    ZMIN =  -30.693672 ZMAX =  -30.693672 ZAVE =  -30.693672
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.3650887"
Evaluating: -19.3650887+3.5
 Parameter: XMAX <- "-15.8650887"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.12976143"
Evaluating: 4.12976143+3.5
 Parameter: YMAX <- "7.62976143"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.6936723"
Evaluating: -30.6936723+3.5
 Parameter: ZMAX <- "-27.1936723"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.3650887"
Evaluating: -19.3650887-3.5
 Parameter: XMIN <- "-22.8650887"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.12976143"
Evaluating: 4.12976143-3.5
 Parameter: YMIN <- "0.62976143"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.6936723"
Evaluating: -30.6936723-3.5
 Parameter: ZMIN <- "-34.1936723"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.8650887"
 Parameter: XMIN -> "-22.8650887"
 Parameter: YMAX -> "7.62976143"
 Parameter: YMIN -> "0.62976143"
 Parameter: ZMAX -> "-27.1936723"
 Parameter: ZMIN -> "-34.1936723"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "45" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "45" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.138793192"
Evaluating: 81.6823114*(0.138793192-0.5)
 Parameter: XPOS <- "-29.504207"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.141490782"
Evaluating: 81.6823114*(0.141490782-0.5)
 Parameter: YPOS <- "-29.2838616"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.848592717"
Evaluating: 85*(0.848592717-0.5)+0
 Parameter: ZPOS <- "29.6303809"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.6303809" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.6303809" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.504207"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.504207-0
 Parameter: XTRAN <- "-29.504207"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.2838616"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -29.2838616-0
 Parameter: YTRAN <- "-29.2838616"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.6303809"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.6303809-0
 Parameter: ZTRAN <- "29.6303809"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.504207"
 Parameter: YTRAN -> "-29.2838616"
 Parameter: ZTRAN -> "29.6303809"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -29.504207  -29.283862   29.630381
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.475326826"
Evaluating: 0.475326826*360.0
 Parameter: XPHI <- "171.117657"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.783136528"
Evaluating: 0.783136528*360.0
 Parameter: YPHI <- "281.92915"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396863495"
Evaluating: 0.396863495*360.0
 Parameter: ZPHI <- "142.870858"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.504207"
 Parameter: YPOS -> "-29.2838616"
 Parameter: ZPOS -> "29.6303809"
 Parameter: XPHI -> "171.117657"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.988007    0.154406
    0.000000   -0.154406   -0.988007

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  171.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.504207"
 Parameter: YPOS -> "-29.2838616"
 Parameter: ZPOS -> "29.6303809"
 Parameter: YPHI -> "281.92915"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.206702    0.000000    0.978404
    0.000000    1.000000    0.000000
   -0.978404    0.000000    0.206702

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   78.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.504207"
 Parameter: YPOS -> "-29.2838616"
 Parameter: ZPOS -> "29.6303809"
 Parameter: ZPHI -> "142.870858"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.797277    0.603614    0.000000
   -0.603614   -0.797277    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.504207 XMAX =  -29.504207 XAVE =  -29.504207
    YMIN =  -29.283862 YMAX =  -29.283862 YAVE =  -29.283862
    ZMIN =   29.630381 ZMAX =   29.630381 ZAVE =   29.630381
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.504207"
Evaluating: -29.504207+3.5
 Parameter: XMAX <- "-26.004207"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.2838616"
Evaluating: -29.2838616+3.5
 Parameter: YMAX <- "-25.7838616"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.6303809"
Evaluating: 29.6303809+3.5
 Parameter: ZMAX <- "33.1303809"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.504207"
Evaluating: -29.504207-3.5
 Parameter: XMIN <- "-33.004207"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.2838616"
Evaluating: -29.2838616-3.5
 Parameter: YMIN <- "-32.7838616"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.6303809"
Evaluating: 29.6303809-3.5
 Parameter: ZMIN <- "26.1303809"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.004207"
 Parameter: XMIN -> "-33.004207"
 Parameter: YMAX -> "-25.7838616"
 Parameter: YMIN -> "-32.7838616"
 Parameter: ZMAX -> "33.1303809"
 Parameter: ZMIN -> "26.1303809"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "46" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "46" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.992815925"
Evaluating: 81.6823114*(0.992815925-0.5)
 Parameter: XPOS <- "40.2543438"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.858149076"
Evaluating: 81.6823114*(0.858149076-0.5)
 Parameter: YPOS <- "29.2544444"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.102596356"
Evaluating: 85*(0.102596356-0.5)+0
 Parameter: ZPOS <- "-33.7793097"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.7793097" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.2543438"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.2543438-0
 Parameter: XTRAN <- "40.2543438"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.2544444"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.2544444-0
 Parameter: YTRAN <- "29.2544444"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.7793097"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.7793097-0
 Parameter: ZTRAN <- "-33.7793097"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.2543438"
 Parameter: YTRAN -> "29.2544444"
 Parameter: ZTRAN -> "-33.7793097"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    40.254344   29.254444  -33.779310
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.886712616"
Evaluating: 0.886712616*360.0
 Parameter: XPHI <- "319.216542"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.933788554"
Evaluating: 0.933788554*360.0
 Parameter: YPHI <- "336.163879"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.275291597E-02"
Evaluating: 4.275291597E-02*360.0
 Parameter: ZPHI <- "15.3910497"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.2543438"
 Parameter: YPOS -> "29.2544444"
 Parameter: ZPOS -> "-33.7793097"
 Parameter: XPHI -> "319.216542"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.757184   -0.653202
    0.000000    0.653202    0.757184

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   40.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.2543438"
 Parameter: YPOS -> "29.2544444"
 Parameter: ZPOS -> "-33.7793097"
 Parameter: YPHI -> "336.163879"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.914705    0.000000    0.404122
    0.000000    1.000000    0.000000
   -0.404122    0.000000    0.914705

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   23.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.2543438"
 Parameter: YPOS -> "29.2544444"
 Parameter: ZPOS -> "-33.7793097"
 Parameter: ZPHI -> "15.3910497"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.964137    0.265406    0.000000
   -0.265406    0.964137    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   15.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.254344 XMAX =   40.254344 XAVE =   40.254344
    YMIN =   29.254444 YMAX =   29.254444 YAVE =   29.254444
    ZMIN =  -33.779310 ZMAX =  -33.779310 ZAVE =  -33.779310
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.2543438"
Evaluating: 40.2543438+3.5
 Parameter: XMAX <- "43.7543438"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.2544444"
Evaluating: 29.2544444+3.5
 Parameter: YMAX <- "32.7544444"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.7793097"
Evaluating: -33.7793097+3.5
 Parameter: ZMAX <- "-30.2793097"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.2543438"
Evaluating: 40.2543438-3.5
 Parameter: XMIN <- "36.7543438"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.2544444"
Evaluating: 29.2544444-3.5
 Parameter: YMIN <- "25.7544444"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.7793097"
Evaluating: -33.7793097-3.5
 Parameter: ZMIN <- "-37.2793097"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.7543438"
 Parameter: XMIN -> "36.7543438"
 Parameter: YMAX -> "32.7544444"
 Parameter: YMIN -> "25.7544444"
 Parameter: ZMAX -> "-30.2793097"
 Parameter: ZMIN -> "-37.2793097"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "47" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "47" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.26835403"
Evaluating: 81.6823114*(0.26835403-0.5)
 Parameter: XPOS <- "-18.9213783"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.994921319"
Evaluating: 81.6823114*(0.994921319-0.5)
 Parameter: YPOS <- "40.4263173"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.970002164E-02"
Evaluating: 85*(4.970002164E-02-0.5)+0
 Parameter: ZPOS <- "-38.2754982"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.2754982" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.9213783"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.9213783-0
 Parameter: XTRAN <- "-18.9213783"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.4263173"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 40.4263173-0
 Parameter: YTRAN <- "40.4263173"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.2754982"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.2754982-0
 Parameter: ZTRAN <- "-38.2754982"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.9213783"
 Parameter: YTRAN -> "40.4263173"
 Parameter: ZTRAN -> "-38.2754982"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -18.921378   40.426317  -38.275498
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.655599331"
Evaluating: 0.655599331*360.0
 Parameter: XPHI <- "236.015759"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.155303814"
Evaluating: 0.155303814*360.0
 Parameter: YPHI <- "55.909373"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.269110071E-02"
Evaluating: 7.269110071E-02*360.0
 Parameter: ZPHI <- "26.1687963"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.9213783"
 Parameter: YPOS -> "40.4263173"
 Parameter: ZPOS -> "-38.2754982"
 Parameter: XPHI -> "236.015759"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.558965   -0.829191
    0.000000    0.829191   -0.558965

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.9213783"
 Parameter: YPOS -> "40.4263173"
 Parameter: ZPOS -> "-38.2754982"
 Parameter: YPHI -> "55.909373"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.560504    0.000000   -0.828152
    0.000000    1.000000    0.000000
    0.828152    0.000000    0.560504

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.9213783"
 Parameter: YPOS -> "40.4263173"
 Parameter: ZPOS -> "-38.2754982"
 Parameter: ZPHI -> "26.1687963"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.897499    0.441017    0.000000
   -0.441017    0.897499    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   26.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.921378 XMAX =  -18.921378 XAVE =  -18.921378
    YMIN =   40.426317 YMAX =   40.426317 YAVE =   40.426317
    ZMIN =  -38.275498 ZMAX =  -38.275498 ZAVE =  -38.275498
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.9213783"
Evaluating: -18.9213783+3.5
 Parameter: XMAX <- "-15.4213783"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.4263173"
Evaluating: 40.4263173+3.5
 Parameter: YMAX <- "43.9263173"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.2754982"
Evaluating: -38.2754982+3.5
 Parameter: ZMAX <- "-34.7754982"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.9213783"
Evaluating: -18.9213783-3.5
 Parameter: XMIN <- "-22.4213783"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.4263173"
Evaluating: 40.4263173-3.5
 Parameter: YMIN <- "36.9263173"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.2754982"
Evaluating: -38.2754982-3.5
 Parameter: ZMIN <- "-41.7754982"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.4213783"
 Parameter: XMIN -> "-22.4213783"
 Parameter: YMAX -> "43.9263173"
 Parameter: YMIN -> "36.9263173"
 Parameter: ZMAX -> "-34.7754982"
 Parameter: ZMIN -> "-41.7754982"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "48" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "48" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.563081945"
Evaluating: 81.6823114*(0.563081945-0.5)
 Parameter: XPOS <- "5.15267908"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.832106717"
Evaluating: 81.6823114*(0.832106717-0.5)
 Parameter: YPOS <- "27.1272443"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.934475893"
Evaluating: 85*(0.934475893-0.5)+0
 Parameter: ZPOS <- "36.9304509"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.9304509" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.9304509" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.15267908"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.15267908-0
 Parameter: XTRAN <- "5.15267908"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.1272443"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.1272443-0
 Parameter: YTRAN <- "27.1272443"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.9304509"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.9304509-0
 Parameter: ZTRAN <- "36.9304509"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.15267908"
 Parameter: YTRAN -> "27.1272443"
 Parameter: ZTRAN -> "36.9304509"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     5.152679   27.127244   36.930451
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31979571"
Evaluating: 0.31979571*360.0
 Parameter: XPHI <- "115.126456"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190292173"
Evaluating: 0.190292173*360.0
 Parameter: YPHI <- "68.5051823"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.430842785"
Evaluating: 0.430842785*360.0
 Parameter: ZPHI <- "155.103403"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.15267908"
 Parameter: YPOS -> "27.1272443"
 Parameter: ZPOS -> "36.9304509"
 Parameter: XPHI -> "115.126456"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.424618    0.905373
    0.000000   -0.905373   -0.424618

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.15267908"
 Parameter: YPOS -> "27.1272443"
 Parameter: ZPOS -> "36.9304509"
 Parameter: YPHI -> "68.5051823"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.366417    0.000000   -0.930451
    0.000000    1.000000    0.000000
    0.930451    0.000000    0.366417

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.15267908"
 Parameter: YPOS -> "27.1272443"
 Parameter: ZPOS -> "36.9304509"
 Parameter: ZPHI -> "155.103403"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.907069    0.420982    0.000000
   -0.420982   -0.907069    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  155.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.152679 XMAX =    5.152679 XAVE =    5.152679
    YMIN =   27.127244 YMAX =   27.127244 YAVE =   27.127244
    ZMIN =   36.930451 ZMAX =   36.930451 ZAVE =   36.930451
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.15267908"
Evaluating: 5.15267908+3.5
 Parameter: XMAX <- "8.65267908"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.1272443"
Evaluating: 27.1272443+3.5
 Parameter: YMAX <- "30.6272443"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.9304509"
Evaluating: 36.9304509+3.5
 Parameter: ZMAX <- "40.4304509"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.15267908"
Evaluating: 5.15267908-3.5
 Parameter: XMIN <- "1.65267908"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.1272443"
Evaluating: 27.1272443-3.5
 Parameter: YMIN <- "23.6272443"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.9304509"
Evaluating: 36.9304509-3.5
 Parameter: ZMIN <- "33.4304509"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.65267908"
 Parameter: XMIN -> "1.65267908"
 Parameter: YMAX -> "30.6272443"
 Parameter: YMIN -> "23.6272443"
 Parameter: ZMAX -> "40.4304509"
 Parameter: ZMIN -> "33.4304509"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      1 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "49" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "49" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.375094256"
Evaluating: 81.6823114*(0.375094256-0.5)
 Parameter: XPOS <- "-10.2025899"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.704577373"
Evaluating: 81.6823114*(0.704577373-0.5)
 Parameter: YPOS <- "16.7103527"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.796782587"
Evaluating: 85*(0.796782587-0.5)+0
 Parameter: ZPOS <- "25.2265199"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.2265199" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.2265199" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.2025899"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.2025899-0
 Parameter: XTRAN <- "-10.2025899"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.7103527"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.7103527-0
 Parameter: YTRAN <- "16.7103527"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.2265199"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.2265199-0
 Parameter: ZTRAN <- "25.2265199"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.2025899"
 Parameter: YTRAN -> "16.7103527"
 Parameter: ZTRAN -> "25.2265199"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -10.202590   16.710353   25.226520
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.532976953"
Evaluating: 0.532976953*360.0
 Parameter: XPHI <- "191.871703"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.215295687"
Evaluating: 0.215295687*360.0
 Parameter: YPHI <- "77.5064473"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.419401289"
Evaluating: 0.419401289*360.0
 Parameter: ZPHI <- "150.984464"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.2025899"
 Parameter: YPOS -> "16.7103527"
 Parameter: ZPOS -> "25.2265199"
 Parameter: XPHI -> "191.871703"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.978611   -0.205721
    0.000000    0.205721   -0.978611

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.2025899"
 Parameter: YPOS -> "16.7103527"
 Parameter: ZPOS -> "25.2265199"
 Parameter: YPHI -> "77.5064473"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.216330    0.000000   -0.976320
    0.000000    1.000000    0.000000
    0.976320    0.000000    0.216330

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   77.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.2025899"
 Parameter: YPOS -> "16.7103527"
 Parameter: ZPOS -> "25.2265199"
 Parameter: ZPHI -> "150.984464"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.874488    0.485047    0.000000
   -0.485047   -0.874488    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  150.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.202590 XMAX =  -10.202590 XAVE =  -10.202590
    YMIN =   16.710353 YMAX =   16.710353 YAVE =   16.710353
    ZMIN =   25.226520 ZMAX =   25.226520 ZAVE =   25.226520
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.2025899"
Evaluating: -10.2025899+3.5
 Parameter: XMAX <- "-6.7025899"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.7103527"
Evaluating: 16.7103527+3.5
 Parameter: YMAX <- "20.2103527"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.2265199"
Evaluating: 25.2265199+3.5
 Parameter: ZMAX <- "28.7265199"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.2025899"
Evaluating: -10.2025899-3.5
 Parameter: XMIN <- "-13.7025899"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.7103527"
Evaluating: 16.7103527-3.5
 Parameter: YMIN <- "13.2103527"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.2265199"
Evaluating: 25.2265199-3.5
 Parameter: ZMIN <- "21.7265199"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.7025899"
 Parameter: XMIN -> "-13.7025899"
 Parameter: YMAX -> "20.2103527"
 Parameter: YMIN -> "13.2103527"
 Parameter: ZMAX -> "28.7265199"
 Parameter: ZMIN -> "21.7265199"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "50" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "50" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.469009443"
Evaluating: 81.6823114*(0.469009443-0.5)
 Parameter: XPOS <- "-2.53138033"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.11736079"
Evaluating: 81.6823114*(0.11736079-0.5)
 Parameter: YPOS <- "-31.2548551"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.758481105E-02"
Evaluating: 85*(3.758481105E-02-0.5)+0
 Parameter: ZPOS <- "-39.3052911"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.3052911" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.53138033"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.53138033-0
 Parameter: XTRAN <- "-2.53138033"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.2548551"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.2548551-0
 Parameter: YTRAN <- "-31.2548551"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.3052911"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.3052911-0
 Parameter: ZTRAN <- "-39.3052911"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.53138033"
 Parameter: YTRAN -> "-31.2548551"
 Parameter: ZTRAN -> "-39.3052911"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -2.531380  -31.254855  -39.305291
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.698190296"
Evaluating: 0.698190296*360.0
 Parameter: XPHI <- "251.348507"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.153244672"
Evaluating: 0.153244672*360.0
 Parameter: YPHI <- "55.1680819"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.29946829E-02"
Evaluating: 2.29946829E-02*360.0
 Parameter: ZPHI <- "8.27808584"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.53138033"
 Parameter: YPOS -> "-31.2548551"
 Parameter: ZPOS -> "-39.3052911"
 Parameter: XPHI -> "251.348507"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.319811   -0.947481
    0.000000    0.947481   -0.319811

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.53138033"
 Parameter: YPOS -> "-31.2548551"
 Parameter: ZPOS -> "-39.3052911"
 Parameter: YPHI -> "55.1680819"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.571171    0.000000   -0.820831
    0.000000    1.000000    0.000000
    0.820831    0.000000    0.571171

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.53138033"
 Parameter: YPOS -> "-31.2548551"
 Parameter: ZPOS -> "-39.3052911"
 Parameter: ZPHI -> "8.27808584"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.989581    0.143978    0.000000
   -0.143978    0.989581    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    8.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.531380 XMAX =   -2.531380 XAVE =   -2.531380
    YMIN =  -31.254855 YMAX =  -31.254855 YAVE =  -31.254855
    ZMIN =  -39.305291 ZMAX =  -39.305291 ZAVE =  -39.305291
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.53138033"
Evaluating: -2.53138033+3.5
 Parameter: XMAX <- "0.96861967"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.2548551"
Evaluating: -31.2548551+3.5
 Parameter: YMAX <- "-27.7548551"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.3052911"
Evaluating: -39.3052911+3.5
 Parameter: ZMAX <- "-35.8052911"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.53138033"
Evaluating: -2.53138033-3.5
 Parameter: XMIN <- "-6.03138033"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.2548551"
Evaluating: -31.2548551-3.5
 Parameter: YMIN <- "-34.7548551"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.3052911"
Evaluating: -39.3052911-3.5
 Parameter: ZMIN <- "-42.8052911"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.96861967"
 Parameter: XMIN -> "-6.03138033"
 Parameter: YMAX -> "-27.7548551"
 Parameter: YMIN -> "-34.7548551"
 Parameter: ZMAX -> "-35.8052911"
 Parameter: ZMIN -> "-42.8052911"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "51" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "51" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.600007668"
Evaluating: 81.6823114*(0.600007668-0.5)
 Parameter: XPOS <- "8.16885748"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "2.77765334E-02"
Evaluating: 81.6823114*(2.77765334E-02-0.5)
 Parameter: YPOS <- "-38.5723042"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.35475032"
Evaluating: 85*(0.35475032-0.5)+0
 Parameter: ZPOS <- "-12.3462228"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.3462228" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.3462228" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "51" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.516466757"
Evaluating: 81.6823114*(0.516466757-0.5)
 Parameter: XPOS <- "1.34504277"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.787792409"
Evaluating: 81.6823114*(0.787792409-0.5)
 Parameter: YPOS <- "23.5075492"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.857441446"
Evaluating: 85*(0.857441446-0.5)+0
 Parameter: ZPOS <- "30.3825229"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.3825229" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.3825229" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.34504277"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.34504277-0
 Parameter: XTRAN <- "1.34504277"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.5075492"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.5075492-0
 Parameter: YTRAN <- "23.5075492"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.3825229"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.3825229-0
 Parameter: ZTRAN <- "30.3825229"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.34504277"
 Parameter: YTRAN -> "23.5075492"
 Parameter: ZTRAN -> "30.3825229"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     1.345043   23.507549   30.382523
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.494947009"
Evaluating: 0.494947009*360.0
 Parameter: XPHI <- "178.180923"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.432583521"
Evaluating: 0.432583521*360.0
 Parameter: YPHI <- "155.730068"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.570897265"
Evaluating: 0.570897265*360.0
 Parameter: ZPHI <- "205.523015"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.34504277"
 Parameter: YPOS -> "23.5075492"
 Parameter: ZPOS -> "30.3825229"
 Parameter: XPHI -> "178.180923"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999496    0.031744
    0.000000   -0.031744   -0.999496

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  178.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.34504277"
 Parameter: YPOS -> "23.5075492"
 Parameter: ZPOS -> "30.3825229"
 Parameter: YPHI -> "155.730068"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.911619    0.000000   -0.411036
    0.000000    1.000000    0.000000
    0.411036    0.000000   -0.911619

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  155.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.34504277"
 Parameter: YPOS -> "23.5075492"
 Parameter: ZPOS -> "30.3825229"
 Parameter: ZPHI -> "205.523015"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.902412   -0.430874    0.000000
    0.430874   -0.902412    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.345043 XMAX =    1.345043 XAVE =    1.345043
    YMIN =   23.507549 YMAX =   23.507549 YAVE =   23.507549
    ZMIN =   30.382523 ZMAX =   30.382523 ZAVE =   30.382523
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.34504277"
Evaluating: 1.34504277+3.5
 Parameter: XMAX <- "4.84504277"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.5075492"
Evaluating: 23.5075492+3.5
 Parameter: YMAX <- "27.0075492"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.3825229"
Evaluating: 30.3825229+3.5
 Parameter: ZMAX <- "33.8825229"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.34504277"
Evaluating: 1.34504277-3.5
 Parameter: XMIN <- "-2.15495723"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.5075492"
Evaluating: 23.5075492-3.5
 Parameter: YMIN <- "20.0075492"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.3825229"
Evaluating: 30.3825229-3.5
 Parameter: ZMIN <- "26.8825229"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.84504277"
 Parameter: XMIN -> "-2.15495723"
 Parameter: YMAX -> "27.0075492"
 Parameter: YMIN -> "20.0075492"
 Parameter: ZMAX -> "33.8825229"
 Parameter: ZMIN -> "26.8825229"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "52" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "52" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "8.761361406E-02"
Evaluating: 81.6823114*(8.761361406E-02-0.5)
 Parameter: XPOS <- "-33.6846732"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.105103432"
Evaluating: 81.6823114*(0.105103432-0.5)
 Parameter: YPOS <- "-32.2560644"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.76623383"
Evaluating: 85*(0.76623383-0.5)+0
 Parameter: ZPOS <- "22.6298756"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.6298756" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.6298756" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.6846732"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.6846732-0
 Parameter: XTRAN <- "-33.6846732"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.2560644"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.2560644-0
 Parameter: YTRAN <- "-32.2560644"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.6298756"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.6298756-0
 Parameter: ZTRAN <- "22.6298756"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.6846732"
 Parameter: YTRAN -> "-32.2560644"
 Parameter: ZTRAN -> "22.6298756"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -33.684673  -32.256064   22.629876
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.999975418"
Evaluating: 0.999975418*360.0
 Parameter: XPHI <- "359.99115"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.698829987E-02"
Evaluating: 4.698829987E-02*360.0
 Parameter: YPHI <- "16.915788"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.937559743"
Evaluating: 0.937559743*360.0
 Parameter: ZPHI <- "337.521507"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.6846732"
 Parameter: YPOS -> "-32.2560644"
 Parameter: ZPOS -> "22.6298756"
 Parameter: XPHI -> "359.99115"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    1.000000   -0.000154
    0.000000    0.000154    1.000000

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    0.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.6846732"
 Parameter: YPOS -> "-32.2560644"
 Parameter: ZPOS -> "22.6298756"
 Parameter: YPHI -> "16.915788"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.956733    0.000000   -0.290966
    0.000000    1.000000    0.000000
    0.290966    0.000000    0.956733

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   16.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.6846732"
 Parameter: YPOS -> "-32.2560644"
 Parameter: ZPOS -> "22.6298756"
 Parameter: ZPHI -> "337.521507"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.924023   -0.382337    0.000000
    0.382337    0.924023    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.684673 XMAX =  -33.684673 XAVE =  -33.684673
    YMIN =  -32.256064 YMAX =  -32.256064 YAVE =  -32.256064
    ZMIN =   22.629876 ZMAX =   22.629876 ZAVE =   22.629876
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.6846732"
Evaluating: -33.6846732+3.5
 Parameter: XMAX <- "-30.1846732"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.2560644"
Evaluating: -32.2560644+3.5
 Parameter: YMAX <- "-28.7560644"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.6298756"
Evaluating: 22.6298756+3.5
 Parameter: ZMAX <- "26.1298756"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.6846732"
Evaluating: -33.6846732-3.5
 Parameter: XMIN <- "-37.1846732"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.2560644"
Evaluating: -32.2560644-3.5
 Parameter: YMIN <- "-35.7560644"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.6298756"
Evaluating: 22.6298756-3.5
 Parameter: ZMIN <- "19.1298756"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.1846732"
 Parameter: XMIN -> "-37.1846732"
 Parameter: YMAX -> "-28.7560644"
 Parameter: YMIN -> "-35.7560644"
 Parameter: ZMAX -> "26.1298756"
 Parameter: ZMIN -> "19.1298756"
 SELRPN>     17 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      6 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26572 POS      POT      52       POT     -**** MEMB     POPC     95       N             2.4231
26572 POS      POT      52       POT     -**** MEMB     POPC     95       C12           2.2615
26572 POS      POT      52       POT     -**** MEMB     POPC     95       C13           2.1397
26572 POS      POT      52       POT     -**** MEMB     POPC     95       C14           3.9038
26572 POS      POT      52       POT     -**** MEMB     POPC     95       C15           2.6798
26572 POS      POT      52       POT     -**** MEMB     POPC     95       C11           3.4306
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "52" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.879662"
Evaluating: 81.6823114*(0.879662-0.5)
 Parameter: XPOS <- "31.0116697"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.284238745"
Evaluating: 81.6823114*(0.284238745-0.5)
 Parameter: YPOS <- "-17.623878"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.452529734"
Evaluating: 85*(0.452529734-0.5)+0
 Parameter: ZPOS <- "-4.03497261"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.03497261" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.03497261" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "52" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.401480807"
Evaluating: 81.6823114*(0.401480807-0.5)
 Parameter: XPOS <- "-8.0472754"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.86124453"
Evaluating: 81.6823114*(0.86124453-0.5)
 Parameter: YPOS <- "29.5072882"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.381788665"
Evaluating: 85*(0.381788665-0.5)+0
 Parameter: ZPOS <- "-10.0479635"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.0479635" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.0479635" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "52" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.103660985"
Evaluating: 81.6823114*(0.103660985-0.5)
 Parameter: XPOS <- "-32.3738868"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "4.078822544E-02"
Evaluating: 81.6823114*(4.078822544E-02-0.5)
 Parameter: YPOS <- "-37.5094792"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.624369544"
Evaluating: 85*(0.624369544-0.5)+0
 Parameter: ZPOS <- "10.5714112"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.5714112" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.5714112" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "52" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.300889868"
Evaluating: 81.6823114*(0.300889868-0.5)
 Parameter: XPOS <- "-16.2637758"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.529466211"
Evaluating: 81.6823114*(0.529466211-0.5)
 Parameter: YPOS <- "2.40686822"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.811396515"
Evaluating: 85*(0.811396515-0.5)+0
 Parameter: ZPOS <- "26.4687038"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.4687038" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.4687038" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.684673 XMAX =  -33.684673 XAVE =  -33.684673
    YMIN =  -32.256064 YMAX =  -32.256064 YAVE =  -32.256064
    ZMIN =   22.629876 ZMAX =   22.629876 ZAVE =   22.629876
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.2637758"
 RDCMND substituted energy or value "?XAVE" to "-33.6846732"
Evaluating: -16.2637758--33.6846732
 Parameter: XTRAN <- "17.4208974"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.40686822"
 RDCMND substituted energy or value "?YAVE" to "-32.2560644"
Evaluating: 2.40686822--32.2560644
 Parameter: YTRAN <- "34.6629326"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.4687038"
 RDCMND substituted energy or value "?ZAVE" to "22.6298756"
Evaluating: 26.4687038-22.6298756
 Parameter: ZTRAN <- "3.8388282"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.4208974"
 Parameter: YTRAN -> "34.6629326"
 Parameter: ZTRAN -> "3.8388282"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    17.420897   34.662933    3.838828
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.908344364"
Evaluating: 0.908344364*360.0
 Parameter: XPHI <- "327.003971"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.494013683"
Evaluating: 0.494013683*360.0
 Parameter: YPHI <- "177.844926"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.118809545"
Evaluating: 0.118809545*360.0
 Parameter: ZPHI <- "42.7714362"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.2637758"
 Parameter: YPOS -> "2.40686822"
 Parameter: ZPOS -> "26.4687038"
 Parameter: XPHI -> "327.003971"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.838708   -0.544581
    0.000000    0.544581    0.838708

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.2637758"
 Parameter: YPOS -> "2.40686822"
 Parameter: ZPOS -> "26.4687038"
 Parameter: YPHI -> "177.844926"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.999293    0.000000   -0.037604
    0.000000    1.000000    0.000000
    0.037604    0.000000   -0.999293

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  177.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.2637758"
 Parameter: YPOS -> "2.40686822"
 Parameter: ZPOS -> "26.4687038"
 Parameter: ZPHI -> "42.7714362"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.734068    0.679075    0.000000
   -0.679075    0.734068    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   42.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.263776 XMAX =  -16.263776 XAVE =  -16.263776
    YMIN =    2.406868 YMAX =    2.406868 YAVE =    2.406868
    ZMIN =   26.468704 ZMAX =   26.468704 ZAVE =   26.468704
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.2637758"
Evaluating: -16.2637758+3.5
 Parameter: XMAX <- "-12.7637758"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.40686821"
Evaluating: 2.40686821+3.5
 Parameter: YMAX <- "5.90686821"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.4687038"
Evaluating: 26.4687038+3.5
 Parameter: ZMAX <- "29.9687038"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.2637758"
Evaluating: -16.2637758-3.5
 Parameter: XMIN <- "-19.7637758"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.40686821"
Evaluating: 2.40686821-3.5
 Parameter: YMIN <- "-1.09313179"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.4687038"
Evaluating: 26.4687038-3.5
 Parameter: ZMIN <- "22.9687038"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.7637758"
 Parameter: XMIN -> "-19.7637758"
 Parameter: YMAX -> "5.90686821"
 Parameter: YMIN -> "-1.09313179"
 Parameter: ZMAX -> "29.9687038"
 Parameter: ZMIN -> "22.9687038"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "53" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "53" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.689081384"
Evaluating: 81.6823114*(0.689081384-0.5)
 Parameter: XPOS <- "15.4446045"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.27001038"
Evaluating: 81.6823114*(0.27001038-0.5)
 Parameter: YPOS <- "-18.7860838"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.442344503"
Evaluating: 85*(0.442344503-0.5)+0
 Parameter: ZPOS <- "-4.90071725"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.90071725" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.90071725" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "53" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.643080894"
Evaluating: 81.6823114*(0.643080894-0.5)
 Parameter: XPOS <- "11.6871781"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.103772863"
Evaluating: 81.6823114*(0.103772863-0.5)
 Parameter: YPOS <- "-32.3647484"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.778587259"
Evaluating: 85*(0.778587259-0.5)+0
 Parameter: ZPOS <- "23.679917"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.679917" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.679917" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.6871781"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.6871781-0
 Parameter: XTRAN <- "11.6871781"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.3647484"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.3647484-0
 Parameter: YTRAN <- "-32.3647484"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.679917"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.679917-0
 Parameter: ZTRAN <- "23.679917"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.6871781"
 Parameter: YTRAN -> "-32.3647484"
 Parameter: ZTRAN -> "23.679917"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    11.687178  -32.364748   23.679917
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.88103737"
Evaluating: 0.88103737*360.0
 Parameter: XPHI <- "317.173453"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56974063"
Evaluating: 0.56974063*360.0
 Parameter: YPHI <- "205.106627"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903535239"
Evaluating: 0.903535239*360.0
 Parameter: ZPHI <- "325.272686"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.6871781"
 Parameter: YPOS -> "-32.3647484"
 Parameter: ZPOS -> "23.679917"
 Parameter: XPHI -> "317.173453"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.733415   -0.679781
    0.000000    0.679781    0.733415

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.6871781"
 Parameter: YPOS -> "-32.3647484"
 Parameter: ZPOS -> "23.679917"
 Parameter: YPHI -> "205.106627"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.905520    0.000000    0.424304
    0.000000    1.000000    0.000000
   -0.424304    0.000000   -0.905520

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.6871781"
 Parameter: YPOS -> "-32.3647484"
 Parameter: ZPOS -> "23.679917"
 Parameter: ZPHI -> "325.272686"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.821873   -0.569671    0.000000
    0.569671    0.821873    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.687178 XMAX =   11.687178 XAVE =   11.687178
    YMIN =  -32.364748 YMAX =  -32.364748 YAVE =  -32.364748
    ZMIN =   23.679917 ZMAX =   23.679917 ZAVE =   23.679917
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.6871781"
Evaluating: 11.6871781+3.5
 Parameter: XMAX <- "15.1871781"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.3647484"
Evaluating: -32.3647484+3.5
 Parameter: YMAX <- "-28.8647484"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.679917"
Evaluating: 23.679917+3.5
 Parameter: ZMAX <- "27.179917"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.6871781"
Evaluating: 11.6871781-3.5
 Parameter: XMIN <- "8.1871781"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.3647484"
Evaluating: -32.3647484-3.5
 Parameter: YMIN <- "-35.8647484"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.679917"
Evaluating: 23.679917-3.5
 Parameter: ZMIN <- "20.179917"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.1871781"
 Parameter: XMIN -> "8.1871781"
 Parameter: YMAX -> "-28.8647484"
 Parameter: YMIN -> "-35.8647484"
 Parameter: ZMAX -> "27.179917"
 Parameter: ZMIN -> "20.179917"
 SELRPN>      5 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      1 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26573 POS      POT      53       POT     -7313 MEMB     POPC     56       C15           3.3057
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "53" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.951188821"
Evaluating: 81.6823114*(0.951188821-0.5)
 Parameter: XPOS <- "36.8541458"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.432758498"
Evaluating: 81.6823114*(0.432758498-0.5)
 Parameter: YPOS <- "-5.49244131"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.701968775"
Evaluating: 85*(0.701968775-0.5)+0
 Parameter: ZPOS <- "17.1673459"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.1673459" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.1673459" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.687178 XMAX =   11.687178 XAVE =   11.687178
    YMIN =  -32.364748 YMAX =  -32.364748 YAVE =  -32.364748
    ZMIN =   23.679917 ZMAX =   23.679917 ZAVE =   23.679917
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.8541458"
 RDCMND substituted energy or value "?XAVE" to "11.6871781"
Evaluating: 36.8541458-11.6871781
 Parameter: XTRAN <- "25.1669677"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.49244131"
 RDCMND substituted energy or value "?YAVE" to "-32.3647484"
Evaluating: -5.49244131--32.3647484
 Parameter: YTRAN <- "26.8723071"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.1673459"
 RDCMND substituted energy or value "?ZAVE" to "23.679917"
Evaluating: 17.1673459-23.679917
 Parameter: ZTRAN <- "-6.5125711"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.1669677"
 Parameter: YTRAN -> "26.8723071"
 Parameter: ZTRAN -> "-6.5125711"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    25.166968   26.872307   -6.512571
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418242207"
Evaluating: 0.418242207*360.0
 Parameter: XPHI <- "150.567195"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.18501471"
Evaluating: 0.18501471*360.0
 Parameter: YPHI <- "66.6052956"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.375110127"
Evaluating: 0.375110127*360.0
 Parameter: ZPHI <- "135.039646"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.8541458"
 Parameter: YPOS -> "-5.49244131"
 Parameter: ZPOS -> "17.1673459"
 Parameter: XPHI -> "150.567195"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.870933    0.491402
    0.000000   -0.491402   -0.870933

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  150.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.8541458"
 Parameter: YPOS -> "-5.49244131"
 Parameter: ZPOS -> "17.1673459"
 Parameter: YPHI -> "66.6052956"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.397063    0.000000   -0.917791
    0.000000    1.000000    0.000000
    0.917791    0.000000    0.397063

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   66.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.8541458"
 Parameter: YPOS -> "-5.49244131"
 Parameter: ZPOS -> "17.1673459"
 Parameter: ZPHI -> "135.039646"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.707596    0.706617    0.000000
   -0.706617   -0.707596    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  135.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.854146 XMAX =   36.854146 XAVE =   36.854146
    YMIN =   -5.492441 YMAX =   -5.492441 YAVE =   -5.492441
    ZMIN =   17.167346 ZMAX =   17.167346 ZAVE =   17.167346
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.8541458"
Evaluating: 36.8541458+3.5
 Parameter: XMAX <- "40.3541458"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.49244131"
Evaluating: -5.49244131+3.5
 Parameter: YMAX <- "-1.99244131"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.1673459"
Evaluating: 17.1673459+3.5
 Parameter: ZMAX <- "20.6673459"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.8541458"
Evaluating: 36.8541458-3.5
 Parameter: XMIN <- "33.3541458"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.49244131"
Evaluating: -5.49244131-3.5
 Parameter: YMIN <- "-8.99244131"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.1673459"
Evaluating: 17.1673459-3.5
 Parameter: ZMIN <- "13.6673459"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.3541458"
 Parameter: XMIN -> "33.3541458"
 Parameter: YMAX -> "-1.99244131"
 Parameter: YMIN -> "-8.99244131"
 Parameter: ZMAX -> "20.6673459"
 Parameter: ZMIN -> "13.6673459"
 SELRPN>     32 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     18 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26573 POS      POT      53       POT     -5361 MEMB     POPC     41       C3            3.7146
26573 POS      POT      53       POT     -5364 MEMB     POPC     41       O31           3.8411
26573 POS      POT      53       POT     -8004 MEMB     POPC     61       O32           3.7178
26573 POS      POT      53       POT     -9156 MEMB     POPC     70       N             3.3146
26573 POS      POT      53       POT     -9157 MEMB     POPC     70       C12           2.8417
26573 POS      POT      53       POT     -9168 MEMB     POPC     70       C15           2.6077
26573 POS      POT      53       POT     -9172 MEMB     POPC     70       C11           2.1728
26573 POS      POT      53       POT     -9175 MEMB     POPC     70       P             3.8530
26573 POS      POT      53       POT     -9177 MEMB     POPC     70       O14           3.3771
26573 POS      POT      53       POT     -9178 MEMB     POPC     70       O12           3.2825
26573 POS      POT      53       POT     -9179 MEMB     POPC     70       O11           3.9902
26573 POS      POT      53       POT     -9180 MEMB     POPC     70       C1            3.3919
26573 POS      POT      53       POT     -9185 MEMB     POPC     70       O21           3.8148
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "53" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.911322647"
Evaluating: 81.6823114*(0.911322647-0.5)
 Parameter: XPOS <- "33.5977845"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "3.207065658E-03"
Evaluating: 81.6823114*(3.207065658E-03-0.5)
 Parameter: YPOS <- "-40.5791952"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.902091498"
Evaluating: 85*(0.902091498-0.5)+0
 Parameter: ZPOS <- "34.1777773"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.1777773" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.1777773" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.854146 XMAX =   36.854146 XAVE =   36.854146
    YMIN =   -5.492441 YMAX =   -5.492441 YAVE =   -5.492441
    ZMIN =   17.167346 ZMAX =   17.167346 ZAVE =   17.167346
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.5977845"
 RDCMND substituted energy or value "?XAVE" to "36.8541458"
Evaluating: 33.5977845-36.8541458
 Parameter: XTRAN <- "-3.2563613"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.5791952"
 RDCMND substituted energy or value "?YAVE" to "-5.49244131"
Evaluating: -40.5791952--5.49244131
 Parameter: YTRAN <- "-35.0867539"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.1777773"
 RDCMND substituted energy or value "?ZAVE" to "17.1673459"
Evaluating: 34.1777773-17.1673459
 Parameter: ZTRAN <- "17.0104314"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.2563613"
 Parameter: YTRAN -> "-35.0867539"
 Parameter: ZTRAN -> "17.0104314"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -3.256361  -35.086754   17.010431
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.799496646"
Evaluating: 0.799496646*360.0
 Parameter: XPHI <- "287.818793"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.930026182E-02"
Evaluating: 3.930026182E-02*360.0
 Parameter: YPHI <- "14.1480943"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.747521794"
Evaluating: 0.747521794*360.0
 Parameter: ZPHI <- "269.107846"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.5977845"
 Parameter: YPOS -> "-40.5791952"
 Parameter: ZPOS -> "34.1777773"
 Parameter: XPHI -> "287.818793"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.306008   -0.952029
    0.000000    0.952029    0.306008

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   72.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.5977845"
 Parameter: YPOS -> "-40.5791952"
 Parameter: ZPOS -> "34.1777773"
 Parameter: YPHI -> "14.1480943"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.969667    0.000000   -0.244429
    0.000000    1.000000    0.000000
    0.244429    0.000000    0.969667

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   14.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.5977845"
 Parameter: YPOS -> "-40.5791952"
 Parameter: ZPOS -> "34.1777773"
 Parameter: ZPHI -> "269.107846"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.015570   -0.999879    0.000000
    0.999879   -0.015570    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   90.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.597785 XMAX =   33.597785 XAVE =   33.597785
    YMIN =  -40.579195 YMAX =  -40.579195 YAVE =  -40.579195
    ZMIN =   34.177777 ZMAX =   34.177777 ZAVE =   34.177777
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.5977845"
Evaluating: 33.5977845+3.5
 Parameter: XMAX <- "37.0977845"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.5791952"
Evaluating: -40.5791952+3.5
 Parameter: YMAX <- "-37.0791952"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.1777773"
Evaluating: 34.1777773+3.5
 Parameter: ZMAX <- "37.6777773"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.5977845"
Evaluating: 33.5977845-3.5
 Parameter: XMIN <- "30.0977845"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.5791952"
Evaluating: -40.5791952-3.5
 Parameter: YMIN <- "-44.0791952"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.1777773"
Evaluating: 34.1777773-3.5
 Parameter: ZMIN <- "30.6777773"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.0977845"
 Parameter: XMIN -> "30.0977845"
 Parameter: YMAX -> "-37.0791952"
 Parameter: YMIN -> "-44.0791952"
 Parameter: ZMAX -> "37.6777773"
 Parameter: ZMIN -> "30.6777773"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "54" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "54" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.224207629"
Evaluating: 81.6823114*(0.224207629-0.5)
 Parameter: XPOS <- "-22.5273583"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.766468385"
Evaluating: 81.6823114*(0.766468385-0.5)
 Parameter: YPOS <- "21.7657536"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.973746049"
Evaluating: 85*(0.973746049-0.5)+0
 Parameter: ZPOS <- "40.2684142"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.2684142" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.2684142" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.5273583"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.5273583-0
 Parameter: XTRAN <- "-22.5273583"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.7657536"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.7657536-0
 Parameter: YTRAN <- "21.7657536"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.2684142"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.2684142-0
 Parameter: ZTRAN <- "40.2684142"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.5273583"
 Parameter: YTRAN -> "21.7657536"
 Parameter: ZTRAN -> "40.2684142"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -22.527358   21.765754   40.268414
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.736627886"
Evaluating: 0.736627886*360.0
 Parameter: XPHI <- "265.186039"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.546137165"
Evaluating: 0.546137165*360.0
 Parameter: YPHI <- "196.609379"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.967336894"
Evaluating: 0.967336894*360.0
 Parameter: ZPHI <- "348.241282"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.5273583"
 Parameter: YPOS -> "21.7657536"
 Parameter: ZPOS -> "40.2684142"
 Parameter: XPHI -> "265.186039"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.083921   -0.996472
    0.000000    0.996472   -0.083921

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.5273583"
 Parameter: YPOS -> "21.7657536"
 Parameter: ZPOS -> "40.2684142"
 Parameter: YPHI -> "196.609379"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.958276    0.000000    0.285845
    0.000000    1.000000    0.000000
   -0.285845    0.000000   -0.958276

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  163.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.5273583"
 Parameter: YPOS -> "21.7657536"
 Parameter: ZPOS -> "40.2684142"
 Parameter: ZPHI -> "348.241282"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.979014   -0.203791    0.000000
    0.203791    0.979014    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   11.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.527358 XMAX =  -22.527358 XAVE =  -22.527358
    YMIN =   21.765754 YMAX =   21.765754 YAVE =   21.765754
    ZMIN =   40.268414 ZMAX =   40.268414 ZAVE =   40.268414
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.5273583"
Evaluating: -22.5273583+3.5
 Parameter: XMAX <- "-19.0273583"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.7657536"
Evaluating: 21.7657536+3.5
 Parameter: YMAX <- "25.2657536"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.2684142"
Evaluating: 40.2684142+3.5
 Parameter: ZMAX <- "43.7684142"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.5273583"
Evaluating: -22.5273583-3.5
 Parameter: XMIN <- "-26.0273583"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.7657536"
Evaluating: 21.7657536-3.5
 Parameter: YMIN <- "18.2657536"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.2684142"
Evaluating: 40.2684142-3.5
 Parameter: ZMIN <- "36.7684142"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.0273583"
 Parameter: XMIN -> "-26.0273583"
 Parameter: YMAX -> "25.2657536"
 Parameter: YMIN -> "18.2657536"
 Parameter: ZMAX -> "43.7684142"
 Parameter: ZMIN -> "36.7684142"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "55" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "55" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.91324845"
Evaluating: 81.6823114*(0.91324845-0.5)
 Parameter: XPOS <- "33.7550886"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.346391919"
Evaluating: 81.6823114*(0.346391919-0.5)
 Parameter: YPOS <- "-12.5470631"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.519507925"
Evaluating: 85*(0.519507925-0.5)+0
 Parameter: ZPOS <- "1.65817362"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.65817362" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.65817362" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "55" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.659669134"
Evaluating: 81.6823114*(0.659669134-0.5)
 Parameter: XPOS <- "13.0421439"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.911493609"
Evaluating: 81.6823114*(0.911493609-0.5)
 Parameter: YPOS <- "33.6117491"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.265840295"
Evaluating: 85*(0.265840295-0.5)+0
 Parameter: ZPOS <- "-19.9035749"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.9035749" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.0421439"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.0421439-0
 Parameter: XTRAN <- "13.0421439"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.6117491"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.6117491-0
 Parameter: YTRAN <- "33.6117491"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.9035749"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.9035749-0
 Parameter: ZTRAN <- "-19.9035749"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.0421439"
 Parameter: YTRAN -> "33.6117491"
 Parameter: ZTRAN -> "-19.9035749"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    13.042144   33.611749  -19.903575
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.306355665"
Evaluating: 0.306355665*360.0
 Parameter: XPHI <- "110.288039"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.125955014"
Evaluating: 0.125955014*360.0
 Parameter: YPHI <- "45.343805"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.872964339"
Evaluating: 0.872964339*360.0
 Parameter: ZPHI <- "314.267162"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.0421439"
 Parameter: YPOS -> "33.6117491"
 Parameter: ZPOS -> "-19.9035749"
 Parameter: XPHI -> "110.288039"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.346740    0.937961
    0.000000   -0.937961   -0.346740

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  110.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.0421439"
 Parameter: YPOS -> "33.6117491"
 Parameter: ZPOS -> "-19.9035749"
 Parameter: YPHI -> "45.343805"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.702851    0.000000   -0.711337
    0.000000    1.000000    0.000000
    0.711337    0.000000    0.702851

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.0421439"
 Parameter: YPOS -> "33.6117491"
 Parameter: ZPOS -> "-19.9035749"
 Parameter: ZPHI -> "314.267162"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.698005   -0.716093    0.000000
    0.716093    0.698005    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.042144 XMAX =   13.042144 XAVE =   13.042144
    YMIN =   33.611749 YMAX =   33.611749 YAVE =   33.611749
    ZMIN =  -19.903575 ZMAX =  -19.903575 ZAVE =  -19.903575
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.0421439"
Evaluating: 13.0421439+3.5
 Parameter: XMAX <- "16.5421439"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.6117491"
Evaluating: 33.6117491+3.5
 Parameter: YMAX <- "37.1117491"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.9035749"
Evaluating: -19.9035749+3.5
 Parameter: ZMAX <- "-16.4035749"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.0421439"
Evaluating: 13.0421439-3.5
 Parameter: XMIN <- "9.5421439"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.6117491"
Evaluating: 33.6117491-3.5
 Parameter: YMIN <- "30.1117491"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.9035749"
Evaluating: -19.9035749-3.5
 Parameter: ZMIN <- "-23.4035749"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.5421439"
 Parameter: XMIN -> "9.5421439"
 Parameter: YMAX -> "37.1117491"
 Parameter: YMIN -> "30.1117491"
 Parameter: ZMAX -> "-16.4035749"
 Parameter: ZMIN -> "-23.4035749"
 SELRPN>     26 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     10 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26575 POS      POT      55       POT     -**** MEMB     POPC     160      N             2.0206
26575 POS      POT      55       POT     -**** MEMB     POPC     160      C12           1.5257
26575 POS      POT      55       POT     -**** MEMB     POPC     160      C13           2.7930
26575 POS      POT      55       POT     -**** MEMB     POPC     160      C14           3.3774
26575 POS      POT      55       POT     -**** MEMB     POPC     160      C15           2.1494
26575 POS      POT      55       POT     -**** MEMB     POPC     160      C11           1.1292
26575 POS      POT      55       POT     -**** MEMB     POPC     160      P             3.2973
26575 POS      POT      55       POT     -**** MEMB     POPC     160      O14           3.7090
26575 POS      POT      55       POT     -**** MEMB     POPC     160      O12           1.8750
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "55" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.612833248"
Evaluating: 81.6823114*(0.612833248-0.5)
 Parameter: XPOS <- "9.2164805"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.357259614"
Evaluating: 81.6823114*(0.357259614-0.5)
 Parameter: YPOS <- "-11.6593647"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.604237643"
Evaluating: 85*(0.604237643-0.5)+0
 Parameter: ZPOS <- "8.86019966"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.86019966" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.86019966" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "55" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.104577624"
Evaluating: 81.6823114*(0.104577624-0.5)
 Parameter: XPOS <- "-32.2990137"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.841210747"
Evaluating: 81.6823114*(0.841210747-0.5)
 Parameter: YPOS <- "27.8708825"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.612922622"
Evaluating: 85*(0.612922622-0.5)+0
 Parameter: ZPOS <- "9.59842287"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.59842287" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.59842287" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "55" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.344620702"
Evaluating: 81.6823114*(0.344620702-0.5)
 Parameter: XPOS <- "-12.6917402"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.164798846"
Evaluating: 81.6823114*(0.164798846-0.5)
 Parameter: YPOS <- "-27.380005"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.272330089"
Evaluating: 85*(0.272330089-0.5)+0
 Parameter: ZPOS <- "-19.3519424"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.3519424" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.042144 XMAX =   13.042144 XAVE =   13.042144
    YMIN =   33.611749 YMAX =   33.611749 YAVE =   33.611749
    ZMIN =  -19.903575 ZMAX =  -19.903575 ZAVE =  -19.903575
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.6917402"
 RDCMND substituted energy or value "?XAVE" to "13.0421439"
Evaluating: -12.6917402-13.0421439
 Parameter: XTRAN <- "-25.7338841"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.380005"
 RDCMND substituted energy or value "?YAVE" to "33.6117491"
Evaluating: -27.380005-33.6117491
 Parameter: YTRAN <- "-60.9917541"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.3519424"
 RDCMND substituted energy or value "?ZAVE" to "-19.9035749"
Evaluating: -19.3519424--19.9035749
 Parameter: ZTRAN <- "0.5516325"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.7338841"
 Parameter: YTRAN -> "-60.9917541"
 Parameter: ZTRAN -> "0.5516325"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -25.733884  -60.991754    0.551632
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.184251628"
Evaluating: 0.184251628*360.0
 Parameter: XPHI <- "66.3305861"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.578214509"
Evaluating: 0.578214509*360.0
 Parameter: YPHI <- "208.157223"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.735955853"
Evaluating: 0.735955853*360.0
 Parameter: ZPHI <- "264.944107"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.6917402"
 Parameter: YPOS -> "-27.380005"
 Parameter: ZPOS -> "-19.3519424"
 Parameter: XPHI -> "66.3305861"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.401459    0.915877
    0.000000   -0.915877    0.401459

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.6917402"
 Parameter: YPOS -> "-27.380005"
 Parameter: ZPOS -> "-19.3519424"
 Parameter: YPHI -> "208.157223"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.881656    0.000000    0.471893
    0.000000    1.000000    0.000000
   -0.471893    0.000000   -0.881656

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  151.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.6917402"
 Parameter: YPOS -> "-27.380005"
 Parameter: ZPOS -> "-19.3519424"
 Parameter: ZPHI -> "264.944107"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.088128   -0.996109    0.000000
    0.996109   -0.088128    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   95.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.691740 XMAX =  -12.691740 XAVE =  -12.691740
    YMIN =  -27.380005 YMAX =  -27.380005 YAVE =  -27.380005
    ZMIN =  -19.351942 ZMAX =  -19.351942 ZAVE =  -19.351942
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.6917402"
Evaluating: -12.6917402+3.5
 Parameter: XMAX <- "-9.1917402"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.380005"
Evaluating: -27.380005+3.5
 Parameter: YMAX <- "-23.880005"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.3519424"
Evaluating: -19.3519424+3.5
 Parameter: ZMAX <- "-15.8519424"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.6917402"
Evaluating: -12.6917402-3.5
 Parameter: XMIN <- "-16.1917402"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.380005"
Evaluating: -27.380005-3.5
 Parameter: YMIN <- "-30.880005"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.3519424"
Evaluating: -19.3519424-3.5
 Parameter: ZMIN <- "-22.8519424"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.1917402"
 Parameter: XMIN -> "-16.1917402"
 Parameter: YMAX -> "-23.880005"
 Parameter: YMIN -> "-30.880005"
 Parameter: ZMAX -> "-15.8519424"
 Parameter: ZMIN -> "-22.8519424"
 SELRPN>     19 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     11 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26575 POS      POT      55       POT     -**** MEMB     POPS     149      N             2.6061
26575 POS      POT      55       POT     -**** MEMB     POPS     149      C12           1.6569
26575 POS      POT      55       POT     -**** MEMB     POPS     149      C13           2.0565
26575 POS      POT      55       POT     -**** MEMB     POPS     149      O13A          2.8629
26575 POS      POT      55       POT     -**** MEMB     POPS     149      O13B          2.6364
26575 POS      POT      55       POT     -**** MEMB     POPS     149      C11           0.9500
26575 POS      POT      55       POT     -**** MEMB     POPS     149      P             3.5162
26575 POS      POT      55       POT     -**** MEMB     POPS     149      O13           3.9162
26575 POS      POT      55       POT     -**** MEMB     POPS     149      O12           2.3802
26575 POS      POT      55       POT     -**** MEMB     POPS     149      O11           3.5164
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "55" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.646996586"
Evaluating: 81.6823114*(0.646996586-0.5)
 Parameter: XPOS <- "12.0070209"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.378593201"
Evaluating: 81.6823114*(0.378593201-0.5)
 Parameter: YPOS <- "-9.91678796"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.977571108"
Evaluating: 85*(0.977571108-0.5)+0
 Parameter: ZPOS <- "40.5935442"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.5935442" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.5935442" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.691740 XMAX =  -12.691740 XAVE =  -12.691740
    YMIN =  -27.380005 YMAX =  -27.380005 YAVE =  -27.380005
    ZMIN =  -19.351942 ZMAX =  -19.351942 ZAVE =  -19.351942
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.0070209"
 RDCMND substituted energy or value "?XAVE" to "-12.6917402"
Evaluating: 12.0070209--12.6917402
 Parameter: XTRAN <- "24.6987611"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.91678796"
 RDCMND substituted energy or value "?YAVE" to "-27.380005"
Evaluating: -9.91678796--27.380005
 Parameter: YTRAN <- "17.463217"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.5935442"
 RDCMND substituted energy or value "?ZAVE" to "-19.3519424"
Evaluating: 40.5935442--19.3519424
 Parameter: ZTRAN <- "59.9454866"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.6987611"
 Parameter: YTRAN -> "17.463217"
 Parameter: ZTRAN -> "59.9454866"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    24.698761   17.463217   59.945487
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.961617666"
Evaluating: 0.961617666*360.0
 Parameter: XPHI <- "346.18236"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.115132966"
Evaluating: 0.115132966*360.0
 Parameter: YPHI <- "41.4478678"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374220511"
Evaluating: 0.374220511*360.0
 Parameter: ZPHI <- "134.719384"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.0070209"
 Parameter: YPOS -> "-9.91678796"
 Parameter: ZPOS -> "40.5935442"
 Parameter: XPHI -> "346.18236"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.971061   -0.238832
    0.000000    0.238832    0.971061

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   13.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.0070209"
 Parameter: YPOS -> "-9.91678796"
 Parameter: ZPOS -> "40.5935442"
 Parameter: YPHI -> "41.4478678"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.749558    0.000000   -0.661938
    0.000000    1.000000    0.000000
    0.661938    0.000000    0.749558

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   41.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.0070209"
 Parameter: YPOS -> "-9.91678796"
 Parameter: ZPOS -> "40.5935442"
 Parameter: ZPHI -> "134.719384"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.703635    0.710561    0.000000
   -0.710561   -0.703635    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  134.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.007021 XMAX =   12.007021 XAVE =   12.007021
    YMIN =   -9.916788 YMAX =   -9.916788 YAVE =   -9.916788
    ZMIN =   40.593544 ZMAX =   40.593544 ZAVE =   40.593544
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.0070209"
Evaluating: 12.0070209+3.5
 Parameter: XMAX <- "15.5070209"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.91678794"
Evaluating: -9.91678794+3.5
 Parameter: YMAX <- "-6.41678794"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.5935442"
Evaluating: 40.5935442+3.5
 Parameter: ZMAX <- "44.0935442"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.0070209"
Evaluating: 12.0070209-3.5
 Parameter: XMIN <- "8.5070209"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.91678794"
Evaluating: -9.91678794-3.5
 Parameter: YMIN <- "-13.4167879"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.5935442"
Evaluating: 40.5935442-3.5
 Parameter: ZMIN <- "37.0935442"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.5070209"
 Parameter: XMIN -> "8.5070209"
 Parameter: YMAX -> "-6.41678794"
 Parameter: YMIN -> "-13.4167879"
 Parameter: ZMAX -> "44.0935442"
 Parameter: ZMIN -> "37.0935442"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "56" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "56" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.813175491"
Evaluating: 81.6823114*(0.813175491-0.5)
 Parameter: XPOS <- "25.580898"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.315639981"
Evaluating: 81.6823114*(0.315639981-0.5)
 Parameter: YPOS <- "-15.0589525"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.449848305"
Evaluating: 85*(0.449848305-0.5)+0
 Parameter: ZPOS <- "-4.26289408"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.26289408" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.26289408" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "56" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.949720173"
Evaluating: 81.6823114*(0.949720173-0.5)
 Parameter: XPOS <- "36.7341832"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.321728558"
Evaluating: 81.6823114*(0.321728558-0.5)
 Parameter: YPOS <- "-14.5616234"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.830893635"
Evaluating: 85*(0.830893635-0.5)+0
 Parameter: ZPOS <- "28.125959"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.125959" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.125959" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.7341832"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.7341832-0
 Parameter: XTRAN <- "36.7341832"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.5616234"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.5616234-0
 Parameter: YTRAN <- "-14.5616234"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.125959"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.125959-0
 Parameter: ZTRAN <- "28.125959"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.7341832"
 Parameter: YTRAN -> "-14.5616234"
 Parameter: ZTRAN -> "28.125959"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    36.734183  -14.561623   28.125959
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.343529077"
Evaluating: 0.343529077*360.0
 Parameter: XPHI <- "123.670468"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.772762541"
Evaluating: 0.772762541*360.0
 Parameter: YPHI <- "278.194515"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.792495938"
Evaluating: 0.792495938*360.0
 Parameter: ZPHI <- "285.298538"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.7341832"
 Parameter: YPOS -> "-14.5616234"
 Parameter: ZPOS -> "28.125959"
 Parameter: XPHI -> "123.670468"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.554416    0.832240
    0.000000   -0.832240   -0.554416

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.7341832"
 Parameter: YPOS -> "-14.5616234"
 Parameter: ZPOS -> "28.125959"
 Parameter: YPHI -> "278.194515"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.142534    0.000000    0.989790
    0.000000    1.000000    0.000000
   -0.989790    0.000000    0.142534

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   81.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.7341832"
 Parameter: YPOS -> "-14.5616234"
 Parameter: ZPOS -> "28.125959"
 Parameter: ZPHI -> "285.298538"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.263848   -0.964564    0.000000
    0.964564    0.263848    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   74.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.734183 XMAX =   36.734183 XAVE =   36.734183
    YMIN =  -14.561623 YMAX =  -14.561623 YAVE =  -14.561623
    ZMIN =   28.125959 ZMAX =   28.125959 ZAVE =   28.125959
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.7341832"
Evaluating: 36.7341832+3.5
 Parameter: XMAX <- "40.2341832"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.5616234"
Evaluating: -14.5616234+3.5
 Parameter: YMAX <- "-11.0616234"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.125959"
Evaluating: 28.125959+3.5
 Parameter: ZMAX <- "31.625959"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.7341832"
Evaluating: 36.7341832-3.5
 Parameter: XMIN <- "33.2341832"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.5616234"
Evaluating: -14.5616234-3.5
 Parameter: YMIN <- "-18.0616234"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.125959"
Evaluating: 28.125959-3.5
 Parameter: ZMIN <- "24.625959"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.2341832"
 Parameter: XMIN -> "33.2341832"
 Parameter: YMAX -> "-11.0616234"
 Parameter: YMIN -> "-18.0616234"
 Parameter: ZMAX -> "31.625959"
 Parameter: ZMIN -> "24.625959"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "57" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "57" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.38633925"
Evaluating: 81.6823114*(0.38633925-0.5)
 Parameter: XPOS <- "-9.28407278"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.78098807"
Evaluating: 81.6823114*(0.78098807-0.5)
 Parameter: YPOS <- "22.951755"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.887762357"
Evaluating: 85*(0.887762357-0.5)+0
 Parameter: ZPOS <- "32.9598003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.9598003" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.9598003" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.28407278"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.28407278-0
 Parameter: XTRAN <- "-9.28407278"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.951755"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.951755-0
 Parameter: YTRAN <- "22.951755"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.9598003"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.9598003-0
 Parameter: ZTRAN <- "32.9598003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.28407278"
 Parameter: YTRAN -> "22.951755"
 Parameter: ZTRAN -> "32.9598003"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -9.284073   22.951755   32.959800
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.132461341"
Evaluating: 0.132461341*360.0
 Parameter: XPHI <- "47.6860828"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.979300457"
Evaluating: 0.979300457*360.0
 Parameter: YPHI <- "352.548165"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.766186789E-02"
Evaluating: 8.766186789E-02*360.0
 Parameter: ZPHI <- "31.5582724"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.28407278"
 Parameter: YPOS -> "22.951755"
 Parameter: ZPOS -> "32.9598003"
 Parameter: XPHI -> "47.6860828"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.673192    0.739468
    0.000000   -0.739468    0.673192

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   47.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.28407278"
 Parameter: YPOS -> "22.951755"
 Parameter: ZPOS -> "32.9598003"
 Parameter: YPHI -> "352.548165"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.991554    0.000000    0.129693
    0.000000    1.000000    0.000000
   -0.129693    0.000000    0.991554

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.28407278"
 Parameter: YPOS -> "22.951755"
 Parameter: ZPOS -> "32.9598003"
 Parameter: ZPHI -> "31.5582724"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.852108    0.523365    0.000000
   -0.523365    0.852108    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   31.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.284073 XMAX =   -9.284073 XAVE =   -9.284073
    YMIN =   22.951755 YMAX =   22.951755 YAVE =   22.951755
    ZMIN =   32.959800 ZMAX =   32.959800 ZAVE =   32.959800
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.28407278"
Evaluating: -9.28407278+3.5
 Parameter: XMAX <- "-5.78407278"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.951755"
Evaluating: 22.951755+3.5
 Parameter: YMAX <- "26.451755"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.9598003"
Evaluating: 32.9598003+3.5
 Parameter: ZMAX <- "36.4598003"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.28407278"
Evaluating: -9.28407278-3.5
 Parameter: XMIN <- "-12.7840728"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.951755"
Evaluating: 22.951755-3.5
 Parameter: YMIN <- "19.451755"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.9598003"
Evaluating: 32.9598003-3.5
 Parameter: ZMIN <- "29.4598003"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.78407278"
 Parameter: XMIN -> "-12.7840728"
 Parameter: YMAX -> "26.451755"
 Parameter: YMIN -> "19.451755"
 Parameter: ZMAX -> "36.4598003"
 Parameter: ZMIN -> "29.4598003"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "58" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "58" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "1.578439385E-02"
Evaluating: 81.6823114*(1.578439385E-02-0.5)
 Parameter: XPOS <- "-39.5518499"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.329298447"
Evaluating: 81.6823114*(0.329298447-0.5)
 Parameter: YPOS <- "-13.9432974"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.854145351"
Evaluating: 85*(0.854145351-0.5)+0
 Parameter: ZPOS <- "30.1023548"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.1023548" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.1023548" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.5518499"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.5518499-0
 Parameter: XTRAN <- "-39.5518499"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.9432974"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.9432974-0
 Parameter: YTRAN <- "-13.9432974"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.1023548"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.1023548-0
 Parameter: ZTRAN <- "30.1023548"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.5518499"
 Parameter: YTRAN -> "-13.9432974"
 Parameter: ZTRAN -> "30.1023548"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -39.551850  -13.943297   30.102355
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549425126"
Evaluating: 0.549425126*360.0
 Parameter: XPHI <- "197.793045"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.20782707E-02"
Evaluating: 4.20782707E-02*360.0
 Parameter: YPHI <- "15.1481775"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.576101538E-02"
Evaluating: 5.576101538E-02*360.0
 Parameter: ZPHI <- "20.0739655"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.5518499"
 Parameter: YPOS -> "-13.9432974"
 Parameter: ZPOS -> "30.1023548"
 Parameter: XPHI -> "197.793045"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.952166   -0.305580
    0.000000    0.305580   -0.952166

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.5518499"
 Parameter: YPOS -> "-13.9432974"
 Parameter: ZPOS -> "30.1023548"
 Parameter: YPHI -> "15.1481775"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.965253    0.000000   -0.261316
    0.000000    1.000000    0.000000
    0.261316    0.000000    0.965253

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   15.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.5518499"
 Parameter: YPOS -> "-13.9432974"
 Parameter: ZPOS -> "30.1023548"
 Parameter: ZPHI -> "20.0739655"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.939250    0.343233    0.000000
   -0.343233    0.939250    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   20.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.551850 XMAX =  -39.551850 XAVE =  -39.551850
    YMIN =  -13.943297 YMAX =  -13.943297 YAVE =  -13.943297
    ZMIN =   30.102355 ZMAX =   30.102355 ZAVE =   30.102355
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.5518499"
Evaluating: -39.5518499+3.5
 Parameter: XMAX <- "-36.0518499"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.9432974"
Evaluating: -13.9432974+3.5
 Parameter: YMAX <- "-10.4432974"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.1023548"
Evaluating: 30.1023548+3.5
 Parameter: ZMAX <- "33.6023548"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.5518499"
Evaluating: -39.5518499-3.5
 Parameter: XMIN <- "-43.0518499"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.9432974"
Evaluating: -13.9432974-3.5
 Parameter: YMIN <- "-17.4432974"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.1023548"
Evaluating: 30.1023548-3.5
 Parameter: ZMIN <- "26.6023548"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.0518499"
 Parameter: XMIN -> "-43.0518499"
 Parameter: YMAX -> "-10.4432974"
 Parameter: YMIN -> "-17.4432974"
 Parameter: ZMAX -> "33.6023548"
 Parameter: ZMIN -> "26.6023548"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "59" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "59" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.59534032"
Evaluating: 81.6823114*(0.59534032-0.5)
 Parameter: XPOS <- "7.78761771"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.750435589"
Evaluating: 81.6823114*(0.750435589-0.5)
 Parameter: YPOS <- "20.4561578"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.938339883"
Evaluating: 85*(0.938339883-0.5)+0
 Parameter: ZPOS <- "37.2588901"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.2588901" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.2588901" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.78761771"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.78761771-0
 Parameter: XTRAN <- "7.78761771"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.4561578"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.4561578-0
 Parameter: YTRAN <- "20.4561578"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.2588901"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.2588901-0
 Parameter: ZTRAN <- "37.2588901"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.78761771"
 Parameter: YTRAN -> "20.4561578"
 Parameter: ZTRAN -> "37.2588901"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     7.787618   20.456158   37.258890
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.955486344"
Evaluating: 0.955486344*360.0
 Parameter: XPHI <- "343.975084"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.964396117"
Evaluating: 0.964396117*360.0
 Parameter: YPHI <- "347.182602"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.77476762"
Evaluating: 0.77476762*360.0
 Parameter: ZPHI <- "278.916343"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.78761771"
 Parameter: YPOS -> "20.4561578"
 Parameter: ZPOS -> "37.2588901"
 Parameter: XPHI -> "343.975084"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.961142   -0.276055
    0.000000    0.276055    0.961142

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.78761771"
 Parameter: YPOS -> "20.4561578"
 Parameter: ZPOS -> "37.2588901"
 Parameter: YPHI -> "347.182602"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.975082    0.000000    0.221845
    0.000000    1.000000    0.000000
   -0.221845    0.000000    0.975082

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   12.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.78761771"
 Parameter: YPOS -> "20.4561578"
 Parameter: ZPOS -> "37.2588901"
 Parameter: ZPHI -> "278.916343"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.154992   -0.987916    0.000000
    0.987916    0.154992    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   81.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.787618 XMAX =    7.787618 XAVE =    7.787618
    YMIN =   20.456158 YMAX =   20.456158 YAVE =   20.456158
    ZMIN =   37.258890 ZMAX =   37.258890 ZAVE =   37.258890
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.78761771"
Evaluating: 7.78761771+3.5
 Parameter: XMAX <- "11.2876177"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.4561578"
Evaluating: 20.4561578+3.5
 Parameter: YMAX <- "23.9561578"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.2588901"
Evaluating: 37.2588901+3.5
 Parameter: ZMAX <- "40.7588901"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.78761771"
Evaluating: 7.78761771-3.5
 Parameter: XMIN <- "4.28761771"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.4561578"
Evaluating: 20.4561578-3.5
 Parameter: YMIN <- "16.9561578"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.2588901"
Evaluating: 37.2588901-3.5
 Parameter: ZMIN <- "33.7588901"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.2876177"
 Parameter: XMIN -> "4.28761771"
 Parameter: YMAX -> "23.9561578"
 Parameter: YMIN -> "16.9561578"
 Parameter: ZMAX -> "40.7588901"
 Parameter: ZMIN -> "33.7588901"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      1 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26579 POS      POT      59       POT     -**** POS      POT      4        POT           1.6421
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "59" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.467656539"
Evaluating: 81.6823114*(0.467656539-0.5)
 Parameter: XPOS <- "-2.64188865"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.315361608"
Evaluating: 81.6823114*(0.315361608-0.5)
 Parameter: YPOS <- "-15.0816906"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.356035449"
Evaluating: 85*(0.356035449-0.5)+0
 Parameter: ZPOS <- "-12.2369868"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.2369868" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.2369868" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "59" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.846724257"
Evaluating: 81.6823114*(0.846724257-0.5)
 Parameter: XPOS <- "28.3212387"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.260603169"
Evaluating: 81.6823114*(0.260603169-0.5)
 Parameter: YPOS <- "-19.5544865"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.562401438"
Evaluating: 85*(0.562401438-0.5)+0
 Parameter: ZPOS <- "5.30412223"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.30412223" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.30412223" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "59" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.959684522"
Evaluating: 81.6823114*(0.959684522-0.5)
 Parameter: XPOS <- "37.5480943"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.736204981"
Evaluating: 81.6823114*(0.736204981-0.5)
 Parameter: YPOS <- "19.2937688"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.639317832"
Evaluating: 85*(0.639317832-0.5)+0
 Parameter: ZPOS <- "11.8420157"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.8420157" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.8420157" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "59" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.402971446"
Evaluating: 81.6823114*(0.402971446-0.5)
 Parameter: XPOS <- "-7.92551656"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "2.493825503E-02"
Evaluating: 81.6823114*(2.493825503E-02-0.5)
 Parameter: YPOS <- "-38.8041414"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "6.723981443E-02"
Evaluating: 85*(6.723981443E-02-0.5)+0
 Parameter: ZPOS <- "-36.7846158"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.7846158" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.787618 XMAX =    7.787618 XAVE =    7.787618
    YMIN =   20.456158 YMAX =   20.456158 YAVE =   20.456158
    ZMIN =   37.258890 ZMAX =   37.258890 ZAVE =   37.258890
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.92551656"
 RDCMND substituted energy or value "?XAVE" to "7.78761771"
Evaluating: -7.92551656-7.78761771
 Parameter: XTRAN <- "-15.7131343"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.8041414"
 RDCMND substituted energy or value "?YAVE" to "20.4561578"
Evaluating: -38.8041414-20.4561578
 Parameter: YTRAN <- "-59.2602992"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.7846158"
 RDCMND substituted energy or value "?ZAVE" to "37.2588901"
Evaluating: -36.7846158-37.2588901
 Parameter: ZTRAN <- "-74.0435059"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.7131343"
 Parameter: YTRAN -> "-59.2602992"
 Parameter: ZTRAN -> "-74.0435059"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -15.713134  -59.260299  -74.043506
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.466233341"
Evaluating: 0.466233341*360.0
 Parameter: XPHI <- "167.844003"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.207880529"
Evaluating: 0.207880529*360.0
 Parameter: YPHI <- "74.8369904"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.742186086E-02"
Evaluating: 4.742186086E-02*360.0
 Parameter: ZPHI <- "17.0718699"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.92551656"
 Parameter: YPOS -> "-38.8041414"
 Parameter: ZPOS -> "-36.7846158"
 Parameter: XPHI -> "167.844003"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.977578    0.210574
    0.000000   -0.210574   -0.977578

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  167.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.92551656"
 Parameter: YPOS -> "-38.8041414"
 Parameter: ZPOS -> "-36.7846158"
 Parameter: YPHI -> "74.8369904"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.261566    0.000000   -0.965186
    0.000000    1.000000    0.000000
    0.965186    0.000000    0.261566

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   74.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.92551656"
 Parameter: YPOS -> "-38.8041414"
 Parameter: ZPOS -> "-36.7846158"
 Parameter: ZPHI -> "17.0718699"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.955937    0.293571    0.000000
   -0.293571    0.955937    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.925517 XMAX =   -7.925517 XAVE =   -7.925517
    YMIN =  -38.804141 YMAX =  -38.804141 YAVE =  -38.804141
    ZMIN =  -36.784616 ZMAX =  -36.784616 ZAVE =  -36.784616
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.92551657"
Evaluating: -7.92551657+3.5
 Parameter: XMAX <- "-4.42551657"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.8041414"
Evaluating: -38.8041414+3.5
 Parameter: YMAX <- "-35.3041414"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.7846158"
Evaluating: -36.7846158+3.5
 Parameter: ZMAX <- "-33.2846158"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.92551657"
Evaluating: -7.92551657-3.5
 Parameter: XMIN <- "-11.4255166"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.8041414"
Evaluating: -38.8041414-3.5
 Parameter: YMIN <- "-42.3041414"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.7846158"
Evaluating: -36.7846158-3.5
 Parameter: ZMIN <- "-40.2846158"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.42551657"
 Parameter: XMIN -> "-11.4255166"
 Parameter: YMAX -> "-35.3041414"
 Parameter: YMIN -> "-42.3041414"
 Parameter: ZMAX -> "-33.2846158"
 Parameter: ZMIN -> "-40.2846158"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "60" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "60" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.629629223"
Evaluating: 81.6823114*(0.629629223-0.5)
 Parameter: XPOS <- "10.5884146"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.339529432"
Evaluating: 81.6823114*(0.339529432-0.5)
 Parameter: YPOS <- "-13.1076069"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.978438697"
Evaluating: 85*(0.978438697-0.5)+0
 Parameter: ZPOS <- "40.6672892"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.6672892" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.6672892" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.5884146"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.5884146-0
 Parameter: XTRAN <- "10.5884146"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.1076069"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.1076069-0
 Parameter: YTRAN <- "-13.1076069"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.6672892"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.6672892-0
 Parameter: ZTRAN <- "40.6672892"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.5884146"
 Parameter: YTRAN -> "-13.1076069"
 Parameter: ZTRAN -> "40.6672892"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    10.588415  -13.107607   40.667289
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.982077115"
Evaluating: 0.982077115*360.0
 Parameter: XPHI <- "353.547761"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190785916"
Evaluating: 0.190785916*360.0
 Parameter: YPHI <- "68.6829298"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777465271"
Evaluating: 0.777465271*360.0
 Parameter: ZPHI <- "279.887498"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.5884146"
 Parameter: YPOS -> "-13.1076069"
 Parameter: ZPOS -> "40.6672892"
 Parameter: XPHI -> "353.547761"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.993666   -0.112375
    0.000000    0.112375    0.993666

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    6.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.5884146"
 Parameter: YPOS -> "-13.1076069"
 Parameter: ZPOS -> "40.6672892"
 Parameter: YPHI -> "68.6829298"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.363529    0.000000   -0.931583
    0.000000    1.000000    0.000000
    0.931583    0.000000    0.363529

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.5884146"
 Parameter: YPOS -> "-13.1076069"
 Parameter: ZPOS -> "40.6672892"
 Parameter: ZPHI -> "279.887498"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.171714   -0.985147    0.000000
    0.985147    0.171714    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   80.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.588415 XMAX =   10.588415 XAVE =   10.588415
    YMIN =  -13.107607 YMAX =  -13.107607 YAVE =  -13.107607
    ZMIN =   40.667289 ZMAX =   40.667289 ZAVE =   40.667289
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.5884146"
Evaluating: 10.5884146+3.5
 Parameter: XMAX <- "14.0884146"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.1076069"
Evaluating: -13.1076069+3.5
 Parameter: YMAX <- "-9.6076069"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.6672892"
Evaluating: 40.6672892+3.5
 Parameter: ZMAX <- "44.1672892"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.5884146"
Evaluating: 10.5884146-3.5
 Parameter: XMIN <- "7.0884146"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.1076069"
Evaluating: -13.1076069-3.5
 Parameter: YMIN <- "-16.6076069"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.6672892"
Evaluating: 40.6672892-3.5
 Parameter: ZMIN <- "37.1672892"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.0884146"
 Parameter: XMIN -> "7.0884146"
 Parameter: YMAX -> "-9.6076069"
 Parameter: YMIN -> "-16.6076069"
 Parameter: ZMAX -> "44.1672892"
 Parameter: ZMIN -> "37.1672892"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      1 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26580 POS      POT      60       POT     -**** POS      POT      55       POT           3.4927
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "60" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.2949565"
Evaluating: 81.6823114*(0.2949565-0.5)
 Parameter: XPOS <- "-16.748427"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.631156036"
Evaluating: 81.6823114*(0.631156036-0.5)
 Parameter: YPOS <- "10.7131282"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.99426424E-02"
Evaluating: 85*(3.99426424E-02-0.5)+0
 Parameter: ZPOS <- "-39.1048754"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.1048754" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.588415 XMAX =   10.588415 XAVE =   10.588415
    YMIN =  -13.107607 YMAX =  -13.107607 YAVE =  -13.107607
    ZMIN =   40.667289 ZMAX =   40.667289 ZAVE =   40.667289
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.748427"
 RDCMND substituted energy or value "?XAVE" to "10.5884146"
Evaluating: -16.748427-10.5884146
 Parameter: XTRAN <- "-27.3368416"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.7131282"
 RDCMND substituted energy or value "?YAVE" to "-13.1076069"
Evaluating: 10.7131282--13.1076069
 Parameter: YTRAN <- "23.8207351"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.1048754"
 RDCMND substituted energy or value "?ZAVE" to "40.6672892"
Evaluating: -39.1048754-40.6672892
 Parameter: ZTRAN <- "-79.7721646"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.3368416"
 Parameter: YTRAN -> "23.8207351"
 Parameter: ZTRAN -> "-79.7721646"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -27.336842   23.820735  -79.772165
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678023687"
Evaluating: 0.678023687*360.0
 Parameter: XPHI <- "244.088527"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.780989878"
Evaluating: 0.780989878*360.0
 Parameter: YPHI <- "281.156356"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.483222582"
Evaluating: 0.483222582*360.0
 Parameter: ZPHI <- "173.96013"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.748427"
 Parameter: YPOS -> "10.7131282"
 Parameter: ZPOS -> "-39.1048754"
 Parameter: XPHI -> "244.088527"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.436982   -0.899470
    0.000000    0.899470   -0.436982

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.748427"
 Parameter: YPOS -> "10.7131282"
 Parameter: ZPOS -> "-39.1048754"
 Parameter: YPHI -> "281.156356"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.193487    0.000000    0.981103
    0.000000    1.000000    0.000000
   -0.981103    0.000000    0.193487

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   78.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.748427"
 Parameter: YPOS -> "10.7131282"
 Parameter: ZPOS -> "-39.1048754"
 Parameter: ZPHI -> "173.96013"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.994449    0.105220    0.000000
   -0.105220   -0.994449    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  173.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.748427 XMAX =  -16.748427 XAVE =  -16.748427
    YMIN =   10.713128 YMAX =   10.713128 YAVE =   10.713128
    ZMIN =  -39.104875 ZMAX =  -39.104875 ZAVE =  -39.104875
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.748427"
Evaluating: -16.748427+3.5
 Parameter: XMAX <- "-13.248427"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.7131282"
Evaluating: 10.7131282+3.5
 Parameter: YMAX <- "14.2131282"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.1048754"
Evaluating: -39.1048754+3.5
 Parameter: ZMAX <- "-35.6048754"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.748427"
Evaluating: -16.748427-3.5
 Parameter: XMIN <- "-20.248427"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.7131282"
Evaluating: 10.7131282-3.5
 Parameter: YMIN <- "7.2131282"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.1048754"
Evaluating: -39.1048754-3.5
 Parameter: ZMIN <- "-42.6048754"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.248427"
 Parameter: XMIN -> "-20.248427"
 Parameter: YMAX -> "14.2131282"
 Parameter: YMIN -> "7.2131282"
 Parameter: ZMAX -> "-35.6048754"
 Parameter: ZMIN -> "-42.6048754"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "61" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "61" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.264609345"
Evaluating: 81.6823114*(0.264609345-0.5)
 Parameter: XPOS <- "-19.2272528"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "6.836388923E-02"
Evaluating: 81.6823114*(6.836388923E-02-0.5)
 Parameter: YPOS <- "-35.2570352"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.601425571"
Evaluating: 85*(0.601425571-0.5)+0
 Parameter: ZPOS <- "8.62117354"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.62117354" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.62117354" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "61" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.413860671"
Evaluating: 81.6823114*(0.413860671-0.5)
 Parameter: XPOS <- "-7.0360595"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.787848043"
Evaluating: 81.6823114*(0.787848043-0.5)
 Parameter: YPOS <- "23.5120935"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.546852943"
Evaluating: 85*(0.546852943-0.5)+0
 Parameter: ZPOS <- "3.98250015"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.98250015" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.98250015" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "61" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.661455222"
Evaluating: 81.6823114*(0.661455222-0.5)
 Parameter: XPOS <- "13.1880357"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.114323696"
Evaluating: 81.6823114*(0.114323696-0.5)
 Parameter: YPOS <- "-31.502932"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.756573639"
Evaluating: 85*(0.756573639-0.5)+0
 Parameter: ZPOS <- "21.8087593"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.8087593" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.8087593" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.1880357"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.1880357-0
 Parameter: XTRAN <- "13.1880357"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.502932"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.502932-0
 Parameter: YTRAN <- "-31.502932"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.8087593"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.8087593-0
 Parameter: ZTRAN <- "21.8087593"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.1880357"
 Parameter: YTRAN -> "-31.502932"
 Parameter: ZTRAN -> "21.8087593"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    13.188036  -31.502932   21.808759
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.96301135"
Evaluating: 0.96301135*360.0
 Parameter: XPHI <- "346.684086"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691453359"
Evaluating: 0.691453359*360.0
 Parameter: YPHI <- "248.923209"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.625800275"
Evaluating: 0.625800275*360.0
 Parameter: ZPHI <- "225.288099"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.1880357"
 Parameter: YPOS -> "-31.502932"
 Parameter: ZPOS -> "21.8087593"
 Parameter: XPHI -> "346.684086"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.973115   -0.230320
    0.000000    0.230320    0.973115

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   13.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.1880357"
 Parameter: YPOS -> "-31.502932"
 Parameter: ZPOS -> "21.8087593"
 Parameter: YPHI -> "248.923209"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.359619    0.000000    0.933099
    0.000000    1.000000    0.000000
   -0.933099    0.000000   -0.359619

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  111.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.1880357"
 Parameter: YPOS -> "-31.502932"
 Parameter: ZPOS -> "21.8087593"
 Parameter: ZPHI -> "225.288099"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.703542   -0.710653    0.000000
    0.710653   -0.703542    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  134.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.188036 XMAX =   13.188036 XAVE =   13.188036
    YMIN =  -31.502932 YMAX =  -31.502932 YAVE =  -31.502932
    ZMIN =   21.808759 ZMAX =   21.808759 ZAVE =   21.808759
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.1880357"
Evaluating: 13.1880357+3.5
 Parameter: XMAX <- "16.6880357"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.502932"
Evaluating: -31.502932+3.5
 Parameter: YMAX <- "-28.002932"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.8087593"
Evaluating: 21.8087593+3.5
 Parameter: ZMAX <- "25.3087593"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.1880357"
Evaluating: 13.1880357-3.5
 Parameter: XMIN <- "9.6880357"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.502932"
Evaluating: -31.502932-3.5
 Parameter: YMIN <- "-35.002932"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.8087593"
Evaluating: 21.8087593-3.5
 Parameter: ZMIN <- "18.3087593"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.6880357"
 Parameter: XMIN -> "9.6880357"
 Parameter: YMAX -> "-28.002932"
 Parameter: YMIN -> "-35.002932"
 Parameter: ZMAX -> "25.3087593"
 Parameter: ZMIN -> "18.3087593"
 SELRPN>     18 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      7 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26581 POS      POT      61       POT     -7301 MEMB     POPC     56       N             2.8917
26581 POS      POT      61       POT     -7302 MEMB     POPC     56       C12           3.1754
26581 POS      POT      61       POT     -7309 MEMB     POPC     56       C14           3.3483
26581 POS      POT      61       POT     -7313 MEMB     POPC     56       C15           1.8937
26581 POS      POT      61       POT     -7317 MEMB     POPC     56       C11           3.4553
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "61" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.23494528"
Evaluating: 81.6823114*(0.23494528-0.5)
 Parameter: XPOS <- "-21.6502822"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "7.305529019E-02"
Evaluating: 81.6823114*(7.305529019E-02-0.5)
 Parameter: YPOS <- "-34.8738307"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.128700275"
Evaluating: 85*(0.128700275-0.5)+0
 Parameter: ZPOS <- "-31.5604766"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.5604766" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.188036 XMAX =   13.188036 XAVE =   13.188036
    YMIN =  -31.502932 YMAX =  -31.502932 YAVE =  -31.502932
    ZMIN =   21.808759 ZMAX =   21.808759 ZAVE =   21.808759
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.6502822"
 RDCMND substituted energy or value "?XAVE" to "13.1880357"
Evaluating: -21.6502822-13.1880357
 Parameter: XTRAN <- "-34.8383179"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.8738307"
 RDCMND substituted energy or value "?YAVE" to "-31.502932"
Evaluating: -34.8738307--31.502932
 Parameter: YTRAN <- "-3.3708987"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.5604766"
 RDCMND substituted energy or value "?ZAVE" to "21.8087593"
Evaluating: -31.5604766-21.8087593
 Parameter: ZTRAN <- "-53.3692359"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.8383179"
 Parameter: YTRAN -> "-3.3708987"
 Parameter: ZTRAN -> "-53.3692359"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -34.838318   -3.370899  -53.369236
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671726121"
Evaluating: 0.671726121*360.0
 Parameter: XPHI <- "241.821404"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.345328863"
Evaluating: 0.345328863*360.0
 Parameter: YPHI <- "124.318391"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.430114721"
Evaluating: 0.430114721*360.0
 Parameter: ZPHI <- "154.8413"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.6502822"
 Parameter: YPOS -> "-34.8738307"
 Parameter: ZPOS -> "-31.5604766"
 Parameter: XPHI -> "241.821404"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.472222   -0.881480
    0.000000    0.881480   -0.472222

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.6502822"
 Parameter: YPOS -> "-34.8738307"
 Parameter: ZPOS -> "-31.5604766"
 Parameter: YPHI -> "124.318391"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.563791    0.000000   -0.825917
    0.000000    1.000000    0.000000
    0.825917    0.000000   -0.563791

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.6502822"
 Parameter: YPOS -> "-34.8738307"
 Parameter: ZPOS -> "-31.5604766"
 Parameter: ZPHI -> "154.8413"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.905134    0.425127    0.000000
   -0.425127   -0.905134    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.650282 XMAX =  -21.650282 XAVE =  -21.650282
    YMIN =  -34.873831 YMAX =  -34.873831 YAVE =  -34.873831
    ZMIN =  -31.560477 ZMAX =  -31.560477 ZAVE =  -31.560477
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.6502822"
Evaluating: -21.6502822+3.5
 Parameter: XMAX <- "-18.1502822"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.8738307"
Evaluating: -34.8738307+3.5
 Parameter: YMAX <- "-31.3738307"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.5604766"
Evaluating: -31.5604766+3.5
 Parameter: ZMAX <- "-28.0604766"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.6502822"
Evaluating: -21.6502822-3.5
 Parameter: XMIN <- "-25.1502822"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.8738307"
Evaluating: -34.8738307-3.5
 Parameter: YMIN <- "-38.3738307"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.5604766"
Evaluating: -31.5604766-3.5
 Parameter: ZMIN <- "-35.0604766"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.1502822"
 Parameter: XMIN -> "-25.1502822"
 Parameter: YMAX -> "-31.3738307"
 Parameter: YMIN -> "-38.3738307"
 Parameter: ZMAX -> "-28.0604766"
 Parameter: ZMIN -> "-35.0604766"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "62" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "62" and "62".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.415764185"
Evaluating: 81.6823114*(0.415764185-0.5)
 Parameter: XPOS <- "-6.88057607"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.191446043"
Evaluating: 81.6823114*(0.191446043-0.5)
 Parameter: YPOS <- "-25.2034004"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.957106844"
Evaluating: 85*(0.957106844-0.5)+0
 Parameter: ZPOS <- "38.8540817"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.8540817" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.8540817" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.88057607"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.88057607-0
 Parameter: XTRAN <- "-6.88057607"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.2034004"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.2034004-0
 Parameter: YTRAN <- "-25.2034004"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.8540817"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.8540817-0
 Parameter: ZTRAN <- "38.8540817"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.88057607"
 Parameter: YTRAN -> "-25.2034004"
 Parameter: ZTRAN -> "38.8540817"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -6.880576  -25.203400   38.854082
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.667897757"
Evaluating: 0.667897757*360.0
 Parameter: XPHI <- "240.443193"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.08653856E-02"
Evaluating: 7.08653856E-02*360.0
 Parameter: YPHI <- "25.5115388"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453491612"
Evaluating: 0.453491612*360.0
 Parameter: ZPHI <- "163.25698"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.88057607"
 Parameter: YPOS -> "-25.2034004"
 Parameter: ZPOS -> "38.8540817"
 Parameter: XPHI -> "240.443193"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.493286   -0.869867
    0.000000    0.869867   -0.493286

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  119.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.88057607"
 Parameter: YPOS -> "-25.2034004"
 Parameter: ZPOS -> "38.8540817"
 Parameter: YPHI -> "25.5115388"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.902499    0.000000   -0.430693
    0.000000    1.000000    0.000000
    0.430693    0.000000    0.902499

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   25.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.88057607"
 Parameter: YPOS -> "-25.2034004"
 Parameter: ZPOS -> "38.8540817"
 Parameter: ZPHI -> "163.25698"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.957606    0.288080    0.000000
   -0.288080   -0.957606    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.880576 XMAX =   -6.880576 XAVE =   -6.880576
    YMIN =  -25.203400 YMAX =  -25.203400 YAVE =  -25.203400
    ZMIN =   38.854082 ZMAX =   38.854082 ZAVE =   38.854082
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.88057607"
Evaluating: -6.88057607+3.5
 Parameter: XMAX <- "-3.38057607"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.2034004"
Evaluating: -25.2034004+3.5
 Parameter: YMAX <- "-21.7034004"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.8540817"
Evaluating: 38.8540817+3.5
 Parameter: ZMAX <- "42.3540817"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.88057607"
Evaluating: -6.88057607-3.5
 Parameter: XMIN <- "-10.3805761"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.2034004"
Evaluating: -25.2034004-3.5
 Parameter: YMIN <- "-28.7034004"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.8540817"
Evaluating: 38.8540817-3.5
 Parameter: ZMIN <- "35.3540817"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.38057607"
 Parameter: XMIN -> "-10.3805761"
 Parameter: YMAX -> "-21.7034004"
 Parameter: YMIN -> "-28.7034004"
 Parameter: ZMAX -> "42.3540817"
 Parameter: ZMIN -> "35.3540817"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "63" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "63" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "63"
 Parameter: NPOS -> "62"
Evaluating: 63-62
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.105546976"
Evaluating: 81.6823114*(0.105546976-0.5)
 Parameter: XPOS <- "-32.2198347"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "8.183576638E-02"
Evaluating: 81.6823114*(8.183576638E-02-0.5)
 Parameter: YPOS <- "-34.1566211"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.190885292"
Evaluating: 85*(0.190885292-0.5)+0
 Parameter: ZPOS <- "-26.2747502"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.2747502" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.2198347"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.2198347-0
 Parameter: XTRAN <- "-32.2198347"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.1566211"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.1566211-0
 Parameter: YTRAN <- "-34.1566211"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.2747502"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.2747502-0
 Parameter: ZTRAN <- "-26.2747502"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.2198347"
 Parameter: YTRAN -> "-34.1566211"
 Parameter: ZTRAN -> "-26.2747502"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -32.219835  -34.156621  -26.274750
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.359471398"
Evaluating: 0.359471398*360.0
 Parameter: XPHI <- "129.409703"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.387368854"
Evaluating: 0.387368854*360.0
 Parameter: YPHI <- "139.452787"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.982443255"
Evaluating: 0.982443255*360.0
 Parameter: ZPHI <- "353.679572"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.2198347"
 Parameter: YPOS -> "-34.1566211"
 Parameter: ZPOS -> "-26.2747502"
 Parameter: XPHI -> "129.409703"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.634861    0.772626
    0.000000   -0.772626   -0.634861

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  129.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.2198347"
 Parameter: YPOS -> "-34.1566211"
 Parameter: ZPOS -> "-26.2747502"
 Parameter: YPHI -> "139.452787"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.759871    0.000000   -0.650074
    0.000000    1.000000    0.000000
    0.650074    0.000000   -0.759871

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  139.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.2198347"
 Parameter: YPOS -> "-34.1566211"
 Parameter: ZPOS -> "-26.2747502"
 Parameter: ZPHI -> "353.679572"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.993922   -0.110089    0.000000
    0.110089    0.993922    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    6.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.219835 XMAX =  -32.219835 XAVE =  -32.219835
    YMIN =  -34.156621 YMAX =  -34.156621 YAVE =  -34.156621
    ZMIN =  -26.274750 ZMAX =  -26.274750 ZAVE =  -26.274750
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.2198347"
Evaluating: -32.2198347+3.5
 Parameter: XMAX <- "-28.7198347"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.1566211"
Evaluating: -34.1566211+3.5
 Parameter: YMAX <- "-30.6566211"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.2747502"
Evaluating: -26.2747502+3.5
 Parameter: ZMAX <- "-22.7747502"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.2198347"
Evaluating: -32.2198347-3.5
 Parameter: XMIN <- "-35.7198347"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.1566211"
Evaluating: -34.1566211-3.5
 Parameter: YMIN <- "-37.6566211"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.2747502"
Evaluating: -26.2747502-3.5
 Parameter: ZMIN <- "-29.7747502"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.7198347"
 Parameter: XMIN -> "-35.7198347"
 Parameter: YMAX -> "-30.6566211"
 Parameter: YMIN -> "-37.6566211"
 Parameter: ZMAX -> "-22.7747502"
 Parameter: ZMIN -> "-29.7747502"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "64" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "64" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "64"
 Parameter: NPOS -> "62"
Evaluating: 64-62
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.858740422"
Evaluating: 81.6823114*(0.858740422-0.5)
 Parameter: XPOS <- "29.3027469"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.120792635"
Evaluating: 81.6823114*(0.120792635-0.5)
 Parameter: YPOS <- "-30.9745341"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.503795487"
Evaluating: 85*(0.503795487-0.5)+0
 Parameter: ZPOS <- "0.322616395"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.322616395" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.322616395" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "64" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "64"
 Parameter: NPOS -> "62"
Evaluating: 64-62
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.659756543"
Evaluating: 81.6823114*(0.659756543-0.5)
 Parameter: XPOS <- "13.0492837"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.429792284"
Evaluating: 81.6823114*(0.429792284-0.5)
 Parameter: YPOS <- "-5.73472852"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.76963595"
Evaluating: 85*(0.76963595-0.5)+0
 Parameter: ZPOS <- "22.9190558"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.9190558" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.9190558" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.0492837"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.0492837-0
 Parameter: XTRAN <- "13.0492837"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.73472852"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.73472852-0
 Parameter: YTRAN <- "-5.73472852"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.9190558"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.9190558-0
 Parameter: ZTRAN <- "22.9190558"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.0492837"
 Parameter: YTRAN -> "-5.73472852"
 Parameter: ZTRAN -> "22.9190558"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    13.049284   -5.734729   22.919056
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.884878977"
Evaluating: 0.884878977*360.0
 Parameter: XPHI <- "318.556432"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.772776629"
Evaluating: 0.772776629*360.0
 Parameter: YPHI <- "278.199586"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.349355896"
Evaluating: 0.349355896*360.0
 Parameter: ZPHI <- "125.768123"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.0492837"
 Parameter: YPOS -> "-5.73472852"
 Parameter: ZPOS -> "22.9190558"
 Parameter: XPHI -> "318.556432"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.749608   -0.661882
    0.000000    0.661882    0.749608

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   41.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.0492837"
 Parameter: YPOS -> "-5.73472852"
 Parameter: ZPOS -> "22.9190558"
 Parameter: YPHI -> "278.199586"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.142622    0.000000    0.989777
    0.000000    1.000000    0.000000
   -0.989777    0.000000    0.142622

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   81.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.0492837"
 Parameter: YPOS -> "-5.73472852"
 Parameter: ZPOS -> "22.9190558"
 Parameter: ZPHI -> "125.768123"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.584506    0.811389    0.000000
   -0.811389   -0.584506    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  125.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.049284 XMAX =   13.049284 XAVE =   13.049284
    YMIN =   -5.734729 YMAX =   -5.734729 YAVE =   -5.734729
    ZMIN =   22.919056 ZMAX =   22.919056 ZAVE =   22.919056
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.0492837"
Evaluating: 13.0492837+3.5
 Parameter: XMAX <- "16.5492837"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.73472852"
Evaluating: -5.73472852+3.5
 Parameter: YMAX <- "-2.23472852"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.9190558"
Evaluating: 22.9190558+3.5
 Parameter: ZMAX <- "26.4190558"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.0492837"
Evaluating: 13.0492837-3.5
 Parameter: XMIN <- "9.5492837"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.73472852"
Evaluating: -5.73472852-3.5
 Parameter: YMIN <- "-9.23472852"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.9190558"
Evaluating: 22.9190558-3.5
 Parameter: ZMIN <- "19.4190558"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.5492837"
 Parameter: XMIN -> "9.5492837"
 Parameter: YMAX -> "-2.23472852"
 Parameter: YMIN -> "-9.23472852"
 Parameter: ZMAX -> "26.4190558"
 Parameter: ZMIN -> "19.4190558"
 SELRPN>      9 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      4 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "65" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "65" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "65"
 Parameter: NPOS -> "62"
Evaluating: 65-62
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.775003056"
Evaluating: 81.6823114*(0.775003056-0.5)
 Parameter: XPOS <- "22.4628853"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.664609639"
Evaluating: 81.6823114*(0.664609639-0.5)
 Parameter: YPOS <- "13.4456958"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.823642029E-02"
Evaluating: 85*(3.823642029E-02-0.5)+0
 Parameter: ZPOS <- "-39.2499043"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.2499043" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.4628853"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.4628853-0
 Parameter: XTRAN <- "22.4628853"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.4456958"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.4456958-0
 Parameter: YTRAN <- "13.4456958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.2499043"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.2499043-0
 Parameter: ZTRAN <- "-39.2499043"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.4628853"
 Parameter: YTRAN -> "13.4456958"
 Parameter: ZTRAN -> "-39.2499043"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    22.462885   13.445696  -39.249904
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.351892724"
Evaluating: 0.351892724*360.0
 Parameter: XPHI <- "126.681381"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.871059744"
Evaluating: 0.871059744*360.0
 Parameter: YPHI <- "313.581508"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.954689034"
Evaluating: 0.954689034*360.0
 Parameter: ZPHI <- "343.688052"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.4628853"
 Parameter: YPOS -> "13.4456958"
 Parameter: ZPOS -> "-39.2499043"
 Parameter: XPHI -> "126.681381"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.597365    0.801970
    0.000000   -0.801970   -0.597365

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  126.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.4628853"
 Parameter: YPOS -> "13.4456958"
 Parameter: ZPOS -> "-39.2499043"
 Parameter: YPHI -> "313.581508"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.689386    0.000000    0.724394
    0.000000    1.000000    0.000000
   -0.724394    0.000000    0.689386

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   46.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.4628853"
 Parameter: YPOS -> "13.4456958"
 Parameter: ZPOS -> "-39.2499043"
 Parameter: ZPHI -> "343.688052"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.959747   -0.280867    0.000000
    0.280867    0.959747    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   16.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.462885 XMAX =   22.462885 XAVE =   22.462885
    YMIN =   13.445696 YMAX =   13.445696 YAVE =   13.445696
    ZMIN =  -39.249904 ZMAX =  -39.249904 ZAVE =  -39.249904
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.4628853"
Evaluating: 22.4628853+3.5
 Parameter: XMAX <- "25.9628853"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.4456958"
Evaluating: 13.4456958+3.5
 Parameter: YMAX <- "16.9456958"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.2499043"
Evaluating: -39.2499043+3.5
 Parameter: ZMAX <- "-35.7499043"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.4628853"
Evaluating: 22.4628853-3.5
 Parameter: XMIN <- "18.9628853"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.4456958"
Evaluating: 13.4456958-3.5
 Parameter: YMIN <- "9.9456958"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.2499043"
Evaluating: -39.2499043-3.5
 Parameter: ZMIN <- "-42.7499043"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.9628853"
 Parameter: XMIN -> "18.9628853"
 Parameter: YMAX -> "16.9456958"
 Parameter: YMIN -> "9.9456958"
 Parameter: ZMAX -> "-35.7499043"
 Parameter: ZMIN -> "-42.7499043"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "66" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "66" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "66"
 Parameter: NPOS -> "62"
Evaluating: 66-62
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.895669489"
Evaluating: 81.6823114*(0.895669489-0.5)
 Parameter: XPOS <- "32.3191984"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.576885552"
Evaluating: 81.6823114*(0.576885552-0.5)
 Parameter: YPOS <- "6.2801896"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "3.314736038E-02"
Evaluating: 85*(3.314736038E-02-0.5)+0
 Parameter: ZPOS <- "-39.6824744"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.6824744" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.3191984"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.3191984-0
 Parameter: XTRAN <- "32.3191984"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.2801896"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.2801896-0
 Parameter: YTRAN <- "6.2801896"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.6824744"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.6824744-0
 Parameter: ZTRAN <- "-39.6824744"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.3191984"
 Parameter: YTRAN -> "6.2801896"
 Parameter: ZTRAN -> "-39.6824744"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    32.319198    6.280190  -39.682474
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.427452654"
Evaluating: 0.427452654*360.0
 Parameter: XPHI <- "153.882955"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.645742864"
Evaluating: 0.645742864*360.0
 Parameter: YPHI <- "232.467431"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.465875978"
Evaluating: 0.465875978*360.0
 Parameter: ZPHI <- "167.715352"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.3191984"
 Parameter: YPOS -> "6.2801896"
 Parameter: ZPOS -> "-39.6824744"
 Parameter: XPHI -> "153.882955"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.897897    0.440206
    0.000000   -0.440206   -0.897897

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  153.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.3191984"
 Parameter: YPOS -> "6.2801896"
 Parameter: ZPOS -> "-39.6824744"
 Parameter: YPHI -> "232.467431"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.609212    0.000000    0.793007
    0.000000    1.000000    0.000000
   -0.793007    0.000000   -0.609212

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  127.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.3191984"
 Parameter: YPOS -> "6.2801896"
 Parameter: ZPOS -> "-39.6824744"
 Parameter: ZPHI -> "167.715352"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.977103    0.212769    0.000000
   -0.212769   -0.977103    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  167.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.319198 XMAX =   32.319198 XAVE =   32.319198
    YMIN =    6.280190 YMAX =    6.280190 YAVE =    6.280190
    ZMIN =  -39.682474 ZMAX =  -39.682474 ZAVE =  -39.682474
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.3191984"
Evaluating: 32.3191984+3.5
 Parameter: XMAX <- "35.8191984"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.2801896"
Evaluating: 6.2801896+3.5
 Parameter: YMAX <- "9.7801896"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.6824744"
Evaluating: -39.6824744+3.5
 Parameter: ZMAX <- "-36.1824744"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.3191984"
Evaluating: 32.3191984-3.5
 Parameter: XMIN <- "28.8191984"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.2801896"
Evaluating: 6.2801896-3.5
 Parameter: YMIN <- "2.7801896"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.6824744"
Evaluating: -39.6824744-3.5
 Parameter: ZMIN <- "-43.1824744"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.8191984"
 Parameter: XMIN -> "28.8191984"
 Parameter: YMAX -> "9.7801896"
 Parameter: YMIN -> "2.7801896"
 Parameter: ZMAX -> "-36.1824744"
 Parameter: ZMIN -> "-43.1824744"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "67" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "67" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "67"
 Parameter: NPOS -> "62"
Evaluating: 67-62
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.536671238"
Evaluating: 81.6823114*(0.536671238-0.5)
 Parameter: XPOS <- "2.99539148"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.228098215"
Evaluating: 81.6823114*(0.228098215-0.5)
 Parameter: YPOS <- "-22.2095663"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.380125498"
Evaluating: 85*(0.380125498-0.5)+0
 Parameter: ZPOS <- "-10.1893327"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.1893327" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.1893327" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "67" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "67"
 Parameter: NPOS -> "62"
Evaluating: 67-62
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.963036996"
Evaluating: 81.6823114*(0.963036996-0.5)
 Parameter: XPOS <- "37.8219321"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.639198491"
Evaluating: 81.6823114*(0.639198491-0.5)
 Parameter: YPOS <- "11.3700545"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.618609923"
Evaluating: 85*(0.618609923-0.5)+0
 Parameter: ZPOS <- "10.0818435"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.0818435" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.0818435" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "67" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "67"
 Parameter: NPOS -> "62"
Evaluating: 67-62
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.856707136"
Evaluating: 81.6823114*(0.856707136-0.5)
 Parameter: XPOS <- "29.1366634"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.62753587"
Evaluating: 81.6823114*(0.62753587-0.5)
 Parameter: YPOS <- "10.4174246"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "2.293552773E-02"
Evaluating: 85*(2.293552773E-02-0.5)+0
 Parameter: ZPOS <- "-40.5504801"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.5504801" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.1366634"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.1366634-0
 Parameter: XTRAN <- "29.1366634"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.4174246"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.4174246-0
 Parameter: YTRAN <- "10.4174246"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.5504801"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.5504801-0
 Parameter: ZTRAN <- "-40.5504801"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.1366634"
 Parameter: YTRAN -> "10.4174246"
 Parameter: ZTRAN -> "-40.5504801"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    29.136663   10.417425  -40.550480
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336060333"
Evaluating: 0.336060333*360.0
 Parameter: XPHI <- "120.98172"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.138928071"
Evaluating: 0.138928071*360.0
 Parameter: YPHI <- "50.0141056"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78108269"
Evaluating: 0.78108269*360.0
 Parameter: ZPHI <- "281.189768"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.1366634"
 Parameter: YPOS -> "10.4174246"
 Parameter: ZPOS -> "-40.5504801"
 Parameter: XPHI -> "120.98172"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.514765    0.857332
    0.000000   -0.857332   -0.514765

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  120.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.1366634"
 Parameter: YPOS -> "10.4174246"
 Parameter: ZPOS -> "-40.5504801"
 Parameter: YPHI -> "50.0141056"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.642599    0.000000   -0.766203
    0.000000    1.000000    0.000000
    0.766203    0.000000    0.642599

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   50.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.1366634"
 Parameter: YPOS -> "10.4174246"
 Parameter: ZPOS -> "-40.5504801"
 Parameter: ZPHI -> "281.189768"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.194059   -0.980990    0.000000
    0.980990    0.194059    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   78.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.136663 XMAX =   29.136663 XAVE =   29.136663
    YMIN =   10.417425 YMAX =   10.417425 YAVE =   10.417425
    ZMIN =  -40.550480 ZMAX =  -40.550480 ZAVE =  -40.550480
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.1366634"
Evaluating: 29.1366634+3.5
 Parameter: XMAX <- "32.6366634"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.4174246"
Evaluating: 10.4174246+3.5
 Parameter: YMAX <- "13.9174246"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.5504801"
Evaluating: -40.5504801+3.5
 Parameter: ZMAX <- "-37.0504801"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.1366634"
Evaluating: 29.1366634-3.5
 Parameter: XMIN <- "25.6366634"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.4174246"
Evaluating: 10.4174246-3.5
 Parameter: YMIN <- "6.9174246"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.5504801"
Evaluating: -40.5504801-3.5
 Parameter: ZMIN <- "-44.0504801"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.6366634"
 Parameter: XMIN -> "25.6366634"
 Parameter: YMAX -> "13.9174246"
 Parameter: YMIN -> "6.9174246"
 Parameter: ZMAX -> "-37.0504801"
 Parameter: ZMIN -> "-44.0504801"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "68" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "68" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "68"
 Parameter: NPOS -> "62"
Evaluating: 68-62
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.890966223"
Evaluating: 81.6823114*(0.890966223-0.5)
 Parameter: XPOS <- "31.9350248"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.504993108"
Evaluating: 81.6823114*(0.504993108-0.5)
 Parameter: YPOS <- "0.407848603"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.118997093"
Evaluating: 85*(0.118997093-0.5)+0
 Parameter: ZPOS <- "-32.3852471"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.3852471" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.9350248"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.9350248-0
 Parameter: XTRAN <- "31.9350248"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.407848603"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.407848603-0
 Parameter: YTRAN <- "0.407848603"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.3852471"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.3852471-0
 Parameter: ZTRAN <- "-32.3852471"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.9350248"
 Parameter: YTRAN -> "0.407848603"
 Parameter: ZTRAN -> "-32.3852471"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    31.935025    0.407849  -32.385247
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.120614716"
Evaluating: 0.120614716*360.0
 Parameter: XPHI <- "43.4212978"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110158212"
Evaluating: 0.110158212*360.0
 Parameter: YPHI <- "39.6569563"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.719398182"
Evaluating: 0.719398182*360.0
 Parameter: ZPHI <- "258.983346"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.9350248"
 Parameter: YPOS -> "0.407848603"
 Parameter: ZPOS -> "-32.3852471"
 Parameter: XPHI -> "43.4212978"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.726319    0.687358
    0.000000   -0.687358    0.726319

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.9350248"
 Parameter: YPOS -> "0.407848603"
 Parameter: ZPOS -> "-32.3852471"
 Parameter: YPHI -> "39.6569563"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.769879    0.000000   -0.638190
    0.000000    1.000000    0.000000
    0.638190    0.000000    0.769879

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   39.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.9350248"
 Parameter: YPOS -> "0.407848603"
 Parameter: ZPOS -> "-32.3852471"
 Parameter: ZPHI -> "258.983346"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.191094   -0.981572    0.000000
    0.981572   -0.191094    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  101.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.935025 XMAX =   31.935025 XAVE =   31.935025
    YMIN =    0.407849 YMAX =    0.407849 YAVE =    0.407849
    ZMIN =  -32.385247 ZMAX =  -32.385247 ZAVE =  -32.385247
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.9350248"
Evaluating: 31.9350248+3.5
 Parameter: XMAX <- "35.4350248"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.407848603"
Evaluating: 0.407848603+3.5
 Parameter: YMAX <- "3.9078486"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.3852471"
Evaluating: -32.3852471+3.5
 Parameter: ZMAX <- "-28.8852471"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.9350248"
Evaluating: 31.9350248-3.5
 Parameter: XMIN <- "28.4350248"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.407848603"
Evaluating: 0.407848603-3.5
 Parameter: YMIN <- "-3.0921514"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.3852471"
Evaluating: -32.3852471-3.5
 Parameter: ZMIN <- "-35.8852471"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.4350248"
 Parameter: XMIN -> "28.4350248"
 Parameter: YMAX -> "3.9078486"
 Parameter: YMIN -> "-3.0921514"
 Parameter: ZMAX -> "-28.8852471"
 Parameter: ZMIN -> "-35.8852471"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "69" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "69" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "69"
 Parameter: NPOS -> "62"
Evaluating: 69-62
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.677608645"
Evaluating: 81.6823114*(0.677608645-0.5)
 Parameter: XPOS <- "14.5074846"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.307643688"
Evaluating: 81.6823114*(0.307643688-0.5)
 Parameter: YPOS <- "-15.7121082"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.30016199"
Evaluating: 85*(0.30016199-0.5)+0
 Parameter: ZPOS <- "-16.9862309"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.9862309" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.5074846"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.5074846-0
 Parameter: XTRAN <- "14.5074846"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.7121082"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.7121082-0
 Parameter: YTRAN <- "-15.7121082"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.9862309"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.9862309-0
 Parameter: ZTRAN <- "-16.9862309"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.5074846"
 Parameter: YTRAN -> "-15.7121082"
 Parameter: ZTRAN -> "-16.9862309"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    14.507485  -15.712108  -16.986231
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.241545121"
Evaluating: 0.241545121*360.0
 Parameter: XPHI <- "86.9562436"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.218890081"
Evaluating: 0.218890081*360.0
 Parameter: YPHI <- "78.8004292"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457518723"
Evaluating: 0.457518723*360.0
 Parameter: ZPHI <- "164.70674"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.5074846"
 Parameter: YPOS -> "-15.7121082"
 Parameter: ZPOS -> "-16.9862309"
 Parameter: XPHI -> "86.9562436"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.053099    0.998589
    0.000000   -0.998589    0.053099

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   86.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.5074846"
 Parameter: YPOS -> "-15.7121082"
 Parameter: ZPOS -> "-16.9862309"
 Parameter: YPHI -> "78.8004292"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.194227    0.000000   -0.980957
    0.000000    1.000000    0.000000
    0.980957    0.000000    0.194227

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   78.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.5074846"
 Parameter: YPOS -> "-15.7121082"
 Parameter: ZPOS -> "-16.9862309"
 Parameter: ZPHI -> "164.70674"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.964588    0.263760    0.000000
   -0.263760   -0.964588    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  164.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.507485 XMAX =   14.507485 XAVE =   14.507485
    YMIN =  -15.712108 YMAX =  -15.712108 YAVE =  -15.712108
    ZMIN =  -16.986231 ZMAX =  -16.986231 ZAVE =  -16.986231
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.5074846"
Evaluating: 14.5074846+3.5
 Parameter: XMAX <- "18.0074846"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.7121082"
Evaluating: -15.7121082+3.5
 Parameter: YMAX <- "-12.2121082"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.9862309"
Evaluating: -16.9862309+3.5
 Parameter: ZMAX <- "-13.4862309"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.5074846"
Evaluating: 14.5074846-3.5
 Parameter: XMIN <- "11.0074846"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.7121082"
Evaluating: -15.7121082-3.5
 Parameter: YMIN <- "-19.2121082"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.9862309"
Evaluating: -16.9862309-3.5
 Parameter: ZMIN <- "-20.4862309"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.0074846"
 Parameter: XMIN -> "11.0074846"
 Parameter: YMAX -> "-12.2121082"
 Parameter: YMIN -> "-19.2121082"
 Parameter: ZMAX -> "-13.4862309"
 Parameter: ZMIN -> "-20.4862309"
 SELRPN>     30 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     17 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26589 NEG      CLA      7        CLA     -**** MEMB     POPS     115      C1            3.2438
26589 NEG      CLA      7        CLA     -**** MEMB     POPS     115      C3            3.9588
26589 NEG      CLA      7        CLA     -**** MEMB     POPS     115      O31           3.9905
26589 NEG      CLA      7        CLA     -**** MEMB     POPC     130      C14           3.0407
26589 NEG      CLA      7        CLA     -**** MEMB     POPC     130      P             3.5002
26589 NEG      CLA      7        CLA     -**** MEMB     POPC     130      O14           3.9492
26589 NEG      CLA      7        CLA     -**** MEMB     POPC     130      O11           2.1703
26589 NEG      CLA      7        CLA     -**** MEMB     POPC     130      C1            2.4838
26589 NEG      CLA      7        CLA     -**** MEMB     POPC     130      C2            3.2090
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "69" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "69"
 Parameter: NPOS -> "62"
Evaluating: 69-62
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.246340906"
Evaluating: 81.6823114*(0.246340906-0.5)
 Parameter: XPOS <- "-20.7194611"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.340739261"
Evaluating: 81.6823114*(0.340739261-0.5)
 Parameter: YPOS <- "-13.0087853"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.491635531"
Evaluating: 85*(0.491635531-0.5)+0
 Parameter: ZPOS <- "-0.710979865"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.710979865" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.710979865" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "69" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "69"
 Parameter: NPOS -> "62"
Evaluating: 69-62
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.572162608"
Evaluating: 81.6823114*(0.572162608-0.5)
 Parameter: XPOS <- "5.89440862"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.33051413"
Evaluating: 81.6823114*(0.33051413-0.5)
 Parameter: YPOS <- "-13.8439976"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.631705538"
Evaluating: 85*(0.631705538-0.5)+0
 Parameter: ZPOS <- "11.1949707"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.1949707" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.1949707" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "69" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "69"
 Parameter: NPOS -> "62"
Evaluating: 69-62
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.625938113"
Evaluating: 81.6823114*(0.625938113-0.5)
 Parameter: XPOS <- "10.2869162"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.831664362"
Evaluating: 81.6823114*(0.831664362-0.5)
 Parameter: YPOS <- "27.0911117"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.811884459"
Evaluating: 85*(0.811884459-0.5)+0
 Parameter: ZPOS <- "26.510179"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.510179" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.510179" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.507485 XMAX =   14.507485 XAVE =   14.507485
    YMIN =  -15.712108 YMAX =  -15.712108 YAVE =  -15.712108
    ZMIN =  -16.986231 ZMAX =  -16.986231 ZAVE =  -16.986231
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.2869162"
 RDCMND substituted energy or value "?XAVE" to "14.5074846"
Evaluating: 10.2869162-14.5074846
 Parameter: XTRAN <- "-4.2205684"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.0911117"
 RDCMND substituted energy or value "?YAVE" to "-15.7121082"
Evaluating: 27.0911117--15.7121082
 Parameter: YTRAN <- "42.8032199"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.510179"
 RDCMND substituted energy or value "?ZAVE" to "-16.9862309"
Evaluating: 26.510179--16.9862309
 Parameter: ZTRAN <- "43.4964099"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.2205684"
 Parameter: YTRAN -> "42.8032199"
 Parameter: ZTRAN -> "43.4964099"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -4.220568   42.803220   43.496410
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418102742"
Evaluating: 0.418102742*360.0
 Parameter: XPHI <- "150.516987"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848443457"
Evaluating: 0.848443457*360.0
 Parameter: YPHI <- "305.439645"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.690293335"
Evaluating: 0.690293335*360.0
 Parameter: ZPHI <- "248.505601"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.2869162"
 Parameter: YPOS -> "27.0911117"
 Parameter: ZPOS -> "26.510179"
 Parameter: XPHI -> "150.516987"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.870502    0.492165
    0.000000   -0.492165   -0.870502

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  150.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.2869162"
 Parameter: YPOS -> "27.0911117"
 Parameter: ZPOS -> "26.510179"
 Parameter: YPHI -> "305.439645"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.579845    0.000000    0.814727
    0.000000    1.000000    0.000000
   -0.814727    0.000000    0.579845

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.2869162"
 Parameter: YPOS -> "27.0911117"
 Parameter: ZPOS -> "26.510179"
 Parameter: ZPHI -> "248.505601"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.366410   -0.930453    0.000000
    0.930453   -0.366410    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  111.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.286916 XMAX =   10.286916 XAVE =   10.286916
    YMIN =   27.091112 YMAX =   27.091112 YAVE =   27.091112
    ZMIN =   26.510179 ZMAX =   26.510179 ZAVE =   26.510179
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.2869162"
Evaluating: 10.2869162+3.5
 Parameter: XMAX <- "13.7869162"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.0911117"
Evaluating: 27.0911117+3.5
 Parameter: YMAX <- "30.5911117"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.510179"
Evaluating: 26.510179+3.5
 Parameter: ZMAX <- "30.010179"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.2869162"
Evaluating: 10.2869162-3.5
 Parameter: XMIN <- "6.7869162"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.0911117"
Evaluating: 27.0911117-3.5
 Parameter: YMIN <- "23.5911117"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.510179"
Evaluating: 26.510179-3.5
 Parameter: ZMIN <- "23.010179"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.7869162"
 Parameter: XMIN -> "6.7869162"
 Parameter: YMAX -> "30.5911117"
 Parameter: YMIN -> "23.5911117"
 Parameter: ZMAX -> "30.010179"
 Parameter: ZMIN -> "23.010179"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      1 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26589 NEG      CLA      7        CLA     -**** POS      POT      10       POT           2.1667
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "69" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "69"
 Parameter: NPOS -> "62"
Evaluating: 69-62
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.439381364"
Evaluating: 81.6823114*(0.439381364-0.5)
 Parameter: XPOS <- "-4.9514703"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.164045464"
Evaluating: 81.6823114*(0.164045464-0.5)
 Parameter: YPOS <- "-27.441543"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "8.608156703E-02"
Evaluating: 85*(8.608156703E-02-0.5)+0
 Parameter: ZPOS <- "-35.1830668"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.1830668" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.286916 XMAX =   10.286916 XAVE =   10.286916
    YMIN =   27.091112 YMAX =   27.091112 YAVE =   27.091112
    ZMIN =   26.510179 ZMAX =   26.510179 ZAVE =   26.510179
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.9514703"
 RDCMND substituted energy or value "?XAVE" to "10.2869162"
Evaluating: -4.9514703-10.2869162
 Parameter: XTRAN <- "-15.2383865"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.441543"
 RDCMND substituted energy or value "?YAVE" to "27.0911117"
Evaluating: -27.441543-27.0911117
 Parameter: YTRAN <- "-54.5326547"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.1830668"
 RDCMND substituted energy or value "?ZAVE" to "26.510179"
Evaluating: -35.1830668-26.510179
 Parameter: ZTRAN <- "-61.6932458"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.2383865"
 Parameter: YTRAN -> "-54.5326547"
 Parameter: ZTRAN -> "-61.6932458"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -15.238387  -54.532655  -61.693246
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644661295"
Evaluating: 0.644661295*360.0
 Parameter: XPHI <- "232.078066"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.916309324E-02"
Evaluating: 6.916309324E-02*360.0
 Parameter: YPHI <- "24.8987136"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.854824651E-02"
Evaluating: 3.854824651E-02*360.0
 Parameter: ZPHI <- "13.8773687"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.9514703"
 Parameter: YPOS -> "-27.441543"
 Parameter: ZPOS -> "-35.1830668"
 Parameter: XPHI -> "232.078066"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.614587   -0.788849
    0.000000    0.788849   -0.614587

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.9514703"
 Parameter: YPOS -> "-27.441543"
 Parameter: ZPOS -> "-35.1830668"
 Parameter: YPHI -> "24.8987136"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.907053    0.000000   -0.421015
    0.000000    1.000000    0.000000
    0.421015    0.000000    0.907053

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   24.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.9514703"
 Parameter: YPOS -> "-27.441543"
 Parameter: ZPOS -> "-35.1830668"
 Parameter: ZPHI -> "13.8773687"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.970811    0.239845    0.000000
   -0.239845    0.970811    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.951470 XMAX =   -4.951470 XAVE =   -4.951470
    YMIN =  -27.441543 YMAX =  -27.441543 YAVE =  -27.441543
    ZMIN =  -35.183067 ZMAX =  -35.183067 ZAVE =  -35.183067
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.9514703"
Evaluating: -4.9514703+3.5
 Parameter: XMAX <- "-1.4514703"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.441543"
Evaluating: -27.441543+3.5
 Parameter: YMAX <- "-23.941543"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.1830668"
Evaluating: -35.1830668+3.5
 Parameter: ZMAX <- "-31.6830668"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.9514703"
Evaluating: -4.9514703-3.5
 Parameter: XMIN <- "-8.4514703"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.441543"
Evaluating: -27.441543-3.5
 Parameter: YMIN <- "-30.941543"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.1830668"
Evaluating: -35.1830668-3.5
 Parameter: ZMIN <- "-38.6830668"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.4514703"
 Parameter: XMIN -> "-8.4514703"
 Parameter: YMAX -> "-23.941543"
 Parameter: YMIN -> "-30.941543"
 Parameter: ZMAX -> "-31.6830668"
 Parameter: ZMIN -> "-38.6830668"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "70" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "70" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "70"
 Parameter: NPOS -> "62"
Evaluating: 70-62
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.311936943"
Evaluating: 81.6823114*(0.311936943-0.5)
 Parameter: XPOS <- "-15.3614252"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.862961747"
Evaluating: 81.6823114*(0.862961747-0.5)
 Parameter: YPOS <- "29.6475544"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.692061474"
Evaluating: 85*(0.692061474-0.5)+0
 Parameter: ZPOS <- "16.3252253"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.3252253" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.3252253" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.3614252"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -15.3614252-0
 Parameter: XTRAN <- "-15.3614252"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.6475544"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.6475544-0
 Parameter: YTRAN <- "29.6475544"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.3252253"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.3252253-0
 Parameter: ZTRAN <- "16.3252253"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.3614252"
 Parameter: YTRAN -> "29.6475544"
 Parameter: ZTRAN -> "16.3252253"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -15.361425   29.647554   16.325225
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.800165259"
Evaluating: 0.800165259*360.0
 Parameter: XPHI <- "288.059493"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.277415081"
Evaluating: 0.277415081*360.0
 Parameter: YPHI <- "99.8694292"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.151089541"
Evaluating: 0.151089541*360.0
 Parameter: ZPHI <- "54.3922348"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.3614252"
 Parameter: YPOS -> "29.6475544"
 Parameter: ZPOS -> "16.3252253"
 Parameter: XPHI -> "288.059493"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.310004   -0.950735
    0.000000    0.950735    0.310004

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   71.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.3614252"
 Parameter: YPOS -> "29.6475544"
 Parameter: ZPOS -> "16.3252253"
 Parameter: YPHI -> "99.8694292"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.171403    0.000000   -0.985201
    0.000000    1.000000    0.000000
    0.985201    0.000000   -0.171403

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   99.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.3614252"
 Parameter: YPOS -> "29.6475544"
 Parameter: ZPOS -> "16.3252253"
 Parameter: ZPHI -> "54.3922348"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.582233    0.813022    0.000000
   -0.813022    0.582233    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   54.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.361425 XMAX =  -15.361425 XAVE =  -15.361425
    YMIN =   29.647554 YMAX =   29.647554 YAVE =   29.647554
    ZMIN =   16.325225 ZMAX =   16.325225 ZAVE =   16.325225
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.3614252"
Evaluating: -15.3614252+3.5
 Parameter: XMAX <- "-11.8614252"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.6475544"
Evaluating: 29.6475544+3.5
 Parameter: YMAX <- "33.1475544"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.3252253"
Evaluating: 16.3252253+3.5
 Parameter: ZMAX <- "19.8252253"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.3614252"
Evaluating: -15.3614252-3.5
 Parameter: XMIN <- "-18.8614252"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.6475544"
Evaluating: 29.6475544-3.5
 Parameter: YMIN <- "26.1475544"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.3252253"
Evaluating: 16.3252253-3.5
 Parameter: ZMIN <- "12.8252253"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.8614252"
 Parameter: XMIN -> "-18.8614252"
 Parameter: YMAX -> "33.1475544"
 Parameter: YMIN -> "26.1475544"
 Parameter: ZMAX -> "19.8252253"
 Parameter: ZMIN -> "12.8252253"
 SELRPN>     28 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     16 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26590 NEG      CLA      8        CLA     -5990 MEMB     POPS     46       O13B          3.7813
26590 NEG      CLA      8        CLA     -6010 MEMB     POPS     46       C3            2.9118
26590 NEG      CLA      8        CLA     -6013 MEMB     POPS     46       O31           2.0546
26590 NEG      CLA      8        CLA     -6014 MEMB     POPS     46       C31           1.0857
26590 NEG      CLA      8        CLA     -6015 MEMB     POPS     46       O32           1.4139
26590 NEG      CLA      8        CLA     -6016 MEMB     POPS     46       C32           1.9118
26590 NEG      CLA      8        CLA     -6066 MEMB     POPS     46       C33           3.4188
26590 NEG      CLA      8        CLA     -8646 MEMB     POPC     66       P             3.4141
26590 NEG      CLA      8        CLA     -8647 MEMB     POPC     66       O13           3.0642
26590 NEG      CLA      8        CLA     -8650 MEMB     POPC     66       O11           3.1819
26590 NEG      CLA      8        CLA     -8656 MEMB     POPC     66       O21           3.6616
26590 NEG      CLA      8        CLA     -8657 MEMB     POPC     66       C21           3.7549
26590 NEG      CLA      8        CLA     -8659 MEMB     POPC     66       C22           3.9054
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "70" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "70"
 Parameter: NPOS -> "62"
Evaluating: 70-62
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.81985621"
Evaluating: 81.6823114*(0.81985621-0.5)
 Parameter: XPOS <- "26.1265945"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.84948888"
Evaluating: 81.6823114*(0.84948888-0.5)
 Parameter: YPOS <- "28.5470595"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.17879551"
Evaluating: 85*(0.17879551-0.5)+0
 Parameter: ZPOS <- "-27.3023817"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.3023817" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.361425 XMAX =  -15.361425 XAVE =  -15.361425
    YMIN =   29.647554 YMAX =   29.647554 YAVE =   29.647554
    ZMIN =   16.325225 ZMAX =   16.325225 ZAVE =   16.325225
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.1265945"
 RDCMND substituted energy or value "?XAVE" to "-15.3614252"
Evaluating: 26.1265945--15.3614252
 Parameter: XTRAN <- "41.4880197"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.5470595"
 RDCMND substituted energy or value "?YAVE" to "29.6475544"
Evaluating: 28.5470595-29.6475544
 Parameter: YTRAN <- "-1.1004949"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.3023817"
 RDCMND substituted energy or value "?ZAVE" to "16.3252253"
Evaluating: -27.3023817-16.3252253
 Parameter: ZTRAN <- "-43.627607"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.4880197"
 Parameter: YTRAN -> "-1.1004949"
 Parameter: ZTRAN -> "-43.627607"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    41.488020   -1.100495  -43.627607
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.251731303"
Evaluating: 0.251731303*360.0
 Parameter: XPHI <- "90.6232691"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.88112923"
Evaluating: 0.88112923*360.0
 Parameter: YPHI <- "317.206523"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518164203"
Evaluating: 0.518164203*360.0
 Parameter: ZPHI <- "186.539113"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.1265945"
 Parameter: YPOS -> "28.5470595"
 Parameter: ZPOS -> "-27.3023817"
 Parameter: XPHI -> "90.6232691"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.010878    0.999941
    0.000000   -0.999941   -0.010878

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   90.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.1265945"
 Parameter: YPOS -> "28.5470595"
 Parameter: ZPOS -> "-27.3023817"
 Parameter: YPHI -> "317.206523"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.733807    0.000000    0.679358
    0.000000    1.000000    0.000000
   -0.679358    0.000000    0.733807

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   42.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.1265945"
 Parameter: YPOS -> "28.5470595"
 Parameter: ZPOS -> "-27.3023817"
 Parameter: ZPHI -> "186.539113"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.993494   -0.113881    0.000000
    0.113881   -0.993494    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  173.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.126594 XMAX =   26.126594 XAVE =   26.126594
    YMIN =   28.547059 YMAX =   28.547059 YAVE =   28.547059
    ZMIN =  -27.302382 ZMAX =  -27.302382 ZAVE =  -27.302382
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.1265945"
Evaluating: 26.1265945+3.5
 Parameter: XMAX <- "29.6265945"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.5470595"
Evaluating: 28.5470595+3.5
 Parameter: YMAX <- "32.0470595"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.3023817"
Evaluating: -27.3023817+3.5
 Parameter: ZMAX <- "-23.8023817"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.1265945"
Evaluating: 26.1265945-3.5
 Parameter: XMIN <- "22.6265945"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.5470595"
Evaluating: 28.5470595-3.5
 Parameter: YMIN <- "25.0470595"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.3023817"
Evaluating: -27.3023817-3.5
 Parameter: ZMIN <- "-30.8023817"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.6265945"
 Parameter: XMIN -> "22.6265945"
 Parameter: YMAX -> "32.0470595"
 Parameter: YMIN -> "25.0470595"
 Parameter: ZMAX -> "-23.8023817"
 Parameter: ZMIN -> "-30.8023817"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "71" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "71" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "71"
 Parameter: NPOS -> "62"
Evaluating: 71-62
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.820897146"
Evaluating: 81.6823114*(0.820897146-0.5)
 Parameter: XPOS <- "26.2116206"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.293641825"
Evaluating: 81.6823114*(0.293641825-0.5)
 Parameter: YPOS <- "-16.8558127"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.792052018"
Evaluating: 85*(0.792052018-0.5)+0
 Parameter: ZPOS <- "24.8244215"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.8244215" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.8244215" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.2116206"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.2116206-0
 Parameter: XTRAN <- "26.2116206"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.8558127"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -16.8558127-0
 Parameter: YTRAN <- "-16.8558127"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.8244215"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.8244215-0
 Parameter: ZTRAN <- "24.8244215"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.2116206"
 Parameter: YTRAN -> "-16.8558127"
 Parameter: ZTRAN -> "24.8244215"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    26.211621  -16.855813   24.824421
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.37808125"
Evaluating: 0.37808125*360.0
 Parameter: XPHI <- "136.10925"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.281820673"
Evaluating: 0.281820673*360.0
 Parameter: YPHI <- "101.455442"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.956965889"
Evaluating: 0.956965889*360.0
 Parameter: ZPHI <- "344.50772"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.2116206"
 Parameter: YPOS -> "-16.8558127"
 Parameter: ZPOS -> "24.8244215"
 Parameter: XPHI -> "136.10925"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.720663    0.693285
    0.000000   -0.693285   -0.720663

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  136.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.2116206"
 Parameter: YPOS -> "-16.8558127"
 Parameter: ZPOS -> "24.8244215"
 Parameter: YPHI -> "101.455442"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.198606    0.000000   -0.980079
    0.000000    1.000000    0.000000
    0.980079    0.000000   -0.198606

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  101.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.2116206"
 Parameter: YPOS -> "-16.8558127"
 Parameter: ZPOS -> "24.8244215"
 Parameter: ZPHI -> "344.50772"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.963666   -0.267109    0.000000
    0.267109    0.963666    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.211621 XMAX =   26.211621 XAVE =   26.211621
    YMIN =  -16.855813 YMAX =  -16.855813 YAVE =  -16.855813
    ZMIN =   24.824421 ZMAX =   24.824421 ZAVE =   24.824421
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.2116206"
Evaluating: 26.2116206+3.5
 Parameter: XMAX <- "29.7116206"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.8558127"
Evaluating: -16.8558127+3.5
 Parameter: YMAX <- "-13.3558127"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.8244215"
Evaluating: 24.8244215+3.5
 Parameter: ZMAX <- "28.3244215"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.2116206"
Evaluating: 26.2116206-3.5
 Parameter: XMIN <- "22.7116206"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.8558127"
Evaluating: -16.8558127-3.5
 Parameter: YMIN <- "-20.3558127"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.8244215"
Evaluating: 24.8244215-3.5
 Parameter: ZMIN <- "21.3244215"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.7116206"
 Parameter: XMIN -> "22.7116206"
 Parameter: YMAX -> "-13.3558127"
 Parameter: YMIN -> "-20.3558127"
 Parameter: ZMAX -> "28.3244215"
 Parameter: ZMIN -> "21.3244215"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "72" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "72" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "72"
 Parameter: NPOS -> "62"
Evaluating: 72-62
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.64634648"
Evaluating: 81.6823114*(0.64634648-0.5)
 Parameter: XPOS <- "11.9539188"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.65077736"
Evaluating: 81.6823114*(0.65077736-0.5)
 Parameter: YPOS <- "12.3158433"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.73855905"
Evaluating: 85*(0.73855905-0.5)+0
 Parameter: ZPOS <- "20.2775193"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.2775193" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.2775193" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.9539188"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.9539188-0
 Parameter: XTRAN <- "11.9539188"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.3158433"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.3158433-0
 Parameter: YTRAN <- "12.3158433"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.2775193"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.2775193-0
 Parameter: ZTRAN <- "20.2775193"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.9539188"
 Parameter: YTRAN -> "12.3158433"
 Parameter: ZTRAN -> "20.2775193"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    11.953919   12.315843   20.277519
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83463356"
Evaluating: 0.83463356*360.0
 Parameter: XPHI <- "300.468082"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.943854706"
Evaluating: 0.943854706*360.0
 Parameter: YPHI <- "339.787694"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.263150155"
Evaluating: 0.263150155*360.0
 Parameter: ZPHI <- "94.7340558"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.9539188"
 Parameter: YPOS -> "12.3158433"
 Parameter: ZPOS -> "20.2775193"
 Parameter: XPHI -> "300.468082"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.507058   -0.861912
    0.000000    0.861912    0.507058

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   59.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.9539188"
 Parameter: YPOS -> "12.3158433"
 Parameter: ZPOS -> "20.2775193"
 Parameter: YPHI -> "339.787694"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.938419    0.000000    0.345500
    0.000000    1.000000    0.000000
   -0.345500    0.000000    0.938419

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   20.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.9539188"
 Parameter: YPOS -> "12.3158433"
 Parameter: ZPOS -> "20.2775193"
 Parameter: ZPHI -> "94.7340558"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.082531    0.996589    0.000000
   -0.996589   -0.082531    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   94.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.953919 XMAX =   11.953919 XAVE =   11.953919
    YMIN =   12.315843 YMAX =   12.315843 YAVE =   12.315843
    ZMIN =   20.277519 ZMAX =   20.277519 ZAVE =   20.277519
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.9539188"
Evaluating: 11.9539188+3.5
 Parameter: XMAX <- "15.4539188"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.3158433"
Evaluating: 12.3158433+3.5
 Parameter: YMAX <- "15.8158433"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.2775193"
Evaluating: 20.2775193+3.5
 Parameter: ZMAX <- "23.7775193"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.9539188"
Evaluating: 11.9539188-3.5
 Parameter: XMIN <- "8.4539188"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.3158433"
Evaluating: 12.3158433-3.5
 Parameter: YMIN <- "8.8158433"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.2775193"
Evaluating: 20.2775193-3.5
 Parameter: ZMIN <- "16.7775193"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.4539188"
 Parameter: XMIN -> "8.4539188"
 Parameter: YMAX -> "15.8158433"
 Parameter: YMIN -> "8.8158433"
 Parameter: ZMAX -> "23.7775193"
 Parameter: ZMIN -> "16.7775193"
 SELRPN>     26 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     11 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26592 NEG      CLA      10       CLA     -1334 MEMB     POPC     11       N             2.5044
26592 NEG      CLA      10       CLA     -1335 MEMB     POPC     11       C12           3.3811
26592 NEG      CLA      10       CLA     -1338 MEMB     POPC     11       C13           1.8046
26592 NEG      CLA      10       CLA     -1342 MEMB     POPC     11       C14           3.6709
26592 NEG      CLA      10       CLA     -1346 MEMB     POPC     11       C15           2.4927
26592 NEG      CLA      10       CLA     -1350 MEMB     POPC     11       C11           3.4323
26592 NEG      CLA      10       CLA     -1353 MEMB     POPC     11       P             3.6615
26592 NEG      CLA      10       CLA     -1355 MEMB     POPC     11       O14           3.9916
26592 NEG      CLA      10       CLA     -1356 MEMB     POPC     11       O12           2.7097
26592 NEG      CLA      10       CLA     -1358 MEMB     POPC     11       C1            3.1156
26592 NEG      CLA      10       CLA     -1361 MEMB     POPC     11       C2            3.9398
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "72" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "72"
 Parameter: NPOS -> "62"
Evaluating: 72-62
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.458535861"
Evaluating: 81.6823114*(0.458535861-0.5)
 Parameter: XPOS <- "-3.38688671"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.196554526"
Evaluating: 81.6823114*(0.196554526-0.5)
 Parameter: YPOS <- "-24.7861277"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.205367303"
Evaluating: 85*(0.205367303-0.5)+0
 Parameter: ZPOS <- "-25.0437792"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.0437792" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.953919 XMAX =   11.953919 XAVE =   11.953919
    YMIN =   12.315843 YMAX =   12.315843 YAVE =   12.315843
    ZMIN =   20.277519 ZMAX =   20.277519 ZAVE =   20.277519
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.38688671"
 RDCMND substituted energy or value "?XAVE" to "11.9539188"
Evaluating: -3.38688671-11.9539188
 Parameter: XTRAN <- "-15.3408055"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.7861277"
 RDCMND substituted energy or value "?YAVE" to "12.3158433"
Evaluating: -24.7861277-12.3158433
 Parameter: YTRAN <- "-37.101971"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.0437792"
 RDCMND substituted energy or value "?ZAVE" to "20.2775193"
Evaluating: -25.0437792-20.2775193
 Parameter: ZTRAN <- "-45.3212985"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.3408055"
 Parameter: YTRAN -> "-37.101971"
 Parameter: ZTRAN -> "-45.3212985"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -15.340806  -37.101971  -45.321298
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549427627"
Evaluating: 0.549427627*360.0
 Parameter: XPHI <- "197.793946"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.566863945"
Evaluating: 0.566863945*360.0
 Parameter: YPHI <- "204.07102"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.704550088"
Evaluating: 0.704550088*360.0
 Parameter: ZPHI <- "253.638032"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.38688671"
 Parameter: YPOS -> "-24.7861277"
 Parameter: ZPOS -> "-25.0437792"
 Parameter: XPHI -> "197.793946"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.952162   -0.305595
    0.000000    0.305595   -0.952162

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.38688671"
 Parameter: YPOS -> "-24.7861277"
 Parameter: ZPOS -> "-25.0437792"
 Parameter: YPHI -> "204.07102"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.913041    0.000000    0.407869
    0.000000    1.000000    0.000000
   -0.407869    0.000000   -0.913041

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.38688671"
 Parameter: YPOS -> "-24.7861277"
 Parameter: ZPOS -> "-25.0437792"
 Parameter: ZPHI -> "253.638032"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.281705   -0.959501    0.000000
    0.959501   -0.281705    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  106.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.386887 XMAX =   -3.386887 XAVE =   -3.386887
    YMIN =  -24.786128 YMAX =  -24.786128 YAVE =  -24.786128
    ZMIN =  -25.043779 ZMAX =  -25.043779 ZAVE =  -25.043779
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.38688671"
Evaluating: -3.38688671+3.5
 Parameter: XMAX <- "0.11311329"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.7861277"
Evaluating: -24.7861277+3.5
 Parameter: YMAX <- "-21.2861277"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.0437792"
Evaluating: -25.0437792+3.5
 Parameter: ZMAX <- "-21.5437792"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.38688671"
Evaluating: -3.38688671-3.5
 Parameter: XMIN <- "-6.88688671"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.7861277"
Evaluating: -24.7861277-3.5
 Parameter: YMIN <- "-28.2861277"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.0437792"
Evaluating: -25.0437792-3.5
 Parameter: ZMIN <- "-28.5437792"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.11311329"
 Parameter: XMIN -> "-6.88688671"
 Parameter: YMAX -> "-21.2861277"
 Parameter: YMIN -> "-28.2861277"
 Parameter: ZMAX -> "-21.5437792"
 Parameter: ZMIN -> "-28.5437792"
 SELRPN>      5 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      1 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "73" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "73" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "73"
 Parameter: NPOS -> "62"
Evaluating: 73-62
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.429149925"
Evaluating: 81.6823114*(0.429149925-0.5)
 Parameter: XPOS <- "-5.78719789"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.473876333"
Evaluating: 81.6823114*(0.473876333-0.5)
 Parameter: YPOS <- "-2.1338415"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "4.606864659E-02"
Evaluating: 85*(4.606864659E-02-0.5)+0
 Parameter: ZPOS <- "-38.584165"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.584165" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.78719789"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.78719789-0
 Parameter: XTRAN <- "-5.78719789"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.1338415"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.1338415-0
 Parameter: YTRAN <- "-2.1338415"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.584165"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.584165-0
 Parameter: ZTRAN <- "-38.584165"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.78719789"
 Parameter: YTRAN -> "-2.1338415"
 Parameter: ZTRAN -> "-38.584165"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -5.787198   -2.133841  -38.584165
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.216497553"
Evaluating: 0.216497553*360.0
 Parameter: XPHI <- "77.9391191"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.503643866"
Evaluating: 0.503643866*360.0
 Parameter: YPHI <- "181.311792"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.770925297"
Evaluating: 0.770925297*360.0
 Parameter: ZPHI <- "277.533107"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.78719789"
 Parameter: YPOS -> "-2.1338415"
 Parameter: ZPOS -> "-38.584165"
 Parameter: XPHI -> "77.9391191"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.208951    0.977926
    0.000000   -0.977926    0.208951

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.78719789"
 Parameter: YPOS -> "-2.1338415"
 Parameter: ZPOS -> "-38.584165"
 Parameter: YPHI -> "181.311792"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.999738    0.000000    0.022893
    0.000000    1.000000    0.000000
   -0.022893    0.000000   -0.999738

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  178.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.78719789"
 Parameter: YPOS -> "-2.1338415"
 Parameter: ZPOS -> "-38.584165"
 Parameter: ZPHI -> "277.533107"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.131099   -0.991369    0.000000
    0.991369    0.131099    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   82.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.787198 XMAX =   -5.787198 XAVE =   -5.787198
    YMIN =   -2.133841 YMAX =   -2.133841 YAVE =   -2.133841
    ZMIN =  -38.584165 ZMAX =  -38.584165 ZAVE =  -38.584165
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.78719789"
Evaluating: -5.78719789+3.5
 Parameter: XMAX <- "-2.28719789"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.1338415"
Evaluating: -2.1338415+3.5
 Parameter: YMAX <- "1.3661585"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.584165"
Evaluating: -38.584165+3.5
 Parameter: ZMAX <- "-35.084165"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.78719789"
Evaluating: -5.78719789-3.5
 Parameter: XMIN <- "-9.28719789"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.1338415"
Evaluating: -2.1338415-3.5
 Parameter: YMIN <- "-5.6338415"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.584165"
Evaluating: -38.584165-3.5
 Parameter: ZMIN <- "-42.084165"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.28719789"
 Parameter: XMIN -> "-9.28719789"
 Parameter: YMAX -> "1.3661585"
 Parameter: YMIN -> "-5.6338415"
 Parameter: ZMAX -> "-35.084165"
 Parameter: ZMIN -> "-42.084165"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "74" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "74" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "74"
 Parameter: NPOS -> "62"
Evaluating: 74-62
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.145178819"
Evaluating: 81.6823114*(0.145178819-0.5)
 Parameter: XPOS <- "-28.9826142"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.912559232"
Evaluating: 81.6823114*(0.912559232-0.5)
 Parameter: YPOS <- "33.6987917"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.532134656"
Evaluating: 85*(0.532134656-0.5)+0
 Parameter: ZPOS <- "2.73144576"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.73144576" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.73144576" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "74" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "74"
 Parameter: NPOS -> "62"
Evaluating: 74-62
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.641931891"
Evaluating: 81.6823114*(0.641931891-0.5)
 Parameter: XPOS <- "11.5933249"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.630098379"
Evaluating: 81.6823114*(0.630098379-0.5)
 Parameter: YPOS <- "10.6267363"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.211434538"
Evaluating: 85*(0.211434538-0.5)+0
 Parameter: ZPOS <- "-24.5280643"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.5280643" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.5933249"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.5933249-0
 Parameter: XTRAN <- "11.5933249"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.6267363"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.6267363-0
 Parameter: YTRAN <- "10.6267363"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.5280643"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.5280643-0
 Parameter: ZTRAN <- "-24.5280643"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.5933249"
 Parameter: YTRAN -> "10.6267363"
 Parameter: ZTRAN -> "-24.5280643"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    11.593325   10.626736  -24.528064
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.527857826"
Evaluating: 0.527857826*360.0
 Parameter: XPHI <- "190.028817"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987981386"
Evaluating: 0.987981386*360.0
 Parameter: YPHI <- "355.673299"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587779337"
Evaluating: 0.587779337*360.0
 Parameter: ZPHI <- "211.600561"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.5933249"
 Parameter: YPOS -> "10.6267363"
 Parameter: ZPOS -> "-24.5280643"
 Parameter: XPHI -> "190.028817"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.984720   -0.174143
    0.000000    0.174143   -0.984720

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  169.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.5933249"
 Parameter: YPOS -> "10.6267363"
 Parameter: ZPOS -> "-24.5280643"
 Parameter: YPHI -> "355.673299"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.997150    0.000000    0.075443
    0.000000    1.000000    0.000000
   -0.075443    0.000000    0.997150

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.5933249"
 Parameter: YPOS -> "10.6267363"
 Parameter: ZPOS -> "-24.5280643"
 Parameter: ZPHI -> "211.600561"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.851722   -0.523994    0.000000
    0.523994   -0.851722    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  148.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.593325 XMAX =   11.593325 XAVE =   11.593325
    YMIN =   10.626736 YMAX =   10.626736 YAVE =   10.626736
    ZMIN =  -24.528064 ZMAX =  -24.528064 ZAVE =  -24.528064
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.5933249"
Evaluating: 11.5933249+3.5
 Parameter: XMAX <- "15.0933249"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.6267363"
Evaluating: 10.6267363+3.5
 Parameter: YMAX <- "14.1267363"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.5280643"
Evaluating: -24.5280643+3.5
 Parameter: ZMAX <- "-21.0280643"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.5933249"
Evaluating: 11.5933249-3.5
 Parameter: XMIN <- "8.0933249"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.6267363"
Evaluating: 10.6267363-3.5
 Parameter: YMIN <- "7.1267363"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.5280643"
Evaluating: -24.5280643-3.5
 Parameter: ZMIN <- "-28.0280643"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.0933249"
 Parameter: XMIN -> "8.0933249"
 Parameter: YMAX -> "14.1267363"
 Parameter: YMIN -> "7.1267363"
 Parameter: ZMAX -> "-21.0280643"
 Parameter: ZMIN -> "-28.0280643"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "75" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "75" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "75"
 Parameter: NPOS -> "62"
Evaluating: 75-62
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.503029562"
Evaluating: 81.6823114*(0.503029562-0.5)
 Parameter: XPOS <- "0.247461627"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "9.821096406E-02"
Evaluating: 81.6823114*(9.821096406E-02-0.5)
 Parameter: YPOS <- "-32.8190572"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.454032093"
Evaluating: 85*(0.454032093-0.5)+0
 Parameter: ZPOS <- "-3.9072721"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.9072721" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.9072721" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "75" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "75"
 Parameter: NPOS -> "62"
Evaluating: 75-62
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.509492257"
Evaluating: 81.6823114*(0.509492257-0.5)
 Parameter: XPOS <- "0.775349492"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.837210164"
Evaluating: 81.6823114*(0.837210164-0.5)
 Parameter: YPOS <- "27.5441056"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.575889304"
Evaluating: 85*(0.575889304-0.5)+0
 Parameter: ZPOS <- "6.45059084"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.45059084" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.45059084" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "75" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "75"
 Parameter: NPOS -> "62"
Evaluating: 75-62
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.609067324"
Evaluating: 81.6823114*(0.609067324-0.5)
 Parameter: XPOS <- "8.90887112"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.674781815"
Evaluating: 81.6823114*(0.674781815-0.5)
 Parameter: YPOS <- "14.2765826"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.457179181"
Evaluating: 85*(0.457179181-0.5)+0
 Parameter: ZPOS <- "-3.63976962"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.63976962" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.63976962" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "75" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "75"
 Parameter: NPOS -> "62"
Evaluating: 75-62
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.909884587"
Evaluating: 81.6823114*(0.909884587-0.5)
 Parameter: XPOS <- "33.4803205"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.286179279"
Evaluating: 81.6823114*(0.286179279-0.5)
 Parameter: YPOS <- "-17.4653707"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.188111881"
Evaluating: 85*(0.188111881-0.5)+0
 Parameter: ZPOS <- "-26.5104901"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.5104901" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.4803205"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.4803205-0
 Parameter: XTRAN <- "33.4803205"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.4653707"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.4653707-0
 Parameter: YTRAN <- "-17.4653707"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.5104901"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.5104901-0
 Parameter: ZTRAN <- "-26.5104901"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.4803205"
 Parameter: YTRAN -> "-17.4653707"
 Parameter: ZTRAN -> "-26.5104901"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    33.480320  -17.465371  -26.510490
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.594030696"
Evaluating: 0.594030696*360.0
 Parameter: XPHI <- "213.851051"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.412030967"
Evaluating: 0.412030967*360.0
 Parameter: YPHI <- "148.331148"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641680817"
Evaluating: 0.641680817*360.0
 Parameter: ZPHI <- "231.005094"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.4803205"
 Parameter: YPOS -> "-17.4653707"
 Parameter: ZPOS -> "-26.5104901"
 Parameter: XPHI -> "213.851051"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.830488   -0.557036
    0.000000    0.557036   -0.830488

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  146.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.4803205"
 Parameter: YPOS -> "-17.4653707"
 Parameter: ZPOS -> "-26.5104901"
 Parameter: YPHI -> "148.331148"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.851097    0.000000   -0.525009
    0.000000    1.000000    0.000000
    0.525009    0.000000   -0.851097

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  148.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.4803205"
 Parameter: YPOS -> "-17.4653707"
 Parameter: ZPOS -> "-26.5104901"
 Parameter: ZPHI -> "231.005094"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.629251   -0.777202    0.000000
    0.777202   -0.629251    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.480320 XMAX =   33.480320 XAVE =   33.480320
    YMIN =  -17.465371 YMAX =  -17.465371 YAVE =  -17.465371
    ZMIN =  -26.510490 ZMAX =  -26.510490 ZAVE =  -26.510490
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.4803205"
Evaluating: 33.4803205+3.5
 Parameter: XMAX <- "36.9803205"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.4653707"
Evaluating: -17.4653707+3.5
 Parameter: YMAX <- "-13.9653707"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.5104901"
Evaluating: -26.5104901+3.5
 Parameter: ZMAX <- "-23.0104901"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.4803205"
Evaluating: 33.4803205-3.5
 Parameter: XMIN <- "29.9803205"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.4653707"
Evaluating: -17.4653707-3.5
 Parameter: YMIN <- "-20.9653707"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.5104901"
Evaluating: -26.5104901-3.5
 Parameter: ZMIN <- "-30.0104901"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.9803205"
 Parameter: XMIN -> "29.9803205"
 Parameter: YMAX -> "-13.9653707"
 Parameter: YMIN -> "-20.9653707"
 Parameter: ZMAX -> "-23.0104901"
 Parameter: ZMIN -> "-30.0104901"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "76" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "76" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "62"
Evaluating: 76-62
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.410524558"
Evaluating: 81.6823114*(0.410524558-0.5)
 Parameter: XPOS <- "-7.30856092"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "9.87688353E-02"
Evaluating: 81.6823114*(9.87688353E-02-0.5)
 Parameter: YPOS <- "-32.7734889"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.180073483"
Evaluating: 85*(0.180073483-0.5)+0
 Parameter: ZPOS <- "-27.1937539"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.1937539" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.30856092"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.30856092-0
 Parameter: XTRAN <- "-7.30856092"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.7734889"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -32.7734889-0
 Parameter: YTRAN <- "-32.7734889"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.1937539"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.1937539-0
 Parameter: ZTRAN <- "-27.1937539"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.30856092"
 Parameter: YTRAN -> "-32.7734889"
 Parameter: ZTRAN -> "-27.1937539"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -7.308561  -32.773489  -27.193754
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515772554"
Evaluating: 0.515772554*360.0
 Parameter: XPHI <- "185.678119"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.525476231"
Evaluating: 0.525476231*360.0
 Parameter: YPHI <- "189.171443"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711380104"
Evaluating: 0.711380104*360.0
 Parameter: ZPHI <- "256.096837"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.30856092"
 Parameter: YPOS -> "-32.7734889"
 Parameter: ZPOS -> "-27.1937539"
 Parameter: XPHI -> "185.678119"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.995093   -0.098940
    0.000000    0.098940   -0.995093

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  174.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.30856092"
 Parameter: YPOS -> "-32.7734889"
 Parameter: ZPOS -> "-27.1937539"
 Parameter: YPHI -> "189.171443"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.987216    0.000000    0.159389
    0.000000    1.000000    0.000000
   -0.159389    0.000000   -0.987216

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  170.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.30856092"
 Parameter: YPOS -> "-32.7734889"
 Parameter: ZPOS -> "-27.1937539"
 Parameter: ZPHI -> "256.096837"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.240282   -0.970703    0.000000
    0.970703   -0.240282    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  103.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.308561 XMAX =   -7.308561 XAVE =   -7.308561
    YMIN =  -32.773489 YMAX =  -32.773489 YAVE =  -32.773489
    ZMIN =  -27.193754 ZMAX =  -27.193754 ZAVE =  -27.193754
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.30856092"
Evaluating: -7.30856092+3.5
 Parameter: XMAX <- "-3.80856092"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.7734889"
Evaluating: -32.7734889+3.5
 Parameter: YMAX <- "-29.2734889"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.1937539"
Evaluating: -27.1937539+3.5
 Parameter: ZMAX <- "-23.6937539"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.30856092"
Evaluating: -7.30856092-3.5
 Parameter: XMIN <- "-10.8085609"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.7734889"
Evaluating: -32.7734889-3.5
 Parameter: YMIN <- "-36.2734889"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.1937539"
Evaluating: -27.1937539-3.5
 Parameter: ZMIN <- "-30.6937539"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.80856092"
 Parameter: XMIN -> "-10.8085609"
 Parameter: YMAX -> "-29.2734889"
 Parameter: YMIN -> "-36.2734889"
 Parameter: ZMAX -> "-23.6937539"
 Parameter: ZMIN -> "-30.6937539"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "77" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "77" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "77"
 Parameter: NPOS -> "62"
Evaluating: 77-62
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "9.891255604E-02"
Evaluating: 81.6823114*(9.891255604E-02-0.5)
 Parameter: XPOS <- "-32.7617495"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.729235743"
Evaluating: 81.6823114*(0.729235743-0.5)
 Parameter: YPOS <- "18.7245053"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.655424224"
Evaluating: 85*(0.655424224-0.5)+0
 Parameter: ZPOS <- "13.211059"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.211059" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.211059" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "77" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "77"
 Parameter: NPOS -> "62"
Evaluating: 77-62
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.613146387"
Evaluating: 81.6823114*(0.613146387-0.5)
 Parameter: XPOS <- "9.24205842"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.690362945"
Evaluating: 81.6823114*(0.690362945-0.5)
 Parameter: YPOS <- "15.5492854"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.317716672"
Evaluating: 85*(0.317716672-0.5)+0
 Parameter: ZPOS <- "-15.4940829"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.4940829" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.24205842"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.24205842-0
 Parameter: XTRAN <- "9.24205842"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.5492854"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.5492854-0
 Parameter: YTRAN <- "15.5492854"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.4940829"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.4940829-0
 Parameter: ZTRAN <- "-15.4940829"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.24205842"
 Parameter: YTRAN -> "15.5492854"
 Parameter: ZTRAN -> "-15.4940829"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     9.242058   15.549285  -15.494083
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.104763116"
Evaluating: 0.104763116*360.0
 Parameter: XPHI <- "37.7147218"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278582552"
Evaluating: 0.278582552*360.0
 Parameter: YPHI <- "100.289719"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.187614229"
Evaluating: 0.187614229*360.0
 Parameter: ZPHI <- "67.5411224"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.24205842"
 Parameter: YPOS -> "15.5492854"
 Parameter: ZPOS -> "-15.4940829"
 Parameter: XPHI -> "37.7147218"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.791066    0.611730
    0.000000   -0.611730    0.791066

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   37.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.24205842"
 Parameter: YPOS -> "15.5492854"
 Parameter: ZPOS -> "-15.4940829"
 Parameter: YPHI -> "100.289719"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.178626    0.000000   -0.983917
    0.000000    1.000000    0.000000
    0.983917    0.000000   -0.178626

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  100.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.24205842"
 Parameter: YPOS -> "15.5492854"
 Parameter: ZPOS -> "-15.4940829"
 Parameter: ZPHI -> "67.5411224"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.382020    0.924154    0.000000
   -0.924154    0.382020    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   67.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.242058 XMAX =    9.242058 XAVE =    9.242058
    YMIN =   15.549285 YMAX =   15.549285 YAVE =   15.549285
    ZMIN =  -15.494083 ZMAX =  -15.494083 ZAVE =  -15.494083
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.24205842"
Evaluating: 9.24205842+3.5
 Parameter: XMAX <- "12.7420584"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.5492854"
Evaluating: 15.5492854+3.5
 Parameter: YMAX <- "19.0492854"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.4940829"
Evaluating: -15.4940829+3.5
 Parameter: ZMAX <- "-11.9940829"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.24205842"
Evaluating: 9.24205842-3.5
 Parameter: XMIN <- "5.74205842"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.5492854"
Evaluating: 15.5492854-3.5
 Parameter: YMIN <- "12.0492854"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.4940829"
Evaluating: -15.4940829-3.5
 Parameter: ZMIN <- "-18.9940829"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.7420584"
 Parameter: XMIN -> "5.74205842"
 Parameter: YMAX -> "19.0492854"
 Parameter: YMIN -> "12.0492854"
 Parameter: ZMAX -> "-11.9940829"
 Parameter: ZMIN -> "-18.9940829"
 SELRPN>     10 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      3 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "78" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "78" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "62"
Evaluating: 78-62
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.432855389"
Evaluating: 81.6823114*(0.432855389-0.5)
 Parameter: XPOS <- "-5.48452702"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.585457429"
Evaluating: 81.6823114*(0.585457429-0.5)
 Parameter: YPOS <- "6.98036033"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.746459369"
Evaluating: 85*(0.746459369-0.5)+0
 Parameter: ZPOS <- "20.9490464"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.9490464" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.9490464" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.48452702"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.48452702-0
 Parameter: XTRAN <- "-5.48452702"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.98036033"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.98036033-0
 Parameter: YTRAN <- "6.98036033"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.9490464"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 20.9490464-0
 Parameter: ZTRAN <- "20.9490464"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.48452702"
 Parameter: YTRAN -> "6.98036033"
 Parameter: ZTRAN -> "20.9490464"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -5.484527    6.980360   20.949046
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.344165476"
Evaluating: 0.344165476*360.0
 Parameter: XPHI <- "123.899571"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.843601491"
Evaluating: 0.843601491*360.0
 Parameter: YPHI <- "303.696537"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.850590352"
Evaluating: 0.850590352*360.0
 Parameter: ZPHI <- "306.212527"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.48452702"
 Parameter: YPOS -> "6.98036033"
 Parameter: ZPOS -> "20.9490464"
 Parameter: XPHI -> "123.899571"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.557739    0.830016
    0.000000   -0.830016   -0.557739

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.48452702"
 Parameter: YPOS -> "6.98036033"
 Parameter: ZPOS -> "20.9490464"
 Parameter: YPHI -> "303.696537"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.554794    0.000000    0.831988
    0.000000    1.000000    0.000000
   -0.831988    0.000000    0.554794

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   56.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.48452702"
 Parameter: YPOS -> "6.98036033"
 Parameter: ZPOS -> "20.9490464"
 Parameter: ZPHI -> "306.212527"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.590782   -0.806831    0.000000
    0.806831    0.590782    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   53.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.484527 XMAX =   -5.484527 XAVE =   -5.484527
    YMIN =    6.980360 YMAX =    6.980360 YAVE =    6.980360
    ZMIN =   20.949046 ZMAX =   20.949046 ZAVE =   20.949046
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.48452702"
Evaluating: -5.48452702+3.5
 Parameter: XMAX <- "-1.98452702"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.98036033"
Evaluating: 6.98036033+3.5
 Parameter: YMAX <- "10.4803603"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.9490464"
Evaluating: 20.9490464+3.5
 Parameter: ZMAX <- "24.4490464"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.48452702"
Evaluating: -5.48452702-3.5
 Parameter: XMIN <- "-8.98452702"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.98036033"
Evaluating: 6.98036033-3.5
 Parameter: YMIN <- "3.48036033"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.9490464"
Evaluating: 20.9490464-3.5
 Parameter: ZMIN <- "17.4490464"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.98452702"
 Parameter: XMIN -> "-8.98452702"
 Parameter: YMAX -> "10.4803603"
 Parameter: YMIN -> "3.48036033"
 Parameter: ZMAX -> "24.4490464"
 Parameter: ZMIN -> "17.4490464"
 SELRPN>     15 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      7 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26598 NEG      CLA      16       CLA     - 135 MEMB     POPC     2        N             3.4659
26598 NEG      CLA      16       CLA     - 136 MEMB     POPC     2        C12           3.0187
26598 NEG      CLA      16       CLA     - 139 MEMB     POPC     2        C13           3.8008
26598 NEG      CLA      16       CLA     - 147 MEMB     POPC     2        C15           3.1115
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "78" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "62"
Evaluating: 78-62
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.405996016"
Evaluating: 81.6823114*(0.405996016-0.5)
 Parameter: XPOS <- "-7.67846269"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.196317164"
Evaluating: 81.6823114*(0.196317164-0.5)
 Parameter: YPOS <- "-24.805516"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.426575582"
Evaluating: 85*(0.426575582-0.5)+0
 Parameter: ZPOS <- "-6.24107553"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.24107553" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.24107553" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "78" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "62"
Evaluating: 78-62
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.250752316"
Evaluating: 81.6823114*(0.250752316-0.5)
 Parameter: XPOS <- "-20.3591269"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.107615359"
Evaluating: 81.6823114*(0.107615359-0.5)
 Parameter: YPOS <- "-32.0508844"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.943547217"
Evaluating: 85*(0.943547217-0.5)+0
 Parameter: ZPOS <- "37.7015134"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.7015134" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.7015134" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.484527 XMAX =   -5.484527 XAVE =   -5.484527
    YMIN =    6.980360 YMAX =    6.980360 YAVE =    6.980360
    ZMIN =   20.949046 ZMAX =   20.949046 ZAVE =   20.949046
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.3591269"
 RDCMND substituted energy or value "?XAVE" to "-5.48452702"
Evaluating: -20.3591269--5.48452702
 Parameter: XTRAN <- "-14.8745999"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.0508844"
 RDCMND substituted energy or value "?YAVE" to "6.98036033"
Evaluating: -32.0508844-6.98036033
 Parameter: YTRAN <- "-39.0312447"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.7015134"
 RDCMND substituted energy or value "?ZAVE" to "20.9490464"
Evaluating: 37.7015134-20.9490464
 Parameter: ZTRAN <- "16.752467"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.8745999"
 Parameter: YTRAN -> "-39.0312447"
 Parameter: ZTRAN -> "16.752467"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -14.874600  -39.031245   16.752467
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.124579811"
Evaluating: 0.124579811*360.0
 Parameter: XPHI <- "44.848732"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905463718"
Evaluating: 0.905463718*360.0
 Parameter: YPHI <- "325.966938"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.935243314"
Evaluating: 0.935243314*360.0
 Parameter: ZPHI <- "336.687593"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.3591269"
 Parameter: YPOS -> "-32.0508844"
 Parameter: ZPOS -> "37.7015134"
 Parameter: XPHI -> "44.848732"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.708971    0.705237
    0.000000   -0.705237    0.708971

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   44.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.3591269"
 Parameter: YPOS -> "-32.0508844"
 Parameter: ZPOS -> "37.7015134"
 Parameter: YPHI -> "325.966938"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.828715    0.000000    0.559671
    0.000000    1.000000    0.000000
   -0.559671    0.000000    0.828715

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   34.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.3591269"
 Parameter: YPOS -> "-32.0508844"
 Parameter: ZPOS -> "37.7015134"
 Parameter: ZPHI -> "336.687593"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.918361   -0.395744    0.000000
    0.395744    0.918361    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   23.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.359127 XMAX =  -20.359127 XAVE =  -20.359127
    YMIN =  -32.050884 YMAX =  -32.050884 YAVE =  -32.050884
    ZMIN =   37.701513 ZMAX =   37.701513 ZAVE =   37.701513
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.3591269"
Evaluating: -20.3591269+3.5
 Parameter: XMAX <- "-16.8591269"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.0508844"
Evaluating: -32.0508844+3.5
 Parameter: YMAX <- "-28.5508844"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.7015134"
Evaluating: 37.7015134+3.5
 Parameter: ZMAX <- "41.2015134"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.3591269"
Evaluating: -20.3591269-3.5
 Parameter: XMIN <- "-23.8591269"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.0508844"
Evaluating: -32.0508844-3.5
 Parameter: YMIN <- "-35.5508844"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.7015134"
Evaluating: 37.7015134-3.5
 Parameter: ZMIN <- "34.2015134"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.8591269"
 Parameter: XMIN -> "-23.8591269"
 Parameter: YMAX -> "-28.5508844"
 Parameter: YMIN -> "-35.5508844"
 Parameter: ZMAX -> "41.2015134"
 Parameter: ZMIN -> "34.2015134"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "79" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "79" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "62"
Evaluating: 79-62
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "8.122557642E-02"
Evaluating: 81.6823114*(8.122557642E-02-0.5)
 Parameter: XPOS <- "-34.2064629"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "3.816061438E-02"
Evaluating: 81.6823114*(3.816061438E-02-0.5)
 Parameter: YPOS <- "-37.7241085"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.595183747"
Evaluating: 85*(0.595183747-0.5)+0
 Parameter: ZPOS <- "8.09061849"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.09061849" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.09061849" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "79" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "62"
Evaluating: 79-62
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.934495204"
Evaluating: 81.6823114*(0.934495204-0.5)
 Parameter: XPOS <- "35.4905726"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.427026473"
Evaluating: 81.6823114*(0.427026473-0.5)
 Parameter: YPOS <- "-5.96064636"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.448361445"
Evaluating: 85*(0.448361445-0.5)+0
 Parameter: ZPOS <- "-4.38927718"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.38927718" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.38927718" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "79" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "62"
Evaluating: 79-62
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.381527231"
Evaluating: 81.6823114*(0.381527231-0.5)
 Parameter: XPOS <- "-9.67712961"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.700771954"
Evaluating: 81.6823114*(0.700771954-0.5)
 Parameter: YPOS <- "16.3995173"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.358607556"
Evaluating: 85*(0.358607556-0.5)+0
 Parameter: ZPOS <- "-12.0183577"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.0183577" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.0183577" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "79" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "62"
Evaluating: 79-62
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.373264748"
Evaluating: 81.6823114*(0.373264748-0.5)
 Parameter: XPOS <- "-10.3520283"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.259286573"
Evaluating: 81.6823114*(0.259286573-0.5)
 Parameter: YPOS <- "-19.6620291"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.798326971"
Evaluating: 85*(0.798326971-0.5)+0
 Parameter: ZPOS <- "25.3577925"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.3577925" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.3577925" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.3520283"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.3520283-0
 Parameter: XTRAN <- "-10.3520283"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.6620291"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.6620291-0
 Parameter: YTRAN <- "-19.6620291"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.3577925"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.3577925-0
 Parameter: ZTRAN <- "25.3577925"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.3520283"
 Parameter: YTRAN -> "-19.6620291"
 Parameter: ZTRAN -> "25.3577925"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -10.352028  -19.662029   25.357792
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.970613446"
Evaluating: 0.970613446*360.0
 Parameter: XPHI <- "349.420841"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.326527454"
Evaluating: 0.326527454*360.0
 Parameter: YPHI <- "117.549883"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.887277977"
Evaluating: 0.887277977*360.0
 Parameter: ZPHI <- "319.420072"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.3520283"
 Parameter: YPOS -> "-19.6620291"
 Parameter: ZPOS -> "25.3577925"
 Parameter: XPHI -> "349.420841"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.983002   -0.183594
    0.000000    0.183594    0.983002

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   10.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.3520283"
 Parameter: YPOS -> "-19.6620291"
 Parameter: ZPOS -> "25.3577925"
 Parameter: YPHI -> "117.549883"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.462521    0.000000   -0.886608
    0.000000    1.000000    0.000000
    0.886608    0.000000   -0.462521

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.3520283"
 Parameter: YPOS -> "-19.6620291"
 Parameter: ZPOS -> "25.3577925"
 Parameter: ZPHI -> "319.420072"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.759499   -0.650508    0.000000
    0.650508    0.759499    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   40.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.352028 XMAX =  -10.352028 XAVE =  -10.352028
    YMIN =  -19.662029 YMAX =  -19.662029 YAVE =  -19.662029
    ZMIN =   25.357792 ZMAX =   25.357792 ZAVE =   25.357792
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.3520283"
Evaluating: -10.3520283+3.5
 Parameter: XMAX <- "-6.8520283"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.6620291"
Evaluating: -19.6620291+3.5
 Parameter: YMAX <- "-16.1620291"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.3577925"
Evaluating: 25.3577925+3.5
 Parameter: ZMAX <- "28.8577925"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.3520283"
Evaluating: -10.3520283-3.5
 Parameter: XMIN <- "-13.8520283"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.6620291"
Evaluating: -19.6620291-3.5
 Parameter: YMIN <- "-23.1620291"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.3577925"
Evaluating: 25.3577925-3.5
 Parameter: ZMIN <- "21.8577925"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.8520283"
 Parameter: XMIN -> "-13.8520283"
 Parameter: YMAX -> "-16.1620291"
 Parameter: YMIN -> "-23.1620291"
 Parameter: ZMAX -> "28.8577925"
 Parameter: ZMIN -> "21.8577925"
 SELRPN>      2 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "80" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "80" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "80"
 Parameter: NPOS -> "62"
Evaluating: 80-62
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.388250999"
Evaluating: 81.6823114*(0.388250999-0.5)
 Parameter: XPOS <- "-9.1279167"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.854769077"
Evaluating: 81.6823114*(0.854769077-0.5)
 Parameter: YPOS <- "28.9783582"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.754526247"
Evaluating: 85*(0.754526247-0.5)+0
 Parameter: ZPOS <- "21.634731"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.634731" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.634731" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.1279167"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.1279167-0
 Parameter: XTRAN <- "-9.1279167"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.9783582"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.9783582-0
 Parameter: YTRAN <- "28.9783582"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.634731"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.634731-0
 Parameter: ZTRAN <- "21.634731"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.1279167"
 Parameter: YTRAN -> "28.9783582"
 Parameter: ZTRAN -> "21.634731"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    -9.127917   28.978358   21.634731
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.560211107"
Evaluating: 0.560211107*360.0
 Parameter: XPHI <- "201.675999"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.100419597"
Evaluating: 0.100419597*360.0
 Parameter: YPHI <- "36.1510549"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.223160907"
Evaluating: 0.223160907*360.0
 Parameter: ZPHI <- "80.3379265"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.1279167"
 Parameter: YPOS -> "28.9783582"
 Parameter: ZPOS -> "21.634731"
 Parameter: XPHI -> "201.675999"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.929287   -0.369358
    0.000000    0.369358   -0.929287

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  158.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.1279167"
 Parameter: YPOS -> "28.9783582"
 Parameter: ZPOS -> "21.634731"
 Parameter: YPHI -> "36.1510549"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.807465    0.000000   -0.589916
    0.000000    1.000000    0.000000
    0.589916    0.000000    0.807465

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.1279167"
 Parameter: YPOS -> "28.9783582"
 Parameter: ZPOS -> "21.634731"
 Parameter: ZPHI -> "80.3379265"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.167837    0.985815    0.000000
   -0.985815    0.167837    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.127917 XMAX =   -9.127917 XAVE =   -9.127917
    YMIN =   28.978358 YMAX =   28.978358 YAVE =   28.978358
    ZMIN =   21.634731 ZMAX =   21.634731 ZAVE =   21.634731
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.1279167"
Evaluating: -9.1279167+3.5
 Parameter: XMAX <- "-5.6279167"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.9783582"
Evaluating: 28.9783582+3.5
 Parameter: YMAX <- "32.4783582"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.634731"
Evaluating: 21.634731+3.5
 Parameter: ZMAX <- "25.134731"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.1279167"
Evaluating: -9.1279167-3.5
 Parameter: XMIN <- "-12.6279167"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.9783582"
Evaluating: 28.9783582-3.5
 Parameter: YMIN <- "25.4783582"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.634731"
Evaluating: 21.634731-3.5
 Parameter: ZMIN <- "18.134731"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.6279167"
 Parameter: XMIN -> "-12.6279167"
 Parameter: YMAX -> "32.4783582"
 Parameter: YMIN -> "25.4783582"
 Parameter: ZMAX -> "25.134731"
 Parameter: ZMIN -> "18.134731"
 SELRPN>     13 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      6 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26600 NEG      CLA      18       CLA     -4536 MEMB     POPC     35       N             3.2704
26600 NEG      CLA      18       CLA     -4537 MEMB     POPC     35       C12           3.5216
26600 NEG      CLA      18       CLA     -4540 MEMB     POPC     35       C13           1.9620
26600 NEG      CLA      18       CLA     -4552 MEMB     POPC     35       C11           3.5767
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "80" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "80"
 Parameter: NPOS -> "62"
Evaluating: 80-62
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.756294986"
Evaluating: 81.6823114*(0.756294986-0.5)
 Parameter: XPOS <- "20.9347669"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.176654162"
Evaluating: 81.6823114*(0.176654162-0.5)
 Parameter: YPOS <- "-26.4116354"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.805149765"
Evaluating: 85*(0.805149765-0.5)+0
 Parameter: ZPOS <- "25.93773"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.93773" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.93773" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.127917 XMAX =   -9.127917 XAVE =   -9.127917
    YMIN =   28.978358 YMAX =   28.978358 YAVE =   28.978358
    ZMIN =   21.634731 ZMAX =   21.634731 ZAVE =   21.634731
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.9347669"
 RDCMND substituted energy or value "?XAVE" to "-9.1279167"
Evaluating: 20.9347669--9.1279167
 Parameter: XTRAN <- "30.0626836"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.4116354"
 RDCMND substituted energy or value "?YAVE" to "28.9783582"
Evaluating: -26.4116354-28.9783582
 Parameter: YTRAN <- "-55.3899936"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.93773"
 RDCMND substituted energy or value "?ZAVE" to "21.634731"
Evaluating: 25.93773-21.634731
 Parameter: ZTRAN <- "4.302999"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.0626836"
 Parameter: YTRAN -> "-55.3899936"
 Parameter: ZTRAN -> "4.302999"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    30.062684  -55.389994    4.302999
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660981493"
Evaluating: 0.660981493*360.0
 Parameter: XPHI <- "237.953337"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.217367169"
Evaluating: 0.217367169*360.0
 Parameter: YPHI <- "78.2521808"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.728881842"
Evaluating: 0.728881842*360.0
 Parameter: ZPHI <- "262.397463"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.9347669"
 Parameter: YPOS -> "-26.4116354"
 Parameter: ZPOS -> "25.93773"
 Parameter: XPHI -> "237.953337"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.530610   -0.847616
    0.000000    0.847616   -0.530610

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.9347669"
 Parameter: YPOS -> "-26.4116354"
 Parameter: ZPOS -> "25.93773"
 Parameter: YPHI -> "78.2521808"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.203604    0.000000   -0.979053
    0.000000    1.000000    0.000000
    0.979053    0.000000    0.203604

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   78.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.9347669"
 Parameter: YPOS -> "-26.4116354"
 Parameter: ZPOS -> "25.93773"
 Parameter: ZPHI -> "262.397463"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.132300   -0.991210    0.000000
    0.991210   -0.132300    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   97.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.934767 XMAX =   20.934767 XAVE =   20.934767
    YMIN =  -26.411635 YMAX =  -26.411635 YAVE =  -26.411635
    ZMIN =   25.937730 ZMAX =   25.937730 ZAVE =   25.937730
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.9347669"
Evaluating: 20.9347669+3.5
 Parameter: XMAX <- "24.4347669"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.4116354"
Evaluating: -26.4116354+3.5
 Parameter: YMAX <- "-22.9116354"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.93773"
Evaluating: 25.93773+3.5
 Parameter: ZMAX <- "29.43773"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.9347669"
Evaluating: 20.9347669-3.5
 Parameter: XMIN <- "17.4347669"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.4116354"
Evaluating: -26.4116354-3.5
 Parameter: YMIN <- "-29.9116354"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.93773"
Evaluating: 25.93773-3.5
 Parameter: ZMIN <- "22.43773"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.4347669"
 Parameter: XMIN -> "17.4347669"
 Parameter: YMAX -> "-22.9116354"
 Parameter: YMIN -> "-29.9116354"
 Parameter: ZMAX -> "29.43773"
 Parameter: ZMIN -> "22.43773"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "81" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "81" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "62"
Evaluating: 81-62
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "4.286660988E-02"
Evaluating: 81.6823114*(4.286660988E-02-0.5)
 Parameter: XPOS <- "-37.3397119"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.25714471"
Evaluating: 81.6823114*(0.25714471-0.5)
 Parameter: YPOS <- "-19.8369814"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.7576065"
Evaluating: 85*(0.7576065-0.5)+0
 Parameter: ZPOS <- "21.8965525"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.8965525" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.8965525" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.3397119"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.3397119-0
 Parameter: XTRAN <- "-37.3397119"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.8369814"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -19.8369814-0
 Parameter: YTRAN <- "-19.8369814"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.8965525"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.8965525-0
 Parameter: ZTRAN <- "21.8965525"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.3397119"
 Parameter: YTRAN -> "-19.8369814"
 Parameter: ZTRAN -> "21.8965525"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -37.339712  -19.836981   21.896552
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.591470116"
Evaluating: 0.591470116*360.0
 Parameter: XPHI <- "212.929242"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.474319505"
Evaluating: 0.474319505*360.0
 Parameter: YPHI <- "170.755022"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.633697461"
Evaluating: 0.633697461*360.0
 Parameter: ZPHI <- "228.131086"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.3397119"
 Parameter: YPOS -> "-19.8369814"
 Parameter: ZPOS -> "21.8965525"
 Parameter: XPHI -> "212.929242"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.839343   -0.543603
    0.000000    0.543603   -0.839343

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  147.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.3397119"
 Parameter: YPOS -> "-19.8369814"
 Parameter: ZPOS -> "21.8965525"
 Parameter: YPHI -> "170.755022"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.987010    0.000000   -0.160656
    0.000000    1.000000    0.000000
    0.160656    0.000000   -0.987010

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  170.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.3397119"
 Parameter: YPOS -> "-19.8369814"
 Parameter: ZPOS -> "21.8965525"
 Parameter: ZPHI -> "228.131086"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.667429   -0.744674    0.000000
    0.744674   -0.667429    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  131.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.339712 XMAX =  -37.339712 XAVE =  -37.339712
    YMIN =  -19.836981 YMAX =  -19.836981 YAVE =  -19.836981
    ZMIN =   21.896552 ZMAX =   21.896552 ZAVE =   21.896552
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.3397119"
Evaluating: -37.3397119+3.5
 Parameter: XMAX <- "-33.8397119"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.8369814"
Evaluating: -19.8369814+3.5
 Parameter: YMAX <- "-16.3369814"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.8965525"
Evaluating: 21.8965525+3.5
 Parameter: ZMAX <- "25.3965525"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.3397119"
Evaluating: -37.3397119-3.5
 Parameter: XMIN <- "-40.8397119"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.8369814"
Evaluating: -19.8369814-3.5
 Parameter: YMIN <- "-23.3369814"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.8965525"
Evaluating: 21.8965525-3.5
 Parameter: ZMIN <- "18.3965525"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.8397119"
 Parameter: XMIN -> "-40.8397119"
 Parameter: YMAX -> "-16.3369814"
 Parameter: YMIN -> "-23.3369814"
 Parameter: ZMAX -> "25.3965525"
 Parameter: ZMIN -> "18.3965525"
 SELRPN>      9 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      5 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26601 NEG      CLA      19       CLA     -9560 MEMB     POPC     73       C11           3.1798
26601 NEG      CLA      19       CLA     -9565 MEMB     POPC     73       O14           3.8853
26601 NEG      CLA      19       CLA     -9566 MEMB     POPC     73       O12           3.7807
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "81" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "62"
Evaluating: 81-62
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.56260077"
Evaluating: 81.6823114*(0.56260077-0.5)
 Parameter: XPOS <- "5.11337559"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.935937766"
Evaluating: 81.6823114*(0.935937766-0.5)
 Parameter: YPOS <- "35.6084044"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.783427114"
Evaluating: 85*(0.783427114-0.5)+0
 Parameter: ZPOS <- "24.0913047"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.0913047" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.0913047" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.339712 XMAX =  -37.339712 XAVE =  -37.339712
    YMIN =  -19.836981 YMAX =  -19.836981 YAVE =  -19.836981
    ZMIN =   21.896552 ZMAX =   21.896552 ZAVE =   21.896552
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.11337559"
 RDCMND substituted energy or value "?XAVE" to "-37.3397119"
Evaluating: 5.11337559--37.3397119
 Parameter: XTRAN <- "42.4530875"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.6084044"
 RDCMND substituted energy or value "?YAVE" to "-19.8369814"
Evaluating: 35.6084044--19.8369814
 Parameter: YTRAN <- "55.4453858"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.0913047"
 RDCMND substituted energy or value "?ZAVE" to "21.8965525"
Evaluating: 24.0913047-21.8965525
 Parameter: ZTRAN <- "2.1947522"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.4530875"
 Parameter: YTRAN -> "55.4453858"
 Parameter: ZTRAN -> "2.1947522"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR    42.453088   55.445386    2.194752
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737530324"
Evaluating: 0.737530324*360.0
 Parameter: XPHI <- "265.510917"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.228081892"
Evaluating: 0.228081892*360.0
 Parameter: YPHI <- "82.1094811"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.622768073"
Evaluating: 0.622768073*360.0
 Parameter: ZPHI <- "224.196506"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.11337559"
 Parameter: YPOS -> "35.6084044"
 Parameter: ZPOS -> "24.0913047"
 Parameter: XPHI -> "265.510917"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.078269   -0.996932
    0.000000    0.996932   -0.078269

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.11337559"
 Parameter: YPOS -> "35.6084044"
 Parameter: ZPOS -> "24.0913047"
 Parameter: YPHI -> "82.1094811"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.137281    0.000000   -0.990532
    0.000000    1.000000    0.000000
    0.990532    0.000000    0.137281

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   82.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.11337559"
 Parameter: YPOS -> "35.6084044"
 Parameter: ZPOS -> "24.0913047"
 Parameter: ZPHI -> "224.196506"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.716953   -0.697121    0.000000
    0.697121   -0.716953    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  135.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.113376 XMAX =    5.113376 XAVE =    5.113376
    YMIN =   35.608404 YMAX =   35.608404 YAVE =   35.608404
    ZMIN =   24.091305 ZMAX =   24.091305 ZAVE =   24.091305
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.11337559"
Evaluating: 5.11337559+3.5
 Parameter: XMAX <- "8.61337559"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.6084044"
Evaluating: 35.6084044+3.5
 Parameter: YMAX <- "39.1084044"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.0913047"
Evaluating: 24.0913047+3.5
 Parameter: ZMAX <- "27.5913047"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.11337559"
Evaluating: 5.11337559-3.5
 Parameter: XMIN <- "1.61337559"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.6084044"
Evaluating: 35.6084044-3.5
 Parameter: YMIN <- "32.1084044"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.0913047"
Evaluating: 24.0913047-3.5
 Parameter: ZMIN <- "20.5913047"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.61337559"
 Parameter: XMIN -> "1.61337559"
 Parameter: YMAX -> "39.1084044"
 Parameter: YMIN -> "32.1084044"
 Parameter: ZMAX -> "27.5913047"
 Parameter: ZMIN -> "20.5913047"
 SELRPN>      7 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      2 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26601 NEG      CLA      19       CLA     -7041 MEMB     POPC     54       C14           3.8191
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "81" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "62"
Evaluating: 81-62
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "2.781678575E-02"
Evaluating: 81.6823114*(2.781678575E-02-0.5)
 Parameter: XPOS <- "-38.5690163"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.449207508"
Evaluating: 81.6823114*(0.449207508-0.5)
 Parameter: YPOS <- "-4.14884815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.644479159"
Evaluating: 85*(0.644479159-0.5)+0
 Parameter: ZPOS <- "12.2807285"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.2807285" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.2807285" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "81" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "62"
Evaluating: 81-62
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.362695333"
Evaluating: 81.6823114*(0.362695333-0.5)
 Parameter: XPOS <- "-11.2153626"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.112717979"
Evaluating: 81.6823114*(0.112717979-0.5)
 Parameter: YPOS <- "-31.6340906"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.569752134"
Evaluating: 85*(0.569752134-0.5)+0
 Parameter: ZPOS <- "5.92893139"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.92893139" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.92893139" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "81" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "62"
Evaluating: 81-62
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.330912815"
Evaluating: 81.6823114*(0.330912815-0.5)
 Parameter: XPOS <- "-13.8114321"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.135637062"
Evaluating: 81.6823114*(0.135637062-0.5)
 Parameter: YPOS <- "-29.762007"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.684035363"
Evaluating: 85*(0.684035363-0.5)+0
 Parameter: ZPOS <- "15.6430059"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.6430059" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.6430059" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.113376 XMAX =    5.113376 XAVE =    5.113376
    YMIN =   35.608404 YMAX =   35.608404 YAVE =   35.608404
    ZMIN =   24.091305 ZMAX =   24.091305 ZAVE =   24.091305
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.8114321"
 RDCMND substituted energy or value "?XAVE" to "5.11337559"
Evaluating: -13.8114321-5.11337559
 Parameter: XTRAN <- "-18.9248077"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.762007"
 RDCMND substituted energy or value "?YAVE" to "35.6084044"
Evaluating: -29.762007-35.6084044
 Parameter: YTRAN <- "-65.3704114"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.6430059"
 RDCMND substituted energy or value "?ZAVE" to "24.0913047"
Evaluating: 15.6430059-24.0913047
 Parameter: ZTRAN <- "-8.4482988"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.9248077"
 Parameter: YTRAN -> "-65.3704114"
 Parameter: ZTRAN -> "-8.4482988"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -18.924808  -65.370411   -8.448299
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169321339"
Evaluating: 0.169321339*360.0
 Parameter: XPHI <- "60.955682"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.900184882"
Evaluating: 0.900184882*360.0
 Parameter: YPHI <- "324.066558"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78626528"
Evaluating: 0.78626528*360.0
 Parameter: ZPHI <- "283.055501"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.8114321"
 Parameter: YPOS -> "-29.762007"
 Parameter: ZPOS -> "15.6430059"
 Parameter: XPHI -> "60.955682"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.485486    0.874244
    0.000000   -0.874244    0.485486

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   60.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.8114321"
 Parameter: YPOS -> "-29.762007"
 Parameter: ZPOS -> "15.6430059"
 Parameter: YPHI -> "324.066558"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.809699    0.000000    0.586845
    0.000000    1.000000    0.000000
   -0.586845    0.000000    0.809699

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   35.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.8114321"
 Parameter: YPOS -> "-29.762007"
 Parameter: ZPOS -> "15.6430059"
 Parameter: ZPHI -> "283.055501"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.225895   -0.974152    0.000000
    0.974152    0.225895    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   76.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.811432 XMAX =  -13.811432 XAVE =  -13.811432
    YMIN =  -29.762007 YMAX =  -29.762007 YAVE =  -29.762007
    ZMIN =   15.643006 ZMAX =   15.643006 ZAVE =   15.643006
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.8114321"
Evaluating: -13.8114321+3.5
 Parameter: XMAX <- "-10.3114321"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.762007"
Evaluating: -29.762007+3.5
 Parameter: YMAX <- "-26.262007"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.6430059"
Evaluating: 15.6430059+3.5
 Parameter: ZMAX <- "19.1430059"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.8114321"
Evaluating: -13.8114321-3.5
 Parameter: XMIN <- "-17.3114321"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.762007"
Evaluating: -29.762007-3.5
 Parameter: YMIN <- "-33.262007"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.6430059"
Evaluating: 15.6430059-3.5
 Parameter: ZMIN <- "12.1430059"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.3114321"
 Parameter: XMIN -> "-17.3114321"
 Parameter: YMAX -> "-26.262007"
 Parameter: YMIN -> "-33.262007"
 Parameter: ZMAX -> "19.1430059"
 Parameter: ZMIN -> "12.1430059"
 SELRPN>     32 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     15 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26601 NEG      CLA      19       CLA     -5096 MEMB     POPS     39       O31           3.2704
26601 NEG      CLA      19       CLA     -5097 MEMB     POPS     39       C31           1.9452
26601 NEG      CLA      19       CLA     -5098 MEMB     POPS     39       O32           1.5639
26601 NEG      CLA      19       CLA     -5099 MEMB     POPS     39       C32           2.0915
26601 NEG      CLA      19       CLA     -5149 MEMB     POPS     39       C33           1.9390
26601 NEG      CLA      19       CLA     -5152 MEMB     POPS     39       C34           2.9576
26601 NEG      CLA      19       CLA     -8494 MEMB     POPC     65       C12           3.8923
26601 NEG      CLA      19       CLA     -8528 MEMB     POPC     65       C3            3.4992
26601 NEG      CLA      19       CLA     -8531 MEMB     POPC     65       O31           3.2116
26601 NEG      CLA      19       CLA     -8532 MEMB     POPC     65       C31           3.1306
26601 NEG      CLA      19       CLA     -8533 MEMB     POPC     65       O32           3.1896
26601 NEG      CLA      19       CLA     -8534 MEMB     POPC     65       C32           3.8005
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "81" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "62"
Evaluating: 81-62
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.156068291"
Evaluating: 81.6823114*(0.156068291-0.5)
 Parameter: XPOS <- "-28.093137"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.236304671"
Evaluating: 81.6823114*(0.236304671-0.5)
 Parameter: YPOS <- "-21.539244"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.218094396"
Evaluating: 85*(0.218094396-0.5)+0
 Parameter: ZPOS <- "-23.9619763"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.9619763" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.811432 XMAX =  -13.811432 XAVE =  -13.811432
    YMIN =  -29.762007 YMAX =  -29.762007 YAVE =  -29.762007
    ZMIN =   15.643006 ZMAX =   15.643006 ZAVE =   15.643006
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.093137"
 RDCMND substituted energy or value "?XAVE" to "-13.8114321"
Evaluating: -28.093137--13.8114321
 Parameter: XTRAN <- "-14.2817049"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.539244"
 RDCMND substituted energy or value "?YAVE" to "-29.762007"
Evaluating: -21.539244--29.762007
 Parameter: YTRAN <- "8.222763"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.9619763"
 RDCMND substituted energy or value "?ZAVE" to "15.6430059"
Evaluating: -23.9619763-15.6430059
 Parameter: ZTRAN <- "-39.6049822"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.2817049"
 Parameter: YTRAN -> "8.222763"
 Parameter: ZTRAN -> "-39.6049822"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -14.281705    8.222763  -39.604982
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.791700454"
Evaluating: 0.791700454*360.0
 Parameter: XPHI <- "285.012163"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.538281033"
Evaluating: 0.538281033*360.0
 Parameter: YPHI <- "193.781172"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.258320109"
Evaluating: 0.258320109*360.0
 Parameter: ZPHI <- "92.9952392"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.093137"
 Parameter: YPOS -> "-21.539244"
 Parameter: ZPOS -> "-23.9619763"
 Parameter: XPHI -> "285.012163"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.259024   -0.965871
    0.000000    0.965871    0.259024

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   74.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.093137"
 Parameter: YPOS -> "-21.539244"
 Parameter: ZPOS -> "-23.9619763"
 Parameter: YPHI -> "193.781172"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.971213    0.000000    0.238214
    0.000000    1.000000    0.000000
   -0.238214    0.000000   -0.971213

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.093137"
 Parameter: YPOS -> "-21.539244"
 Parameter: ZPOS -> "-23.9619763"
 Parameter: ZPHI -> "92.9952392"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.052253    0.998634    0.000000
   -0.998634   -0.052253    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   93.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.093137 XMAX =  -28.093137 XAVE =  -28.093137
    YMIN =  -21.539244 YMAX =  -21.539244 YAVE =  -21.539244
    ZMIN =  -23.961976 ZMAX =  -23.961976 ZAVE =  -23.961976
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.093137"
Evaluating: -28.093137+3.5
 Parameter: XMAX <- "-24.593137"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.539244"
Evaluating: -21.539244+3.5
 Parameter: YMAX <- "-18.039244"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.9619763"
Evaluating: -23.9619763+3.5
 Parameter: ZMAX <- "-20.4619763"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.093137"
Evaluating: -28.093137-3.5
 Parameter: XMIN <- "-31.593137"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.539244"
Evaluating: -21.539244-3.5
 Parameter: YMIN <- "-25.039244"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.9619763"
Evaluating: -23.9619763-3.5
 Parameter: ZMIN <- "-27.4619763"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.593137"
 Parameter: XMIN -> "-31.593137"
 Parameter: YMAX -> "-18.039244"
 Parameter: YMIN -> "-25.039244"
 Parameter: ZMAX -> "-20.4619763"
 Parameter: ZMIN -> "-27.4619763"
 SELRPN>      5 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      3 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "82" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "82" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "82"
 Parameter: NPOS -> "62"
Evaluating: 82-62
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "6.162318044E-02"
Evaluating: 81.6823114*(6.162318044E-02-0.5)
 Parameter: XPOS <- "-35.8076319"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.201064649"
Evaluating: 81.6823114*(0.201064649-0.5)
 Parameter: YPOS <- "-24.4177304"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.989034033"
Evaluating: 85*(0.989034033-0.5)+0
 Parameter: ZPOS <- "41.5678928"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.5678928" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.5678928" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.8076319"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.8076319-0
 Parameter: XTRAN <- "-35.8076319"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.4177304"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.4177304-0
 Parameter: YTRAN <- "-24.4177304"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.5678928"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.5678928-0
 Parameter: ZTRAN <- "41.5678928"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.8076319"
 Parameter: YTRAN -> "-24.4177304"
 Parameter: ZTRAN -> "41.5678928"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -35.807632  -24.417730   41.567893
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.543575287"
Evaluating: 0.543575287*360.0
 Parameter: XPHI <- "195.687103"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.265629513"
Evaluating: 0.265629513*360.0
 Parameter: YPHI <- "95.6266247"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.410323441"
Evaluating: 0.410323441*360.0
 Parameter: ZPHI <- "147.716439"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.8076319"
 Parameter: YPOS -> "-24.4177304"
 Parameter: ZPOS -> "41.5678928"
 Parameter: XPHI -> "195.687103"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.962753   -0.270384
    0.000000    0.270384   -0.962753

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  164.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.8076319"
 Parameter: YPOS -> "-24.4177304"
 Parameter: ZPOS -> "41.5678928"
 Parameter: YPHI -> "95.6266247"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.098045    0.000000   -0.995182
    0.000000    1.000000    0.000000
    0.995182    0.000000   -0.098045

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   95.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.8076319"
 Parameter: YPOS -> "-24.4177304"
 Parameter: ZPOS -> "41.5678928"
 Parameter: ZPHI -> "147.716439"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.845415    0.534110    0.000000
   -0.534110   -0.845415    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.807632 XMAX =  -35.807632 XAVE =  -35.807632
    YMIN =  -24.417730 YMAX =  -24.417730 YAVE =  -24.417730
    ZMIN =   41.567893 ZMAX =   41.567893 ZAVE =   41.567893
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.8076319"
Evaluating: -35.8076319+3.5
 Parameter: XMAX <- "-32.3076319"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.4177304"
Evaluating: -24.4177304+3.5
 Parameter: YMAX <- "-20.9177304"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.5678928"
Evaluating: 41.5678928+3.5
 Parameter: ZMAX <- "45.0678928"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.8076319"
Evaluating: -35.8076319-3.5
 Parameter: XMIN <- "-39.3076319"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.4177304"
Evaluating: -24.4177304-3.5
 Parameter: YMIN <- "-27.9177304"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.5678928"
Evaluating: 41.5678928-3.5
 Parameter: ZMIN <- "38.0678928"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.3076319"
 Parameter: XMIN -> "-39.3076319"
 Parameter: YMAX -> "-20.9177304"
 Parameter: YMIN -> "-27.9177304"
 Parameter: ZMAX -> "45.0678928"
 Parameter: ZMIN -> "38.0678928"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "83" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "83" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "62"
Evaluating: 83-62
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.580245328"
Evaluating: 81.6823114*(0.580245328-0.5)
 Parameter: XPOS <- "6.55462387"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.161220429"
Evaluating: 81.6823114*(0.161220429-0.5)
 Parameter: YPOS <- "-27.6722984"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.386659438"
Evaluating: 85*(0.386659438-0.5)+0
 Parameter: ZPOS <- "-9.63394777"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.63394777" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.63394777" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "83" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "62"
Evaluating: 83-62
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "5.825129935E-02"
Evaluating: 81.6823114*(5.825129935E-02-0.5)
 Parameter: XPOS <- "-36.0830549"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "4.218569704E-02"
Evaluating: 81.6823114*(4.218569704E-02-0.5)
 Parameter: YPOS <- "-37.3953305"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.110418989"
Evaluating: 85*(0.110418989-0.5)+0
 Parameter: ZPOS <- "-33.1143859"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.1143859" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.0830549"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.0830549-0
 Parameter: XTRAN <- "-36.0830549"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.3953305"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.3953305-0
 Parameter: YTRAN <- "-37.3953305"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.1143859"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.1143859-0
 Parameter: ZTRAN <- "-33.1143859"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.0830549"
 Parameter: YTRAN -> "-37.3953305"
 Parameter: ZTRAN -> "-33.1143859"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -36.083055  -37.395331  -33.114386
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.419568544E-02"
Evaluating: 9.419568544E-02*360.0
 Parameter: XPHI <- "33.9104468"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453395001"
Evaluating: 0.453395001*360.0
 Parameter: YPHI <- "163.2222"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.226144101"
Evaluating: 0.226144101*360.0
 Parameter: ZPHI <- "81.4118764"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.0830549"
 Parameter: YPOS -> "-37.3953305"
 Parameter: ZPOS -> "-33.1143859"
 Parameter: XPHI -> "33.9104468"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.829911    0.557896
    0.000000   -0.557896    0.829911

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   33.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.0830549"
 Parameter: YPOS -> "-37.3953305"
 Parameter: ZPOS -> "-33.1143859"
 Parameter: YPHI -> "163.2222"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
   -0.957431    0.000000   -0.288661
    0.000000    1.000000    0.000000
    0.288661    0.000000   -0.957431

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.0830549"
 Parameter: YPOS -> "-37.3953305"
 Parameter: ZPOS -> "-33.1143859"
 Parameter: ZPHI -> "81.4118764"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.149330    0.988787    0.000000
   -0.988787    0.149330    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   81.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.083055 XMAX =  -36.083055 XAVE =  -36.083055
    YMIN =  -37.395331 YMAX =  -37.395331 YAVE =  -37.395331
    ZMIN =  -33.114386 ZMAX =  -33.114386 ZAVE =  -33.114386
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.0830549"
Evaluating: -36.0830549+3.5
 Parameter: XMAX <- "-32.5830549"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.3953305"
Evaluating: -37.3953305+3.5
 Parameter: YMAX <- "-33.8953305"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.1143859"
Evaluating: -33.1143859+3.5
 Parameter: ZMAX <- "-29.6143859"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.0830549"
Evaluating: -36.0830549-3.5
 Parameter: XMIN <- "-39.5830549"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.3953305"
Evaluating: -37.3953305-3.5
 Parameter: YMIN <- "-40.8953305"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.1143859"
Evaluating: -33.1143859-3.5
 Parameter: ZMIN <- "-36.6143859"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.5830549"
 Parameter: XMIN -> "-39.5830549"
 Parameter: YMAX -> "-33.8953305"
 Parameter: YMIN -> "-40.8953305"
 Parameter: ZMAX -> "-29.6143859"
 Parameter: ZMIN -> "-36.6143859"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "84" and "84".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "84" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "84"
 Parameter: NPOS -> "62"
Evaluating: 84-62
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.572013211"
Evaluating: 81.6823114*(0.572013211-0.5)
 Parameter: XPOS <- "5.88220553"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.1460756"
Evaluating: 81.6823114*(0.1460756-0.5)
 Parameter: YPOS <- "-28.9093631"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.322069061"
Evaluating: 85*(0.322069061-0.5)+0
 Parameter: ZPOS <- "-15.1241298"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.1241298" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.88220553"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.88220553-0
 Parameter: XTRAN <- "5.88220553"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.9093631"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.9093631-0
 Parameter: YTRAN <- "-28.9093631"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.1241298"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.1241298-0
 Parameter: ZTRAN <- "-15.1241298"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.88220553"
 Parameter: YTRAN -> "-28.9093631"
 Parameter: ZTRAN -> "-15.1241298"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR     5.882206  -28.909363  -15.124130
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225888754"
Evaluating: 0.225888754*360.0
 Parameter: XPHI <- "81.3199514"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.816226469E-02"
Evaluating: 8.816226469E-02*360.0
 Parameter: YPHI <- "31.7384153"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.791879762"
Evaluating: 0.791879762*360.0
 Parameter: ZPHI <- "285.076714"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.88220553"
 Parameter: YPOS -> "-28.9093631"
 Parameter: ZPOS -> "-15.1241298"
 Parameter: XPHI -> "81.3199514"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.150917    0.988546
    0.000000   -0.988546    0.150917

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   81.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.88220553"
 Parameter: YPOS -> "-28.9093631"
 Parameter: ZPOS -> "-15.1241298"
 Parameter: YPHI -> "31.7384153"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.850459    0.000000   -0.526042
    0.000000    1.000000    0.000000
    0.526042    0.000000    0.850459

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.88220553"
 Parameter: YPOS -> "-28.9093631"
 Parameter: ZPOS -> "-15.1241298"
 Parameter: ZPHI -> "285.076714"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.260112   -0.965578    0.000000
    0.965578    0.260112    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   74.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.882206 XMAX =    5.882206 XAVE =    5.882206
    YMIN =  -28.909363 YMAX =  -28.909363 YAVE =  -28.909363
    ZMIN =  -15.124130 ZMAX =  -15.124130 ZAVE =  -15.124130
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.88220553"
Evaluating: 5.88220553+3.5
 Parameter: XMAX <- "9.38220553"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.9093631"
Evaluating: -28.9093631+3.5
 Parameter: YMAX <- "-25.4093631"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.1241298"
Evaluating: -15.1241298+3.5
 Parameter: ZMAX <- "-11.6241298"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.88220553"
Evaluating: 5.88220553-3.5
 Parameter: XMIN <- "2.38220553"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.9093631"
Evaluating: -28.9093631-3.5
 Parameter: YMIN <- "-32.4093631"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.1241298"
Evaluating: -15.1241298-3.5
 Parameter: ZMIN <- "-18.6241298"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.38220553"
 Parameter: XMIN -> "2.38220553"
 Parameter: YMAX -> "-25.4093631"
 Parameter: YMIN -> "-32.4093631"
 Parameter: ZMAX -> "-11.6241298"
 Parameter: ZMIN -> "-18.6241298"
 SELRPN>     23 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>     11 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
26604 NEG      CLA      22       CLA     -**** MEMB     POPC     137      O14           3.7153
26604 NEG      CLA      22       CLA     -**** MEMB     POPC     154      C1            3.2561
26604 NEG      CLA      22       CLA     -**** MEMB     POPC     154      C2            1.9663
26604 NEG      CLA      22       CLA     -**** MEMB     POPC     154      O21           1.8243
26604 NEG      CLA      22       CLA     -**** MEMB     POPC     154      C21           1.4867
26604 NEG      CLA      22       CLA     -**** MEMB     POPC     154      O22           1.2346
26604 NEG      CLA      22       CLA     -**** MEMB     POPC     154      C22           2.8368
26604 NEG      CLA      22       CLA     -**** MEMB     POPC     154      C3            2.9794
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "62"
 Comparing "84" and "62".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "84"
 Parameter: NPOS -> "62"
Evaluating: 84-62
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "3.082786089E-02"
Evaluating: 81.6823114*(3.082786089E-02-0.5)
 Parameter: XPOS <- "-38.3230648"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "81.6823114"
 RDCMND substituted energy or value "?RANDOM" to "0.486562382"
Evaluating: 81.6823114*(0.486562382-0.5)
 Parameter: YPOS <- "-1.0976157"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "85"
 Parameter: ZCEN -> "0"
 RDCMND substituted energy or value "?RANDOM" to "0.799895828"
Evaluating: 85*(0.799895828-0.5)+0
 Parameter: ZPOS <- "25.4911454"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.4911454" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.4911454" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.882206 XMAX =    5.882206 XAVE =    5.882206
    YMIN =  -28.909363 YMAX =  -28.909363 YAVE =  -28.909363
    ZMIN =  -15.124130 ZMAX =  -15.124130 ZAVE =  -15.124130
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.3230648"
 RDCMND substituted energy or value "?XAVE" to "5.88220553"
Evaluating: -38.3230648-5.88220553
 Parameter: XTRAN <- "-44.2052703"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.0976157"
 RDCMND substituted energy or value "?YAVE" to "-28.9093631"
Evaluating: -1.0976157--28.9093631
 Parameter: YTRAN <- "27.8117474"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.4911454"
 RDCMND substituted energy or value "?ZAVE" to "-15.1241298"
Evaluating: 25.4911454--15.1241298
 Parameter: ZTRAN <- "40.6152752"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.2052703"
 Parameter: YTRAN -> "27.8117474"
 Parameter: ZTRAN -> "40.6152752"
 SELRPN>      1 atoms have been selected out of  26604
 TRANSLATION VECTOR   -44.205270   27.811747   40.615275
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.755402394E-02"
Evaluating: 6.755402394E-02*360.0
 Parameter: XPHI <- "24.3194486"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.157972404"
Evaluating: 0.157972404*360.0
 Parameter: YPHI <- "56.8700654"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.765486919"
Evaluating: 0.765486919*360.0
 Parameter: ZPHI <- "275.575291"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.3230648"
 Parameter: YPOS -> "-1.0976157"
 Parameter: ZPOS -> "25.4911454"
 Parameter: XPHI -> "24.3194486"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.911264    0.411824
    0.000000   -0.411824    0.911264

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   24.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.3230648"
 Parameter: YPOS -> "-1.0976157"
 Parameter: ZPOS -> "25.4911454"
 Parameter: YPHI -> "56.8700654"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.546540    0.000000   -0.837433
    0.000000    1.000000    0.000000
    0.837433    0.000000    0.546540

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   56.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.3230648"
 Parameter: YPOS -> "-1.0976157"
 Parameter: ZPOS -> "25.4911454"
 Parameter: ZPHI -> "275.575291"
 SELRPN>      1 atoms have been selected out of  26604
 ROTATION MATRIX
    0.097154   -0.995269    0.000000
    0.995269    0.097154    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   84.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  26604
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.323065 XMAX =  -38.323065 XAVE =  -38.323065
    YMIN =   -1.097616 YMAX =   -1.097616 YAVE =   -1.097616
    ZMIN =   25.491145 ZMAX =   25.491145 ZAVE =   25.491145
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.3230648"
Evaluating: -38.3230648+3.5
 Parameter: XMAX <- "-34.8230648"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.09761568"
Evaluating: -1.09761568+3.5
 Parameter: YMAX <- "2.40238432"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.4911454"
Evaluating: 25.4911454+3.5
 Parameter: ZMAX <- "28.9911454"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.3230648"
Evaluating: -38.3230648-3.5
 Parameter: XMIN <- "-41.8230648"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.09761568"
Evaluating: -1.09761568-3.5
 Parameter: YMIN <- "-4.59761568"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.4911454"
Evaluating: 25.4911454-3.5
 Parameter: ZMIN <- "21.9911454"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.8230648"
 Parameter: XMIN -> "-41.8230648"
 Parameter: YMAX -> "2.40238432"
 Parameter: YMIN -> "-4.59761568"
 Parameter: ZMAX -> "28.9911454"
 Parameter: ZMIN -> "21.9911454"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  38756
 SELRPN>      0 atoms have been selected out of  38756

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "84"
 Comparing "85" and "84".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "POT"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "62"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "22"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     62 atoms have been selected out of  26604
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "26521"
 Parameter: POSAT <- "26521"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     22 atoms have been selected out of  26604
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "26583"
 Parameter: NEGAT <- "26583"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "26583" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "26583"
 Comparing "26521" and "26583".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of  26604
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>     62 atoms have been selected out of  26604
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "62"
 Parameter: NPOSATOMS <- "62"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     22 atoms have been selected out of  26604
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "22"
 Parameter: NNEGATOMS <- "22"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>     62 atoms have been selected out of  26604
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>     62 atoms have been selected out of  26604
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "62"
 Parameter: NIONATOMS <- "62"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "62" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      284
         Number of atoms         =    26604   Number of groups     =     6924
         Number of bonds         =    26320   Number of angles     =    50600
         Number of dihedrals     =    70360   Number of impropers  =      440
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4.3_ion_protmemb.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUL, 05. 2023. JOB
 TITLE> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 TITLE> *  DATE:     7/ 5/23     14:34:12      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for 26520 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "5.911715562E-12"
Evaluating: 5.911715562E-12
 Parameter: CGTOTINIT <- "5.911715562E-12"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "5.911715562E-12"
Evaluating: INT(5.911715562E-12)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "5.911715562E-12"
Evaluating: ABS(0-5.911715562E-12)
 Parameter: CGDIFF <- "5.911715562E-12"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "5.911715562E-12" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>  26520 atoms have been selected out of  26604

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:        200 residues deleted.

 Message from MAPIC:          1 segments deleted.
 DELTIC:     26320 bonds deleted
 DELTIC:     50600 angles deleted
 DELTIC:     70360 dihedrals deleted
 DELTIC:       440 improper dihedrals deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =       84
         Number of atoms         =       84   Number of groups     =       84
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   40.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 62
 RDTITL> * SET NNEGTOT = 22
 RDTITL> * SET NIONTOT = 84
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     14.97 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    14.98  SECONDS 
                         CPU TIME:    14.87  SECONDS 
